{"version":3,"sources":["model/houseguest.ts","model/playerProfile.ts","utils/utilities.ts","utils/relationshipMap.ts","model/color.ts","utils/ai/classifyRelationship.ts","components/playerPortrait/subtitle.tsx","model/portraitDisplayMode.ts","components/playerPortrait/selectedPortrait.ts","subjects/subjects.tsx","components/playerPortrait/houseguestPortraitController.ts","components/playerPortrait/houseguestPortrait.tsx","components/playerPortrait/houseguestToPortrait.tsx","components/tooltip/tooltip.tsx","components/playerPortrait/portraits.tsx","components/memoryWall/memoryWall.tsx","components/layout/text.ts","components/playerPortrait/setupPortrait.tsx","components/castingScreen/numericInput.tsx","components/castingScreen/randomXButton.tsx","components/layout/centered.tsx","components/episode/allianceList.tsx","components/viewsBar/viewBarTag.tsx","components/viewsBar/viewBar.tsx","components/seasonEditor/seasonEditorList.tsx","components/seasonEditor/twistAdder.tsx","components/episode/episodes.tsx","components/episode/bigBrotherEpisode.tsx","components/episode/scenes/scene.tsx","components/nextEpisodeButton/nextEpisodeButton.tsx","components/mainPage/fullscreenButton.tsx","components/episode/scenes/votingTable.tsx","model/logging/voteType.tsx","utils/listStrings.ts","components/episode/scenes/hohCompScene.tsx","components/layout/box.tsx","utils/fft.ts","utils/poissonbinomial.ts","utils/ai/aiUtils.ts","utils/ai/targets.ts","utils/ai/aiApi.ts","components/episode/scenes/botbNomCeremonyScene.tsx","components/episode/veto/veto.tsx","components/episode/botbEpisode.tsx","components/episode/scenes/botbScene.tsx","components/episode/boomerangVetoEpisode.tsx","components/episode/scenes/nomCeremonyScene.tsx","components/episode/scenes/vetoCompScene.tsx","components/episode/scenes/vetoCeremonyScene.tsx","components/episode/utilities/evictHouseguest.ts","model/season.ts","model/gameState.ts","components/episode/scenes/evictionScene.tsx","components/episode/coHoHEpisode.tsx","components/episode/diamondVetoEpisode.tsx","components/episode/doubleEvictionEpisode.tsx","components/episode/forcedVetoEpisode.tsx","components/episode/instantEvictionEpisode.tsx","components/episode/noVetoEpisode.tsx","components/episode/pregameEpisode.tsx","components/episode/tripleEvictionEpisodeCad.tsx","components/episode/tripleEvictionEpisodeUs.tsx","components/seasonEditor/seasonEditorPage.tsx","components/castingScreen/castingScreen.tsx","components/deckScreen/deckScreen.tsx","components/topbar/topBar.tsx","components/pregameScreen/pregameScreen.tsx","utils/BbRandomGenerator.ts","model/logging/episodelog.ts","utils/generateGraph.ts","utils/generateCliques.ts","components/episode/episodeFactory.ts","components/episode/bigBrotherWeekstartWrapper.tsx","components/episode/scenes/juryVoteScene.tsx","components/episode/bigBrotherFinale.tsx","components/episode/scenes/finalHohCompScene.tsx","components/episode/scenes/finalEvictionScene.tsx","components/episode/gameOver.tsx","components/sidebar/sidebarController.ts","components/sidebar/sidebar.tsx","components/mainPage/mainContentArea.tsx","components/mainPage/mainPage.tsx","components/mainPage/mainPageController.ts","theme/theme.ts","theme/globalTheme.ts","App.tsx","index.tsx"],"names":["Houseguest","_PlayerProfile","init","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","isEvicted","isJury","id","nominations","hohWins","povWins","compatibility","popularity","deltaPopularity","previousPopularity","relationships","targets","powerRanking","superiors","friends","enemies","targetingMe","assign","assertThisInitialized","inherits","createClass","key","value","villain","PlayerProfile","name","imageURL","castingScreenId","roundTwoDigits","number","Math","round","intersection","setA","setB","_intersection","Set","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","elem","has","add","err","return","difference","_difference","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","delete","isWellDefined","x","isNotWellDefined","magnitude","result","forEach","pow","angleBetween","y","length","Error","concat","acos","_","i","dot","newRelationshipMap","size","exclude","componentToHex","c","hex","toString","RelationshipType","TwoWayRelationshipType","Rgb","r","g","b","interpolateColor","min","max","percent","toHex","RelationshipTypeToSymbol","FRIEND","ENEMY","PAWN","QUEEN","classifyRelationship","heroPopularity","villainPopularity","relationship","benefitsHero","benefitsVillain","Friend","Pawn","Queen","Enemy","classifyTwoWayRelationship","PawnQueen","heroIsPregame","hero","addPopularityLine","state","detailed","subtitle","popularitySubtitle","deltaPop","houseguest","statePopularity","getDeltaPopularity","push","react_default","a","createElement","addCompsLine","compWins","style","lineHeight","popularityMinColor","popularityMaxColor","popularityMode","minColor","maxColor","backgroundColor","extremePopularity","xSquared","extremeValues","generateSubtitle","_addFriendshipCountTi","data","getSelectedPlayer","titles","friendOrEnemyTitle","map","txt","count","Relationship","friendEnemyCountTitle","addFriendshipCountTitles","arguments","powerMaxColor","powerMinColor","powerMode","selectPlayer","player","selectedPlayer$","displayMode$","keys","selectCastPlayer","selectedCastPlayers","selectedCastPlayer$","selectedColor","HouseguestPortraitController","view","subs","refreshData","props","setState","comparePowerRankings","defaultState","shuffle","selectedPlayer","displayMode","_this2","subscribe","sub","unsubscribe","get","Subtitle","styled","small","_templateObject","MemoryWallPortrait","div","_templateObject2","_ref","theme","portraitBorder","Evicted","_templateObject3","Jury","_templateObject4","Normal","img","_templateObject5","Grayscale","_templateObject6","Sepia","_templateObject7","HouseguestPortrait","_React$Component","controller","Img","imageClass","getImageClass","Portrait","onClick","src","height","width","React","Component","houseguestToPortrait","houseguestPortrait_HouseguestPortrait","common","Text","p","tooltip_templateObject","WideText","tooltip_templateObject2","Tooltip","visible","Txt","wide","Popover_default","position","isOpen","content","text","onMouseEnter","onMouseLeave","children","PortraitWrapper","className","centered","tooltip","tooltip_Tooltip","Portraits","rows","houseguests","display","justifyContent","alignItems","memoryWallPortrait","MemoryWall","margin","maxWidth","HasText","text_templateObject","Input","input","text_templateObject2","_ref2","EditPortrait","setupPortrait_templateObject","Noselect","setupPortrait_templateObject2","XButton","setupPortrait_templateObject3","EditButton","setupPortrait_templateObject4","SetupPortrait","selected","textAlign","maxHeight","onDoubleClick","onDelete","event","stopPropagation","onRename","imageUrl","NumericInputStyle","numericInput_templateObject","NumericInput","type","placeholder","onChange","target","test","RandomButton","_useState","useState","_useState2","slicedToArray","setNumber","disabled","random","parseInt","NoMargin","centered_templateObject","Center","centered_templateObject2","Centered","noMargin","CenteredBold","CenteredItallic","HelpLink","allianceList_templateObject","link","AllianceList","canDisplayCliques","gameState","elements","cliques","clique","affiliates","phase","core","getById","entries","toConsumableArray","href","rel","ViewBarTag","mode","_this3","background","toRgba","cursor","setDisplayMode","ViewsBar","inJury","marginBottom","viewBarTag_ViewBarTag","InvalidDragItem","seasonEditorList_templateObject","DragItem","seasonEditorList_templateObject2","_items","_castSize","getEpisodeLibrary","playersRemaining","_arr","_i","item","episode","BigBrotherVanilla","eliminates","ListItem","provided","snapshot","Item","isValid","ref","innerRef","draggableProps","dragHandleProps","weekText","getEmoji","twistCapacity$","BehaviorSubject","SeasonEditorList","castSize","week","items","newCapacity","twist","updateTwistCapacity","maxCapacity","newItems","Array","from","array","n","match","splice","removeFirstNMatching","unshift","refreshItems","removeLast1Matching","twist$","addRemoveTwist","addIndex","finalItems","playerCount","canPlayWith","setTwistsValid","every","react_beautiful_dnd_esm","onDragEnd","destination","_newItems$splice","source","index","removed","droppableId","droppableProps","draggableId","seasonEditorList_ListItem","Subject","emoji","TwistAdder","twistCount","twistCapacity","border","borderRadius","description","Label","readOnly","Episode","initialGameState","scenes","title","initialGamestate","Tabs","bigBrotherWeekstartWrapper_WeekStartWrapper","NextEpisodeButton","viewsBar","hasViewsbar","viewBar_ViewsBar","Scene","GameState","players","jury","render","switchSceneRelative","FullscreenIcon","fullscreenButton_templateObject","FullscreenButton","isFullscreen$","getValue","EndgameTableCell","td","votingTable_templateObject","tableCellBorder","EndgameTable","table","votingTable_templateObject2","Gray","votingTable_templateObject3","_ref3","grayCell","SaveCell","votingTable_templateObject4","_ref4","saveCell","White","votingTable_templateObject5","_ref5","lightGrayCell","votingTable_templateObject6","_ref6","evictedCell","WinnerCell","votingTable_templateObject7","_ref7","winnerCell","RunnerUpCell","_templateObject8","_ref8","runnerUpCell","NomineeCell","_templateObject9","_ref9","nomineeCell","HohCell","_templateObject10","_ref10","hohCell","PoVCell","_templateObject11","BlackRow","tr","_templateObject12","anotherKey","generateVotingTable","masterLog","log","houseguestCells","hg","evictionOrder","topRowCells","preVetoCells","vetoCells","postVetoCells","evictedCells","winnerCells","logs","cells","colspan","colSpan","generateTopRow","nominationsPreVeto","vetoWinner","rowSpan","interleave","generatePreVetoRow","generateVetoRow","nominationsPostVeto","generatePostVetoRow","saveOrEvict","soleVoter","votingTo","toLowerCase","evicted","voteTextLine1","values","votes","filter","vote","votesInMajority","outOf","votingTable_Evicted","generateEvictedRow","runnerUp","winner","_ref13","_ref12","WinnerVote","RunnerUpVote","winnerRow","topRow","preVetoRow","vetoRow","postVetoRow","blackRow","houseguestRows","evictedRow","desiredLength","reverse","_ref14","_ref15","tempList","slice","arr","thing","_ref16","apply","voteKey","getKey","SaveVote","NormalVote","NomineeVote","PoVvote","HoHVote","_this4","hohText","hohVote","listNames","names","join","generateHohCompScene","options","newGameState","MutableGameState","coHoH","coHohIsFinal","doubleEviction","previousHoh","previousHOH","newHoH","randomPlayer","newHoH2","currentLog","portraitLine","portraits_Portrait","wonText","scene","customText","__logindex__","h","ShadowBox","box_templateObject","overlay","StyledBox","box_templateObject2","bodyArea","DividerBox","Box","fft","real","imag","levels","cosTable","sinTable","cos","PI","sin","j","reverseBits","temp","halfsize","tablestep","k","l","tpre","tpim","val","transformRadix2","m","areal","newArrayOfZeros","aimag","breal","bimag","creal","cimag","convolveComplex","transformBluestein","xreal","ximag","yreal","yimag","outreal","outimag","pbincdf","pp","zeros","ones","num","cdf","nPlusOne","ω","sigmaLogModulusZ","sum","p_j","e1","e2","sigmaPrincipalArgz","atan2","ceil","d","exp","sigmaArgZ","ξ","_pbincdf","pHeroWinsTheFinale","hgs","juror","pJurorVotesForHero","deadValue","pHeroWins","winrate","villianName","getRelationshipSummary","doIWin","WinrateStrategy","TargetStrategy","Targets","firstTarget","secondTarget","newTarget","isBetterTarget","determineStrategy","MoR","StatusQuo","Underdog","isBetterTargetWithLogic","old","neww","decision","reason","strategy","winrateStrategy","High","Low","Medium","determineWinrateStrategy","r0","r1","voteBasedonWinrate","voteBasedOnRelationship","isBetterTargetStatusQuo","morStrategy","targetEnemies","voteBasedOnCentrality","isBetterTargetMoR","underdogStrategy","isBetterTargetUnderdog","internalCallback","nominees","condition","_computeLocalPopulari","nonFriends","nonEvictedHouseguests","relationshipWith","oldPop","oldHg","newPop","newHg","computeLocalPopularity","isMoreCentral","callback","_targetEnemies","nom0","nom1","heroBeatsnom0","heroBeatsnom1","lowestIndex","lowestScore","Infinity","currentScore","castVoteToSave","currentSave","nominee","evictionTarget","castEvictionVote","remainingPlayers","castF3Vote","HoH","evictNom0","winningOddsF3","evictNom1","castF4vote","houseguestCache","villain1","villain2","heroVs1","heroVs2","v1Vs2","backdoorNPlayers","sortedOptions","sort","hg1","hg2","generateBotbNomCeremonyScene","hoh1","hoh2","exclusions","noms1","noms2","nextNom","nom","require","block","noms","hoh","finalStatement","GoldenVeto","use","useGoldenVeto","DiamondVeto","checks","basicVetoChecks","ids1","ids2","worseTarget","SpotlightVeto","invertedDecision","BoomerangVeto","veto1","veto2","potentialSave","immunePlayers","BattleOfTheBlock","arrowsEnabled","generate","hohArray","hohCompScene","nomCeremonyScene","currentGameState","_generateHohCompScene","_generateHohCompScene2","botbscene","finalhoh","finalnoms","botbWinners","_generateBotbNomCerem","_generateBotbNomCerem2","_generateBotbScene","nomsArray","hoh0wins","rng","flipCoin","winners","hohIndex","nomIndex","block0","block1","w","generateBotbScene","_generateBotbScene2","vetostuff","generateVetoScenesOnwards","BoomerangVetoEpisode","generateBBVanillaScenes","generateNomCeremonyScene","hohList","nom3","nom2","thirdNominee","shuffleOrDont","myOur","theHoH","firstText","secondText","generateVetoCompScene","HoHs","veto","choices","povPlayers","everyoneWillPlay","objectSpread","introText","povWinner","firstRow","extras","generateVetoCeremonyScene","initialNominees","immuneHgs","povTarget","descisionText","vetoChoice","nomineeWonPov","tousethepov","replacementSpeech","nameAReplacement","finalNominees","HoHnamer","replacementNomineeNamer","HoHwonPoV","aReplacementNominee","oneOf","you","exclusion","replacementNoms","v","replacementNom","findIndex","nomineeNames","evictHouseguest","evictee","finalJurySize","refreshHgStats","updateDelta","getJurors","populateSuperiors","xi","average","house","targetId","calculatePopularity","updatePopularity","addTarget","getTargets","updateFriendCounts","generateEvictionScene","castVote","lastVoter","nonVoters","logic","voteCounts","pluralities","numbers","highest","reduce","acc","cur","getHighestIndicies","tieVote","tieBreaker","tieBreakerHg","VoteType","evictees","safe","evicteesSet","votesPerEvictee","voteCountText","listVotes","compWinner","soleVoteText","displayHoH","marginTop","voters","CoHoH","vetoCompScene","_generateNomCeremonyS","_generateNomCeremonyS2","vetoCeremonyScene","_generateVetoCompScen","_generateVetoCompScen2","evictionScene","_generateVetoCeremony","_generateVetoCeremony2","_generateEvictionScen","_generateEvictionScen2","DiamondVetoEpisode","DoubleEviction","incrementLogIndex","ForcedVetoEpisode","InstantEviction","NoVeto","PregameEpisodeType","PregameEpisode","_Episode","pregameScreen_PregameScreen","cast","TripleEvictionCad","tripleScenes","TripleEvictionUs","tripleEviction","Subheader","h3","seasonEditorPage_templateObject","label","seasonEditorPage_templateObject2","twists","submit","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","season$","pushToMainContentStream","cast$","Screens","Other","newEpisode","stop","_x","SeasonEditorPage","castLength","defaultJurySize","jurySize","setJurySize","validJurySize","validateJurySize","_useState3","_useState4","areTwistsValid","seasonEditorList_SeasonEditorList","padding","twistAdder_TwistAdder","color","paddingTop","paddingRight","float","CastingScreen","newCast","Season","_amount","amount","allPlayers","unselectedPlayers","selectedPlayers","handleUpload","handleFiles","files","handleDrop","newState","newName","prompt","_this5","setupPortrait_SetupPortrait","deleteMethod","rename","_this6","FileDrop","onDrop","multiple","getFiles","file","substr","lastIndexOf","URL","createObjectURL","decksPerPage","baseUrl","imageCache","DeckStyle","deckScreen_templateObject","deckScreen_templateObject2","DeckText","deckScreen_templateObject3","_callee2","folder","links","image","_context2","abrupt","fetch","sent","json","sample","_callee3","casts","playerProfiles","_loop","_context4","imageLinks","folderProfiles","_context3","url","delegateYield","t1","finish","castingScreen_CastingScreen","Casting","Deck","_React$useState","_React$useState2","setImage","_React$useState3","_React$useState4","loading","setLoading","deck","randomImageFromFolder","then","selectDeckSubject","DeckList","decks","DeckScreen","handlePageClick","page","debounceSearch","debounce","nextValue","debouncedSearchText","handleSearch","searchText","sortedDecks","selectedDecks","isSorted","_componentDidMount","selectedDecks$","minWidth","submitCasts","deckScreen_Centered","dist_default","previousLabel","nextLabel","breakLabel","breakClassName","pageCount","marginPagesDisplayed","pageRangeDisplayed","onPageChange","containerClassName","activeClassName","activeScreen$","TopbarLink","topBar_templateObject","ActiveTopbarLink","topBar_templateObject2","CastingScreenLink","LinkStyle","JSON","parse","stringify","EditSeasonLink","ChooseCastLink","deckScreen_DeckScreen","Topbar","tab","PregameScreen","textShadow","mainContentStream$","episodes$","switchEpisode$","weekStartTab$","theme$","BbRandomGenerator","seed","prand","xorshift128plus","_this$rng$next","_this$rng$next2","_prand$uniformIntDist","uniformIntDistribution","_prand$uniformIntDist2","_this$rng$next3","_this$rng$next4","rng$","EpisodeLog","castNames","string","hash","charCodeAt","hashcode","inclusions","excludedIds","includes","randomInt","_GameState","jurors","_GameState2","_init","profiles","profile","_GameState3","copy","cloneDeep","EdgeMap","generateGraph","nodes","edges","stringId","villainId","_generateEdge","generateEdge","_generateEdge2","edge","neighbors","newCliquesLength","generateCliques","bronKerbosch","rPrime","pPrime","node","xPrime","mergeCandidates","clq","cliqueI","cliqueJ","affiliatesI","affiliatesJ","blacklist","candidate","nextEpisode","episodeType","u","randomFloat","abs","θ","φ","iMap","jMap","impression","firstImpressions","resetLogIndex","finalState","WeekStartWrapper","helpText1","helptext2","TabItem","li","bigBrotherEpisode_templateObject","Tab","active","setActive","paddingLeft","juryVoteScene","finalists","castJuryVote","votesFor0","votesFor1","BigBrotherFinale","finalHoH","finalEviction","_finalHohCompScene","final3","enduranceWinner","enduranceLosers","skillWinner","finalHohCompScene","_finalHohCompScene2","_finalEvictionScene","_castEvictionVote","survivor","finalEvictionScene","_finalEvictionScene2","_juryVoteScene","_juryVoteScene2","juryScene","GameOver","episodeLibrary","whichEpisodeType","SidebarController","subscriptions","season","selectedEpisode","delta","selectedScene","renderedScenes","targetScene","lastEpisode","episodes","switchToScene","renderEpisode","screen","selectionsActive","onNewEpisode","library","_switchToScene","keyCode","_handleKeyDown","bind","firstLoad","Sidebar","allBBs","document","addEventListener","handleKeyDown","indexOf","t0","destroy","getEpisodes","episodeKey","breakKey","getHighlight","getSelectedEpisode","MainContentAreaWrapper","mainContentArea_templateObject","MainContentArea","contentStream","prevProps","prevState","window","scrollTo","MainPage","fullscreen","inject","hideOnFullscreen","wrapperStyle","overflow","topBar_Topbar","sidebar_Sidebar","overflowX","mainContentArea_MainContentArea","MainPageController","darkTheme","bg","toggleBorder","GlobalStyles","createGlobalStyle","globalTheme_templateObject","App","styled_components_browser_esm","Fragment","mainPage_MainPage","ReactDOM","src_App","getElementById"],"mappings":"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","file":"static/js/main.05528ea6.chunk.js","sourcesContent":["import { PlayerProfile } from \"./playerProfile\";\nimport { RelationshipMap } from \"../utils\";\n\ninterface HouseguestInit extends PlayerProfile {\n    id: number;\n    relationships: RelationshipMap;\n}\n\nexport class Houseguest extends PlayerProfile {\n    public isEvicted: boolean = false;\n    public isJury: boolean = false;\n\n    readonly id: number = 0;\n\n    public nominations: number = 0;\n    public hohWins: number = 0;\n    public povWins: number = 0;\n\n    // Popularity ranges from -1 to 1\n    public compatibility: [number, number, number] = [0, 0, 0];\n    public popularity: number = 0;\n    public deltaPopularity: number = 0;\n    public previousPopularity: number = 0;\n    readonly relationships: RelationshipMap = {};\n\n    public targets: [number, number] = [this.id, this.id];\n\n    // power rankings range from 0 to 1\n    public powerRanking: number = 0;\n    readonly superiors: { [id: number]: number } = {}; // { id : pHeroWins }\n\n    public relationshipWith(villain: Houseguest): number {\n        return this.relationships[villain.id];\n    }\n    public friends = 0;\n    public enemies = 0;\n    public targetingMe = 0;\n\n    constructor(init: HouseguestInit) {\n        super(init);\n        Object.assign(this, init);\n    }\n}\n","interface InitPlayerProfile {\n    readonly name: string;\n    readonly imageURL: string;\n}\n\nexport class PlayerProfile {\n    public name: string = \"\";\n    readonly imageURL: string = \"\";\n    public castingScreenId?: number | undefined = 0;\n    constructor(init: InitPlayerProfile) {\n        if (!init) {\n            return;\n        }\n        Object.assign(this, init);\n    }\n}\n","export function hashcode(string: string): number {\n    let hash = 0,\n        i,\n        chr;\n    if (string.length === 0) return hash;\n    for (i = 0; i < string.length; i++) {\n        chr = string.charCodeAt(i);\n        hash = (hash << 5) - hash + chr;\n        hash |= 0;\n    }\n    return hash;\n}\n\nexport function roundTwoDigits(number: number | undefined) {\n    if (!number) {\n        return 0;\n    }\n    return Math.round(number * 100);\n}\n\nexport function max(a: number, b: number) {\n    return a > b ? a : b;\n}\n\nexport function intersection<T>(setA: Set<T>, setB: Set<T>): Set<T> {\n    let _intersection = new Set<T>();\n    for (let elem of setB) {\n        if (setA.has(elem)) {\n            _intersection.add(elem);\n        }\n    }\n    return _intersection;\n}\nexport function difference<T>(setA: Set<T>, setB: Set<T>): Set<T> {\n    let _difference = new Set<T>(setA);\n    for (let elem of setB) {\n        _difference.delete(elem);\n    }\n    return _difference;\n}\n\nexport function extremeValues(x: number | undefined): number {\n    if (!x) {\n        return 0;\n    }\n    const xSquared = x * x;\n    if (x >= 0) {\n        return -xSquared + 2 * x;\n    } else {\n        return xSquared + 2 * x;\n    }\n}\n\nexport function average(x: number[]): number {\n    let sum = 0;\n    x.forEach((xi) => (sum += xi));\n    return sum / x.length;\n}\n\nexport function isWellDefined(x: any) {\n    return x !== null && x !== undefined;\n}\n\nexport function isNotWellDefined(x: any): x is null | undefined {\n    return x === null || x === undefined;\n}\n\nexport function dot(x: number[], y: number[]) {\n    if (x.length !== y.length)\n        throw new Error(\n            `Tried to get the dot product between two vectors of non-equal length: ${x.length} !== ${y.length}`\n        );\n    let result = 0;\n    x.forEach((_, i) => {\n        result += x[i] * y[i];\n    });\n    return result;\n}\n\nexport function magnitude(x: number[]): number {\n    let result = 0;\n    x.forEach((x) => (result += x ** 2));\n    return result;\n}\n\n// returns a value between 0 and pi\n\nexport function angleBetween(x: number[], y: number[]): number {\n    if (x.length !== y.length)\n        throw new Error(\n            `Tried to get the angle between two vectors of non-equal length: ${x.length} !== ${y.length}`\n        );\n    return Math.acos((dot(x, y) / magnitude(x)) * magnitude(y));\n}\n\n// takes in an array, a number n, and a match function, then removes the first n elements from the array for which the match function returns true\n\nexport function removeFirstNMatching(array: any[], n: number, match: (x: any) => boolean): any[] {\n    let i = 0;\n    while (i < array.length && n > 0) {\n        if (match(array[i])) {\n            n--;\n            array.splice(i, 1);\n            i--;\n        }\n        i++;\n    }\n    return array;\n}\n\n// takes in an array, a number n, and a match function, then removes the last elements from the array for which the match function returns true\n// returns the index of the first element that does not match, or -1\n\nexport function removeLast1Matching(array: any[], match: (x: any) => boolean): number {\n    let i = array.length - 1;\n    while (i >= 0) {\n        if (match(array[i])) {\n            array.splice(i, 1);\n            return i;\n        }\n        i--;\n    }\n    return -1;\n}\n","export interface RelationshipMap {\n    [id: number]: number;\n}\n\nexport function newRelationshipMap(size: number, exclude: number): RelationshipMap {\n    const result: RelationshipMap = {};\n    for (let i = 0; i < size; i++) {\n        if (i !== exclude) result[i] = 0;\n    }\n    return result;\n}\n","function componentToHex(c: any) {\n    var hex = Math.round(c).toString(16);\n    return hex.length == 1 ? \"0\" + hex : hex;\n}\n\nexport class Rgb {\n    public r: number;\n    public g: number;\n    public b: number;\n    public toHex() {\n        return \"#\" + componentToHex(this.r) + componentToHex(this.g) + componentToHex(this.b);\n    }\n    public toRgba(): string {\n        return `rgba(${this.r}, ${this.g}, ${this.b}, 1)`;\n    }\n    constructor(r: number, g: number, b: number) {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n    }\n}\n\nexport function interpolateColor(min: Rgb, max: Rgb, percent: number): string {\n    return new Rgb(\n        min.r + percent * (max.r - min.r),\n        min.g + percent * (max.g - min.g),\n        min.b + percent * (max.b - min.b)\n    ).toHex();\n}\n","export enum RelationshipType {\n    Friend = \"FRIEND\",\n    Queen = \"QUEEN\",\n    Pawn = \"PAWN\",\n    Enemy = \"ENEMY\",\n}\nexport enum TwoWayRelationshipType {\n    Friend = \"FRIEND\",\n    PawnQueen = \"PAWN/QUEEN\",\n    Enemy = \"ENEMY\",\n}\n\nexport const RelationshipTypeToSymbol = { FRIEND: \"♥\", ENEMY: \"💔\", PAWN: \"PAWN\", QUEEN: \"QUEEN\" };\n\nexport function classifyRelationship(\n    heroPopularity: number,\n    villainPopularity: number,\n    relationship: number\n): RelationshipType {\n    const benefitsHero = relationship > heroPopularity;\n    const benefitsVillain = relationship > villainPopularity;\n    if (benefitsHero && benefitsVillain) {\n        return RelationshipType.Friend;\n    } else if (benefitsHero && !benefitsVillain) {\n        return RelationshipType.Pawn;\n    } else if (!benefitsHero && benefitsVillain) {\n        return RelationshipType.Queen;\n    }\n    return RelationshipType.Enemy;\n}\n\nexport function classifyTwoWayRelationship(\n    heroPopularity: number,\n    villainPopularity: number,\n    relationship: number\n): TwoWayRelationshipType {\n    const benefitsHero = relationship > heroPopularity;\n    const benefitsVillain = relationship > villainPopularity;\n    if (benefitsHero && benefitsVillain) {\n        return TwoWayRelationshipType.Friend;\n    } else if (!benefitsHero && !benefitsVillain) {\n        return TwoWayRelationshipType.Enemy;\n    }\n    return TwoWayRelationshipType.PawnQueen;\n}\n","import React from \"react\";\nimport { isWellDefined, roundTwoDigits } from \"../../utils\";\nimport { ProfileHouseguest, PortraitProps, PortraitState } from \"../memoryWall\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport {\n    RelationshipTypeToSymbol,\n    RelationshipType as Relationship,\n    classifyRelationship,\n} from \"../../utils/ai/classifyRelationship\";\nimport { getSelectedPlayer } from \"../../subjects/subjects\";\n\nexport function heroIsPregame(hero: PortraitProps): boolean {\n    const heroIsZero =\n        hero.friends === 0 && hero.enemies === 0 && hero.popularity === 0 && hero.targetingMe === 0;\n    return heroIsZero || (hero.friends === undefined && hero.enemies === undefined);\n}\n\nexport function generatePowerSubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    _: boolean | undefined\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    key = addPopularityLine(state, hero, !!_, subtitle, key);\n    key = addCompsLine(hero, subtitle, key);\n    if (!hero.isEvicted && state.powerRanking !== undefined) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            subtitle.push(<div key={key++}>{`WIN ${roundTwoDigits(state.powerRanking!)}%`}</div>);\n        } else if (data && data.id === hero.id) {\n            subtitle.push(<div key={key++}>I WOULD</div>);\n        } else {\n            subtitle.push(\n                <div key={key++}>{`WIN ${roundTwoDigits(state.powerRanking)}%${\n                    hero.targetingMe ? ` | 🎯 ${hero.targetingMe}` : \"\"\n                }`}</div>\n            );\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return subtitle;\n}\n\nexport function generatePopularitySubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    detailed: boolean = false\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    // popularity\n    key = addPopularityLine(state, hero, detailed, subtitle, key);\n    // competition wins\n    key = addCompsLine(hero, subtitle, key);\n    // friendship count / relationship classification titles\n    ({ subtitle, key } = addFriendshipCountTitles(hero, subtitle, key));\n    return subtitle;\n}\n\nfunction addFriendshipCountTitles(hero: PortraitProps, subtitle: any[], key: number) {\n    if (heroIsPregame(hero)) {\n        subtitle = subtitle.concat(<br key={key++} />);\n        return { subtitle, key };\n    }\n    if (!hero.isEvicted) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            const titles = friendOrEnemyTitle(hero, data);\n            subtitle = subtitle.concat(titles.map((txt) => <div key={key++}>{txt}</div>));\n        } else {\n            const titles = friendEnemyCountTitle(hero);\n            subtitle = subtitle.concat(titles.map((txt) => <div key={key++}>{txt}</div>));\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return { subtitle, key };\n}\n\nfunction addPopularityLine(\n    state: { popularity?: number },\n    hero: PortraitProps,\n    detailed: boolean,\n    subtitle: any[],\n    key: number\n) {\n    let popularity = state.popularity;\n    if (popularity && (popularity > 1 || popularity < -1)) {\n        popularity = hero.popularity;\n    }\n    if (popularity && !hero.isEvicted) {\n        let popularitySubtitle = `${roundTwoDigits(popularity)}%`;\n        const deltaPop = getDeltaPopularity(hero, popularity);\n        if (detailed && deltaPop !== 0) {\n            const arrow = deltaPop > 0 ? \" | ↑\" : \" | ↓\";\n            popularitySubtitle += `${arrow} ${deltaPop}%`;\n        }\n        subtitle.push(<div key={key++}>{popularitySubtitle}</div>);\n    }\n    return key;\n}\n\nfunction addCompsLine(hero: PortraitProps, subtitle: any[], key: number) {\n    if (compWins(hero)) {\n        subtitle.push(<div key={key++}>{`${compWins(hero)}`}</div>);\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return key;\n}\n\nfunction getDeltaPopularity(houseguest: PortraitProps, statePopularity: number) {\n    if (roundTwoDigits(houseguest.popularity) !== roundTwoDigits(statePopularity)) {\n        return 0;\n    }\n    return houseguest.deltaPopularity ? roundTwoDigits(houseguest.deltaPopularity) : 0;\n}\n\nfunction compWins(houseguest: ProfileHouseguest): string {\n    return `${houseguest.hohWins ? `♔ ${houseguest.hohWins}` : \"\"}${\n        houseguest.povWins && houseguest.hohWins\n            ? `|🛇 ${houseguest.povWins}`\n            : houseguest.povWins\n            ? `🛇 ${houseguest.povWins}`\n            : \"\"\n    }${(houseguest.hohWins || houseguest.povWins) && houseguest.nominations ? \"|\" : \"\"}${\n        houseguest.nominations ? `✘ ${houseguest.nominations}` : \"\"\n    }`;\n}\n\nfunction friendOrEnemyTitle(hero: PortraitProps, villain: SelectedPlayerData): string[] {\n    const titles: string[] = [];\n    titles.push(\n        RelationshipTypeToSymbol[\n            classifyRelationship(hero.popularity || 0, villain.popularity, hero.relationships![villain.id])\n        ]\n    );\n    return titles;\n}\n\nfunction friendEnemyCountTitle(hero: PortraitProps): string[] {\n    const titles: string[] = [];\n    const count =\n        isWellDefined(hero.friends) && isWellDefined(hero.enemies)\n            ? { friends: hero.friends, enemies: hero.enemies }\n            : { friends: 0, enemies: 0 };\n    titles.push(\n        `${count.friends} ${RelationshipTypeToSymbol[Relationship.Friend]}| ${count.enemies} ${\n            RelationshipTypeToSymbol[Relationship.Enemy]\n        }${hero.targetingMe ? `| 🎯 ${hero.targetingMe}` : \"\"}`\n    );\n    return titles;\n}\n","import { Rgb, interpolateColor } from \"./color\";\nimport { PortraitState, PortraitProps } from \"../components/memoryWall\";\nimport { extremeValues } from \"../utils\";\nimport { generatePopularitySubtitle, generatePowerSubtitle } from \"../components/playerPortrait/subtitle\";\n\nexport interface PortraitDisplayMode {\n    minColor: Rgb;\n    maxColor: Rgb;\n    backgroundColor: (state: PortraitState) => string;\n    generateSubtitle: (props: PortraitProps, state: PortraitState, detailed?: boolean) => any[];\n}\n\nconst popularityMinColor = new Rgb(252, 137, 137);\nconst popularityMaxColor = new Rgb(137, 252, 137);\n\nexport const popularityMode: PortraitDisplayMode = {\n    minColor: popularityMinColor,\n    maxColor: popularityMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const popularity = state.popularity;\n\n        const extremePopularity = extremeValues(popularity);\n        const percent = (extremePopularity + 1) / 2;\n        return interpolateColor(popularityMinColor, popularityMaxColor, percent);\n    },\n    generateSubtitle: generatePopularitySubtitle,\n};\n\nconst powerMaxColor = new Rgb(255, 204, 94);\nconst powerMinColor = new Rgb(192, 181, 255);\nexport const powerMode: PortraitDisplayMode = {\n    minColor: powerMinColor,\n    maxColor: powerMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const powerRanking = state.powerRanking;\n        if (powerRanking === undefined) return \"\";\n\n        return interpolateColor(powerMinColor, powerMaxColor, powerRanking);\n    },\n    generateSubtitle: generatePowerSubtitle,\n};\n","import { Houseguest } from \"../../model\";\nimport { RelationshipMap } from \"../../utils\";\nimport {\n    displayMode$,\n    getSelectedCastPlayers,\n    getSelectedPlayer,\n    selectedCastPlayer$,\n    selectedPlayer$,\n} from \"../../subjects/subjects\";\nimport { powerMode } from \"../../model/portraitDisplayMode\";\n\nexport interface SelectedPlayerData {\n    id: number;\n    popularity: number;\n    relationships: RelationshipMap;\n    isEvicted: boolean;\n    superiors?: { [id: number]: number };\n}\n\nexport function selectPlayer(player: SelectedPlayerData | null) {\n    if (!player || (getSelectedPlayer() && (getSelectedPlayer() as Houseguest).id === player.id)) {\n        selectedPlayer$.next(null);\n        return;\n    }\n    if (\n        !player.superiors ||\n        (displayMode$.value === powerMode && Object.keys(player.superiors).length === 0)\n    ) {\n        selectedPlayer$.next(null);\n        return;\n    }\n    selectedPlayer$.next(player);\n}\n\nexport function selectCastPlayer(id: number | null) {\n    if (id === null) {\n        selectedCastPlayer$.next(new Set());\n        return;\n    }\n    const selectedCastPlayers = getSelectedCastPlayers();\n    if (selectedCastPlayers.has(id)) {\n        // remove if exists\n        selectedCastPlayers.delete(id);\n    } else {\n        // else add\n        selectedCastPlayers.add(id);\n    }\n    selectedCastPlayer$.next(selectedCastPlayers);\n}\n","import { BehaviorSubject, Subject } from \"rxjs\";\nimport { PregameScreen } from \"../components/pregameScreen/pregameScreen\";\nimport { Episode, PlayerProfile } from \"../model\";\nimport { SelectedPlayerData } from \"../components/playerPortrait/selectedPortrait\";\nimport React from \"react\";\nimport { PortraitDisplayMode, popularityMode } from \"../model/portraitDisplayMode\";\nimport { ColorTheme } from \"../theme/theme\";\nimport { EpisodeLibrary } from \"../model/season\";\nimport { activeScreen$, Screens } from \"../components/topbar/topBar\";\n\n// What is currently being displayed.\nexport const mainContentStream$ = new BehaviorSubject(<PregameScreen cast={[]} />);\n\nexport function pushToMainContentStream(content: JSX.Element, tab?: Screens) {\n    tab && activeScreen$.next(tab);\n    mainContentStream$.next(content);\n}\n\n// Push episodes to this subject to add them to the sidebar. Null resets everything.\nexport const episodes$ = new BehaviorSubject<Episode | null>(null);\n// Forcibly switches to an episode. Used when adding a new episode.\nexport const switchEpisode$ = new Subject<number>();\nexport function newEpisode(episode: Episode | null) {\n    episodes$.next(episode);\n}\nexport function switchSceneRelative(n: number) {\n    switchEpisode$.next(n);\n}\n\n// pushed when a new season is created (may need to be upgraded to behavior subject in the future)\nexport const season$ = new Subject<EpisodeLibrary>();\n\n// the list of players in the game\nexport const cast$ = new BehaviorSubject<PlayerProfile[]>([]);\nexport function updateCast(newCast: PlayerProfile[]) {\n    cast$.next(newCast);\n}\nexport function getCast(): PlayerProfile[] {\n    return cast$.value;\n}\n// The player that the user has clicked on.\nexport const selectedPlayer$ = new BehaviorSubject<SelectedPlayerData | null>(null);\nexport function getSelectedPlayer() {\n    return selectedPlayer$.value;\n}\n\n// The cast member(s) that the user has clicked on.\n// Used for the casting screen.\nexport const selectedCastPlayer$ = new BehaviorSubject<Set<number>>(new Set<number>());\n\nexport function getSelectedCastPlayers() {\n    return selectedCastPlayer$.value;\n}\n\n// The decks that have been selected on the casting screen.\nexport const selectedDecks$ = new BehaviorSubject<Set<string>>(new Set<string>());\n\nexport function selectDeckSubject(deck: string | null) {\n    if (deck === null) {\n        selectedDecks$.next(new Set());\n        return;\n    }\n    const selectedDecks = selectedDecks$.value;\n    if (selectedDecks.has(deck)) {\n        // remove if exists\n        selectedDecks.delete(deck);\n    } else {\n        // else add\n        selectedDecks.add(deck);\n    }\n    selectedDecks$.next(selectedDecks);\n}\n\n// The tab selected on the start of each week.\nexport const weekStartTab$ = new BehaviorSubject<number>(0);\n\n// The display mode selected by the viewsbar.\nexport const displayMode$ = new BehaviorSubject<PortraitDisplayMode>(popularityMode);\n\n// If the screen is fullscreen or not.\nexport const isFullscreen$ = new BehaviorSubject<boolean>(false);\n\n// dark or light mode.\nexport const theme$ = new Subject<ColorTheme>();\n","import { PortraitProps, HouseguestPortrait, PortraitState } from \"../memoryWall\";\nimport { Subscription } from \"rxjs\";\nimport { selectedPlayer$, displayMode$, getSelectedPlayer } from \"../../subjects/subjects\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport { Rgb } from \"../../model/color\";\nimport { heroIsPregame } from \"./subtitle\";\nimport { shuffle } from \"lodash\";\n\nexport const selectedColor = new Rgb(51, 255, 249);\n\nexport class HouseguestPortraitController {\n    private subs: Subscription[] = [];\n    private view: HouseguestPortrait;\n    constructor(view: HouseguestPortrait) {\n        this.view = view;\n    }\n\n    get defaultState() {\n        return {\n            popularity: this.view.props.popularity,\n            displayMode: displayMode$.value,\n            powerRanking: this.view.props.powerRanking,\n        };\n    }\n\n    public backgroundColor(props: PortraitProps): undefined | string {\n        if (heroIsPregame(props)) {\n            return shuffle([\n                \"#ca9389\",\n                \"#cab389\",\n                \"#c0ca89\",\n                \"#cabb89\",\n                \"#c0ca89\",\n                \"#cabb89\",\n                \"#b9ca89\",\n                \"#98ca89\",\n            ])[0];\n        }\n        const selectedPlayer = getSelectedPlayer();\n        if (selectedPlayer !== null && selectedPlayer.id === props.id) {\n            return selectedColor.toHex();\n        }\n        return props.isEvicted ? undefined : this.view.state.displayMode.backgroundColor(this.view.state);\n    }\n\n    public subscribe() {\n        const subs: Subscription[] = [];\n        subs.push(\n            selectedPlayer$.subscribe({\n                next: this.refreshData,\n            })\n        );\n        subs.push(\n            displayMode$.subscribe({\n                next: (displayMode) => this.view.setState({ displayMode }),\n            })\n        );\n        this.subs = subs;\n    }\n\n    public unsubscribe() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    private comparePowerRankings(data: SelectedPlayerData): number {\n        // 0 is blue. 1 is orange\n        if (!data.superiors) return 0;\n        const id = this.view.props.id === undefined ? -1 : this.view.props.id;\n        return data.superiors[id];\n    }\n\n    private refreshData = (data: SelectedPlayerData | null) => {\n        if (!data) {\n            this.view.setState(this.defaultState);\n        } else {\n            if (data.id !== this.view.props.id) {\n                this.view.setState({\n                    popularity: data.relationships[this.view.props.id!],\n                    powerRanking: this.comparePowerRankings(data),\n                });\n            } else {\n                this.view.setState({ popularity: 2, powerRanking: 2 });\n            }\n        }\n    };\n}\n","import React from \"react\";\nimport { selectPlayer } from \"./selectedPortrait\";\nimport { isNotWellDefined, RelationshipMap } from \"../../utils\";\nimport _ from \"lodash\";\nimport { HouseguestPortraitController } from \"./houseguestPortraitController\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst Subtitle = styled.small`\n    font-weight: 100;\n    font-size: small;\n`;\n\nconst MemoryWallPortrait = styled.div`\n    margin: 5px;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.portraitBorder};\n    color: black;\n    border-radius: 5px;\n    text-align: center;\n    font-weight: 600;\n    width: 7rem;\n    word-wrap: break-word;\n    -webkit-transition-property: none;\n    -moz-transition-property: none;\n    -o-transition-property: none;\n    transition-property: none;\n`;\n\nconst Evicted = styled(MemoryWallPortrait)`\n    font-weight: 100;\n    color: grey;\n    background-color: #111111;\n`;\n\nconst Jury = styled(MemoryWallPortrait)`\n    font-weight: 100;\n    color: #c3ae88;\n    background-color: #5d5340;\n    filter: brightness(0.6);\n`;\n\nconst Normal = styled.img`\n    min-width: 100px;\n    width: 100%;\n    width: -moz-available; /* For Mozzila */\n    width: -webkit-fill-available; /* For Chrome */\n    width: stretch; /* Unprefixed */\n    -webkit-transition-property: none;\n    -moz-transition-property: none;\n    -o-transition-property: none;\n    transition-property: none;\n`;\n\nconst Grayscale = styled(Normal)`\n    filter: grayscale(100%);\n`;\n\nconst Sepia = styled(Normal)`\n    filter: sepia(100%);\n`;\n\nexport interface PortraitProps {\n    imageURL: string;\n    name: string;\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    powerRanking?: number;\n    deltaPopularity?: number;\n    detailed?: boolean;\n    superiors?: { [id: number]: number };\n    friends?: number;\n    enemies?: number;\n    targetingMe?: number;\n    targets?: number[];\n}\n\nexport interface PortraitState {\n    popularity?: number;\n    powerRanking?: number;\n    displayMode: PortraitDisplayMode;\n}\nexport class HouseguestPortrait extends React.Component<PortraitProps, PortraitState> {\n    private controller: HouseguestPortraitController;\n\n    public constructor(props: PortraitProps) {\n        super(props);\n        this.controller = new HouseguestPortraitController(this);\n        this.state = this.controller.defaultState;\n    }\n\n    public componentDidMount() {\n        if (isNotWellDefined(this.props.id)) {\n            return;\n        }\n        this.controller.subscribe();\n    }\n\n    public componentWillUnmount() {\n        this.controller.unsubscribe();\n    }\n\n    private onClick(): void {\n        if (\n            (this.props.targets && this.props.targets[0] === 0 && this.props.targets[1] == 0) ||\n            isNotWellDefined(this.props.id) ||\n            !this.props.relationships\n        ) {\n            return;\n        }\n        const data = {\n            id: this.props.id,\n            relationships: this.props.relationships,\n            isEvicted: !!this.props.isEvicted,\n            popularity: this.props.popularity || 0,\n            superiors: this.props.superiors,\n        };\n        selectPlayer(data);\n    }\n\n    public render() {\n        const props = this.props;\n        const Img = getImageClass(props);\n        let subtitle: any[] = [];\n        subtitle = this.state.displayMode.generateSubtitle(this.props, this.state, !!props.detailed);\n\n        let Portrait = MemoryWallPortrait;\n        if (props.isJury) {\n            Portrait = Jury;\n        } else if (props.isEvicted) {\n            Portrait = Evicted;\n        }\n        return (\n            <Portrait\n                onClick={() => this.onClick()}\n                style={{\n                    backgroundColor: this.controller.backgroundColor(props),\n                }}\n            >\n                <Img src={props.imageURL} style={{ height: 100, width: \"-moz-available\" }} />\n                <br />\n                {props.name}\n                <br />\n                {<Subtitle>{subtitle}</Subtitle>}\n            </Portrait>\n        );\n    }\n}\n\nfunction getImageClass(props: PortraitProps) {\n    let imageClass = props.isEvicted ? Grayscale : Normal;\n    imageClass = props.isJury ? Sepia : imageClass;\n    return imageClass;\n}\n","import { ProfileHouseguest, HouseguestPortrait } from \"../memoryWall\";\nimport React from \"react\";\n\nexport function houseguestToPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={false} />;\n}\n\nexport function memoryWallPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={true} />;\n}\n","import React from \"react\";\nimport Popover from \"react-tiny-popover\";\nimport styled from \"styled-components\";\n\nconst common = `padding: 3px 8px;\ncolor: #fff;\ntext-align: center;\nbackground-color: #000;\nborder-radius: 4px;`;\n\nconst Text = styled.p`\n    max-width: 200px;\n    ${common}\n`;\nconst WideText = styled.p`\n    max-width: 800px;\n    ${common}\n`;\ninterface TooltipProps {\n    text: string;\n    children: any;\n    wide?: boolean;\n}\n\ninterface ToolTipState {\n    visible: boolean;\n}\n\nexport class Tooltip extends React.Component<TooltipProps, ToolTipState> {\n    constructor(props: TooltipProps) {\n        super(props);\n        this.state = { visible: false };\n    }\n\n    public render() {\n        const Txt = this.props.wide ? WideText : Text;\n        return (\n            <Popover\n                position={[\"top\", \"bottom\"]}\n                isOpen={this.state.visible}\n                content={<Txt>{this.props.text}</Txt>}\n            >\n                <div\n                    onMouseEnter={() => this.setState({ visible: true })}\n                    onMouseLeave={() => this.setState({ visible: false })}\n                >\n                    {this.props.children}\n                </div>\n            </Popover>\n        );\n    }\n}\n","import React from \"react\";\nimport { ProfileHouseguest } from \"../memoryWall\";\nimport { houseguestToPortrait, memoryWallPortrait } from \"./houseguestToPortrait\";\nimport { Tooltip } from \"../tooltip/tooltip\";\n\nlet key = -1;\n\nfunction PortraitWrapper(props: { centered?: boolean; children: any }): JSX.Element {\n    return (\n        <div\n            key={key++}\n            className={`columns is-gapless is-mobile is-multiline ${props.centered ? \"is-centered\" : \"\"}`}\n        >\n            {props.children}\n        </div>\n    );\n}\n\nexport function Portrait(props: { houseguest: ProfileHouseguest; centered?: boolean }): JSX.Element {\n    const result = (\n        <PortraitWrapper centered={props.centered}>{houseguestToPortrait(props.houseguest)}</PortraitWrapper>\n    );\n    if (props.houseguest.tooltip) {\n        return (\n            <PortraitWrapper centered={props.centered}>\n                <Tooltip text={props.houseguest.tooltip}>{houseguestToPortrait(props.houseguest)}</Tooltip>\n            </PortraitWrapper>\n        );\n    }\n    return result;\n}\n\nexport function Portraits(props: {\n    houseguests: (ProfileHouseguest | \"⬅️\" | \"➡️\")[];\n    centered?: boolean;\n    detailed?: boolean;\n}): JSX.Element {\n    const rows: JSX.Element[] = [];\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    props.houseguests.forEach((houseguest: ProfileHouseguest | \"⬅️\" | \"➡️\") => {\n        let result;\n        if (houseguest === \"⬅️\" || houseguest === \"➡️\") {\n            result = (\n                <div\n                    key={`plus-${key++}`}\n                    style={{ display: \"flex\", justifyContent: \"center\", alignItems: \"center\" }}\n                    className=\"column is-narrow\"\n                >\n                    <p>{houseguest}</p>\n                </div>\n            );\n        } else if (props.detailed) {\n            result = memoryWallPortrait(houseguest, key++);\n        } else {\n            result = houseguestToPortrait(houseguest, key++);\n        }\n        if (houseguest !== \"⬅️\" && houseguest !== \"➡️\" && houseguest.tooltip) {\n            result = (\n                <Tooltip key={key++} text={houseguest.tooltip}>\n                    {result}\n                </Tooltip>\n            );\n        }\n        rows.push(result);\n    });\n    return (\n        <div className={`columns is-gapless is-mobile is-multiline ${props.centered && \"is-centered\"}`}>\n            {rows}\n        </div>\n    );\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { Portraits } from \"../playerPortrait/portraits\";\nimport { RelationshipMap } from \"../../utils\";\nexport interface IMemoryWallProps {\n    readonly houseguests: ProfileHouseguest[];\n}\n\nexport interface ProfileHouseguest extends PlayerProfile {\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    deltaPopularity?: number;\n    hohWins?: number;\n    povWins?: number;\n    nominations?: number;\n    tooltip?: string;\n    friends?: number;\n    enemies?: number;\n    targetingMe?: number;\n}\n\nexport function MemoryWall(props: IMemoryWallProps): JSX.Element {\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    return (\n        <div\n            style={{\n                margin: \"auto\",\n                maxWidth: props.houseguests.length < 26 ? 800 : -1,\n            }}\n        >\n            <Portraits houseguests={props.houseguests} centered={true} detailed={true} />\n        </div>\n    );\n}\n","import styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nexport const HasText = styled.div`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport const Input = styled.input`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { selectedColor } from \"./houseguestPortraitController\";\n\nconst EditPortrait = styled.div`\n    padding: 5px;\n    margin: 5px;\n    border: 1px solid grey;\n    background-color: grey;\n    color: black;\n    border-radius: 5px;\n    font-weight: 600;\n    width: 7rem;\n    word-wrap: break-word;\n`;\n\nexport const Noselect = styled.div`\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -khtml-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n`;\n\nconst XButton = styled(Noselect)`\n    color: #300808;\n    width: 50%;\n\n    :active {\n        color: #ff7133;\n        background-color: #ffd8c7;\n    }\n    :hover {\n        color: red;\n        background-color: #ffe1ea;\n    }\n`;\n\nconst EditButton = styled(Noselect)`\n    color: #300808;\n    width: 50%;\n\n    :active {\n        color: #ff7133;\n        background-color: #ffd8c7;\n    }\n    :hover {\n        color: orange;\n        background-color: #fff6e1;\n    }\n`;\n\ninterface SetupPortraitProps {\n    name: string;\n    imageUrl: string;\n    onDelete: () => void;\n    onRename: () => void;\n    onClick: () => void;\n    selected: boolean;\n}\n\ninterface SetupPortraitState {\n    name: string;\n}\n\nexport class SetupPortrait extends React.Component<SetupPortraitProps, SetupPortraitState> {\n    public constructor(props: SetupPortraitProps) {\n        super(props);\n        this.state = { name: props.name };\n    }\n\n    public UNSAFE_componentWillReceiveProps(props: SetupPortraitProps) {\n        this.setState({ name: props.name });\n    }\n\n    public render() {\n        const style = this.props.selected ? { backgroundColor: selectedColor.toHex() } : {};\n        return (\n            <EditPortrait onClick={() => this.props.onClick()} style={style}>\n                <div style={{ textAlign: \"center\" }}>\n                    <div style={{ maxHeight: 20, display: \"flex\" }}>\n                        <XButton\n                            onDoubleClick={() => this.props.onDelete()}\n                            onClick={(event) => event.stopPropagation()}\n                        >\n                            ✘\n                        </XButton>\n                        <EditButton\n                            onClick={(event) => {\n                                event.stopPropagation();\n                                this.props.onRename();\n                            }}\n                        >\n                            ✎\n                        </EditButton>\n                    </div>\n                    <img src={this.props.imageUrl} style={{ width: 100, height: 100 }} />\n                    <br />\n                    <p>{this.state.name}</p>\n                </div>\n            </EditPortrait>\n        );\n    }\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\n\ninterface NumericInputProps {\n    value: string;\n    onChange: (newValue: string) => void;\n    style?: any;\n    className?: string;\n    placeholder?: string;\n}\n\nexport const NumericInputStyle = styled.input`\n    width: 3em;\n`;\n\nexport function NumericInput(props: NumericInputProps) {\n    const style = props.style || {};\n    return (\n        <NumericInputStyle\n            type=\"text\"\n            className={`input${props.className ? ` ${props.className}` : \"\"}`}\n            style={style}\n            value={props.value}\n            placeholder={props.placeholder || \"\"}\n            onChange={(event) => {\n                const value = event.target.value;\n                if (/^\\d*$/g.test(value)) {\n                    props.onChange(value);\n                }\n            }}\n        />\n    );\n}\n","import React, { useState } from \"react\";\nimport { Tooltip } from \"../tooltip/tooltip\";\nimport { NumericInput } from \"./numericInput\";\n\ninterface RandomButtonProps {\n    random: (n: number) => void;\n}\n\nexport function RandomButton(props: RandomButtonProps): JSX.Element {\n    const [number, setNumber] = useState(\"16\");\n    return (\n        <div className=\"field has-addons\" style={{ display: \"flex\" }}>\n            <div className=\"control\">\n                <Tooltip text={\"Selected cast members will always be chosen.\"}>\n                    <button\n                        disabled={number === \"\"}\n                        className=\"button is-primary\"\n                        onClick={() => props.random(parseInt(number))}\n                    >\n                        Random\n                    </button>\n                </Tooltip>\n            </div>\n            <div className=\"control\">\n                <NumericInput value={number} onChange={setNumber} />\n            </div>\n        </div>\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\ninterface TextProps {\n    noMargin?: boolean;\n    children?: any;\n    style?: any;\n    className?: string;\n}\n\nconst NoMargin = styled.div`\n    text-align: center;\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\nconst Center = styled.p`\n    text-align: center;\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport function Centered(props: TextProps): JSX.Element {\n    if (props.noMargin) return <NoMargin>{props.children}</NoMargin>;\n    return (\n        <Center className={props.className || \"\"} style={props.style || {}}>\n            {props.children}\n        </Center>\n    );\n}\n\nexport function CenteredBold(props: TextProps): JSX.Element {\n    return (\n        <Centered className={props.className || \"\"} style={props.style || {}} noMargin={props.noMargin}>\n            <b>{props.children} </b>\n        </Centered>\n    );\n}\n\nexport function CenteredItallic(props: TextProps): JSX.Element {\n    return (\n        <Centered className={props.className || \"\"} style={props.style || {}} noMargin={props.noMargin}>\n            <i>{props.children} </i>\n        </Centered>\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { canDisplayCliques, GameState, getById } from \"../../model\";\nimport { ColorTheme } from \"../../theme/theme\";\nimport { isNotWellDefined } from \"../../utils\";\nimport { Centered } from \"../layout/centered\";\nimport { HasText } from \"../layout/text\";\nimport { Portraits } from \"../playerPortrait/portraits\";\n\nexport const HelpLink = styled.a`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.link};\n    cursor: pointer;\n    font-weight: bold;\n    margin-top: 10px;\n    margin-bottom: 10px;\n`;\n\ninterface AllianceListProps {\n    gameState: GameState;\n}\n\nexport function AllianceList(props: AllianceListProps) {\n    if (!canDisplayCliques(props.gameState))\n        return (\n            <HasText>\n                <Centered>\n                    ⚠️ There are too many players left in the game to display the alliances! Try again when\n                    there are 30 or less! ⚠️\n                </Centered>\n            </HasText>\n        );\n    const cliques = props.gameState.cliques;\n    const elements: JSX.Element[] = cliques.map((clique, i) => {\n        if (isNotWellDefined(clique.affiliates)) {\n            return (\n                <Portraits\n                    centered={true}\n                    detailed={true}\n                    key={`${clique}, ${i}, ${props.gameState.phase}`}\n                    houseguests={clique.core.map((id) => getById(props.gameState, id))}\n                />\n            );\n        }\n        const entries: (number | \"⬅️\" | \"➡️\")[] = [\n            ...clique.affiliates[0],\n            \"➡️\",\n            ...clique.core,\n            \"⬅️\",\n            ...clique.affiliates[1],\n        ];\n        return (\n            <Portraits\n                centered={true}\n                detailed={true}\n                key={`${clique}, ${i}, ${props.gameState.phase}`}\n                houseguests={entries.map((id) => {\n                    if (id === \"⬅️\") return \"⬅️\";\n                    if (id === \"➡️\") return \"➡️\";\n                    return getById(props.gameState, id);\n                })}\n            />\n        );\n    });\n    return (\n        <div>\n            {elements}\n            {props.gameState.phase < 3 && (\n                <HelpLink\n                    href=\"https://github.com/spaulmark/bb-bots/blob/master/README.md#understanding-alliances-or-what-do-the-arrows-mean\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                >\n                    What do the arrows mean?\n                </HelpLink>\n            )}\n        </div>\n    );\n}\n","import React from \"react\";\nimport { PortraitDisplayMode, powerMode } from \"../../model/portraitDisplayMode\";\nimport { displayMode$, getSelectedPlayer, selectedPlayer$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nfunction setDisplayMode(p: PortraitDisplayMode) {\n    if (p === powerMode) {\n        const player = getSelectedPlayer();\n        if (player && (!player.superiors || Object.keys(player.superiors).length === 0)) {\n            selectedPlayer$.next(null);\n        }\n    }\n    displayMode$.next(p);\n}\n\ninterface ViewBarTagProps {\n    mode: PortraitDisplayMode;\n    text: string;\n    disabled?: boolean;\n}\n\nexport class ViewBarTag extends React.Component<ViewBarTagProps, { selected: boolean }> {\n    private sub: Subscription | null = null;\n\n    public constructor(props: ViewBarTagProps) {\n        super(props);\n        this.state = { selected: props.mode === displayMode$.value };\n    }\n\n    public componentDidMount() {\n        this.sub = displayMode$.subscribe({\n            next: (mode) => {\n                if (mode !== this.props.mode) {\n                    this.setState({ selected: false });\n                } else {\n                    this.setState({ selected: true });\n                }\n            },\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    public render() {\n        const name = \"level-item tag is-medium is-light\";\n        const style = getStyle(this.props);\n        return (\n            <span\n                className={name}\n                style={style}\n                onClick={() => {\n                    !this.props.disabled && setDisplayMode(this.props.mode);\n                    !this.props.disabled && this.setState({ selected: true });\n                }}\n            >\n                {styleText(this.props.text, this.state.selected)}\n            </span>\n        );\n    }\n}\n\nfunction styleText(text: string, selected: boolean): JSX.Element {\n    return selected ? <b>{text}</b> : <i>{text}</i>;\n}\n\nfunction getStyle(props: ViewBarTagProps) {\n    return props.disabled\n        ? {}\n        : {\n              background: `linear-gradient(90deg, ${props.mode.minColor.toRgba()} 0%, ${props.mode.maxColor.toRgba()} 100%)`,\n              cursor: \"pointer\",\n          };\n}\n","import React from \"react\";\nimport { popularityMode, powerMode } from \"../../model/portraitDisplayMode\";\nimport { ViewBarTag } from \"./viewBarTag\";\nimport { GameState, inJury } from \"../../model\";\nimport { displayMode$ } from \"../../subjects/subjects\";\n\nexport class ViewsBar extends React.Component<{ gameState: GameState }, {}> {\n    public constructor(props: { gameState: GameState }) {\n        super(props);\n        if (!inJury(this.props.gameState) && displayMode$.value === powerMode) {\n            displayMode$.next(popularityMode);\n        }\n    }\n\n    componentDidUpdate() {\n        if (!inJury(this.props.gameState) && displayMode$.value === powerMode) {\n            displayMode$.next(popularityMode);\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"level is-mobile\" key=\"viewsbar\" style={{ marginBottom: 0 }}>\n                <ViewBarTag mode={popularityMode} text={\"Relationships\"}></ViewBarTag>\n                {inJury(this.props.gameState) && (\n                    <ViewBarTag mode={powerMode} text={\"Endgame Winrate\"}></ViewBarTag>\n                )}\n            </div>\n        );\n    }\n}\n","import { DragDropContext, Droppable } from \"react-beautiful-dnd\";\nimport { Draggable } from \"react-beautiful-dnd\";\nimport React from \"react\";\nimport styled from \"styled-components\";\nimport { EpisodeType } from \"../episode/episodes\";\nimport { BigBrotherVanilla } from \"../episode/bigBrotherEpisode\";\nimport { BehaviorSubject, Subscription } from \"rxjs\";\nimport { getEmoji, twist$ } from \"./twistAdder\";\nimport { min } from \"lodash\";\nimport { removeFirstNMatching, removeLast1Matching } from \"../../utils\";\nimport { EpisodeLibrary } from \"../../model/season\";\n\nconst common = `\npadding: 10px;\nborder-radius: 6px;\nbox-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);\nmargin: 0 0 3px 0;\nborder: 1px solid #6c6c6c;\ndisplay: grid;\nflex-direction: column;\n`;\n\nconst InvalidDragItem = styled.div`\n    ${common}\n    background: #ffe1ea;\n    color: red;\n`;\n\nconst DragItem = styled.div`\n    ${common}\n    background: #444346;\n    color: #fff;\n`;\n\nlet _items: SeasonEditorListItem[] = [];\nlet _castSize: number = 0;\n\nexport function getEpisodeLibrary(): EpisodeLibrary {\n    const result: EpisodeLibrary = {};\n    let playersRemaining = _castSize;\n    for (const item of _items) {\n        if (item.episode !== BigBrotherVanilla) {\n            result[playersRemaining] = item.episode;\n        }\n        playersRemaining -= item.episode.eliminates;\n    }\n    return result;\n}\n\nconst ListItem = ({\n    item,\n    provided,\n    snapshot,\n}: {\n    item: SeasonEditorListItem;\n    provided: any;\n    snapshot: any;\n}): JSX.Element => {\n    const Item = item.isValid ? DragItem : InvalidDragItem;\n    return (\n        <Item\n            ref={provided.innerRef}\n            snapshot={snapshot}\n            {...provided.draggableProps}\n            {...provided.dragHandleProps}\n        >\n            <span>{`${item.weekText}${\n                item.episode !== BigBrotherVanilla ? ` | ${getEmoji(item.episode) + item.episode.name}` : \"\"\n            }`}</span>\n        </Item>\n    );\n};\n\ninterface SeasonEditorListProps {\n    castSize: number;\n    setTwistsValid: (valid: boolean) => void;\n}\n\ninterface SeasonEditorListState {\n    items: SeasonEditorListItem[];\n}\n\ninterface SeasonEditorListItem {\n    id: string;\n    weekText: string;\n    episode: EpisodeType;\n    isValid: boolean;\n}\n\nexport const twistCapacity$ = new BehaviorSubject<number>(0);\n\nexport class SeasonEditorList extends React.Component<SeasonEditorListProps, SeasonEditorListState> {\n    private id: number = 0;\n    private subs: Subscription[] = [];\n\n    public constructor(props: SeasonEditorListProps) {\n        super(props);\n        _castSize = props.castSize;\n        const elements: SeasonEditorListItem[] = [];\n        let week: number = 0;\n        for (let i = props.castSize; i > 3; i--) {\n            week++;\n            elements.push({\n                id: (this.id++).toString(),\n                weekText: `Week ${week}: F${i}`,\n                episode: BigBrotherVanilla,\n                isValid: true,\n            });\n        }\n        _items = elements;\n        this.state = { items: elements };\n    }\n\n    private maxCapacity(): number {\n        return this.props.castSize - 3;\n    }\n\n    private updateTwistCapacity(newCapacity: number) {\n        twistCapacity$.next(newCapacity);\n    }\n\n    private addRemoveTwist(twist: { type: EpisodeType; add: boolean }) {\n        this.updateTwistCapacity(\n            twist.add\n                ? min([twistCapacity$.value - twist.type.eliminates, this.maxCapacity()]) || 0\n                : twistCapacity$.value + twist.type.eliminates\n        );\n        // add or remove the twist\n        if (twist.add) {\n            // remove X vanilla episodes, then add the twist\n            const newItems = Array.from(this.state.items);\n            removeFirstNMatching(\n                newItems,\n                twist.type.eliminates,\n                (item) => item.episode === BigBrotherVanilla\n            );\n            newItems.unshift({\n                id: (this.id++).toString(),\n                weekText: ``,\n                episode: twist.type,\n                isValid: true,\n            });\n            this.refreshItems(newItems);\n        } else {\n            // remove the LAST instance of the twist, and add X vanilla episodes\n            const newItems = Array.from(this.state.items);\n            const i = removeLast1Matching(newItems, (item) => item.episode === twist.type);\n            this.refreshItems(newItems, i);\n        }\n    }\n\n    public componentDidMount() {\n        twistCapacity$.next(this.maxCapacity());\n        this.subs.push(twist$.subscribe((twist) => this.addRemoveTwist(twist)));\n    }\n\n    public componentWillUnmount(): void {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    private refreshItems(newItems: SeasonEditorListItem[], addIndex?: number) {\n        const finalItems = [];\n        let week: number = 0;\n        let playerCount: number = this.props.castSize;\n\n        for (const item of newItems) {\n            const isValid = item.episode.canPlayWith(playerCount);\n            week++;\n            item.weekText = `Week ${week}: F${playerCount}`;\n            item.isValid = isValid;\n            playerCount -= item.episode.eliminates;\n            // delete all vanilla big brother episodes if player count is below 3\n            if (isValid || item.episode !== BigBrotherVanilla) {\n                finalItems.push(item);\n            }\n        }\n        // if we have to add new vanilla episodes b/c we dont have enough to get to F4, add them\n        if (playerCount > 3) {\n            while (playerCount > 3) {\n                week++;\n                const item = {\n                    id: (this.id++).toString(),\n                    weekText: `Week ${week}: F${playerCount}`,\n                    episode: BigBrotherVanilla,\n                    isValid: true,\n                };\n                if (addIndex !== undefined) {\n                    finalItems.splice(addIndex, 0, item);\n                } else {\n                    finalItems.unshift(item);\n                }\n                playerCount--;\n            }\n            this.refreshItems(finalItems);\n        }\n        _items = finalItems;\n        this.setState({ items: finalItems });\n        this.props.setTwistsValid(finalItems.every((item) => item.isValid));\n    }\n    public render() {\n        const onDragEnd = (result: any) => {\n            if (!result.destination) {\n                return;\n            }\n            const newItems = Array.from(this.state.items);\n            const [removed] = newItems.splice(result.source.index, 1);\n            newItems.splice(result.destination.index, 0, removed);\n            this.refreshItems(newItems);\n        };\n        const items = this.state.items;\n        return (\n            <DragDropContext onDragEnd={onDragEnd}>\n                <Droppable droppableId=\"droppable\">\n                    {(provided) => (\n                        <div {...provided.droppableProps} ref={provided.innerRef}>\n                            {items.map((item, index) => (\n                                <Draggable key={item.id} draggableId={item.id} index={index}>\n                                    {(provided, snapshot) => (\n                                        <ListItem provided={provided} snapshot={snapshot} item={item} />\n                                    )}\n                                </Draggable>\n                            ))}\n                            {provided.placeholder}\n                        </div>\n                    )}\n                </Droppable>\n            </DragDropContext>\n        );\n    }\n}\n","import React from \"react\";\nimport { Subject, Subscription } from \"rxjs\";\nimport { NumericInputStyle } from \"../castingScreen/numericInput\";\nimport { EpisodeType } from \"../episode/episodes\";\nimport { Tooltip } from \"../tooltip/tooltip\";\nimport { twistCapacity$ } from \"./seasonEditorList\";\nimport { Label } from \"./seasonEditorPage\";\n\nexport const twist$ = new Subject<{ type: EpisodeType; add: boolean }>();\n\nexport function getEmoji(episode: EpisodeType): string {\n    return episode.emoji ? `${episode.emoji} ` : \"\";\n}\n\ninterface TwistAdderProps {\n    type: EpisodeType;\n}\n\nexport class TwistAdder extends React.Component<\n    TwistAdderProps,\n    { twistCount: number; twistCapacity: number }\n> {\n    private subs: Subscription[];\n\n    public constructor(props: TwistAdderProps) {\n        super(props);\n        this.state = { twistCount: 0, twistCapacity: twistCapacity$.value };\n        this.subs = [];\n    }\n\n    public componentDidMount(): void {\n        this.subs.push(twistCapacity$.subscribe((twistCapacity) => this.setState({ twistCapacity })));\n    }\n\n    public componentWillUnmount(): void {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    public render(): JSX.Element {\n        const twistCount = this.state.twistCount;\n        return (\n            <div\n                className=\"column is-5-desktop is-5-widescreen is-5-fullhd is-12-tablet\"\n                style={{\n                    border: \"1px solid #808080\",\n                    borderRadius: \"4px\",\n                    backgroundColor: \"#444346\",\n                    margin: \"10px\",\n                }}\n            >\n                <Tooltip wide={true} text={this.props.type.description}>\n                    <div className=\"field has-addons has-addons-centered\" style={{ textAlign: \"center\" }}>\n                        <p className=\"field-label is-normal control\">\n                            <Label className=\"label\">\n                                {getEmoji(this.props.type)}\n                                {this.props.type.name}\n                            </Label>\n                        </p>\n                        <p className=\"control\">\n                            <button\n                                className=\"button is-danger\"\n                                disabled={twistCount === 0}\n                                onClick={() => {\n                                    twist$.next({ type: this.props.type, add: false });\n                                    this.setState({ twistCount: twistCount - 1 });\n                                }}\n                            >\n                                -\n                            </button>\n                        </p>\n                        <p className=\"control\">\n                            <NumericInputStyle className=\"input\" readOnly value={`${twistCount}`} />\n                        </p>\n                        <p className=\"control\">\n                            <button\n                                className=\"button is-success\"\n                                onClick={() => {\n                                    twist$.next({ type: this.props.type, add: true });\n                                    this.setState({ twistCount: twistCount + 1 });\n                                }}\n                                disabled={this.state.twistCapacity < this.props.type.eliminates}\n                            >\n                                +\n                            </button>\n                        </p>\n                    </div>\n                </Tooltip>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { Scene } from \"./scenes/scene\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\nimport { defaultContent } from \"./bigBrotherEpisode\";\nimport { getEmoji } from \"../seasonEditor/twistAdder\";\n\nexport interface InitEpisode {\n    scenes: Scene[];\n    title?: string;\n    content?: JSX.Element;\n    gameState: GameState;\n    initialGamestate?: GameState;\n    type: EpisodeType;\n}\n\nexport class Episode {\n    readonly scenes: Scene[];\n    readonly title: string;\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly initialGameState: GameState;\n    readonly type: EpisodeType;\n    get render(): JSX.Element {\n        const viewsBar = this.type.hasViewsbar ? <ViewsBar gameState={this.scenes[0].gameState} /> : null;\n        return (\n            <div>\n                {viewsBar}\n                {this.content}\n            </div>\n        );\n    }\n\n    constructor(init: InitEpisode) {\n        this.scenes = init.scenes;\n        this.title = init.title || `Week ${init.gameState.phase} ${getEmoji(init.type)}`;\n        this.content = init.content || defaultContent(init.initialGamestate || init.gameState);\n        this.gameState = init.gameState;\n        this.initialGameState = init.initialGamestate || init.gameState;\n        this.type = init.type;\n    }\n}\n\nexport interface EpisodeType {\n    readonly canPlayWith: (n: number) => boolean;\n    readonly eliminates: number;\n    readonly arrowsEnabled: boolean;\n    readonly hasViewsbar: boolean;\n    readonly name: string;\n    readonly emoji: string;\n    readonly description: string;\n    readonly generate: (gameState: GameState) => Episode;\n}\n","import { GameState, Houseguest, EpisodeType, Episode } from \"../../model\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateNomCeremonyScene } from \"./scenes/nomCeremonyScene\";\nimport { generateVetoCompScene } from \"./scenes/vetoCompScene\";\nimport { generateVetoCeremonyScene } from \"./scenes/vetoCeremonyScene\";\nimport { generateEvictionScene } from \"./scenes/evictionScene\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Scene } from \"./scenes/scene\";\nimport { HasText } from \"../layout/text\";\nimport styled from \"styled-components\";\nimport { weekStartTab$ } from \"../../subjects/subjects\";\nimport { WeekStartWrapper } from \"./bigBrotherWeekstartWrapper\";\nimport { GoldenVeto, Veto } from \"./veto/veto\";\n\nexport const BigBrotherVanilla: EpisodeType = {\n    canPlayWith: (n: number) => {\n        return n > 3;\n    },\n    eliminates: 1,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n    name: \"BigBrotherVanilla\",\n    emoji: \"\",\n    description: \"\",\n    generate: generateBbVanilla,\n};\n\nconst TabItem = styled.li`\n    cursor: pointer;\n`;\n\n// Refactoring ideas\n/**\n * Might be best to start passing ids instead of houseguests for HoH/nominees/veto winner\n */\n\nfunction Tab(props: { text: string; active: number; id: number; setActive: any }): JSX.Element {\n    return (\n        <TabItem\n            className={props.active === props.id ? \"is-active\" : \"\"}\n            onClick={() => {\n                props.setActive(props.id);\n                weekStartTab$.next(props.id);\n            }}\n        >\n            <a>{props.text}</a>\n        </TabItem>\n    );\n}\n\nexport function Tabs(): JSX.Element {\n    const [active, setActive] = React.useState(weekStartTab$.value);\n    return (\n        <div className=\"tabs is-centered is-fullwidth is-medium\" style={{ marginBottom: 0 }}>\n            <ul style={{ paddingLeft: 0 }}>\n                <Tab text={\"Memory Wall\"} active={active} setActive={setActive} id={0} />\n                <Tab text={\"Alliances\"} active={active} setActive={setActive} id={1} />\n            </ul>\n        </div>\n    );\n}\n\nexport function defaultContent(initialGameState: GameState) {\n    return (\n        <HasText>\n            <Tabs />\n            <WeekStartWrapper gameState={initialGameState} />\n            <br />\n            <NextEpisodeButton />\n        </HasText>\n    );\n}\n\nexport function generateBbVanilla(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, GoldenVeto);\n    return new Episode({\n        scenes: episode.scenes,\n        gameState: new GameState(episode.gameState),\n        initialGamestate,\n        type: BigBrotherVanilla,\n    });\n}\n\nexport function generateBBVanillaScenes(\n    initialGamestate: GameState,\n    veto: Veto | null,\n    doubleEviction: boolean = false\n): {\n    gameState: GameState;\n    scenes: Scene[];\n} {\n    let hohArray: Houseguest[];\n    let currentGameState: GameState;\n    let hohCompScene: Scene;\n    const scenes: Scene[] = [];\n\n    [currentGameState, hohCompScene, hohArray] = generateHohCompScene(initialGamestate, { doubleEviction });\n    const hoh = hohArray[0];\n    scenes.push(hohCompScene);\n\n    let nomCeremonyScene;\n    let nominees: Houseguest[];\n    [currentGameState, nomCeremonyScene, nominees] = generateNomCeremonyScene(currentGameState, [hoh], {\n        doubleEviction,\n    });\n    scenes.push(nomCeremonyScene);\n\n    return generateVetoScenesOnwards(veto, currentGameState, hoh, nominees, doubleEviction, scenes, []);\n}\nexport function generateVetoScenesOnwards(\n    veto: Veto | null,\n    currentGameState: GameState,\n    hoh: Houseguest,\n    nominees: Houseguest[],\n    doubleEviction: boolean,\n    scenes: Scene[],\n    immuneHgs: Houseguest[]\n) {\n    let povWinner: Houseguest | undefined = undefined;\n    if (veto) {\n        let vetoCompScene;\n        [currentGameState, vetoCompScene, povWinner] = generateVetoCompScene(\n            currentGameState,\n            [hoh],\n            nominees,\n            veto,\n            doubleEviction\n        );\n        scenes.push(vetoCompScene);\n        let vetoCeremonyScene;\n\n        [currentGameState, vetoCeremonyScene, nominees] = generateVetoCeremonyScene(\n            currentGameState,\n            [hoh],\n            nominees,\n            povWinner,\n            doubleEviction,\n            veto,\n            immuneHgs\n        );\n        scenes.push(vetoCeremonyScene);\n    }\n    let evictionScene;\n    [currentGameState, evictionScene] = generateEvictionScene(currentGameState, [hoh], nominees, {\n        doubleEviction,\n        povWinner,\n        votingTo: \"Evict\",\n    });\n    if (veto === null) {\n        currentGameState.currentLog.nominationsPostVeto = currentGameState.currentLog.nominationsPreVeto;\n    }\n    scenes.push(evictionScene);\n    return { gameState: currentGameState, scenes };\n}\n","import React from \"react\";\nimport { GameState } from \"../../../model/gameState\";\nimport { ViewsBar } from \"../../viewsBar/viewBar\";\ninterface InitScene {\n    readonly title: string;\n    readonly gameState: GameState;\n    readonly content: JSX.Element;\n}\nexport class Scene {\n    readonly title: string = \"\";\n    readonly gameState: GameState = new GameState({ players: [], jury: -1 });\n    readonly content: JSX.Element = (<div>{`Error while rendering ${this.title}`}</div>);\n    public render: JSX.Element;\n    public constructor(init: Partial<InitScene>) {\n        Object.assign(this, init);\n        this.render = (\n            <div>\n                <ViewsBar gameState={this.gameState} />\n                {this.content}\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { switchSceneRelative } from \"../../subjects/subjects\";\n\nexport function NextEpisodeButton(): JSX.Element {\n    return (\n        <button className=\"button is-primary\" onClick={() => switchSceneRelative(1)}>\n            Continue\n        </button>\n    );\n}\n","import React from \"react\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\n\nconst FullscreenIcon = styled.img`\n    position: -webkit-sticky;\n    position: sticky;\n    top: 20px;\n    right: 20px;\n`;\n\nexport function FullscreenButton(): JSX.Element {\n    return (\n        <FullscreenIcon\n            src={\n                \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAASElEQVRIiWNgGAUEACMa/z+R6ohWz0Sqi0gFLIRcQAAQDAGa+2DoWzAKRgH1wX8G3OULWfqHfkYbsNIUPR5IrQ/gYLQsGngAAEPgCRZjAdYSAAAAAElFTkSuQmCC\"\n            }\n            className=\"button is-rounded\"\n            onClick={() => {\n                isFullscreen$.next(!isFullscreen$.getValue());\n            }}\n        />\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { EpisodeLog } from \"../../../model/logging/episodelog\";\nimport { CenteredBold, Centered, CenteredItallic } from \"../../layout/centered\";\nimport { GameState, getById } from \"../../../model\";\nimport { VoteType, WinnerVote, RunnerUpVote } from \"../../../model/logging/voteType\";\nimport { FullscreenButton } from \"../../mainPage/fullscreenButton\";\nimport { ColorTheme } from \"../../../theme/theme\";\nimport _ from \"lodash\";\n\nexport const EndgameTableCell = styled.td`\n    padding: 0.1em 0.4em;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n`;\n\nconst EndgameTable = styled.table`\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n    border-collapse: collapse;\n`;\n\nconst Gray = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.grayCell};\n`;\n\nexport const SaveCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.saveCell};\n`;\n\nconst White = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.lightGrayCell};\n`;\n\nconst Evicted = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.evictedCell};\n`;\n\nexport const WinnerCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.winnerCell};\n`;\n\nexport const RunnerUpCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.runnerUpCell};\n`;\n\nexport const NomineeCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.nomineeCell};\n`;\n\nexport const HohCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.hohCell};\n`;\nexport const PoVCell = styled(EndgameTableCell)`\n    background-color: #78773f;\n`;\n\nconst BlackRow = styled.tr`\n    height: 0.4em;\n    background-color: #000000;\n`;\nlet anotherKey = 0;\nexport function generateVotingTable(gameState: GameState): JSX.Element {\n    const masterLog: EpisodeLog[][] = gameState.log;\n    const houseguestCells: JSX.Element[][] = [];\n    gameState.houseguests.forEach((hg, i) => {\n        houseguestCells[hg.id] = [\n            <Gray key={`hg-name---${i}`}>\n                <CenteredBold noMargin={true}>{hg.name}</CenteredBold>\n            </Gray>,\n        ];\n    });\n    const evictionOrder: [number, number][] = [];\n    const topRowCells: JSX.Element[] = [];\n    const preVetoCells: JSX.Element[] = [];\n    const vetoCells: JSX.Element[] = [];\n    const postVetoCells: JSX.Element[] = [];\n    const evictedCells: JSX.Element[] = [];\n    const winnerCells: JSX.Element[] = [];\n    masterLog.forEach((logs: EpisodeLog[] | undefined, i) => {\n        // multiple entries (ie. a double eviction) will all share the same toprow\n        generateTopRow(\n            logs ? logs[0] : undefined,\n            i,\n            topRowCells,\n            masterLog.length - 1,\n            logs ? logs.length : -1 // -1 doesn't matter because its unread\n        );\n        const iterateLogs = logs ? logs : [undefined]; // this is incredibly dank\n        iterateLogs.forEach((log: EpisodeLog | undefined) => {\n            generatePreVetoRow(log, i, preVetoCells);\n            generateVetoRow(log, i, vetoCells);\n            generatePostVetoRow(log, i, postVetoCells);\n            generateEvictedRow(log, i, evictedCells, winnerCells, gameState);\n            if (!log) return;\n            log.evicted.forEach((evicted) => evictionOrder.push([evicted, i]));\n\n            if (log.runnerUp !== undefined) evictionOrder.push([log.runnerUp, i]);\n            if (log.winner !== undefined) evictionOrder.push([log.winner, i]);\n            // add each of the votes to the houseguest cells\n            for (const [key, value] of Object.entries(log.votes)) {\n                // typescript for .. in loops kinda suck so i need to do a sketchy type conversion\n                const id: number = key as unknown as number;\n                const vote: VoteType = value;\n                houseguestCells[id].push(vote.render(gameState));\n            }\n            if (log.winner !== undefined && log.runnerUp !== undefined) {\n                houseguestCells[log.winner].push(new WinnerVote().render(gameState));\n                houseguestCells[log.runnerUp].push(new RunnerUpVote().render(gameState));\n                evictedCells.push(\n                    <RunnerUpCell key={\"runnerUp\"}>\n                        <CenteredBold noMargin={true}>{getById(gameState, log.runnerUp).name}</CenteredBold>\n                        <Centered noMargin={true}>\n                            <small>Finalist</small>\n                        </Centered>\n                    </RunnerUpCell>\n                );\n                winnerCells.push(\n                    <WinnerCell key={\"winner\"}>\n                        <CenteredBold noMargin={true}>{getById(gameState, log.winner).name}</CenteredBold>\n                        <Centered noMargin={true}>\n                            <small>Winner</small>\n                        </Centered>\n                    </WinnerCell>\n                );\n            }\n        });\n    });\n    preVetoCells.push(\n        <White key={`preveto--finale`} rowSpan={3}>\n            <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n        </White>\n    );\n    const winnerRow = <tr>{winnerCells}</tr>;\n    const topRow = <tr>{topRowCells}</tr>;\n    const preVetoRow = <tr>{preVetoCells}</tr>;\n    const vetoRow = <tr>{vetoCells}</tr>;\n    const postVetoRow = <tr>{postVetoCells}</tr>;\n    const blackRow = (\n        <BlackRow>\n            <td colSpan={gameState.houseguests.length} />\n        </BlackRow>\n    );\n    const houseguestRows: JSX.Element[] = [];\n    const evictedRow = <tr>{evictedCells}</tr>;\n    let desiredLength = -1;\n    evictionOrder.reverse().forEach(([id, week], i) => {\n        if (i === 0) desiredLength = houseguestCells[id].length;\n        if (i > 1) {\n            const weekText = i === 2 ? \"(Finale)\" : `(Week ${week})`;\n            const evicted = (\n                <Evicted\n                    colSpan={desiredLength - houseguestCells[id].length}\n                    key={`evicted-week-${weekText}-${i}`}\n                >\n                    <CenteredItallic noMargin={true}>Evicted</CenteredItallic>\n                    <CenteredItallic noMargin={true}>\n                        <small>{weekText}</small>\n                    </CenteredItallic>\n                </Evicted>\n            );\n            if (!getById(gameState, id).isJury) {\n                houseguestCells[id].push(evicted); // not jury, they dead\n            } else {\n                const tempList = houseguestCells[id].slice(0, -1);\n                tempList.push(evicted);\n                tempList.push(houseguestCells[id][houseguestCells[id].length - 1]);\n                houseguestCells[id] = tempList;\n            }\n        }\n        houseguestRows.push(<tr key={`hgrow--${id}--${anotherKey++}`}>{houseguestCells[id]}</tr>);\n    });\n\n    return (\n        <div>\n            <FullscreenButton />\n            <EndgameTable>\n                <tbody>\n                    {topRow}\n                    {preVetoRow}\n                    {vetoRow}\n                    {postVetoRow}\n                    {blackRow}\n                    {houseguestRows}\n                    {blackRow}\n                    {evictedRow}\n                    {winnerRow}\n                </tbody>\n            </EndgameTable>\n        </div>\n    );\n}\n\nfunction generateEvictedRow(\n    log: EpisodeLog | undefined,\n    i: number,\n    cells: JSX.Element[],\n    winnerCells: JSX.Element[],\n    gameState: GameState\n) {\n    if (!log) {\n        cells.push(\n            <Gray key={`evicted${i}--${anotherKey++}`} rowSpan={2}>\n                <CenteredBold noMargin={true}>Evicted</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    const saveOrEvict =\n        log.soleVoter !== undefined ? \"evict\" : (log.votingTo && log.votingTo.toLowerCase()) || \"evict\";\n\n    const rowSpan = log.evicted.length === 1 ? 2 : 1;\n    log.evicted.forEach((evicted, i) => {\n        const voteTextLine1 =\n            log.soleVoter !== undefined\n                ? `${log.soleVoter}'s choice`\n                : `${\n                      log.votingTo === \"Save\"\n                          ? Object.values(log.votes).filter((vote) => vote.id === evicted).length\n                          : log.votesInMajority\n                  } of ${log.outOf} votes`;\n\n        const content = (\n            <Evicted key={`evicted${i}--${anotherKey++}`} rowSpan={rowSpan}>\n                <Centered noMargin={true}>\n                    <b>{getById(gameState, evicted).name}</b>\n                    <br />\n                    <small>\n                        {voteTextLine1} <br />\n                        to {saveOrEvict}\n                    </small>\n                </Centered>\n            </Evicted>\n        );\n        if (i === 0) cells.push(content);\n        else winnerCells.push(content);\n    });\n}\n\nfunction generatePostVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`postVeto--${i}-${anotherKey++}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(post-veto)</small>\n                </CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`preveto--${i}-${anotherKey++}`}>\n            <Centered noMargin={true}>\n                {interleave(\n                    log.nominationsPostVeto as any,\n                    (key) => (\n                        <br key={`preveto--br--${i}-${key++}`} />\n                    ),\n                    anotherKey\n                )}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`veto--${i}-${anotherKey++}`}>\n                <CenteredBold noMargin={true}>Veto Winner</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    if (log.vetoWinner === undefined) return;\n\n    cells.push(\n        <White key={`veto--${i}-${anotherKey++}`}>\n            <Centered noMargin={true}>{log.vetoWinner}</Centered>\n        </White>\n    );\n}\n\n// javascript is my passion\nfunction interleave<T>(arr: T[], thing: (key: number) => T, key: number): T[] {\n    return ([] as T[]).concat(...arr.map((n: T) => [n, thing(key++)])).slice(0, -1);\n}\n\nfunction generatePreVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`preveto--${i}-${anotherKey++}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(pre-veto)</small>\n                </CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    if (log.nominationsPreVeto.length === 0 || log.vetoWinner === undefined) {\n        cells.push(\n            <White key={`preveto--${i}-${anotherKey++}`} rowSpan={2}>\n                <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n            </White>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`preveto--${i}-${anotherKey++}`}>\n            <Centered noMargin={true}>\n                {interleave(\n                    log.nominationsPreVeto as any,\n                    (key) => (\n                        <br key={`preveto--br--${i}-${key++}`} />\n                    ),\n                    anotherKey\n                )}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateTopRow(\n    log: EpisodeLog | undefined,\n    i: number,\n    cells: JSX.Element[],\n    max: number,\n    colspan: number\n) {\n    if (!log) {\n        cells.push(<Gray key={`toprow--${i}`} />);\n        return;\n    }\n    if (i === max) {\n        cells.push(\n            <Gray key={`toprow--${i}`} colSpan={2}>\n                <CenteredBold noMargin={true}>Finale</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    cells.push(\n        <Gray key={`toprow--${i}`} colSpan={colspan}>\n            <CenteredBold noMargin={true}>Week {i}</CenteredBold>\n        </Gray>\n    );\n}\n","import React from \"react\";\nimport { GameState, getById } from \"../gameState\";\nimport { CenteredItallic, Centered } from \"../../components/layout/centered\";\nimport {\n    EndgameTableCell,\n    WinnerCell,\n    RunnerUpCell,\n    NomineeCell,\n    HohCell,\n    SaveCell,\n    PoVCell,\n} from \"../../components/episode/scenes/votingTable\";\n\nlet voteKey = 0;\n\nfunction getKey(): string {\n    return `${voteKey++}-- vote key`;\n}\n\nexport interface VoteType {\n    id: number;\n    render: (state: GameState) => JSX.Element;\n}\n\nexport class SaveVote implements VoteType {\n    id: number;\n    render = (state: GameState) => (\n        <SaveCell key={getKey()}>\n            <Centered noMargin={true}>{getById(state, this.id).name}</Centered>\n        </SaveCell>\n    );\n    constructor(id: number) {\n        this.id = id;\n    }\n}\n\nexport class NormalVote implements VoteType {\n    id: number;\n    render = (state: GameState) => (\n        <EndgameTableCell key={getKey()}>\n            <Centered noMargin={true}>{getById(state, this.id).name}</Centered>\n        </EndgameTableCell>\n    );\n    constructor(id: number) {\n        this.id = id;\n    }\n}\n\nexport class WinnerVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <WinnerCell key={\"winner---\"}>\n            <Centered noMargin={true}>Winner</Centered>\n        </WinnerCell>\n    );\n}\n\nexport class RunnerUpVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <RunnerUpCell key={\"runnerUp---\"}>\n            <Centered noMargin={true}>Finalist</Centered>\n        </RunnerUpCell>\n    );\n}\n\nexport class NomineeVote implements VoteType {\n    id: number = -1;\n    evicted: boolean;\n    render = (state: GameState) => (\n        <NomineeCell key={getKey()}>\n            <CenteredItallic noMargin={true}>Nominated</CenteredItallic>\n        </NomineeCell>\n    );\n    constructor(evicted: boolean) {\n        this.evicted = evicted;\n    }\n}\n\nexport class PoVvote implements VoteType {\n    id: number;\n    render = (state: GameState) => {\n        return (\n            <PoVCell key={getKey()}>\n                <CenteredItallic noMargin={true}>{getById(state, this.id).name}</CenteredItallic>\n            </PoVCell>\n        );\n    };\n    constructor(id: number) {\n        this.id = id;\n    }\n}\n\nexport class HoHVote implements VoteType {\n    id: number;\n\n    get hohText(): JSX.Element {\n        return (\n            <CenteredItallic noMargin={true}>\n                Head of\n                <br />\n                Household\n            </CenteredItallic>\n        );\n    }\n\n    private hohVote(state: GameState): JSX.Element {\n        return <CenteredItallic noMargin={true}>{getById(state, this.id).name}</CenteredItallic>;\n    }\n\n    render = (state: GameState) => {\n        return <HohCell key={getKey()}>{this.id == -1 ? this.hohText : this.hohVote(state)}</HohCell>;\n    };\n    constructor(id?: number) {\n        this.id = id === undefined ? -1 : id;\n    }\n}\n","export function listNames(names: string[]): string {\n    if (names.length === 0) {\n        return \"\";\n    }\n    if (names.length === 1) {\n        return names[0];\n    }\n    if (names.length === 2) {\n        return names[0] + \" and \" + names[1];\n    }\n    return names.slice(0, names.length - 1).join(\", \") + \", and \" + names[names.length - 1];\n}\n\nexport function listVotes(votes: string[]): string {\n    if (votes.length === 0) {\n        return \"\";\n    }\n    if (votes.length === 1) {\n        return votes[0];\n    }\n    if (votes.length === 2) {\n        return votes[0] + \" to \" + votes[1];\n    }\n    return votes.slice(0, votes.length - 1).join(` - `) + ` - ` + votes[votes.length - 1];\n}\n","import { GameState, Houseguest, MutableGameState, randomPlayer } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { HoHVote } from \"../../../model/logging/voteType\";\nimport { listNames } from \"../../../utils/listStrings\";\n\ninterface HohCompOptions {\n    doubleEviction?: boolean;\n    customText?: string;\n    coHoH?: boolean;\n    coHohIsFinal?: boolean;\n}\n\nexport function generateHohCompScene(\n    initialGameState: GameState,\n    options: HohCompOptions\n): [GameState, Scene, Houseguest[]] {\n    const newGameState = new MutableGameState(initialGameState);\n    const coHoH = options.coHoH || false;\n    const coHohIsFinal = options.coHohIsFinal || false;\n    const doubleEviction: boolean = options.doubleEviction || false;\n    const previousHoh = initialGameState.previousHOH ? initialGameState.previousHOH : [];\n    const newHoH: Houseguest = randomPlayer(newGameState.houseguests, previousHoh);\n    const newHoH2: Houseguest = options.coHoH\n        ? randomPlayer(newGameState.houseguests, [newHoH, ...previousHoh])\n        : newHoH;\n    // set previous hoh\n    (!coHoH || coHohIsFinal) && (newGameState.previousHOH = [newHoH]);\n    coHoH && coHohIsFinal && (newGameState.previousHOH = [newHoH, newHoH2]);\n    // add hoh vote in whatever\n    (!coHoH || coHohIsFinal) && (newGameState.currentLog.votes[newHoH.id] = new HoHVote());\n    coHoH && coHohIsFinal && (newGameState.currentLog.votes[newHoH2.id] = new HoHVote());\n    // new hoh wins\n    newHoH.hohWins += 1;\n    coHoH && (newHoH2.hohWins += 1);\n\n    const portraitLine = coHoH ? (\n        <Portraits centered={true} houseguests={[newHoH, newHoH2]} />\n    ) : (\n        <Portrait centered={true} houseguest={newHoH} />\n    );\n    const wonText = `${coHoH ? listNames([newHoH.name, newHoH2.name]) : newHoH.name} ${\n        coHoH ? \"have\" : \"has\"\n    } won Head of Household!`;\n\n    const scene = new Scene({\n        title: \"HoH Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                {options.customText ? (\n                    <CenteredBold>{options.customText}</CenteredBold>\n                ) : (\n                    previousHoh.length > 0 &&\n                    (doubleEviction ? (\n                        <CenteredBold>\n                            Houseguests, please return to the living room. Tonight will be a{\" \"}\n                            {initialGameState.__logindex__ === 1 ? \"double\" : \"triple\"} eviction.\n                        </CenteredBold>\n                    ) : (\n                        <Centered>\n                            {`Houseguests, it's time to find a new Head of Household. As outgoing HoH, ${listNames(\n                                previousHoh.map((h) => h.name)\n                            )} will not compete.`}\n                        </Centered>\n                    ))\n                )}\n                {portraitLine}\n                <CenteredBold>{wonText}</CenteredBold>\n                <br />\n                {!doubleEviction && <NextEpisodeButton />}\n            </div>\n        ),\n    });\n\n    return [new GameState(newGameState), scene, coHoH ? [newHoH, newHoH2] : [newHoH]];\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst ShadowBox = styled.div`\n    box-shadow: ${({ theme }: { theme: ColorTheme }) =>\n        theme.name === \"light\" ? \"0 2px 3px rgba(10, 10, 10, 0.1), 0 0 0 1px rgba(10, 10, 10, 0.1)\" : \"\"};\n    border-radius: 6px;\n    margin-left: 3px;\n    margin-top: 3px;\n    margin-right: 3px;\n    background: ${({ theme }: { theme: ColorTheme }) => theme.overlay};\n`;\n\nconst StyledBox = styled.div`\n    margin-left: 3px;\n    margin-right: 3px;\n    margin-bottom: 3px;\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bodyArea};\n`;\n\nexport function DividerBox(props: any): JSX.Element {\n    return <ShadowBox className={props.className || \"\"}>{props.children}</ShadowBox>;\n}\n\nexport function Box(props: any): JSX.Element {\n    return (\n        <StyledBox style={props.style} className={`box ${props.className || \"\"}`}>\n            {props.children}\n        </StyledBox>\n    );\n}\n","/*\n * Free FFT and convolution (TypeScript)\n *\n * Copyright (c) 2020 Project Nayuki. (MIT License)\n * https://www.nayuki.io/page/free-small-fft-in-multiple-languages\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\n * this software and associated documentation files (the \"Software\"), to deal in\n * the Software without restriction, including without limitation the rights to\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\n * the Software, and to permit persons to whom the Software is furnished to do so,\n * subject to the following conditions:\n * - The above copyright notice and this permission notice shall be included in\n *   all copies or substantial portions of the Software.\n * - The Software is provided \"as is\", without warranty of any kind, express or\n *   implied, including but not limited to the warranties of merchantability,\n *   fitness for a particular purpose and noninfringement. In no event shall the\n *   authors or copyright holders be liable for any claim, damages or other\n *   liability, whether in an action of contract, tort or otherwise, arising from,\n *   out of or in connection with the Software or the use or other dealings in the\n *   Software.\n */\n\n/*\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\n * The vector can have any length. This is a wrapper function.\n */\nexport function fft(real: number[] | Float64Array, imag: number[] | Float64Array): void {\n    const n: number = real.length;\n    if (n != imag.length) throw \"Mismatched lengths\";\n    if (n == 0) return;\n    else if ((n & (n - 1)) == 0)\n        // Is power of 2\n        transformRadix2(real, imag);\n    // More complicated algorithm for arbitrary sizes\n    else transformBluestein(real, imag);\n}\n\n/*\n * Computes the inverse discrete Fourier transform (IDFT) of the given complex vector, storing the result back into the vector.\n * The vector can have any length. This is a wrapper function. This transform does not perform scaling, so the inverse is not a true inverse.\n */\nexport function inverseFFT(real: Array<number> | Float64Array, imag: Array<number> | Float64Array): void {\n    fft(imag, real);\n}\n\n/*\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\n * The vector's length must be a power of 2. Uses the Cooley-Tukey decimation-in-time radix-2 algorithm.\n */\nfunction transformRadix2(real: Array<number> | Float64Array, imag: Array<number> | Float64Array): void {\n    // Length variables\n    const n: number = real.length;\n    if (n != imag.length) throw \"Mismatched lengths\";\n    if (n == 1)\n        // Trivial transform\n        return;\n    let levels: number = -1;\n    for (let i = 0; i < 32; i++) {\n        if (1 << i == n) levels = i; // Equal to log2(n)\n    }\n    if (levels == -1) throw \"Length is not a power of 2\";\n\n    // Trigonometric tables\n    let cosTable = new Array<number>(n / 2);\n    let sinTable = new Array<number>(n / 2);\n    for (let i = 0; i < n / 2; i++) {\n        cosTable[i] = Math.cos((2 * Math.PI * i) / n);\n        sinTable[i] = Math.sin((2 * Math.PI * i) / n);\n    }\n\n    // Bit-reversed addressing permutation\n    for (let i = 0; i < n; i++) {\n        const j: number = reverseBits(i, levels);\n        if (j > i) {\n            let temp: number = real[i];\n            real[i] = real[j];\n            real[j] = temp;\n            temp = imag[i];\n            imag[i] = imag[j];\n            imag[j] = temp;\n        }\n    }\n\n    // Cooley-Tukey decimation-in-time radix-2 FFT\n    for (let size = 2; size <= n; size *= 2) {\n        const halfsize: number = size / 2;\n        const tablestep: number = n / size;\n        for (let i = 0; i < n; i += size) {\n            for (let j = i, k = 0; j < i + halfsize; j++, k += tablestep) {\n                const l: number = j + halfsize;\n                const tpre: number = real[l] * cosTable[k] + imag[l] * sinTable[k];\n                const tpim: number = -real[l] * sinTable[k] + imag[l] * cosTable[k];\n                real[l] = real[j] - tpre;\n                imag[l] = imag[j] - tpim;\n                real[j] += tpre;\n                imag[j] += tpim;\n            }\n        }\n    }\n\n    // Returns the integer whose value is the reverse of the lowest 'width' bits of the integer 'val'.\n    function reverseBits(val: number, width: number): number {\n        let result: number = 0;\n        for (let i = 0; i < width; i++) {\n            result = (result << 1) | (val & 1);\n            val >>>= 1;\n        }\n        return result;\n    }\n}\n\n/*\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\n * The vector can have any length. This requires the convolution function, which in turn requires the radix-2 FFT function.\n * Uses Bluestein's chirp z-transform algorithm.\n */\nfunction transformBluestein(real: Array<number> | Float64Array, imag: Array<number> | Float64Array): void {\n    // Find a power-of-2 convolution length m such that m >= n * 2 + 1\n    const n: number = real.length;\n    if (n != imag.length) throw \"Mismatched lengths\";\n    let m: number = 1;\n    while (m < n * 2 + 1) m *= 2;\n\n    // Trigonometric tables\n    let cosTable = new Array<number>(n);\n    let sinTable = new Array<number>(n);\n    for (let i = 0; i < n; i++) {\n        const j: number = (i * i) % (n * 2); // This is more accurate than j = i * i\n        cosTable[i] = Math.cos((Math.PI * j) / n);\n        sinTable[i] = Math.sin((Math.PI * j) / n);\n    }\n\n    // Temporary vectors and preprocessing\n    let areal: Array<number> = newArrayOfZeros(m);\n    let aimag: Array<number> = newArrayOfZeros(m);\n    for (let i = 0; i < n; i++) {\n        areal[i] = real[i] * cosTable[i] + imag[i] * sinTable[i];\n        aimag[i] = -real[i] * sinTable[i] + imag[i] * cosTable[i];\n    }\n    let breal: Array<number> = newArrayOfZeros(m);\n    let bimag: Array<number> = newArrayOfZeros(m);\n    breal[0] = cosTable[0];\n    bimag[0] = sinTable[0];\n    for (let i = 1; i < n; i++) {\n        breal[i] = breal[m - i] = cosTable[i];\n        bimag[i] = bimag[m - i] = sinTable[i];\n    }\n\n    // Convolution\n    let creal = new Array<number>(m);\n    let cimag = new Array<number>(m);\n    convolveComplex(areal, aimag, breal, bimag, creal, cimag);\n\n    // Postprocessing\n    for (let i = 0; i < n; i++) {\n        real[i] = creal[i] * cosTable[i] + cimag[i] * sinTable[i];\n        imag[i] = -creal[i] * sinTable[i] + cimag[i] * cosTable[i];\n    }\n}\n\n/*\n * Computes the circular convolution of the given real vectors. Each vector's length must be the same.\n */\nfunction convolveReal(\n    xvec: Array<number> | Float64Array,\n    yvec: Array<number> | Float64Array,\n    outvec: Array<number> | Float64Array\n): void {\n    const n: number = xvec.length;\n    if (n != yvec.length || n != outvec.length) throw \"Mismatched lengths\";\n    convolveComplex(xvec, newArrayOfZeros(n), yvec, newArrayOfZeros(n), outvec, newArrayOfZeros(n));\n}\n\n/*\n * Computes the circular convolution of the given complex vectors. Each vector's length must be the same.\n */\nfunction convolveComplex(\n    xreal: Array<number> | Float64Array,\n    ximag: Array<number> | Float64Array,\n    yreal: Array<number> | Float64Array,\n    yimag: Array<number> | Float64Array,\n    outreal: Array<number> | Float64Array,\n    outimag: Array<number> | Float64Array\n): void {\n    const n: number = xreal.length;\n    if (\n        n != ximag.length ||\n        n != yreal.length ||\n        n != yimag.length ||\n        n != outreal.length ||\n        n != outimag.length\n    )\n        throw \"Mismatched lengths\";\n\n    xreal = xreal.slice();\n    ximag = ximag.slice();\n    yreal = yreal.slice();\n    yimag = yimag.slice();\n    fft(xreal, ximag);\n    fft(yreal, yimag);\n\n    for (let i = 0; i < n; i++) {\n        const temp: number = xreal[i] * yreal[i] - ximag[i] * yimag[i];\n        ximag[i] = ximag[i] * yreal[i] + xreal[i] * yimag[i];\n        xreal[i] = temp;\n    }\n    inverseFFT(xreal, ximag);\n\n    for (let i = 0; i < n; i++) {\n        // Scaling (because this FFT implementation omits it)\n        outreal[i] = xreal[i] / n;\n        outimag[i] = ximag[i] / n;\n    }\n}\n\nfunction newArrayOfZeros(n: number): Array<number> {\n    let result: Array<number> = [];\n    for (let i = 0; i < n; i++) result.push(0);\n    return result;\n}\n","// Homebrew typescript implementation of this:\n// https://www.researchgate.net/publication/257017356_On_computing_the_distribution_function_for_the_Poisson_binomial_distribution?enrichId=rgreq-6ff78e1a69dcaf49a733e2dd0e9f2db6-XXX&enrichSource=Y292ZXJQYWdlOzI1NzAxNzM1NjtBUzo1NTg0MDU5OTE1MzA0OTZAMTUxMDE0NTc3MTQ0Mw%3D%3D&el=1_x_3&_esc=publicationCoverPdf\n\nimport _ from \"lodash\";\nimport { fft } from \"./fft\";\n\n// Due to the high complexity of this function, it has been optimized for readability.\n// And even then, it's still pretty spooky.\n\nexport function pbincdf(pp: number[]): number[] {\n    const p: number[] = [];\n    const zeros: number[] = [];\n    const ones: number[] = [];\n    pp.forEach((num) => {\n        num === 0 && zeros.push(0);\n        num === 1 && ones.push(1);\n        num !== 0 && num !== 1 && p.push(num);\n    });\n    const cdf = _pbincdf(p);\n    cdf.forEach((number, i) => (cdf[i] = 1 - number));\n    const result = ones.concat(cdf, zeros);\n    return result;\n}\n\nfunction _pbincdf(p: number[]): number[] {\n    const n = p.length;\n    const nPlusOne = n + 1;\n    const ω = (2 * Math.PI) / nPlusOne;\n    const a = [1];\n    const b = [0];\n    // STEP 1 OF THE ALGORITHM\n    const sigmaLogModulusZ = (l: number): number => {\n        let sum = 0;\n        p.forEach((p_j) => {\n            const e1 = (1 - p_j + p_j * Math.cos(ω * l)) ** 2;\n            const e2 = (p_j * Math.sin(ω * l)) ** 2;\n            sum += 0.5 * Math.log(e1 + e2);\n        });\n        return sum;\n    };\n    const sigmaPrincipalArgz = (l: number): number => {\n        let sum = 0;\n        p.forEach((p_j) => {\n            const y = p_j * Math.sin(ω * l);\n            const x = 1 - p_j + p_j * Math.cos(ω * l);\n            sum += Math.atan2(y, x);\n        });\n        return sum;\n    };\n    for (let l = 1; l <= Math.ceil(n / 2); l++) {\n        const d = Math.exp(sigmaLogModulusZ(l));\n        const sigmaArgZ = sigmaPrincipalArgz(l);\n        a[l] = d * Math.cos(sigmaArgZ);\n        b[l] = d * Math.sin(sigmaArgZ);\n    }\n    // STEP 2 OF THE ALGORITHM\n    for (let l = Math.ceil(n / 2) + 1; l <= n; l++) {\n        a[l] = a[nPlusOne - l];\n        b[l] = -b[nPlusOne - l];\n    }\n    // STEP 3 OF THE ALGORITHM\n    fft(a, b);\n    const ξ = a;\n    // STEP 4 OF THE ALGORITHM\n    const result: number[] = [];\n    ξ.forEach((a, i) => (ξ[i] = a / nPlusOne));\n    result[0] = ξ[0];\n    ξ.forEach((_, m) => {\n        if (m === 0) return;\n        result[m] = result[m - 1] + ξ[m];\n    });\n    return result;\n}\n","import { Houseguest } from \"../../model\";\nimport { pbincdf } from \"../poissonbinomial\";\nimport { pJurorVotesForHero } from \"./aiApi\";\nimport { classifyRelationship } from \"./classifyRelationship\";\n\nexport const relationship = (hero: Houseguest, villain: { id: number }) => hero.relationships[villain.id];\n\nexport const RelationshipTypeToNumber = { FRIEND: 10, ENEMY: -10, PAWN: 0, QUEEN: +5 };\n\nexport const friendship = (hero: Houseguest, villain: Houseguest) =>\n    hero.relationshipWith(villain) +\n    RelationshipTypeToNumber[\n        classifyRelationship(hero.popularity, villain.popularity, hero.relationshipWith(villain))\n    ];\n\nexport function getBestFriend(hero: Houseguest, options: Houseguest[]) {\n    // take in the players and return the favourite, taking friend/enemy/nonmutual into account.\n    return highestScore(hero, options, friendship);\n}\n\nexport function favouriteIndex(hero: Houseguest, options: Houseguest[]) {\n    // Return the index of the houseguest that hero has the highest relationship % with.\n    return highestScore(hero, options, relationship);\n}\n\nfunction highestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let highestIndex = 0;\n    let highestScore = -Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore > highestScore) {\n            highestIndex = i;\n            highestScore = currentScore;\n        }\n    });\n    return highestIndex;\n}\nexport function lowestScore<H, V>(hero: H, options: V[], callback: (hero: H, villain: V) => number) {\n    let lowestIndex = 0;\n    let lowestScore = Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore < lowestScore) {\n            lowestIndex = i;\n            lowestScore = currentScore;\n        }\n    });\n    return lowestIndex;\n}\n\n// returns the probability that the hero wins the f2 between hero and villian\nexport function pHeroWinsTheFinale(\n    hgs: { hero: Houseguest; villain: Houseguest },\n    jury: Houseguest[]\n): number {\n    const hero = hgs.hero;\n    const villain = hgs.villain;\n    const p: number[] = [];\n    jury.forEach((juror) => {\n        if (juror.id === hero.id || juror.id === villain.id) return;\n        p.push(pJurorVotesForHero(juror, hero, villain));\n    });\n    const cdf = pbincdf(p);\n    return cdf[Math.ceil((jury.length - 2) / 2) - 1];\n}\n","import _ from \"lodash\";\nimport { GameState, getById, Houseguest, inJury } from \"../../model\";\nimport { NumberWithLogic } from \"./aiApi\";\nimport { lowestScore, relationship } from \"./aiUtils\";\nimport { classifyRelationship, classifyTwoWayRelationship, RelationshipType } from \"./classifyRelationship\";\n\n// abandon all hope ye who enter here\n\ninterface RelationshipSummary {\n    type: RelationshipType;\n    relationship: number;\n    winrate: number;\n    id: number;\n    pHeroWins: number;\n    villainPopularity: number;\n    villianName: string;\n}\n\nconst deadValue: RelationshipSummary = {\n    type: RelationshipType.Friend,\n    id: -123456789, // to make debugging easier :)\n    pHeroWins: -1,\n    winrate: -1,\n    relationship: 2,\n    villainPopularity: 2,\n    villianName: \"This is an error\",\n};\n\nexport function getRelationshipSummary(hero: Houseguest, villain: Houseguest): RelationshipSummary {\n    const doIWin = hero.superiors[villain.id];\n    const type = classifyRelationship(hero.popularity, villain.popularity, hero.relationships[villain.id]);\n    return {\n        id: villain.id,\n        relationship: villain.relationships[hero.id],\n        type,\n        winrate: hero.powerRanking,\n        pHeroWins: doIWin,\n        villainPopularity: villain.popularity,\n        villianName: villain.name,\n    };\n}\n\nexport class Targets {\n    private firstTarget: RelationshipSummary = deadValue;\n    private secondTarget: RelationshipSummary = deadValue;\n    private hg: Houseguest;\n\n    constructor(hg: Houseguest) {\n        this.hg = hg;\n    }\n\n    public getTargets(): [number, number] {\n        return [this.firstTarget.id, this.secondTarget.id];\n    }\n    public addTarget(newTarget: RelationshipSummary, gameState: GameState) {\n        if (\n            !(\n                isBetterTarget(this.firstTarget, newTarget, this.hg, gameState) ||\n                isBetterTarget(this.secondTarget, newTarget, this.hg, gameState)\n            )\n        )\n            return;\n        isBetterTarget(this.firstTarget, this.secondTarget, this.hg, gameState)\n            ? (this.firstTarget = newTarget)\n            : (this.secondTarget = newTarget);\n    }\n}\n\nenum WinrateStrategy {\n    Low,\n    Medium,\n    High,\n}\n\n// Statusquo goes with the status quo, underdog tries to disrupt & go after big targets, MoR goes after his personal targets\nexport enum TargetStrategy {\n    StatusQuo,\n    Underdog,\n    MoR,\n}\n\nfunction determineWinrateStrategy(hero: Houseguest): WinrateStrategy {\n    if (hero.powerRanking >= 0.45) return WinrateStrategy.High;\n    if (hero.powerRanking <= 1 / 3) return WinrateStrategy.Low;\n    return WinrateStrategy.Medium;\n}\n\nexport function determineStrategy(hero: Houseguest): TargetStrategy {\n    if (hero.friends === hero.enemies) return TargetStrategy.MoR;\n    return hero.friends > hero.enemies ? TargetStrategy.StatusQuo : TargetStrategy.Underdog;\n}\n\n// return the index of the better target\nexport function isBetterTargetWithLogic(\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    hero: Houseguest,\n    gameState: GameState\n): NumberWithLogic {\n    if (old.relationship === 2) return { decision: 1, reason: \"remove debug value\" };\n    if (neww.relationship === 2) return { decision: 0, reason: \"remove debug value\" };\n    const strategy = determineStrategy(hero);\n    const winrateStrategy = determineWinrateStrategy(hero);\n    if (strategy === TargetStrategy.StatusQuo)\n        return isBetterTargetStatusQuo(hero, old, neww, winrateStrategy, gameState);\n    else if (strategy === TargetStrategy.MoR) {\n        return isBetterTargetMoR(old, neww, gameState, hero, winrateStrategy);\n    } else {\n        return isBetterTargetUnderdog(old, neww, gameState, hero, winrateStrategy);\n    }\n}\n\nexport function isBetterTarget(\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    hero: Houseguest,\n    gameState: GameState\n): boolean {\n    return isBetterTargetWithLogic(old, neww, hero, gameState).decision === 1;\n}\n\nfunction voteBasedOnCentrality(\n    gameState: GameState,\n    internalCallback: (x: RelationshipType) => boolean\n): (hero: Houseguest, nominees: [RelationshipSummary, RelationshipSummary]) => NumberWithLogic {\n    return (hero: Houseguest, nominees: [RelationshipSummary, RelationshipSummary]): NumberWithLogic => {\n        const decision = isMoreCentral(hero, nominees[0], nominees[1], gameState, internalCallback) ? 1 : 0;\n        return {\n            decision,\n            reason: `${[nominees[0], nominees[1]][decision].villianName} is more popular among my enemies.`,\n        };\n    };\n}\n\nfunction targetEnemies(\n    hero: Houseguest,\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    callback: (\n        hero: Houseguest,\n        nominees: [RelationshipSummary, RelationshipSummary],\n        callback?: (hero: Houseguest, nominees: [RelationshipSummary, RelationshipSummary]) => NumberWithLogic\n    ) => NumberWithLogic\n): NumberWithLogic {\n    if (old.type !== RelationshipType.Enemy) return _targetEnemies();\n    if (neww.type !== RelationshipType.Enemy)\n        return { decision: 0, reason: `${old.villianName} is my enemy.` };\n    return callback(hero, [old, neww]);\n\n    function _targetEnemies() {\n        const decision = (neww.type === RelationshipType.Enemy ? true : neww.relationship < old.relationship)\n            ? 1\n            : 0;\n        return {\n            decision,\n            reason: `I like ${[old, neww][decision].villianName} the least of these noms.`,\n        };\n    }\n}\n\nfunction isBetterTargetMoR(\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    gameState: GameState,\n    hero: Houseguest,\n    winrateStrategy: WinrateStrategy\n): NumberWithLogic {\n    const morStrategy = (x: RelationshipType) => x === RelationshipType.Enemy;\n    if (winrateStrategy === WinrateStrategy.High || !inJury(gameState)) {\n        // prioritize targeting enemies, break ties based on enemy centrality\n        return targetEnemies(hero, old, neww, voteBasedOnCentrality(gameState, morStrategy));\n    } else if (winrateStrategy === WinrateStrategy.Medium) {\n        // prioritize targeting enemies, break ties based on if i can beat them, then break further ties based on centrality\n        return targetEnemies(hero, old, neww, (hero, [old, neww]) =>\n            voteBasedonWinrate(hero, old, neww, voteBasedOnCentrality(gameState, morStrategy))\n        );\n    } else {\n        // prioritize targeting high winrate, break ties based on friend/enemy status, then centrality\n        return voteBasedonWinrate(hero, old, neww, (hero, [old, neww]) =>\n            targetEnemies(hero, old, neww, voteBasedOnCentrality(gameState, morStrategy))\n        );\n    }\n}\n\nfunction isBetterTargetUnderdog(\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    gameState: GameState,\n    hero: Houseguest,\n    winrateStrategy: WinrateStrategy\n): NumberWithLogic {\n    const underdogStrategy = (x: RelationshipType) => x !== RelationshipType.Friend;\n    if (winrateStrategy === WinrateStrategy.High || !inJury(gameState)) {\n        // prioritize targeting enemies, break ties based on enemy centrality\n        return targetEnemies(hero, old, neww, voteBasedOnCentrality(gameState, underdogStrategy));\n    } else if (winrateStrategy === WinrateStrategy.Medium) {\n        // prioritize targeting enemies, break ties based on if i can beat them, then break further ties based on centrality\n        return targetEnemies(hero, old, neww, (hero, [old, neww]) =>\n            voteBasedonWinrate(hero, old, neww, voteBasedOnCentrality(gameState, underdogStrategy))\n        );\n    } else {\n        // prioritize targeting high winrate, break ties based on friend/enemy status, then centrality\n        return voteBasedonWinrate(hero, old, neww, (hero, [old, neww]) =>\n            targetEnemies(hero, old, neww, voteBasedOnCentrality(gameState, underdogStrategy))\n        );\n    }\n}\n\n// returns true if neww is more central than old\nfunction isMoreCentral(\n    hero: Houseguest,\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    gameState: GameState,\n    condition: (x: RelationshipType) => boolean\n): boolean {\n    let { oldPop, newPop }: { oldPop: number; newPop: number } = computeLocalPopularity(\n        gameState,\n        hero,\n        old,\n        neww,\n        condition\n    );\n    return oldPop < newPop;\n}\n\n// computes the popularity of houseguests old and neww,\n// only taking into account houseguests that have relationship type x with hero\n// satisfying the boolean condition you pass in\nfunction computeLocalPopularity(\n    gameState: GameState,\n    hero: Houseguest,\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    condition: (x: RelationshipType) => boolean\n) {\n    const nonFriends: Houseguest[] = Array.from(gameState.nonEvictedHouseguests)\n        .map((hg) => getById(gameState, hg))\n        .filter(\n            (villain) =>\n                condition(\n                    classifyRelationship(hero.popularity, villain.popularity, hero.relationshipWith(villain))\n                ) && hero.id !== villain.id\n        );\n    let oldPop: number = 0;\n    const oldHg: Houseguest = getById(gameState, old.id);\n    let newPop: number = 0;\n    const newHg: Houseguest = getById(gameState, neww.id);\n    nonFriends.forEach((hg) => {\n        if (hg.id !== oldHg.id) {\n            oldPop += oldHg.relationshipWith(hg);\n        }\n        if (hg.id !== newHg.id) {\n            newPop += newHg.relationshipWith(hg);\n        }\n    });\n    return { oldPop, newPop };\n}\n\nfunction isBetterTargetStatusQuo(\n    hero: Houseguest,\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    winrateStrategy: WinrateStrategy,\n    gameState: GameState\n): NumberWithLogic {\n    if (winrateStrategy === WinrateStrategy.High || !inJury(gameState)) {\n        return voteBasedOnRelationship(hero, [old, neww]);\n    } else if (winrateStrategy === WinrateStrategy.Medium) {\n        // with a sort of low winrate, break ties with winrate\n        const r0 = classifyTwoWayRelationship(\n            hero.popularity,\n            old.villainPopularity,\n            hero.relationships[old.id]\n        );\n        const r1 = classifyTwoWayRelationship(\n            hero.popularity,\n            neww.villainPopularity,\n            hero.relationships[neww.id]\n        );\n        return r0 === r1\n            ? voteBasedonWinrate(hero, old, neww, voteBasedOnRelationship)\n            : voteBasedOnRelationship(hero, [old, neww]);\n    } else {\n        return voteBasedonWinrate(hero, old, neww, voteBasedOnRelationship);\n    }\n}\n\nfunction voteBasedonWinrate(\n    hero: Houseguest,\n    nom0: RelationshipSummary,\n    nom1: RelationshipSummary,\n    callback: (hero: Houseguest, nominees: [RelationshipSummary, RelationshipSummary]) => NumberWithLogic\n): NumberWithLogic {\n    const heroBeatsnom0 = hero.powerRanking < hero.superiors[nom0.id];\n    const heroBeatsnom1 = hero.powerRanking < hero.superiors[nom1.id];\n    // if i am voting between 2 people who i can't beat, vote based on relationship\n    if (!heroBeatsnom0 && !heroBeatsnom1) {\n        return callback(hero, [nom0, nom1]);\n    }\n    // otherwise, vote based on winrate\n    const decision = hero.superiors[nom0.id] < hero.superiors[nom1.id] ? 0 : 1;\n    return {\n        decision,\n        reason: `I can't beat ${[nom0, nom1][decision].villianName} in the end.`,\n    };\n}\n\n// returns the index (0 or 1) of the vote\n// formerly known as cutthroatVote\nfunction voteBasedOnRelationship(\n    hero: Houseguest,\n    nominees: [RelationshipSummary, RelationshipSummary]\n): NumberWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    const r0 = classifyRelationship(hero.popularity, nom0.villainPopularity, hero.relationships[nom0.id]);\n    const r1 = classifyRelationship(hero.popularity, nom1.villainPopularity, hero.relationships[nom1.id]);\n\n    if (r0 === RelationshipType.Enemy && r1 === RelationshipType.Enemy) {\n        const decision = hero.relationships[nom0.id] < hero.relationships[nom1.id] ? 0 : 1;\n        return {\n            decision,\n            reason: `I dislike ${nominees[decision].villianName} the most of these enemies.`,\n        };\n    } else if (\n        (r0 === RelationshipType.Enemy && r1 !== RelationshipType.Enemy) ||\n        (r1 === RelationshipType.Enemy && r0 !== RelationshipType.Enemy)\n    ) {\n        const vote = r0 === RelationshipType.Enemy ? 0 : 1;\n        return { decision: vote, reason: `${nominees[vote].villianName} is my enemy.` };\n    } else if (\n        (r0 !== RelationshipType.Friend && r1 === RelationshipType.Friend) ||\n        (r1 !== RelationshipType.Friend && r0 === RelationshipType.Friend)\n    ) {\n        const vote = r0 !== RelationshipType.Friend ? 0 : 1;\n        const nonVote = vote === 0 ? 1 : 0;\n        return { decision: vote, reason: `${nominees[nonVote].villianName} is my friend.` };\n    }\n    const vote = lowestScore(hero, nominees, relationship);\n    return {\n        decision: vote,\n        reason: `I like ${nominees[vote === 0 ? 1 : 0].villianName} the most of these noms.`,\n    };\n}\n","import { Houseguest, GameState, exclude, inJury } from \"../../model\";\nimport { rng } from \"../BbRandomGenerator\";\nimport { getRelationshipSummary, isBetterTarget, isBetterTargetWithLogic } from \"./targets\";\n\nexport interface NumberWithLogic {\n    decision: number;\n    reason: string;\n}\n\nexport interface HouseguestWithLogic {\n    decision: Houseguest | null;\n    reason: string;\n}\n\n// Return the index of the eviction target.\n\n// vote to save, in the future, generalize this to n nominees instead of going 2 by 2\nexport function castVoteToSave(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): NumberWithLogic {\n    if (nominees.length === 0) throw new Error(\"Tried to cast a vote to save with no nominees.\");\n    let currentSave: NumberWithLogic = { decision: 0, reason: \"\" };\n    nominees.forEach((nominee, i) => {\n        if (i === 0) return;\n        const evictionTarget = castEvictionVote(hero, [nominee, nominees[currentSave.decision]], gameState);\n        if (!currentSave.reason) {\n            currentSave.reason = evictionTarget.reason;\n        }\n        if (evictionTarget.decision === 1) {\n            currentSave = { decision: i, reason: evictionTarget.reason };\n        }\n    });\n    return currentSave;\n}\n\n// returns the index in the array of the person you're voting to evict\nexport function castEvictionVote(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): NumberWithLogic {\n    // In the F3 vote, take the person who you have better odds against to F2\n    if (gameState.remainingPlayers === 3) {\n        return castF3Vote(hero, nominees[0], nominees[1]);\n    }\n    // In the F4 vote, do some genius level mathematics to predict what gives you the best odds of winning given that the\n    // person who wins the F3 HoH will evict the person they have the worst odds against\n    if (gameState.remainingPlayers === 4) {\n        // prevents 4 player games from crashing LULW\n        if (!inJury(gameState)) {\n            return isBetterTargetWithLogic(\n                getRelationshipSummary(hero, nominees[0]),\n                getRelationshipSummary(hero, nominees[1]),\n                hero,\n                gameState\n            );\n        }\n        return castF4vote(\n            hero,\n            nominees[0],\n            nominees[1],\n            // all this work just to get the HoH...\n            exclude(\n                Array.from(gameState.nonEvictedHouseguests.values()).map(\n                    (id) => gameState.houseguestCache[id]\n                ),\n                [nominees[0], nominees[1], hero]\n            )[0]\n        );\n    }\n    return isBetterTargetWithLogic(\n        getRelationshipSummary(hero, nominees[0]),\n        getRelationshipSummary(hero, nominees[1]),\n        hero,\n        gameState\n    );\n}\n\nfunction winningOddsF3(hero: Houseguest, villain1: Houseguest, villain2: Houseguest): number {\n    // chance that hero wins final HoH\n    const heroVs1: number = hero.superiors[villain1.id];\n    const heroVs2: number = hero.superiors[villain2.id];\n    const v1Vs2: number = villain1.superiors[villain2.id];\n\n    if (heroVs1 === undefined)\n        throw new Error(\n            `Tried to get a power comparison that does not exist between ${hero.name} and ${villain1.name} [1]`\n        );\n    if (heroVs2 === undefined)\n        throw new Error(\n            `Tried to get a power comparison that does not exist between ${hero.name} and ${villain2.name} [2]`\n        );\n    if (v1Vs2 === undefined)\n        throw new Error(\n            `Tried to get a power comparison that does not exist between ${villain1.name} and ${villain2.name} [3]`\n        );\n    const heroWins: number = Math.max(heroVs1, heroVs2); // evict the person who beats you more often\n    const v1wins: number = castF3Vote(villain1, hero, villain2).decision === 0 ? 0 : heroVs1;\n    const v2wins: number = castF3Vote(villain2, hero, villain1).decision === 0 ? 0 : heroVs2;\n    return (1 / 3) * heroWins + (1 / 3) * v1wins + (1 / 3) * v2wins;\n}\n\nfunction castF3Vote(hero: Houseguest, nom0: Houseguest, nom1: Houseguest): NumberWithLogic {\n    const decision = hero.superiors[nom0.id] < hero.superiors[nom1.id] ? 0 : 1;\n    return {\n        decision,\n        reason: `I have better odds of beating ${decision ? nom0.name : nom1.name} in the final 2.`,\n    };\n}\n\nfunction castF4vote(hero: Houseguest, nom0: Houseguest, nom1: Houseguest, HoH: Houseguest): NumberWithLogic {\n    const evictNom0 = winningOddsF3(hero, nom1, HoH);\n    const evictNom1 = winningOddsF3(hero, nom0, HoH);\n    const decision = evictNom0 > evictNom1 ? 0 : 1;\n    return {\n        decision,\n        reason: `Evicting ${\n            [nom0, nom1][decision].name\n        } gives me better odds of making it to the end and winning.`,\n    };\n}\n\n// returns the id of the houseguests you're backdooring\nexport function backdoorNPlayers(\n    hero: Houseguest,\n    options: Houseguest[],\n    gameState: GameState,\n    n: number\n): NumberWithLogic[] {\n    if (options.length < n) throw new Error(`Tried to backdoor ${n} players with ${options.length} options.`);\n    const result: NumberWithLogic[] = [];\n    const sortedOptions = [...options];\n    // negative value if first is less than second\n    sortedOptions.sort((hg1, hg2) => {\n        return isBetterTarget(\n            getRelationshipSummary(hero, hg1),\n            getRelationshipSummary(hero, hg2),\n            hero,\n            gameState\n        )\n            ? 1\n            : -1;\n    });\n\n    while (result.length < n) {\n        const decision = sortedOptions[result.length];\n        const reason = \"\";\n        result.push({ decision: decision.id, reason });\n    }\n    return result;\n}\n\nexport function pJurorVotesForHero(juror: Houseguest, hero: Houseguest, villain: Houseguest): number {\n    const r1 = juror.relationshipWith(hero);\n    const r2 = juror.relationshipWith(villain);\n    const delta = (r1 - r2) / 2;\n    let result = 0.5 + delta;\n    if (result > 1) result = 1;\n    if (result < 0) result = 0;\n    return result;\n}\n\n// Returns the index of the finalist with the highest relationship with juror\n// only works with 2 finalists\nexport function castJuryVote(juror: Houseguest, finalists: Houseguest[]): number {\n    const choice = Math.abs(rng().randomFloat());\n    return choice > pJurorVotesForHero(juror, finalists[0], finalists[1]) ? 1 : 0;\n}\n","import { GameState, Houseguest, MutableGameState, getById, exclude } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { backdoorNPlayers } from \"../../../utils/ai/aiApi\";\nimport { listNames } from \"../../../utils/listStrings\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\n\nexport function generateBotbNomCeremonyScene(\n    initialGameState: GameState,\n    hoh1: Houseguest,\n    hoh2: Houseguest\n): [GameState, Scene, Houseguest[][]] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    const exclusions = [hoh1, hoh2];\n    const noms1: Houseguest[] = [];\n    const noms2: Houseguest[] = [];\n    for (let i = 0; i < 4; i++) {\n        const hoh = i % 2 === 0 ? hoh1 : hoh2;\n        const nextNom: Houseguest = getById(\n            newGameState,\n            backdoorNPlayers(hoh, exclude(newGameState.houseguests, exclusions), newGameState, 1)[0].decision\n        );\n        exclusions.push(nextNom);\n        i % 2 === 0 ? noms1.push(nextNom) : noms2.push(nextNom);\n    }\n    [noms1, noms2].forEach((arr) => arr.forEach((nom) => nom.nominations++));\n    newGameState.currentLog.nominationsPreVeto = [...noms1, ...noms2].map((nom) => nom.name);\n\n    newGameState.currentLog.nominationsPreVeto = require(\"alphanum-sort\")(\n        newGameState.currentLog.nominationsPreVeto\n    );\n    const finalStatement = (noms: Houseguest[]) =>\n        `I have nominated you, ${listNames(noms.map((n) => n.name))} for eviction. `;\n    const firstText = \"My first nominee is...\";\n    const secondText = \"My second nominee is...\";\n\n    const block = (noms: Houseguest[], hoh: ProfileHouseguest) => {\n        return (\n            <div className=\"column\">\n                <div className=\"column\">\n                    <div className=\"columns is-centered\">\n                        <div className=\"column\">\n                            <Portrait centered={true} houseguest={hoh} />\n                        </div>\n                    </div>\n                    <div className=\"columns is-centered\">\n                        <DividerBox className=\"column is-5\">\n                            <Centered> {firstText}</Centered>\n                            <Portrait centered={true} houseguest={noms[0]} />\n                        </DividerBox>\n                        <DividerBox className=\"column is-5\">\n                            <Centered> {secondText}</Centered>\n                            <Portrait centered={true} houseguest={noms[1]} />\n                        </DividerBox>\n                    </div>\n                </div>\n                <div className=\"column\">\n                    <CenteredBold>{finalStatement(noms)}</CenteredBold>\n                </div>\n            </div>\n        );\n    };\n\n    const scene = new Scene({\n        title: \"Nomination Ceremony\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    This is the nomination ceremony. It is our responsibility as Heads of Household to each\n                    nominate two houseguests for eviction.\n                </Centered>\n                <div className=\"columns is-marginless is-centered\">\n                    {block(noms1, hoh1)}\n                    {block(noms2, hoh2)}\n                </div>\n                <br />\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, [noms1, noms2]];\n}\n","import { every } from \"lodash\";\nimport { Houseguest, GameState, exclude, getById, nonEvictedHouseguests } from \"../../../model\";\nimport { backdoorNPlayers, HouseguestWithLogic, NumberWithLogic } from \"../../../utils/ai/aiApi\";\nimport { classifyRelationship, RelationshipType } from \"../../../utils/ai/classifyRelationship\";\nimport {\n    isBetterTarget,\n    getRelationshipSummary,\n    isBetterTargetWithLogic,\n    determineStrategy,\n    TargetStrategy,\n} from \"../../../utils/ai/targets\";\n\nexport interface Veto {\n    name: string;\n    use: (hero: Houseguest, nominees: Houseguest[], gameState: GameState, HoH: number) => HouseguestWithLogic;\n}\n\nexport const GoldenVeto: Veto = {\n    name: \"Golden Power of Veto\",\n    use: useGoldenVeto,\n};\n\nexport const DiamondVeto: Veto = {\n    name: \"💎 Diamond Power of Veto\",\n    use: useDiamondVeto,\n};\n\nexport const SpotlightVeto: Veto = {\n    name: \"🔦 Spotlight Power of Veto\",\n    use: useSpotlightVeto,\n};\n\nexport const BoomerangVeto: Veto = {\n    name: \"🪃 Boomerang Power of Veto\",\n    use: useBoomerangVeto,\n};\n\n// only works for 2 nominees\nfunction useBoomerangVeto(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState,\n    HoH: number\n): HouseguestWithLogic {\n    if (nominees.length !== 2) throw new Error(\"Boomerang veto only works for 2 nominees.\");\n    const checks = basicVetoChecks(hero, nominees, gameState, HoH);\n    if (checks) return checks;\n    // Need an additional check for boomerang veto, since there are 2 replacement noms\n    if (gameState.remainingPlayers - 1 - nominees.length === 2) {\n        return {\n            decision: null,\n            reason: \"It doesn't make sense to use the veto here.\",\n        };\n    }\n\n    // if you wouldn't use gold veto on either of them, discard\n    const veto1 = useGoldenVeto(hero, [nominees[0]], gameState, HoH);\n    const veto2 = useGoldenVeto(hero, [nominees[1]], gameState, HoH);\n    if (veto1.decision === null && veto2.decision === null) {\n        return { decision: null, reason: \"I don't want to save either of these noms.\" };\n    }\n    // if you would use gold veto on both of them, use\n    if (veto1.decision !== null && veto2.decision !== null) {\n        return { decision: nominees[0], reason: \"I want to save both of these noms.\" };\n    }\n    // if you would only use it on one of them, only use it if you have low friend counts\n    const strategy = determineStrategy(hero);\n    if (strategy === TargetStrategy.StatusQuo) {\n        return { decision: null, reason: \"I want to evict at least one of these noms.\" };\n    } else {\n        return { decision: nominees[0], reason: \"I want to save at least one of these noms.\" };\n    }\n}\n\nfunction useSpotlightVeto(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState,\n    HoH: number\n): HouseguestWithLogic {\n    // basically ya forced to use it\n    const checks = basicVetoChecks(hero, nominees, gameState, HoH);\n    if (checks && checks.decision !== null) return checks;\n    // use the veto on whoever is the worse target between the 2 nominees\n    const invertedDecision = isBetterTargetWithLogic(\n        getRelationshipSummary(hero, nominees[0]),\n        getRelationshipSummary(hero, nominees[1]),\n        hero,\n        gameState\n    );\n    const decision = invertedDecision.decision === 0 ? 1 : 0;\n    return { decision: nominees[decision], reason: invertedDecision.reason };\n}\n\nfunction useGoldenVeto(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState,\n    HoH: number\n): HouseguestWithLogic {\n    const checks = basicVetoChecks(hero, nominees, gameState, HoH);\n    if (checks) return checks;\n    let reason = \"None of these nominees are my friends.\";\n    let potentialSave: Houseguest | null = null;\n    let alwaysSave: Houseguest | null = null;\n    nominees.forEach((nominee) => {\n        // TODO: Save people who you can beat in the end if you are low winrate\n        const relationship = classifyRelationship(\n            hero.popularity,\n            nominee.popularity,\n            hero.relationshipWith(nominee)\n        );\n        if (relationship === RelationshipType.Friend) {\n            if (potentialSave) {\n                potentialSave =\n                    hero.relationshipWith(nominee) > hero.relationshipWith(potentialSave)\n                        ? nominee\n                        : potentialSave;\n                reason = `Of these noms, I like ${potentialSave.name} the most.`;\n            } else {\n                reason = `${nominee.name} is my friend.`;\n                potentialSave = nominee;\n            }\n        }\n    });\n    if (alwaysSave) {\n        return { decision: alwaysSave, reason };\n    } else if (potentialSave) {\n        return { decision: potentialSave, reason };\n    } else {\n        return { decision: null, reason };\n    }\n}\n\n// only works with 2 nominees\nfunction useDiamondVeto(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState,\n    HoH: number,\n    skipChecks: boolean = false\n): HouseguestWithLogic {\n    if (!skipChecks) {\n        const checks = basicVetoChecks(hero, nominees, gameState, HoH);\n        if (checks) return checks;\n    }\n    // get the 2 best targets out of the pool of all options\n    const idealTargets: NumberWithLogic[] = backdoorNPlayers(\n        hero,\n        exclude(nonEvictedHouseguests(gameState), [hero, getById(gameState, HoH)]),\n        gameState,\n        2\n    );\n    // if ideal targets is equal to nominees, do nothing\n    const ids1 = idealTargets.map((n) => n.decision);\n    const ids2 = nominees.map((n) => n.id);\n    if ((ids1[0] === ids2[0] && ids1[1] === ids2[1]) || (ids1[0] === ids2[1] && ids1[1] === ids2[0])) {\n        return {\n            decision: null,\n            reason: \"These are my ideal nominations.\",\n        };\n    }\n    // otherwise, replace the person i least want gone\n    const worseTarget: number = isBetterTarget(\n        getRelationshipSummary(hero, nominees[0]),\n        getRelationshipSummary(hero, nominees[1]),\n        hero,\n        gameState\n    )\n        ? 0\n        : 1;\n\n    return { decision: nominees[worseTarget], reason: \"I would rather see someone else nominated.\" };\n}\n\nfunction basicVetoChecks(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState,\n    HoH: number,\n    immunePlayers: Houseguest[] = []\n): HouseguestWithLogic | null {\n    if (hero.id === HoH) {\n        return {\n            decision: null,\n            reason: \"These are my ideal nominations.\",\n        };\n    }\n    for (const nom of nominees) {\n        if (hero.id === nom.id) return { decision: hero, reason: \"I am going to save myself.\" };\n    }\n    // if player is not immune, don't use the veto if you are the only replacement nominee\n    if (\n        every(immunePlayers, (player) => player.id !== hero.id) &&\n        gameState.remainingPlayers - 1 - immunePlayers.length - nominees.length === 1\n    ) {\n        return {\n            decision: null,\n            reason: \"It doesn't make sense to use the veto here.\",\n        };\n    }\n    return null;\n}\n","import { GameState, Houseguest, MutableGameState } from \"../../model\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport { Scene } from \"./scenes/scene\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateBotbNomCeremonyScene } from \"./scenes/botbNomCeremonyScene\";\nimport { generateVetoScenesOnwards } from \"./bigBrotherEpisode\";\nimport { GoldenVeto } from \"./veto/veto\";\nimport { generateBotbScene } from \"./scenes/botbScene\";\n\nexport const BattleOfTheBlock: EpisodeType = {\n    canPlayWith: (n: number) => n >= 6,\n    eliminates: 1,\n    arrowsEnabled: true,\n    emoji: \"⚔️\",\n    hasViewsbar: true,\n    name: \"Battle of the Block\",\n    description:\n        \"Two HoHs name a total of four nominees. The nominees compete in a competition, and the winners are safe for the week and dethrone the HoH who nominated them.\",\n    generate: generateBoB,\n};\n\nfunction generateBoB(initialGamestate: GameState): Episode {\n    // generate (co)-hoh scene\n    let currentGameState = new MutableGameState(initialGamestate);\n    let hohArray: Houseguest[];\n    let hohCompScene: Scene;\n    const scenes: Scene[] = [];\n    [currentGameState, hohCompScene, hohArray] = generateHohCompScene(currentGameState, {\n        coHoH: true,\n        coHohIsFinal: false,\n    });\n    scenes.push(hohCompScene);\n    // nominations, but with TWO sets of nominees\n    let nomCeremonyScene;\n    let nominees: Houseguest[][];\n    [currentGameState, nomCeremonyScene, nominees] = generateBotbNomCeremonyScene(\n        currentGameState,\n        hohArray[0],\n        hohArray[1]\n    );\n    scenes.push(nomCeremonyScene);\n    // then battle of the block where one of the HoHs is dethroned\n    let botbscene;\n    let finalhoh;\n    let finalnoms;\n    let botbWinners;\n    [currentGameState, botbscene, finalhoh, finalnoms, botbWinners] = generateBotbScene(\n        currentGameState,\n        hohArray,\n        [...nominees[0], ...nominees[1]]\n    );\n    scenes.push(botbscene);\n    // then veto onwards plays normally except\n    // the winning pair is somehow immune for the week: they can't be backdoored.\n    const vetostuff = generateVetoScenesOnwards(\n        GoldenVeto,\n        currentGameState,\n        finalhoh,\n        finalnoms,\n        false,\n        scenes,\n        botbWinners\n    );\n    currentGameState = vetostuff.gameState;\n\n    return new Episode({\n        gameState: new GameState(currentGameState),\n        initialGamestate,\n        scenes: vetostuff.scenes,\n        type: BattleOfTheBlock,\n    });\n}\n","import { GameState, Houseguest, MutableGameState } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { rng } from \"../../../utils\";\nimport { listNames } from \"../../../utils/listStrings\";\nimport { HoHVote } from \"../../../model/logging/voteType\";\n\nexport function generateBotbScene(\n    initialGameState: GameState,\n    hohArray: Houseguest[],\n    nomsArray: Houseguest[]\n): [GameState, Scene, Houseguest, Houseguest[], Houseguest[]] {\n    const newGameState = new MutableGameState(initialGameState);\n    const hoh0wins = rng().flipCoin();\n    const hoh = hohArray[hoh0wins ? 0 : 1];\n    newGameState.previousHOH = [hoh];\n    newGameState.currentLog.votes[hoh.id] = new HoHVote();\n    const noms = hoh0wins ? [nomsArray[0], nomsArray[1]] : [nomsArray[2], nomsArray[3]];\n    const winners = hoh0wins ? [nomsArray[2], nomsArray[3]] : [nomsArray[0], nomsArray[1]];\n\n    const block = (hohIndex: number, nomIndex: number) => {\n        return (\n            <div className=\"column\">\n                <div className=\"columns is-centered\">\n                    <div className=\"column\">\n                        <Portrait centered={true} houseguest={hohArray[hohIndex]} />\n                    </div>\n                </div>\n                <div className=\"columns is-centered\">\n                    <DividerBox className={`column is-11`}>\n                        <Portraits\n                            centered={true}\n                            houseguests={[nomsArray[nomIndex], nomsArray[nomIndex + 1]]}\n                        />\n                    </DividerBox>\n                </div>\n            </div>\n        );\n    };\n    const block0 = block(0, 0);\n    const block1 = block(1, 2);\n\n    const scene = new Scene({\n        title: \"Battle of the Block\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    {`This is the Battle of the Block competition. ${hohArray[0].name}'s nominees will battle ${hohArray[1].name}'s nominees to save themselves from the block. The winning pair will win safety for the week, and dethrone the HoH that nominated them.`}\n                </Centered>\n                <div className=\"columns is-centered\">\n                    {block0} {block1}\n                </div>\n                <Centered>...</Centered>\n                <Portraits centered={true} houseguests={winners} />\n                <CenteredBold>\n                    {`${listNames(winners.map((w) => w.name))} have won the Battle of the Block!`}\n                </CenteredBold>\n\n                <div className=\"column\">\n                    <div className=\"columns is-centered\">\n                        <div className=\"column\">\n                            <Portrait centered={true} houseguest={hoh} />\n                        </div>\n                    </div>\n                    <div className=\"columns is-centered\">\n                        <DividerBox className=\"column is-5\">\n                            <Portrait centered={true} houseguest={noms[0]} />\n                        </DividerBox>\n                        <DividerBox className=\"column is-5\">\n                            <Portrait centered={true} houseguest={noms[1]} />\n                        </DividerBox>\n                    </div>\n                </div>\n\n                <CenteredBold>\n                    {`${listNames([hoh.name])} will remain as HoH, with ${listNames(\n                        noms.map((n) => n.name)\n                    )} as nominees.`}\n                </CenteredBold>\n                <br />\n                {<NextEpisodeButton />}\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, hoh, noms, winners];\n}\n","import { GameState } from \"../../model\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { EpisodeType, Episode } from \"./episodes\";\nimport { BoomerangVeto } from \"./veto/veto\";\n\nexport const BoomerangVetoEpisode: EpisodeType = {\n    canPlayWith: (n: number) => n >= 5,\n    eliminates: 1,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n    emoji: \"🪃\",\n    description: \"A veto that must be discarded or used to save both nominees.\",\n    name: \"Boomerang Veto\",\n    generate: generate,\n};\n\nfunction generate(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, BoomerangVeto);\n    return new Episode({\n        gameState: new GameState(episode.gameState),\n        initialGamestate,\n        scenes: episode.scenes,\n        type: BoomerangVetoEpisode,\n    });\n}\n","import { GameState, Houseguest, MutableGameState, getById, exclude } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { shuffle } from \"lodash\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { backdoorNPlayers } from \"../../../utils/ai/aiApi\";\nimport { listNames } from \"../../../utils/listStrings\";\n\ninterface NomCeremonyOptions {\n    doubleEviction?: boolean;\n    thirdNominee?: boolean;\n}\n\nexport function generateNomCeremonyScene(\n    initialGameState: GameState,\n    hohList: Houseguest[],\n    options: NomCeremonyOptions\n): [GameState, Scene, Houseguest[]] {\n    const newGameState = new MutableGameState(initialGameState);\n    const HoH = hohList[0];\n    const coHoH = hohList.length > 1 ? hohList[1] : undefined;\n    const doubleEviction = options.doubleEviction || false;\n\n    const nom1: Houseguest = getById(\n        newGameState,\n        backdoorNPlayers(\n            HoH,\n            exclude(newGameState.houseguests, coHoH ? [HoH, coHoH] : [HoH]),\n            newGameState,\n            1\n        )[0].decision\n    );\n\n    const nom2 = coHoH\n        ? getById(\n              newGameState,\n              backdoorNPlayers(\n                  coHoH,\n                  exclude(newGameState.houseguests, [HoH, coHoH, nom1]),\n                  newGameState,\n                  1\n              )[0].decision\n          )\n        : getById(\n              newGameState,\n              backdoorNPlayers(HoH, exclude(newGameState.houseguests, [HoH, nom1]), newGameState, 1)[0]\n                  .decision\n          );\n    nom1.nominations++;\n    nom2.nominations++;\n    newGameState.currentLog.nominationsPreVeto = [nom1.name, nom2.name];\n    let nom3: Houseguest | undefined;\n    if (options.thirdNominee) {\n        nom3 = getById(\n            newGameState,\n            backdoorNPlayers(HoH, exclude(newGameState.houseguests, [HoH, nom1, nom2]), newGameState, 1)[0]\n                .decision\n        );\n        nom3.nominations++;\n        newGameState.currentLog.nominationsPreVeto.push(nom3.name);\n    }\n    newGameState.currentLog.nominationsPreVeto = require(\"alphanum-sort\")(\n        newGameState.currentLog.nominationsPreVeto\n    );\n    const shuffleOrDont = coHoH ? (a: Houseguest[]): Houseguest[] => a : shuffle;\n    const noms = nom3 ? shuffleOrDont([nom1, nom2, nom3]) : shuffleOrDont([nom1, nom2]);\n    const weI = coHoH ? \"We\" : \"I\";\n    const finalStatement = `${weI} have nominated you, ${listNames(noms.map((n) => n.name))} for eviction. `;\n    const myOur = coHoH ? \"our\" : \"my\";\n    const theHoH = coHoH ? \"Heads of Household\" : \"the Head of Household\";\n    const firstText = coHoH ? `${HoH.name} has nominated...` : \"My first nominee is...\";\n    const secondText = coHoH ? `${coHoH.name} has nominated...` : \"My second nominee is...\";\n    const scene = new Scene({\n        title: \"Nomination Ceremony\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    {!doubleEviction &&\n                        `This is the nomination ceremony. It is ${myOur} responsibility as ${theHoH} to\n                    nominate ${options.thirdNominee ? `three` : `two`} houseguests for eviction.`}\n                </Centered>\n                {!doubleEviction && <Portraits centered={true} houseguests={hohList} />}\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Centered>{firstText}</Centered>\n                        <Portrait centered={true} houseguest={noms[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Centered>{secondText}</Centered>\n                        <Portrait centered={true} houseguest={noms[1]} />\n                    </DividerBox>\n                    {options.thirdNominee && (\n                        <DividerBox className=\"column\">\n                            <Centered>My third nominee is...</Centered>\n                            <Portrait centered={true} houseguest={noms[2]} />\n                        </DividerBox>\n                    )}\n                </div>\n                <CenteredBold>{finalStatement}</CenteredBold>\n                <br />\n                {!doubleEviction && <NextEpisodeButton />}\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, noms];\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById,\n} from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { listNames } from \"../../../utils/listStrings\";\nimport { Veto } from \"../veto/veto\";\n\nexport function generateVetoCompScene(\n    initialGameState: GameState,\n    HoHs: Houseguest[],\n    nominees: Houseguest[],\n    veto: Veto,\n    doubleEviction: boolean = false\n): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    // pick players\n    const choices = nonEvictedHouseguests(newGameState);\n    let povPlayers: any[] = [];\n    const everyoneWillPlay = choices.length <= 6;\n\n    if (everyoneWillPlay) {\n        HoHs.forEach((hoh) => povPlayers.push({ ...hoh }));\n        nominees.forEach((nominee) => povPlayers.push({ ...nominee }));\n        while (povPlayers.length < choices.length) {\n            povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        }\n    } else {\n        HoHs.forEach((hoh) => povPlayers.push({ ...hoh }));\n        nominees.forEach((nominee) => povPlayers.push({ ...nominee }));\n        while (povPlayers.length < 6) {\n            povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        }\n    }\n    let povWinner = randomPlayer(povPlayers);\n    povWinner = getById(newGameState, povWinner.id);\n    povWinner.povWins++;\n    newGameState.currentLog.vetoWinner = povWinner.name;\n    let introText: string;\n    if (everyoneWillPlay) {\n        introText = \"Everyone left in the house will compete in this challenge.\";\n    } else {\n        introText = `${listNames(HoHs.map((h) => h.name))}, as Head of Household, and ${listNames(\n            nominees.map((nom) => nom.name)\n        )} as nominees, will compete, as well as ${\n            povPlayers.length - HoHs.length - nominees.length\n        } others chosen by random draw.`; // this line assumes hoh plays in veto (-1)\n    }\n    const firstRow = [...HoHs, ...nominees];\n    const extras = [];\n    for (let i = firstRow.length; i < povPlayers.length; i++) {\n        extras.push(povPlayers[i]);\n    }\n    const scene = new Scene({\n        title: \"Veto Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>\n                    {doubleEviction\n                        ? \"The houseguests compete in the veto competition.\"\n                        : \"It's time to pick players for the veto competition.\"}\n                </Centered>\n                <Portraits centered={true} houseguests={firstRow} />\n                {!doubleEviction && <Centered>{introText}</Centered>}\n                <Portraits centered={true} houseguests={extras} />\n                <Centered>...</Centered>\n                <Portraits centered={true} houseguests={[povWinner]} />\n                <CenteredBold>{`${povWinner.name} has won the ${veto.name}!`}</CenteredBold>\n                {!doubleEviction && <NextEpisodeButton />}\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, povWinner];\n}\n","import { GameState, Houseguest, getById, exclude } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { backdoorNPlayers } from \"../../../utils/ai/aiApi\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { listNames } from \"../../../utils/listStrings\";\nimport _ from \"lodash\";\nimport { BoomerangVeto, DiamondVeto, Veto } from \"../veto/veto\";\n\nexport function generateVetoCeremonyScene(\n    initialGameState: GameState,\n    hohArray: Houseguest[],\n    initialNominees: Houseguest[],\n    povWinner: Houseguest,\n    doubleEviction: boolean,\n    veto: Veto,\n    immuneHgs: Houseguest[]\n): [GameState, Scene, Houseguest[]] {\n    let povTarget: Houseguest | null = null;\n    let descisionText = \"\";\n\n    initialNominees = initialNominees.map((nominee) => {\n        return getById(initialGameState, nominee.id);\n    });\n    const HoH = hohArray[0];\n    const coHoH = hohArray.length > 1 ? hohArray[1] : undefined;\n\n    const vetoChoice = veto.use(povWinner, initialNominees, initialGameState, coHoH ? -1 : HoH.id);\n\n    let nomineeWonPov = false;\n    initialNominees.forEach((nom) => nom.id === povWinner.id && (nomineeWonPov = true));\n\n    povTarget = vetoChoice.decision;\n    const tousethepov = \"to use the power of veto\";\n    if (!povTarget) {\n        descisionText += `... not ${tousethepov}.`;\n    } else if (veto === BoomerangVeto) {\n        descisionText += `... ${tousethepov}.`;\n    } else if (nomineeWonPov) {\n        descisionText += `...${tousethepov} on myself.`;\n    } else {\n        descisionText += `...${tousethepov} on ${povTarget.name}.`;\n    }\n    let replacementSpeech = \"\";\n    let nameAReplacement = \"\";\n    let finalNominees: any[] = [...initialNominees];\n    const HoHnamer = coHoH && povTarget ? (povTarget.id === initialNominees[1].id ? coHoH : HoH) : HoH;\n    const replacementNomineeNamer = veto === DiamondVeto ? povWinner : HoHnamer;\n    if (povTarget) {\n        const HoHwonPoV = HoH.id === povWinner.id && !coHoH;\n        const aReplacementNominee = veto === BoomerangVeto ? \"replacement nominees\" : \"a replacement nominee\";\n        const oneOf = veto !== BoomerangVeto ? \"one of \" : \"\";\n        const you = veto === DiamondVeto ? \"I\" : \"you\";\n        nameAReplacement += HoHwonPoV\n            ? `Since I have just vetoed one of my nominations, I must name ${aReplacementNominee}.`\n            : `${HoHnamer.name}, since I have just vetoed ${oneOf}your nominations, ${you} must name ${aReplacementNominee}.`;\n        // if the exclusion yielded no options, you may be forced to name the veto winner as a replacement\n        let exclusion = exclude(initialGameState.houseguests, [\n            HoH,\n            ...initialNominees,\n            povWinner,\n            ...immuneHgs,\n            coHoH || HoH,\n        ]);\n        if (exclusion.length === 0) {\n            exclusion = exclude(initialGameState.houseguests, [HoH, ...initialNominees, ...immuneHgs]);\n        }\n        const replacementCount = veto === BoomerangVeto ? 2 : 1;\n        const replacementNoms = backdoorNPlayers(\n            replacementNomineeNamer,\n            exclusion,\n            initialGameState,\n            replacementCount\n        ).map((v) => {\n            return getById(initialGameState, v.decision);\n        });\n        if (replacementNoms.length === 1) {\n            const replacementNom = replacementNoms[0];\n            const replacementIndex = initialNominees.findIndex((hg) => hg.id === vetoChoice.decision!.id);\n            finalNominees[replacementIndex] = replacementNom;\n            replacementNom.nominations++;\n            replacementSpeech = `My replacement nominee is ${replacementNom.name}.`;\n        } else {\n            finalNominees = replacementNoms;\n            finalNominees.forEach((nom) => nom.nominations++);\n            replacementSpeech = `My replacement nominees are ${listNames(\n                replacementNoms.map((n) => n.name)\n            )}.`;\n        }\n    }\n    const nomineeNames = initialNominees.map((nom) => nom.name);\n    const scene = new Scene({\n        title: \"Veto Ceremony\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                {!doubleEviction && <Centered>This is the Veto Ceremony.</Centered>}\n                {!doubleEviction && (\n                    <Centered>\n                        {`${listNames(nomineeNames)} have been nominated for eviction, \n                    but I have the power to veto one of these nominations.`}\n                    </Centered>\n                )}\n                <div className=\"columns is-marginless is-centered\">\n                    {initialNominees.map((nom, i) => (\n                        <DividerBox className=\"column\" key={`nominee-${i}`}>\n                            <Portrait centered={true} houseguest={nom} />\n                        </DividerBox>\n                    ))}\n                </div>\n                <CenteredBold>\n                    I have decided... <br />\n                </CenteredBold>\n                <Portrait centered={true} houseguest={{ ...povWinner, tooltip: vetoChoice.reason }} />\n                <CenteredBold noMargin={true}>{descisionText}</CenteredBold>\n                <Centered>{nameAReplacement}</Centered>\n                {replacementSpeech && <Portrait centered={true} houseguest={replacementNomineeNamer} />}\n                <CenteredBold>{replacementSpeech}</CenteredBold>\n                <div className=\"columns is-marginless is-centered\">\n                    {finalNominees.map((nom, i) => (\n                        <DividerBox className=\"column\" key={`final-nominee-${i}`}>\n                            <Portrait centered={true} houseguest={nom} />\n                        </DividerBox>\n                    ))}\n                </div>\n                {!doubleEviction && <NextEpisodeButton />}\n            </div>\n        ),\n    });\n    initialGameState.currentLog.nominationsPostVeto = require(\"alphanum-sort\")(\n        finalNominees.map((nom) => nom.name)\n    );\n    return [initialGameState, scene, finalNominees];\n}\n","import _ from \"lodash\";\nimport {\n    Houseguest,\n    GameState,\n    nonEvictedHouseguests,\n    calculatePopularity,\n    getById,\n    getJurors,\n    inJury,\n    MutableGameState,\n} from \"../../../model\";\nimport { getFinalists } from \"../../../model/season\";\nimport { average, roundTwoDigits } from \"../../../utils\";\nimport { pHeroWinsTheFinale } from \"../../../utils/ai/aiUtils\";\nimport { classifyRelationship, RelationshipType } from \"../../../utils/ai/classifyRelationship\";\nimport { Targets, getRelationshipSummary } from \"../../../utils/ai/targets\";\n\nexport function evictHouseguest(gameState: MutableGameState, id: number): GameState {\n    const evictee = getById(gameState, id);\n    if (gameState.currentLog) gameState.currentLog.evicted.push(evictee.id);\n    evictee.isEvicted = true;\n    if (gameState.remainingPlayers - getFinalists() <= gameState.finalJurySize()) {\n        evictee.isJury = true;\n    }\n    gameState.nonEvictedHouseguests.delete(evictee.id);\n    gameState.remainingPlayers--;\n    refreshHgStats(gameState);\n    return gameState;\n}\n\nexport function refreshHgStats(gameState: MutableGameState, updateDelta: boolean = false) {\n    if (inJury(gameState) && getJurors(gameState).length === 0) {\n        populateSuperiors(nonEvictedHouseguests(gameState));\n    }\n    if (inJury(gameState)) {\n        updatePowerRankings(nonEvictedHouseguests(gameState));\n    }\n    updatePopularity(gameState, updateDelta);\n    gameState.remainingPlayers > 2 && updateFriendCounts(gameState);\n}\n\nfunction populateSuperiors(houseguests: Houseguest[]) {\n    for (let i = 0; i < houseguests.length; i++) {\n        const hero = houseguests[i];\n        for (let j = i + 1; j < houseguests.length; j++) {\n            const villain = houseguests[j];\n            const pHeroWins = pHeroWinsTheFinale({ hero, villain }, houseguests);\n            hero.superiors[villain.id] = pHeroWins;\n            villain.superiors[hero.id] = 1 - pHeroWins;\n        }\n    }\n}\n\nfunction updatePowerRankings(houseguests: Houseguest[]) {\n    houseguests.forEach((hg) => {\n        let superiors: { [id: number]: number } = { ...hg.superiors };\n        const nonEvictedHouseguests: Set<number> = new Set<number>(houseguests.map((h) => h.id));\n        superiors = _.filter(superiors, (_, id) => nonEvictedHouseguests.has(parseInt(id)));\n        hg.powerRanking = average(Object.values(superiors));\n    });\n}\n\nfunction updatePopularity(gameState: GameState, updateDelta: boolean = false) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach((hg) => {\n        hg.targetingMe = 0;\n        const result = calculatePopularity(hg, nonEvictedHouseguests(gameState));\n        if (updateDelta)\n            hg.deltaPopularity = (roundTwoDigits(result) - roundTwoDigits(hg.previousPopularity)) / 100;\n        hg.popularity = result;\n    });\n}\n\nfunction updateFriendCounts(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach((hero: Houseguest) => {\n        let targets = new Targets(hero);\n        let friends = 0;\n        let enemies = 0;\n        houseguests.forEach((villain) => {\n            if (hero.id === villain.id) return;\n            const type = classifyRelationship(\n                hero.popularity,\n                villain.popularity,\n                hero.relationshipWith(villain)\n            );\n            if (type === RelationshipType.Friend) {\n                friends++;\n            } else if (type === RelationshipType.Enemy) {\n                enemies++;\n            }\n        });\n        hero.friends = friends;\n        hero.enemies = enemies;\n        houseguests.forEach((villain) => {\n            if (hero.id === villain.id) return;\n            targets.addTarget(getRelationshipSummary(hero, villain), gameState);\n        });\n        hero.targets = targets.getTargets();\n        hero.targets.forEach((target) => {\n            getById(gameState, target).targetingMe++;\n        });\n    });\n}\n","import { BigBrotherVanilla } from \"../components/episode/bigBrotherEpisode\";\nimport { GameState } from \"./gameState\";\nimport { Episode, EpisodeType, nextEpisode } from \".\";\nimport { BigBrotherFinale } from \"../components/episode/bigBrotherFinale\";\nimport { GameOver } from \"../components/episode/gameOver\";\n\nexport function getFinalists() {\n    return 2;\n}\n\nexport interface EpisodeLibrary {\n    [id: number]: EpisodeType;\n}\n\nexport class Season {\n    private episodeLibrary: EpisodeLibrary = {};\n\n    public constructor(episodeLibrary?: EpisodeLibrary) {\n        if (episodeLibrary) this.episodeLibrary = episodeLibrary;\n    }\n\n    public renderEpisode(gameState: GameState): Episode {\n        return nextEpisode(gameState, this.whichEpisodeType(gameState.remainingPlayers));\n    }\n\n    public whichEpisodeType(players: number) {\n        if (players === 3) {\n            return BigBrotherFinale;\n        }\n        if (players === 2) {\n            return GameOver;\n        }\n        if (this.episodeLibrary[players]) {\n            return this.episodeLibrary[players];\n        }\n        return BigBrotherVanilla;\n    }\n}\n","import { Houseguest } from \"./houseguest\";\nimport { PlayerProfile } from \"./playerProfile\";\nimport _ from \"lodash\";\nimport { newRelationshipMap, rng } from \"../utils\";\nimport { getFinalists } from \"./season\";\nimport { EpisodeLog } from \"./logging/episodelog\";\nimport { Cliques } from \"../utils/generateCliques\";\n\nexport function getById(gameState: GameState, id: number): Houseguest {\n    return gameState.houseguestCache[id];\n}\n\nexport function exclude(inclusions: Houseguest[], exclusions: Houseguest[]) {\n    const excludedIds = exclusions.map((hg) => hg.id);\n    return inclusions.filter((hg) => !excludedIds.includes(hg.id) && !hg.isEvicted);\n}\n\nexport function randomPlayer(inclusions: Houseguest[], exclusions: Houseguest[] = []): Houseguest {\n    if (inclusions.length === 0) {\n        throw new Error(\"Tried to get a random player from a list of 0 players.\");\n    }\n    const options = exclude(inclusions, exclusions);\n    const choice = rng().randomInt(0, options.length - 1);\n\n    return options[choice];\n}\n\nexport function nonEvictedHouseguests(gameState: GameState): Houseguest[] {\n    return [...gameState.nonEvictedHouseguests.entries()].map(([_, id]) => getById(gameState, id));\n}\nexport function getJurors(gameState: GameState): Houseguest[] {\n    return gameState.houseguests.filter((hg) => hg.isJury);\n}\n\nexport function inJury(gameState: GameState): Boolean {\n    return gameState.remainingPlayers - getFinalists() <= gameState.finalJurySize();\n}\n\nexport function calculatePopularity(hero: Houseguest, house: Houseguest[]) {\n    let sum = 0;\n    let count = 0;\n    const targetId = hero.id;\n    house.forEach((houseguest) => {\n        if (houseguest.id !== targetId) {\n            count++;\n            sum += houseguest.relationships[targetId];\n        }\n    });\n    return count === 0 ? 0 : sum / count;\n}\n\nexport function defaultJurySize(castSize: number): number {\n    castSize = Math.round(castSize * 0.55);\n    if (castSize % 2 === 0) {\n        castSize--;\n    }\n    return castSize;\n}\n\nexport function validateJurySize(j: number, castSize: number): boolean {\n    return j >= 1 && j % 2 === 1 && castSize - 2 >= j;\n}\n\nclass _GameState {\n    private jurors: number = 0;\n    readonly houseguests: Houseguest[] = [];\n\n    public finalJurySize() {\n        return this.jurors;\n    }\n    set jurySize(j: number) {\n        if (!validateJurySize(j, this.houseguests.length)) {\n            return;\n        }\n        this.jurors = j;\n    }\n}\n\ninterface InitGameState {\n    players: PlayerProfile[];\n    jury: number;\n}\n\nexport class GameState extends _GameState {\n    // State of the game after a phase.\n\n    readonly houseguestCache: { [id: number]: Houseguest } = {};\n    readonly nonEvictedHouseguests: Set<number> = new Set<number>();\n    readonly remainingPlayers: number = 0;\n    readonly phase: number = 0;\n    readonly previousHOH?: Houseguest[];\n    readonly log: EpisodeLog[][] = [];\n    readonly cliques: Cliques[] = [];\n\n    public __logindex__: number = 0;\n    get currentLog(): EpisodeLog {\n        if (!this.log[this.phase]) return new EpisodeLog(); // an unused episode log, kind of like /dev/null\n        return this.log[this.phase][this.__logindex__];\n    }\n    public incrementLogIndex() {\n        this.__logindex__++;\n        this.log[this.phase].push(new EpisodeLog());\n    }\n    public resetLogIndex() {\n        this.__logindex__ = 0;\n    }\n\n    public constructor(init: InitGameState | GameState) {\n        super();\n        if (init instanceof GameState || init instanceof MutableGameState) {\n            Object.assign(this, init);\n        } else {\n            const _init = init as InitGameState;\n            const profiles = _init.players;\n            this.remainingPlayers = profiles.length;\n            profiles.forEach((profile, i) => {\n                const hg: Houseguest = new Houseguest({\n                    ...profile,\n                    id: i,\n                    relationships: newRelationshipMap(profiles.length, i),\n                });\n                this.nonEvictedHouseguests.add(i);\n                this.houseguestCache[i] = hg;\n                this.houseguests.push(hg);\n            });\n            this.jurySize = _init.jury;\n        }\n        if (!this.finalJurySize()) {\n            this.jurySize = defaultJurySize(this.houseguests.length);\n        }\n    }\n}\n\nexport class MutableGameState extends _GameState {\n    public houseguestCache: { [id: number]: Houseguest } = {};\n    readonly nonEvictedHouseguests: Set<number> = new Set<number>();\n    public remainingPlayers: number = 0;\n    public phase: number = 0;\n    public previousHOH?: Houseguest[];\n    public cliques: Cliques[] = [];\n    public log: EpisodeLog[][] = [];\n\n    public __logindex__: number = 0;\n    get currentLog(): EpisodeLog {\n        if (!this.log[this.phase]) return new EpisodeLog();\n        return this.log[this.phase][this.__logindex__];\n    }\n    public incrementLogIndex() {\n        this.__logindex__++;\n        this.log[this.phase].push(new EpisodeLog());\n    }\n    public resetLogIndex() {\n        this.__logindex__ = 0;\n    }\n\n    public constructor(init: GameState | MutableGameState) {\n        super();\n        const copy = _.cloneDeep(init);\n        Object.assign(this, copy);\n    }\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests, getById } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { shuffle } from \"lodash\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { castEvictionVote, castVoteToSave, NumberWithLogic } from \"../../../utils/ai/aiApi\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NomineeVote, NormalVote, HoHVote, SaveVote, PoVvote } from \"../../../model/logging/voteType\";\nimport { evictHouseguest } from \"../utilities/evictHouseguest\";\nimport { listNames, listVotes } from \"../../../utils/listStrings\";\n\nfunction getHighestIndicies(numbers: number[]): number[] {\n    const highest = Math.max(...numbers);\n    const highestIndicies = numbers.reduce((acc: any[], cur, i) => {\n        if (cur === highest) {\n            acc.push(i);\n        }\n        return acc;\n    }, []);\n    return highestIndicies;\n}\n\ninterface EvictionSceneOptions {\n    votingTo: \"Save\" | \"Evict\";\n    doubleEviction?: boolean;\n    povWinner?: Houseguest;\n}\n\nexport function generateEvictionScene(\n    initialGameState: GameState,\n    hohArray: Houseguest[],\n    nominees: Houseguest[],\n    options: EvictionSceneOptions\n): [GameState, Scene] {\n    const doubleEviction = options.doubleEviction || false;\n    const castVote: (hero: Houseguest, noms: Houseguest[], gameState: GameState) => NumberWithLogic =\n        options.votingTo === \"Save\" ? castVoteToSave : castEvictionVote;\n    let newGameState = new MutableGameState(initialGameState);\n    newGameState.currentLog.votingTo = options.votingTo;\n    nominees = shuffle(nominees);\n    const votes: Array<ProfileHouseguest[]> = nominees.map((_) => []);\n    let lastVoter: Houseguest;\n    let outOf = 0;\n    const nonVoters = new Set<number>(nominees.map((hg) => hg.id));\n    const coHoH = hohArray.length > 1;\n    hohArray.forEach((h) => nonVoters.add(h.id));\n    nonEvictedHouseguests(newGameState).forEach((hg) => {\n        if (!nonVoters.has(hg.id)) {\n            const logic = castVote(hg, nominees, newGameState);\n            const result: ProfileHouseguest = { ...hg };\n            result.tooltip = logic.reason;\n            newGameState.currentLog.votes[hg.id] =\n                options.votingTo === \"Evict\"\n                    ? new NormalVote(nominees[logic.decision].id)\n                    : new SaveVote(nominees[logic.decision].id);\n            votes[logic.decision].push(result);\n            lastVoter = hg;\n            outOf++;\n        }\n    });\n    const voteCounts: number[] = votes.map((vote) => vote.length);\n    const pluralities = getHighestIndicies(voteCounts);\n    newGameState.currentLog.outOf = outOf;\n    if (outOf === 1) {\n        newGameState.currentLog.soleVoter = lastVoter!!.name;\n    }\n    let tieVote = pluralities.length > 1;\n    let tieBreaker = { decision: -1, reason: \"\" };\n    const tieBreakerHg = coHoH ? options.povWinner : hohArray[0];\n    if (tieVote) {\n        newGameState.currentLog.outOf++;\n        tieBreaker = castVote(\n            tieBreakerHg!,\n            pluralities.map((p) => nominees[p]),\n            newGameState\n        );\n        const VoteType = coHoH ? PoVvote : HoHVote;\n        newGameState.currentLog.votes[tieBreakerHg!.id] = new VoteType(\n            nominees[pluralities[tieBreaker.decision]].id\n        );\n    }\n    let evictees: Houseguest[] = [];\n\n    if (options.votingTo === \"Evict\") {\n        // voting to evict\n        if (tieBreaker.decision > -1) {\n            // there was a tie\n            evictees.push(nominees[pluralities[tieBreaker.decision]]);\n            newGameState.currentLog.votesInMajority = voteCounts[pluralities[tieBreaker.decision]] + 1;\n        } else {\n            // there wasn't a tie\n            evictees.push(nominees[pluralities[0]]);\n            newGameState.currentLog.votesInMajority = voteCounts[pluralities[0]];\n        }\n    } else {\n        // voting to save\n        if (tieBreaker.decision > -1) {\n            // there was a tie\n            const safe = nominees[pluralities[tieBreaker.decision]];\n            newGameState.currentLog.votesInMajority = voteCounts[pluralities[tieBreaker.decision]] + 1;\n            nominees.forEach((nom) => {\n                if (nom.id !== safe.id) {\n                    evictees.push(nom);\n                }\n            });\n        } else {\n            // there wasn't a tie\n            const safe = nominees[pluralities[0]];\n            newGameState.currentLog.votesInMajority = voteCounts[pluralities[0]];\n            nominees.forEach((nom) => {\n                if (nom.id !== safe.id) {\n                    evictees.push(nom);\n                }\n            });\n        }\n    }\n    const evicteesSet = new Set<number>(evictees.map((hg) => hg.id));\n    nominees.forEach((hg) => {\n        newGameState.currentLog.votes[hg.id] = new NomineeVote(evicteesSet.has(hg.id));\n    });\n\n    const votesPerEvictee: any = {};\n    nominees.forEach((hg, i) => {\n        if (!evicteesSet.has(hg.id)) return;\n        votesPerEvictee[hg.id] = voteCounts[i] + (tieBreaker.decision === i ? 1 : 0);\n    });\n\n    if (options.votingTo === \"Evict\") evictees.sort((a, b) => votesPerEvictee[b.id] - votesPerEvictee[a.id]);\n    else evictees.sort((a, b) => votesPerEvictee[a.id] - votesPerEvictee[b.id]);\n\n    evictees.forEach((evictee) => {\n        newGameState = evictHouseguest(newGameState, evictee.id);\n    });\n    const isUnanimous = voteCounts.filter((n) => n !== 0).length === 1;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${listVotes(voteCounts.map((v) => `${v}`))}...`;\n\n    const compWinner = coHoH ? \"Power of Veto winner\" : \"current Head of Household\";\n    const soleVoteText = `${\n        tieBreakerHg!.name\n    }, as ${compWinner}, you must cast the sole vote to ${options.votingTo.toLowerCase()}.`;\n\n    const displayHoH: ProfileHouseguest = { ...tieBreakerHg! };\n    displayHoH.tooltip = tieBreaker.reason;\n    const margin = doubleEviction ? { marginTop: 200 } : {};\n    const scene = new Scene({\n        title: \"Live Eviction\",\n        gameState: initialGameState,\n        content: (\n            <div style={margin}>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    {votes.map((voters, i) => (\n                        <DividerBox className=\"column\" key={`voters${i}`}>\n                            <Portraits houseguests={voters} centered={true} />\n                        </DividerBox>\n                    ))}\n                </div>\n                {tieVote && (\n                    <div>\n                        <CenteredBold> We have a tie.</CenteredBold>\n                        <Centered>{soleVoteText}</Centered>\n                        <Portraits houseguests={[displayHoH]} centered={true} />\n                        <CenteredBold>\n                            I vote to {options.votingTo.toLowerCase()}\n                            {` ${nominees[pluralities[tieBreaker.decision]].name}.`}\n                        </CenteredBold>\n                    </div>\n                )}\n                <Portraits houseguests={nominees.map((hg) => getById(newGameState, hg.id))} centered={true} />\n                {options.votingTo === \"Save\" && (\n                    <CenteredBold>{`${listNames(\n                        nominees.filter((nom) => !evicteesSet.has(nom.id)).map((hg) => hg.name)\n                    )}... you are safe.`}</CenteredBold>\n                )}\n                <CenteredBold>{`${options.votingTo === \"Save\" ? \"That means \" : \"\"}${listNames(\n                    evictees.map((hg) => hg.name)\n                )}... you have been evicted from the Big Brother House.`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [newGameState, scene];\n}\n","import { GameState, Houseguest, MutableGameState } from \"../../model\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport { Scene } from \"./scenes/scene\";\nimport { GoldenVeto } from \"./veto/veto\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateNomCeremonyScene } from \"./scenes/nomCeremonyScene\";\nimport { generateVetoCompScene } from \"./scenes/vetoCompScene\";\nimport { generateVetoCeremonyScene } from \"./scenes/vetoCeremonyScene\";\nimport { generateEvictionScene } from \"./scenes/evictionScene\";\n\nexport const CoHoH: EpisodeType = {\n    canPlayWith: (n: number) => n >= 5,\n    eliminates: 1,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n    name: \"Co-HoH\",\n    description:\n        \"Two HoHs each name one nominee, and are responsible for replacing the person they nominated if the veto is used on them.\",\n    emoji: \"👥\",\n    generate: generateCoHoH,\n};\n\nfunction generateCoHoH(initialGamestate: GameState): Episode {\n    // generate (co)-hoh scene\n    let currentGameState = new MutableGameState(initialGamestate);\n    let hohArray: Houseguest[];\n    let hohCompScene: Scene;\n    const scenes: Scene[] = [];\n    [currentGameState, hohCompScene, hohArray] = generateHohCompScene(currentGameState, {\n        coHoH: true,\n        coHohIsFinal: true,\n    });\n    scenes.push(hohCompScene);\n\n    // generate nominations scene\n    let nomCeremonyScene;\n    let nominees: Houseguest[];\n    [currentGameState, nomCeremonyScene, nominees] = generateNomCeremonyScene(currentGameState, hohArray, {});\n    scenes.push(nomCeremonyScene);\n    // veto comp\n    let vetoCompScene;\n    let povWinner: Houseguest;\n    [currentGameState, vetoCompScene, povWinner] = generateVetoCompScene(\n        currentGameState,\n        hohArray,\n        nominees,\n        GoldenVeto\n    );\n    scenes.push(vetoCompScene);\n    // veto replacement scene might be different because each hoh nominated one person, so whoever gets vetoed, that hoh replaces\n    let vetoCeremonyScene;\n\n    [currentGameState, vetoCeremonyScene, nominees] = generateVetoCeremonyScene(\n        currentGameState,\n        hohArray,\n        nominees,\n        povWinner,\n        false,\n        GoldenVeto,\n        []\n    );\n    scenes.push(vetoCeremonyScene);\n\n    // then eviction scene\n    let evictionScene;\n    [currentGameState, evictionScene] = generateEvictionScene(currentGameState, hohArray, nominees, {\n        votingTo: \"Evict\",\n        povWinner,\n    });\n    scenes.push(evictionScene);\n    return new Episode({\n        gameState: new GameState(currentGameState),\n        initialGamestate,\n        scenes,\n        type: CoHoH,\n    });\n}\n","import { GameState } from \"../../model\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { EpisodeType, Episode } from \"./episodes\";\nimport { DiamondVeto } from \"./veto/veto\";\n\nexport const DiamondVetoEpisode: EpisodeType = {\n    canPlayWith: (n: number) => n >= 4,\n    eliminates: 1,\n    arrowsEnabled: true,\n    emoji: \"💎\",\n    hasViewsbar: true,\n    name: \"Diamond Veto\",\n    description: \"The veto winner has the right to name a replacement nominee.\",\n    generate: generateNoVeto,\n};\n\nfunction generateNoVeto(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, DiamondVeto);\n    return new Episode({\n        gameState: new GameState(episode.gameState),\n        initialGamestate,\n        scenes: episode.scenes,\n        type: DiamondVetoEpisode,\n    });\n}\n","import { GameState } from \"../../model\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport React from \"react\";\nimport { Scene } from \"./scenes/scene\";\nimport { GoldenVeto } from \"./veto/veto\";\n\nexport const DoubleEviction: EpisodeType = {\n    canPlayWith: (n: number) => n >= 5,\n    eliminates: 2,\n    arrowsEnabled: true,\n    emoji: \"⏩\",\n    hasViewsbar: true,\n    name: \"Double Eviction\",\n    description: \"A second round of Big Brother plays out in a single scene.\",\n    generate: generateDoubleEviction,\n};\n\nfunction generateDoubleEviction(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, GoldenVeto);\n    let currentGameState = episode.gameState;\n    const scenes: Scene[] = episode.scenes;\n\n    currentGameState.incrementLogIndex();\n    const doubleEviction = generateBBVanillaScenes(currentGameState, GoldenVeto, true);\n    currentGameState = doubleEviction.gameState;\n    scenes.push(\n        new Scene({\n            title: \"Double Eviction\",\n            content: <div>{doubleEviction.scenes.map((scene) => scene.content)}</div>,\n            gameState: doubleEviction.gameState,\n        })\n    );\n\n    return new Episode({\n        gameState: new GameState(currentGameState),\n        initialGamestate,\n        scenes,\n        type: DoubleEviction,\n    });\n}\n","import { GameState } from \"../../model\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { EpisodeType, Episode } from \"./episodes\";\nimport { SpotlightVeto } from \"./veto/veto\";\n\nexport const ForcedVetoEpisode: EpisodeType = {\n    canPlayWith: (n: number) => n >= 5,\n    eliminates: 1,\n    arrowsEnabled: true,\n    emoji: \"🔦\",\n    hasViewsbar: true,\n    name: \"Forced Veto\",\n    description: \"The veto winner must use the veto.\",\n    generate: generateForcedVeto,\n};\n\nfunction generateForcedVeto(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, SpotlightVeto);\n    return new Episode({\n        gameState: new GameState(episode.gameState),\n        initialGamestate,\n        scenes: episode.scenes,\n        type: ForcedVetoEpisode,\n    });\n}\n","import React from \"react\";\nimport { GameState } from \"../../model\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { EpisodeType, Episode } from \"./episodes\";\nimport { Scene } from \"./scenes/scene\";\nimport { GoldenVeto } from \"./veto/veto\";\n\nexport const InstantEviction: EpisodeType = {\n    canPlayWith: (n: number) => n >= 5,\n    eliminates: 2,\n    arrowsEnabled: true,\n    emoji: \"⚡\",\n    hasViewsbar: true,\n    name: \"Instant Eviction\",\n    description: \"A double eviction without a veto.\",\n    generate: generateInstantEviction,\n};\n\nfunction generateInstantEviction(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, GoldenVeto);\n    let currentGameState = episode.gameState;\n    const scenes: Scene[] = episode.scenes;\n\n    currentGameState.incrementLogIndex();\n    const doubleEviction = generateBBVanillaScenes(currentGameState, null, true);\n    currentGameState = doubleEviction.gameState;\n\n    scenes.push(\n        new Scene({\n            title: \"Instant Eviction\",\n            content: <div>{doubleEviction.scenes.map((scene) => scene.content)}</div>,\n            gameState: doubleEviction.gameState,\n        })\n    );\n\n    return new Episode({\n        gameState: new GameState(currentGameState),\n        initialGamestate,\n        scenes,\n        type: InstantEviction,\n    });\n}\n","import { GameState } from \"../../model\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { EpisodeType, Episode } from \"./episodes\";\n\nexport const NoVeto: EpisodeType = {\n    canPlayWith: (n: number) => n >= 4,\n    eliminates: 1,\n    arrowsEnabled: true,\n    emoji: \"🚫\",\n    hasViewsbar: true,\n    name: \"No Veto\",\n    description: \"A week without a veto.\",\n    generate: generateNoVeto,\n};\n\nfunction generateNoVeto(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, null);\n    return new Episode({\n        gameState: new GameState(episode.gameState),\n        initialGamestate,\n        scenes: episode.scenes,\n        type: NoVeto,\n    });\n}\n","import React from \"react\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { GameState } from \"../../model/gameState\";\n\nconst PregameEpisodeType: EpisodeType = {\n    eliminates: 0,\n    canPlayWith: (n: number) => {\n        return n > 2;\n    },\n    arrowsEnabled: true,\n    emoji: \"\",\n    hasViewsbar: false,\n    name: \"Pregame\",\n    description: \"\",\n    generate: (gameState: GameState) => new PregameEpisode(gameState),\n};\n\nexport class PregameEpisode extends Episode {\n    readonly title = \"Pregame\";\n    readonly scenes = [];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = PregameEpisodeType;\n\n    public constructor(gameState: GameState) {\n        super({\n            title: \"Pregame\",\n            scenes: [],\n            content: <PregameScreen cast={gameState.houseguests} />,\n            gameState,\n            type: PregameEpisodeType,\n        });\n        this.gameState = gameState;\n        this.content = <PregameScreen cast={gameState.houseguests} />;\n    }\n}\n","import { Episode, EpisodeType, GameState, Houseguest } from \"../../model\";\nimport React from \"react\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { Scene } from \"./scenes/scene\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateNomCeremonyScene } from \"./scenes/nomCeremonyScene\";\nimport { generateVetoCompScene } from \"./scenes/vetoCompScene\";\nimport { generateVetoCeremonyScene } from \"./scenes/vetoCeremonyScene\";\nimport { generateEvictionScene } from \"./scenes/evictionScene\";\nimport { GoldenVeto } from \"./veto/veto\";\n\nexport const TripleEvictionCad: EpisodeType = {\n    canPlayWith: (n: number) => n >= 6,\n    eliminates: 3,\n    arrowsEnabled: true,\n    emoji: \"🇨🇦\",\n    hasViewsbar: true,\n    name: \"Triple Eviction\",\n    description:\n        \"A double eviction with three nominees. Houseguests vote to save one, and the other two are evicted.\",\n    generate: generateTripleEvictionCad,\n};\n\nexport function generateTripleEvictionCad(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, GoldenVeto);\n    let currentGameState = episode.gameState;\n    const scenes: Scene[] = episode.scenes;\n\n    currentGameState.incrementLogIndex();\n\n    let hohArray: Houseguest[];\n    let hohCompScene: Scene;\n    const tripleScenes: Scene[] = [];\n    [currentGameState, hohCompScene, hohArray] = generateHohCompScene(currentGameState, {\n        doubleEviction: true,\n        customText: \"Houseguests, please return to the living room. Tonight will be a triple eviction.\",\n    });\n    tripleScenes.push(hohCompScene);\n    const hoh = hohArray[0];\n\n    let nomCeremonyScene;\n    let nominees: Houseguest[];\n    [currentGameState, nomCeremonyScene, nominees] = generateNomCeremonyScene(currentGameState, [hoh], {\n        doubleEviction: true,\n        thirdNominee: true,\n    });\n    tripleScenes.push(nomCeremonyScene);\n\n    let vetoCompScene;\n    let povWinner: Houseguest;\n    [currentGameState, vetoCompScene, povWinner] = generateVetoCompScene(\n        currentGameState,\n        [hoh],\n        nominees,\n        GoldenVeto,\n        true\n    );\n    tripleScenes.push(vetoCompScene);\n\n    let vetoCeremonyScene;\n\n    [currentGameState, vetoCeremonyScene, nominees] = generateVetoCeremonyScene(\n        currentGameState,\n        [hoh],\n        nominees,\n        povWinner,\n        true,\n        GoldenVeto,\n        []\n    );\n    tripleScenes.push(vetoCeremonyScene);\n\n    let evictionScene;\n    [currentGameState, evictionScene] = generateEvictionScene(currentGameState, [hoh], nominees, {\n        doubleEviction: true,\n        votingTo: \"Save\",\n    });\n    tripleScenes.push(evictionScene);\n\n    scenes.push(\n        new Scene({\n            title: \"Triple Eviction\",\n            content: <div>{tripleScenes.map((scene) => scene.content)}</div>,\n            gameState: currentGameState,\n        })\n    );\n\n    return new Episode({\n        gameState: new GameState(currentGameState),\n        initialGamestate,\n        scenes,\n        type: TripleEvictionCad,\n    });\n}\n","import { Episode, EpisodeType, GameState } from \"../../model\";\nimport React from \"react\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { Scene } from \"./scenes/scene\";\nimport { GoldenVeto } from \"./veto/veto\";\n\nexport const TripleEvictionUs: EpisodeType = {\n    canPlayWith: (n: number) => n >= 6,\n    eliminates: 3,\n    arrowsEnabled: true,\n    emoji: \"🇺🇸\",\n    hasViewsbar: true,\n    name: \"Triple Eviction\",\n    description: \"Two back to back double evictions.\",\n    generate: generateTripleEvictionUs,\n};\n\nexport function generateTripleEvictionUs(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, GoldenVeto);\n    let currentGameState = episode.gameState;\n    const scenes: Scene[] = episode.scenes;\n\n    currentGameState.incrementLogIndex();\n    const doubleEviction = generateBBVanillaScenes(currentGameState, GoldenVeto, true);\n    currentGameState = doubleEviction.gameState;\n    scenes.push(\n        new Scene({\n            title: \"Double Eviction\",\n            content: <div>{doubleEviction.scenes.map((scene) => scene.content)}</div>,\n            gameState: doubleEviction.gameState,\n        })\n    );\n    currentGameState.incrementLogIndex();\n    const tripleEviction = generateBBVanillaScenes(currentGameState, GoldenVeto, true);\n    currentGameState = tripleEviction.gameState;\n    scenes.push(\n        new Scene({\n            title: \"Triple Eviction\",\n            content: <div>{tripleEviction.scenes.map((scene) => scene.content)}</div>,\n            gameState: tripleEviction.gameState,\n        })\n    );\n    return new Episode({\n        gameState: new GameState(currentGameState),\n        initialGamestate,\n        scenes,\n        type: TripleEvictionUs,\n    });\n}\n","import React, { useState } from \"react\";\nimport styled from \"styled-components\";\nimport { defaultJurySize, GameState, validateJurySize } from \"../../model/gameState\";\nimport { cast$, newEpisode, pushToMainContentStream, season$ } from \"../../subjects/subjects\";\nimport { NumericInput } from \"../castingScreen/numericInput\";\nimport { BattleOfTheBlock } from \"../episode/botbEpisode\";\nimport { BoomerangVetoEpisode } from \"../episode/boomerangVetoEpisode\";\nimport { CoHoH } from \"../episode/coHoHEpisode\";\nimport { DiamondVetoEpisode } from \"../episode/diamondVetoEpisode\";\nimport { DoubleEviction } from \"../episode/doubleEvictionEpisode\";\nimport { EpisodeType } from \"../episode/episodes\";\nimport { ForcedVetoEpisode } from \"../episode/forcedVetoEpisode\";\nimport { InstantEviction } from \"../episode/instantEvictionEpisode\";\nimport { NoVeto } from \"../episode/noVetoEpisode\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { TripleEvictionCad } from \"../episode/tripleEvictionEpisodeCad\";\nimport { TripleEvictionUs } from \"../episode/tripleEvictionEpisodeUs\";\nimport { HasText } from \"../layout/text\";\nimport { selectPlayer } from \"../playerPortrait/selectedPortrait\";\nimport { Noselect } from \"../playerPortrait/setupPortrait\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { Screens } from \"../topbar/topBar\";\nimport { getEpisodeLibrary, SeasonEditorList } from \"./seasonEditorList\";\nimport { TwistAdder } from \"./twistAdder\";\n\nconst Subheader = styled.h3`\n    text-align: center;\n    color: #fff;\n`;\n\nexport const Label = styled.label`\n    color: #fff;\n`;\n\nconst twists: EpisodeType[] = [\n    DoubleEviction,\n    TripleEvictionCad,\n    TripleEvictionUs,\n    InstantEviction,\n    NoVeto,\n    DiamondVetoEpisode,\n    ForcedVetoEpisode,\n    BoomerangVetoEpisode,\n    CoHoH,\n    BattleOfTheBlock,\n];\n\nconst submit = async (jury: number): Promise<void> => {\n    season$.next(getEpisodeLibrary());\n\n    // reset stuff and start a new game\n    pushToMainContentStream(<PregameScreen cast={cast$.value} />, Screens.Other);\n    selectPlayer(null);\n    // vscode says the awaits are unnessecary here,\n    // but if you remove them then bad things happen\n    await newEpisode(null);\n    await newEpisode(new PregameEpisode(new GameState({ players: cast$.value, jury })));\n};\n\nexport function SeasonEditorPage(): JSX.Element {\n    const castLength = cast$.value.length;\n    const [jurySize, setJurySize] = useState(`${defaultJurySize(castLength)}`);\n    const validJurySize = validateJurySize(parseInt(jurySize), castLength);\n    const [areTwistsValid, setTwistsValid] = useState(true);\n    return (\n        <div className=\"columns\">\n            <div className=\"column is-one-quarter\">\n                <HasText>\n                    <h3 style={{ textAlign: \"center\" }}>Season Overview</h3>\n                </HasText>\n                <hr />\n                <Noselect>\n                    <SeasonEditorList setTwistsValid={setTwistsValid} castSize={castLength} />\n                </Noselect>\n            </div>\n            <div className=\"column\" style={{ padding: 20 }}>\n                <Subheader>Add Twists</Subheader>\n                <div className=\"columns is-multiline is-centered\">\n                    {twists.map((type) => (\n                        <TwistAdder type={type} key={`${type.name}${type.emoji}`} />\n                    ))}\n                    <div\n                        className=\"column is-4\"\n                        style={{\n                            border: \"1px solid #808080\",\n                            borderRadius: \"4px\",\n                            backgroundColor: \"#444346\",\n                            margin: \"10px\",\n                        }}\n                    >\n                        <HasText className=\"field is-horizontal centered\">\n                            <div className=\"field-label is-normal\">\n                                <Label className=\"label\" style={validJurySize ? {} : { color: \"#fb8a8a\" }}>\n                                    Jury Size:\n                                </Label>\n                            </div>\n                            <div className=\"field-body\">\n                                <div className=\"field\">\n                                    <div className=\"control\">\n                                        <NumericInput\n                                            className={validJurySize ? undefined : \"is-danger\"}\n                                            value={jurySize}\n                                            onChange={setJurySize}\n                                            placeholder={`${defaultJurySize(castLength)}`}\n                                        />\n                                    </div>\n                                    <p className=\"help\" style={validJurySize ? {} : { color: \"#fb8a8a\" }}>\n                                        {validJurySize\n                                            ? `(Jury starts at F${parseInt(jurySize) + 2})`\n                                            : `Jury must be an odd number < ${castLength - 2}`}\n                                    </p>\n                                </div>\n                            </div>\n                        </HasText>\n                    </div>\n                </div>\n            </div>\n            <div className=\"column is-narrow\" style={{ paddingTop: 20, paddingRight: 20 }}>\n                <button\n                    className=\"button is-success\"\n                    style={{ float: \"right\" }}\n                    onClick={() => {\n                        submit(parseInt(jurySize));\n                    }}\n                    disabled={!validJurySize || !areTwistsValid}\n                >\n                    Submit\n                </button>\n            </div>\n        </div>\n    );\n}\n","import React from \"react\";\nimport FileDrop from \"react-file-drop\";\nimport { PlayerProfile } from \"../../model\";\nimport { SetupPortrait } from \"../playerPortrait/setupPortrait\";\nimport { shuffle } from \"lodash\";\nimport { RandomButton } from \"./randomXButton\";\nimport { selectCastPlayer } from \"../playerPortrait/selectedPortrait\";\nimport { pushToMainContentStream, selectedCastPlayer$, updateCast } from \"../../subjects/subjects\";\nimport { HasText, Input } from \"../layout/text\";\nimport { Centered } from \"../layout/centered\";\nimport { Subscription } from \"rxjs\";\nimport _ from \"lodash\";\nimport { HelpLink } from \"../episode/allianceList\";\nimport { SeasonEditorPage } from \"../seasonEditor/seasonEditorPage\";\nimport { Screens } from \"../topbar/topBar\";\n\ninterface CastingScreenProps {\n    cast?: PlayerProfile[];\n}\n\ninterface CastingScreenState {\n    players: PlayerProfile[];\n    selectedPlayers: Set<number>;\n}\n\nlet id = 1;\n\nexport class CastingScreen extends React.Component<CastingScreenProps, CastingScreenState> {\n    private sub: Subscription | null = null;\n\n    constructor(props: CastingScreenProps) {\n        super(props);\n        if (props.cast) {\n            selectCastPlayer(null);\n            props.cast.forEach((player) => (player.castingScreenId = id++));\n        }\n        this.state = { players: props.cast || [], selectedPlayers: new Set<number>() };\n    }\n\n    public componentDidMount() {\n        this.sub = selectedCastPlayer$.subscribe((selectedPlayers) => {\n            this.setState({ selectedPlayers });\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    private deleteMethod(i: number, castingScreenId: number) {\n        return () => {\n            const newState = { ...this.state };\n            newState.players.splice(i, 1);\n            if (newState.selectedPlayers.has(castingScreenId)) {\n                selectCastPlayer(castingScreenId);\n            }\n            this.setState(newState);\n        };\n    }\n\n    private rename(i: number) {\n        return () => {\n            const newState = { ...this.state };\n            const newName: string | null = prompt(`Enter a new name for ${newState.players[i].name}`);\n            if (!newName) return;\n            newState.players[i].name = newName;\n            this.setState(newState);\n        };\n    }\n\n    private getFiles() {\n        const players = this.state.players;\n        if (!players) {\n            return;\n        }\n        const rows: JSX.Element[] = [];\n        let i = 0;\n        players.forEach((player) =>\n            rows.push(\n                <SetupPortrait\n                    name={player.name}\n                    imageUrl={player.imageURL}\n                    onDelete={this.deleteMethod(i, player.castingScreenId || -1)}\n                    onClick={() => {\n                        selectCastPlayer(player.castingScreenId || -1);\n                    }}\n                    onRename={this.rename(i)}\n                    selected={this.state.selectedPlayers.has(player.castingScreenId || -1)}\n                    key={(++i).toString()}\n                />\n            )\n        );\n        return <div className=\"columns is-gapless is-mobile is-multiline is-centered\">{rows}</div>;\n    }\n\n    private submit = () => {\n        updateCast(this.state.players);\n        pushToMainContentStream(<SeasonEditorPage />, Screens.Season);\n    };\n\n    private random = (_amount: number) => {\n        // get all the selected players first\n        let result: PlayerProfile[] = [];\n        let amount = _amount;\n\n        const allPlayers = this.state.players;\n        let unselectedPlayers: PlayerProfile[] = [];\n\n        allPlayers.forEach((player) => {\n            if (this.state.selectedPlayers.has(player.castingScreenId || -1)) {\n                result.push(player);\n                amount--;\n            } else {\n                unselectedPlayers.push(player);\n            }\n        });\n\n        if (amount > 0) {\n            unselectedPlayers = shuffle(unselectedPlayers);\n            unselectedPlayers = unselectedPlayers.slice(0, amount);\n        }\n        let players = amount > 0 ? result.concat(unselectedPlayers) : result;\n        players = shuffle(players);\n        this.setState({ players });\n    };\n\n    public render() {\n        return (\n            <FileDrop onDrop={this.handleDrop}>\n                <HasText className=\"level\">\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-danger\"\n                            onClick={() => {\n                                this.setState({ players: [] });\n                                selectCastPlayer(null);\n                            }}\n                        >\n                            Delete all\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-danger\"\n                            disabled={this.state.selectedPlayers.size === 0}\n                            onClick={() => {\n                                const players = this.state.players.filter(\n                                    (player) => !this.state.selectedPlayers.has(player.castingScreenId || -1)\n                                );\n                                this.setState({ players });\n                                selectCastPlayer(null);\n                            }}\n                        >\n                            Delete selected\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-warning\"\n                            onClick={() => selectCastPlayer(null)}\n                            disabled={this.state.selectedPlayers.size === 0}\n                        >\n                            Unselect {this.state.selectedPlayers.size || \"all\"}\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <RandomButton random={this.random} />\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-success\"\n                            disabled={this.state.players.length < 3}\n                            onClick={this.submit}\n                        >\n                            Next\n                        </button>\n                    </div>\n                </HasText>\n                <Input type=\"file\" multiple onChange={this.handleUpload} />\n                {this.state.players.length === 0 && (\n                    <Centered>\n                        ~ Drop images here ~\n                        <br />\n                        <br />\n                        <HelpLink\n                            href=\"https://github.com/spaulmark/bb-bots/blob/master/README.md#choose-a-cast-of-characters\"\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            Need help setting up a game?\n                        </HelpLink>\n                    </Centered>\n                )}\n                {this.getFiles()}\n            </FileDrop>\n        );\n    }\n\n    private handleUpload = (event: any) => {\n        this.handleFiles(event.target.files);\n    };\n\n    private handleDrop = (files: FileList | null) => {\n        if (!files) return;\n        this.handleFiles(files);\n    };\n\n    private handleFiles(files: FileList) {\n        const newState = { ...this.state };\n        for (let i = 0; i < files.length; i++) {\n            const file = files[i];\n            if (file.type.match(/image\\/*/)) {\n                newState.players.push({\n                    name: file.name.substr(0, file.name.lastIndexOf(\".\")) || file.name,\n                    imageURL: URL.createObjectURL(file),\n                    castingScreenId: id++,\n                });\n            }\n        }\n        this.setState(newState);\n    }\n}\n","import React from \"react\";\nimport ReactPaginate from \"react-paginate\";\nimport { HasText } from \"../layout/text\";\nimport { shuffle, ceil, debounce } from \"lodash\";\nimport { pushToMainContentStream, selectDeckSubject, selectedDecks$ } from \"../../subjects/subjects\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport _ from \"lodash\";\nimport styled from \"styled-components\";\nimport { Subscription } from \"rxjs\";\nimport { selectedColor } from \"../playerPortrait/houseguestPortraitController\";\nimport { PlayerProfile } from \"../../model\";\nimport { Screens } from \"../topbar/topBar\";\n\ninterface DeckScreenProps {}\n\ninterface DeckScreenState {\n    loading: boolean;\n    decks: string[];\n    i: number;\n    sortedDecks: string[];\n    debouncedSearchText: string;\n    isSorted: boolean;\n    searchText: string;\n    selectedDecks: Set<string>;\n}\n\nconst decksPerPage = 26;\nconst baseUrl = \"https://spaulmark.github.io/img/\";\n\nconst imageCache: { [id: string]: string } = {};\n\nconst DeckStyle = styled(HasText)`\n    display: flex;\n    cursor: pointer;\n    align-items: center;\n    :hover {\n        color: red;\n        background-color: #ffe1ea;\n    }\n`;\n\nconst Centered = styled.div`\n    display: flex;\n    justify-content: center;\n    align-items: center;\n`;\n\nconst DeckText = styled.p`\n    margin-left: 1rem;\n`;\n\nasync function randomImageFromFolder(folder: string) {\n    if (imageCache[folder]) return imageCache[folder];\n    const links = await (await fetch(`${baseUrl}${folder}/dir.json`)).json();\n    const image = _.sample(links[\"files\"]);\n    imageCache[folder] = `${baseUrl}${folder}/${image}`;\n    return `${baseUrl}${folder}/${image}`;\n}\n\nasync function submitCasts(casts: Set<string>) {\n    const playerProfiles: PlayerProfile[] = [];\n\n    for (const cast of casts) {\n        const links = await (await fetch(`${baseUrl}${cast}/dir.json`)).json();\n        const imageLinks = links[\"files\"].map((file: string) => {\n            return { name: file, url: `${baseUrl}${cast}/${file}` };\n        });\n        const folderProfiles = imageLinks.map((image: { name: string; url: string }) => {\n            return {\n                name: image.name.substr(0, image.name.lastIndexOf(\".\")) || image.name,\n                imageURL: image.url,\n            };\n        });\n        playerProfiles.push(...folderProfiles);\n    }\n\n    pushToMainContentStream(<CastingScreen cast={playerProfiles} />, Screens.Casting);\n}\n\nfunction Deck(props: { deck: string; selected: boolean }): JSX.Element {\n    const [img, setImage] = React.useState(\"\");\n    const [loading, setLoading] = React.useState(true);\n    const deck = props.deck;\n\n    if (loading)\n        randomImageFromFolder(deck).then((img) => {\n            setLoading(false);\n            setImage(img);\n        });\n    const style = props.selected ? { backgroundColor: selectedColor.toHex(), color: \"black\" } : {};\n    return (\n        <DeckStyle className=\"column is-6\" onClick={() => selectDeckSubject(props.deck)} style={style}>\n            <img src={img} style={{ width: 50, height: 50 }} />\n            <DeckText>{deck}</DeckText>\n        </DeckStyle>\n    );\n}\n\nfunction DeckList(props: { data: string[]; i: number; selected: Set<string> }): JSX.Element {\n    let decks: JSX.Element[] = [];\n    const i = props.i;\n    const data = props.data;\n    const min = i * decksPerPage;\n    for (let j = min; j < min + decksPerPage; j++) {\n        const deck = data[j];\n        if (!deck) continue;\n        decks.push(<Deck selected={props.selected.has(deck)} key={`${deck}__${i}__${j}`} deck={deck} />);\n    }\n    return (\n        <div key={\"__ul__\"} className={\"columns is-multiline\"}>\n            {decks}\n        </div>\n    );\n}\n\nexport class DeckScreen extends React.Component<DeckScreenProps, DeckScreenState> {\n    private subs: Subscription[] = [];\n\n    constructor(props: DeckScreenProps) {\n        super(props);\n        this.state = {\n            loading: true,\n            decks: [],\n            sortedDecks: [],\n            selectedDecks: new Set<string>(),\n            i: 0,\n            isSorted: false,\n            debouncedSearchText: \"\",\n            searchText: \"\",\n        };\n    }\n    async componentDidMount() {\n        selectDeckSubject(null);\n        this.subs.push(selectedDecks$.subscribe((selectedDecks) => this.setState({ selectedDecks })));\n        const data = await (await fetch(\"https://spaulmark.github.io/img/dir.json\")).json();\n        this.setState({\n            sortedDecks: data.decks,\n            decks: shuffle(data.decks),\n            selectedDecks: new Set<string>(),\n            loading: false,\n        });\n    }\n    componentWillUnmount() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    private handlePageClick = (page: { selected: number }) => {\n        this.setState({ i: page.selected });\n    };\n\n    private debounceSearch = debounce((nextValue: string) => {\n        this.setState({ debouncedSearchText: nextValue, i: 0 });\n    }, 250);\n\n    private handleSearch = (event: { target: { value: string } }) => {\n        this.setState({ searchText: event.target.value });\n        this.debounceSearch(event.target.value);\n    };\n\n    render() {\n        if (this.state.loading) return <div />;\n        const decks = (this.state.isSorted ? this.state.sortedDecks : this.state.decks).filter((deck) =>\n            deck.toLowerCase().match(this.state.debouncedSearchText.toLowerCase())\n        );\n        return (\n            <div>\n                <div className=\"level\">\n                    <div className=\"level-item\">\n                        <input\n                            style={{ minWidth: \"50%\" }}\n                            className=\"input\"\n                            type=\"text\"\n                            placeholder=\"Search...\"\n                            onChange={this.handleSearch}\n                            value={this.state.searchText}\n                        ></input>\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className={`button ${this.state.isSorted ? \"is-danger\" : \"is-primary\"}`}\n                            onClick={() => this.setState({ isSorted: !this.state.isSorted })}\n                        >\n                            A/Z\n                        </button>\n                    </div>\n\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-warning\"\n                            onClick={() => selectDeckSubject(null)}\n                            disabled={this.state.selectedDecks.size === 0}\n                        >\n                            Unselect All\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <HasText>{`${this.state.selectedDecks.size} casts selected`}</HasText>\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-success\"\n                            disabled={this.state.selectedDecks.size === 0}\n                            onClick={() => submitCasts(this.state.selectedDecks)}\n                        >\n                            Next\n                        </button>\n                    </div>\n                </div>\n                <DeckList\n                    key={\"comments\"}\n                    selected={this.state.selectedDecks}\n                    data={decks}\n                    i={this.state.i}\n                />\n                <Centered>\n                    <ReactPaginate\n                        key={\"__list__\"}\n                        previousLabel={\"previous\"}\n                        nextLabel={\"next\"}\n                        breakLabel={\"...\"}\n                        breakClassName={\"break-me\"}\n                        pageCount={ceil(decks.length / decksPerPage)}\n                        marginPagesDisplayed={2}\n                        pageRangeDisplayed={3}\n                        onPageChange={this.handlePageClick}\n                        containerClassName={\"pagination\"}\n                        activeClassName={\"active\"}\n                    />\n                </Centered>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport { getCast, pushToMainContentStream } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\nimport { Box } from \"../layout/box\";\nimport { DeckScreen } from \"../deckScreen/deckScreen\";\nimport { SeasonEditorPage } from \"../seasonEditor/seasonEditorPage\";\nimport { BehaviorSubject, Subscription } from \"rxjs\";\n\nexport enum Screens {\n    Deck = \"choosecast\",\n    Casting = \"editcast\",\n    Season = \"editseason\",\n    Other = \"other\",\n}\n\n// for topbar minty colors\nexport const activeScreen$ = new BehaviorSubject<Screens>(Screens.Other);\n\nexport const TopbarLink = styled.a`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.link};\n    cursor: pointer;\n`;\n\nexport const ActiveTopbarLink = styled.mark`\n    cursor: pointer;\n    font-weight: bold;\n`;\n\nexport function CastingScreenLink(): JSX.Element {\n    const LinkStyle = activeScreen$.value === Screens.Casting ? ActiveTopbarLink : TopbarLink;\n    return (\n        <LinkStyle\n            onClick={() => {\n                pushToMainContentStream(\n                    <CastingScreen cast={JSON.parse(JSON.stringify(getCast()))} />,\n                    Screens.Casting\n                );\n            }}\n        >\n            Edit / Upload Cast\n        </LinkStyle>\n    );\n}\n\nexport function EditSeasonLink(): JSX.Element {\n    const LinkStyle = activeScreen$.value === Screens.Season ? ActiveTopbarLink : TopbarLink;\n    return (\n        <LinkStyle\n            onClick={() => {\n                pushToMainContentStream(<SeasonEditorPage />, Screens.Season);\n            }}\n        >\n            Edit Season/Twists\n        </LinkStyle>\n    );\n}\n\nexport function ChooseCastLink(): JSX.Element {\n    const LinkStyle = activeScreen$.value === Screens.Deck ? ActiveTopbarLink : TopbarLink;\n    return (\n        <LinkStyle\n            onClick={() => {\n                pushToMainContentStream(<DeckScreen />, Screens.Deck);\n            }}\n        >\n            Choose Cast\n        </LinkStyle>\n    );\n}\n\nexport class Topbar extends React.Component<{ style?: any }, { tab: Screens }> {\n    private subs: Subscription[] = [];\n    constructor(props: Readonly<{ style?: any }>) {\n        super(props);\n        this.state = { tab: Screens.Other };\n    }\n    componentDidMount() {\n        this.subs.push(activeScreen$.subscribe((tab) => this.setState({ tab })));\n    }\n    componentWillUnmount() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    public render(): JSX.Element {\n        const style = { ...(this.props.style || {}) };\n        return (\n            <Box className=\"level is-mobile\" style={style}>\n                <div className=\"level-item\">\n                    <ChooseCastLink />\n                </div>\n                <div className=\"level-item\">\n                    <CastingScreenLink />\n                </div>\n                <div className=\"level-item\">\n                    <EditSeasonLink />\n                </div>\n            </Box>\n        );\n    }\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { HasText } from \"../layout/text\";\nimport { popularityMode } from \"../../model/portraitDisplayMode\";\nimport { displayMode$, pushToMainContentStream, switchSceneRelative } from \"../../subjects/subjects\";\nimport { selectedColor } from \"../playerPortrait/houseguestPortraitController\";\nimport { Screens, TopbarLink } from \"../topbar/topBar\";\nimport { SeasonEditorPage } from \"../seasonEditor/seasonEditorPage\";\nimport { Centered, CenteredBold } from \"../layout/centered\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport { DeckScreen } from \"../deckScreen/deckScreen\";\n\ninterface PregameScreenProps {\n    cast: PlayerProfile[];\n}\n\nexport class PregameScreen extends React.Component<PregameScreenProps, {}> {\n    public componentDidMount() {\n        displayMode$.next(popularityMode);\n    }\n\n    public render() {\n        const props = this.props;\n        return (\n            <HasText>\n                <h2\n                    style={{\n                        color: selectedColor.toHex(),\n                        textShadow: \"rgb(114, 46, 123) 2px 2px 0px\",\n                        textAlign: \"center\",\n                    }}\n                >\n                    Big Brother Bots\n                </h2>\n                <CenteredBold>Big Brother Bots is a simulator for the reality show Big Brother.</CenteredBold>\n                <Centered>\n                    <TopbarLink\n                        onClick={() => {\n                            pushToMainContentStream(<DeckScreen />, Screens.Deck);\n                        }}\n                    >\n                        Choose characters\n                    </TopbarLink>{\" \"}\n                    from 300+ collections, or{\" \"}\n                    <TopbarLink\n                        onClick={() => {\n                            pushToMainContentStream(<CastingScreen cast={[]} />, Screens.Casting);\n                        }}\n                    >\n                        upload your own\n                    </TopbarLink>\n                    , then{\" \"}\n                    <TopbarLink\n                        onClick={() => {\n                            pushToMainContentStream(<SeasonEditorPage />, Screens.Season);\n                        }}\n                    >\n                        add twists\n                    </TopbarLink>{\" \"}\n                    and watch as everyone votes each other out until one winner remains!{\" \"}\n                </Centered>\n                {props.cast.length === 0 ? \"\" : <MemoryWall houseguests={props.cast} />}\n                {props.cast.length === 0 ? (\n                    \"\"\n                ) : (\n                    <p>\n                        <b> {\"You can use the ⬅️ and ➡️ arrow keys to move forwards and backwards.\"}</b>\n                    </p>\n                )}\n                {props.cast.length === 0 ? (\n                    \"\"\n                ) : (\n                    <button className=\"button is-success\" onClick={() => switchSceneRelative(1)}>\n                        Start Game\n                    </button>\n                )}\n            </HasText>\n        );\n    }\n}\n","import prand from \"pure-rand\";\nimport { BehaviorSubject } from \"rxjs\";\nimport { hashcode } from \"./utilities\";\nimport { cast$ } from \"../subjects/subjects\";\n\nexport class BbRandomGenerator {\n    private rng: prand.RandomGenerator;\n\n    // returns a random number between 0 and 1.\n    public randomFloat(): number {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result / 2147483647.0;\n    }\n\n    public randomInt(a: number, b: number): number {\n        let result: number;\n        [result, this.rng] = prand.uniformIntDistribution(a, b, this.rng);\n        return result;\n    }\n\n    public flipCoin(): boolean {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result % 2 === 0;\n    }\n\n    public seed(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n\n    public constructor(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n}\n\nexport function rng() {\n    return rng$.value;\n}\n\nconst rng$ = new BehaviorSubject(new BbRandomGenerator(0));\n\nconst castSub = cast$.subscribe({\n    next: (cast) => {\n        let castNames = \"\";\n        cast.forEach((houseguest) => (castNames += houseguest.name));\n        rng$.next(new BbRandomGenerator(hashcode(castNames)));\n    },\n});\n","import { VoteType } from \"./voteType\";\n\nexport class EpisodeLog {\n    public nominationsPreVeto: string[] = [];\n    public vetoWinner?: string;\n    public winner?: number;\n    public runnerUp?: number;\n    public nominationsPostVeto: string[] = [];\n    public evicted: number[] = [];\n    public votes: { [id: string]: VoteType } = {};\n    public votesInMajority: number = -1;\n    public outOf: number = -1;\n    public soleVoter?: string;\n    public votingTo?: string;\n}\n","import { Houseguest, GameState, nonEvictedHouseguests, getById } from \"../model\";\n\nimport { classifyRelationship, RelationshipType } from \"./ai/classifyRelationship\";\n\nimport _ from \"lodash\";\nimport { Graph } from \"./generateCliques\";\n\nclass EdgeMap {\n    public data: { [id: number]: Set<number> } = {};\n    public add(key: number, value: number) {\n        if (!this.data[key]) {\n            this.data[key] = new Set<number>([value]);\n        } else {\n            this.data[key].add(value);\n        }\n    }\n}\n\nfunction generateEdge(\n    hero: Houseguest,\n    villain: Houseguest,\n    relationship: number\n): [number[] | null, number] {\n    const relationshipType = classifyRelationship(hero.popularity, villain.popularity, relationship);\n    if (relationshipType === RelationshipType.Friend) {\n        return [[hero.id, villain.id], 1];\n    }\n    // no edge for non-mutual friends\n    return [null, 0];\n}\n\nexport default function generateGraph(gameState: GameState): Graph {\n    // this algorithm assumes every relationship is mutual,\n    // and will need a face lift if we get non-mutual relationships.\n    const players = nonEvictedHouseguests(gameState);\n    const nodes: number[] = [];\n    const edges: EdgeMap = new EdgeMap();\n    players.forEach((player) => {\n        let friendCount = 0;\n        _.forEach(player.relationships, (relationship, stringId) => {\n            const villainId = parseInt(stringId);\n            const [edge, friends] = generateEdge(player, getById(gameState, villainId), relationship);\n            friendCount += friends;\n            if (villainId > player.id) {\n                if (edge) {\n                    edges.add(player.id, villainId);\n                    edges.add(villainId, player.id);\n                }\n            }\n        });\n        // nodes[player.id] = friendCount; // for pivot later on, thats why friendcount is there unused\n        nodes.push(player.id);\n    });\n    return { nodes, neighbors: (v: number) => edges.data[v] || new Set([]) };\n}\n","import { intersection } from \".\";\nimport { GameState, getById } from \"../model\";\nimport generateGraph from \"./generateGraph\";\nimport { difference } from \"./utilities\";\n\nlet cliques: number[][] = [];\nexport interface Graph {\n    nodes: number[];\n    neighbors: (v: number) => Set<number>;\n}\n\nexport function newCliquesLength(a: Cliques): number {\n    return a.core.length + (a.affiliates ? a.affiliates[0].length + a.affiliates[1].length : 0);\n}\n\nexport interface Cliques {\n    core: number[];\n    affiliates?: [number[], number[]];\n}\n\nexport function generateCliques(gameState: GameState): Cliques[] {\n    const g = generateGraph(gameState);\n    cliques = [];\n    bronKerbosch(new Set<number>([]), new Set(g.nodes), new Set<number>([]), g);\n    cliques.forEach((clique) => clique.map((id) => getById(gameState, id)));\n    cliques = cliques.sort((a, b) => b.length - a.length);\n    const result: Cliques[] = [];\n    // ids of clique i, clique j, & overlap size\n    const mergeCandidates: [number, number, Cliques][] = [];\n    // generate overlap numbers for each clique (n^2)\n    cliques.forEach((clq, i) => {\n        const cliqueI = new Set(clq);\n        for (let j = i + 1; j < cliques.length; j++) {\n            const cliqueJ = new Set(cliques[j]);\n            const core = intersection(cliqueI, cliqueJ);\n            const affiliatesI: Set<number> = difference(cliqueI, core);\n            const affiliatesJ: Set<number> = difference(cliqueJ, core);\n            if (core.size > 0) {\n                mergeCandidates.push([\n                    i,\n                    j,\n                    {\n                        core: Array.from(core),\n                        affiliates: [Array.from(affiliatesI), Array.from(affiliatesJ)],\n                    },\n                ]);\n            }\n        }\n    });\n    // cliques that already have been merged get blacklisted\n    const blacklist: Set<number> = new Set<number>();\n\n    // merge cliques with highest overlap numbers until only unnacceptable overlap remains\n    // for example maybe if the size of both left and right affiliates is greater than the core\n    mergeCandidates.sort(\n        (a: [number, number, Cliques], b: [number, number, Cliques]) => b[2].core.length - a[2].core.length\n    );\n\n    mergeCandidates.forEach((candidate: [number, number, Cliques]) => {\n        const i = candidate[0];\n        const j = candidate[1];\n        if (blacklist.has(i) || blacklist.has(j)) return;\n        blacklist.add(i);\n        blacklist.add(j);\n        result.push(candidate[2]);\n    });\n    // add non merged cliques\n    cliques.forEach((clique, i) => {\n        if (blacklist.has(i)) return;\n        result.push({ core: clique });\n    });\n\n    // then sort and return result\n    result.sort((a: Cliques, b: Cliques) => newCliquesLength(b) - newCliquesLength(a));\n\n    return result;\n}\n\nfunction bronKerbosch(r: Set<number>, p: Set<number>, x: Set<number>, g: Graph) {\n    if (p.size === 0 && x.size === 0) {\n        const values = Array.from(r.values());\n        cliques.push(values);\n        return;\n    }\n    Array.from(p.keys()).forEach((v) => {\n        const rPrime = new Set(r.values()).add(v);\n        const pPrime = new Set([...p].filter((node) => g.neighbors(v).has(node)));\n        const xPrime = new Set([...x].filter((node) => g.neighbors(v).has(node)));\n        bronKerbosch(rPrime, pPrime, xPrime, g);\n        p.delete(v);\n        x.add(v);\n    });\n}\n","import { GameState, MutableGameState, nonEvictedHouseguests } from \"../../model/gameState\";\nimport { Episode, Houseguest } from \"../../model\";\nimport { EpisodeType } from \"./episodes\";\nimport { angleBetween, rng, roundTwoDigits } from \"../../utils\";\nimport { EpisodeLog } from \"../../model/logging/episodelog\";\nimport { generateCliques } from \"../../utils/generateCliques\";\nimport _ from \"lodash\";\nimport { refreshHgStats } from \"./utilities/evictHouseguest\";\n\nexport function canDisplayCliques(newState: GameState): boolean {\n    return newState.remainingPlayers <= 30;\n}\n\nfunction firstImpressions(houseguests: Houseguest[]) {\n    const sin = Math.sin;\n    const cos = Math.cos;\n    houseguests.forEach((hg) => {\n        // generate random spherical co-ordinates on the unit sphere\n        const u = rng().randomFloat();\n        const v = Math.abs(rng().randomFloat());\n        const θ = 2 * Math.PI * u;\n        const φ = Math.acos(2 * v - 1);\n        // convert spherical co-ords to cartesian co-ords\n        hg.compatibility = [sin(θ) * cos(φ), sin(θ) * sin(φ), cos(θ)];\n    });\n    for (let i = 0; i < houseguests.length; i++) {\n        const iMap = houseguests[i].relationships;\n        for (let j = i + 1; j < houseguests.length; j++) {\n            // creates a bunch of mutual relationships based on points on a sphere\n            const jMap = houseguests[j].relationships;\n            const impression =\n                1 - (2 * angleBetween(houseguests[i].compatibility, houseguests[j].compatibility)) / Math.PI;\n            jMap[i] = impression;\n            iMap[j] = impression;\n        }\n    }\n}\n\nexport function nextEpisode(gameState: GameState, episodeType: EpisodeType): Episode {\n    let newState = new MutableGameState(gameState);\n    if (gameState.phase === 0) {\n        firstImpressions(newState.houseguests);\n    }\n    newState.phase++;\n    newState.resetLogIndex();\n    if (gameState.remainingPlayers > 2) {\n        newState.log[newState.phase] = [new EpisodeLog()];\n    }\n    refreshHgStats(newState, true);\n    nonEvictedHouseguests(newState).forEach((hg) => {\n        hg.previousPopularity = hg.popularity;\n    });\n    if (canDisplayCliques(newState)) newState.cliques = generateCliques(newState);\n    const finalState = new GameState(newState);\n    if (!episodeType.canPlayWith(finalState.remainingPlayers))\n        throw new Error(\n            `Episode type ${episodeType.name} not playable with ${finalState.remainingPlayers} players`\n        );\n    return episodeType.generate(finalState);\n}\n","import React from \"react\";\nimport { GameState } from \"../../model\";\nimport { weekStartTab$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { AllianceList, HelpLink } from \"./allianceList\";\n\ninterface WeekStartWrapperProps {\n    gameState: GameState;\n}\n\ninterface WeekStartWrapperState {\n    tab: number;\n}\n\nexport class WeekStartWrapper extends React.Component<WeekStartWrapperProps, WeekStartWrapperState> {\n    private subs: Subscription[] = [];\n    constructor(props: Readonly<WeekStartWrapperProps>) {\n        super(props);\n        this.state = { tab: weekStartTab$.value };\n    }\n    componentDidMount() {\n        this.subs.push(weekStartTab$.subscribe((tab) => this.setState({ tab })));\n    }\n    componentWillUnmount() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    render() {\n        const helpText1 =\n            this.props.gameState.phase === 1 ? (\n                <div key=\"helptext1\" style={{ marginTop: 10 }}>\n                    <b>Try clicking on houseguests to view their relationships.</b> <br />\n                </div>\n            ) : null;\n        const helptext2 =\n            this.props.gameState.phase === 2 ? (\n                <HelpLink\n                    key=\"helptext2\"\n                    href=\"https://github.com/spaulmark/bb-bots/blob/master/README.md#understanding-relationships\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                >\n                    What do the 🛇 ✘ ♥ 💔 🎯 symbols mean?\n                </HelpLink>\n            ) : null;\n        if (this.state.tab === 0) {\n            return [\n                <MemoryWall key=\"memorywall\" houseguests={this.props.gameState.houseguests} />,\n                helpText1,\n                helptext2,\n            ];\n        }\n        return <AllianceList gameState={this.props.gameState} />;\n    }\n}\n","import { GameState, getJurors, nonEvictedHouseguests, MutableGameState, Houseguest } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { castJuryVote } from \"../../../utils/ai/aiApi\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport React from \"react\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport { NormalVote } from \"../../../model/logging/voteType\";\n\nexport function juryVoteScene(initialGameState: GameState): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const jurors: Houseguest[] = getJurors(newGameState);\n    const finalists = nonEvictedHouseguests(newGameState);\n    const votes: Array<ProfileHouseguest[]> = [[], []];\n    jurors.forEach((juror) => {\n        const decision = castJuryVote(juror, finalists);\n        const result: ProfileHouseguest = { ...juror };\n        votes[decision].push(result);\n        newGameState.currentLog.votes[juror.id] = new NormalVote(finalists[decision].id);\n    });\n    const votesFor0 = votes[0].length;\n    const votesFor1 = votes[1].length;\n    const isUnanimous = votesFor0 === 0 || votesFor1 === 0;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${votesFor0} to ${votesFor1}...`;\n\n    const winner = votesFor0 > votesFor1 ? finalists[0] : finalists[1];\n    const runnerUp = votesFor0 < votesFor1 ? finalists[0] : finalists[1];\n    newGameState.currentLog.winner = winner.id;\n    newGameState.currentLog.runnerUp = runnerUp.id;\n    const scene = new Scene({\n        title: \"Jury Votes\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[0]} centered={true} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[1]} centered={true} />\n                    </DividerBox>\n                </div>\n                <Portraits houseguests={finalists} centered={true} />\n                <CenteredBold>{`Congratulations, ${winner.name}... you are the winner of Big Brother!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [newGameState, scene];\n}\n","import React from \"react\";\nimport { EpisodeType, Episode, InitEpisode } from \"./episodes\";\nimport { Scene } from \"./scenes/scene\";\nimport { GameState } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { finalHohCompScene } from \"./scenes/finalHohCompScene\";\nimport { finalEvictionScene } from \"./scenes/finalEvictionScene\";\nimport { juryVoteScene } from \"./scenes/juryVoteScene\";\nimport { HasText } from \"../layout/text\";\n\nexport const BigBrotherFinale: EpisodeType = {\n    canPlayWith: (n: number) => n === 3,\n    eliminates: 2,\n    arrowsEnabled: true,\n    emoji: \"\",\n    hasViewsbar: true,\n    name: \"Big Brother Finale\",\n    description: \"\",\n    generate: generateBbFinale,\n};\n\nexport function generateBbFinale(initialGameState: GameState): Episode {\n    const title = \"Finale\";\n    const content = (\n        <HasText>\n            <MemoryWall houseguests={initialGameState.houseguests} /> <br />\n            <NextEpisodeButton />\n        </HasText>\n    );\n    let currentGameState;\n    let hohCompScene;\n    let finalHoH;\n    const scenes = [];\n    [currentGameState, hohCompScene, finalHoH] = finalHohCompScene(initialGameState);\n    scenes.push(hohCompScene);\n    let finalEviction;\n    [currentGameState, finalEviction] = finalEvictionScene(currentGameState, finalHoH);\n    scenes.push(finalEviction);\n    const [gameState, juryScene] = juryVoteScene(currentGameState);\n    scenes.push(juryScene);\n    return new Episode({ gameState, content, title, scenes, type: BigBrotherFinale });\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById,\n} from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { Portraits, Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\n\nexport function finalHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n    const final3 = nonEvictedHouseguests(initialGameState);\n    const enduranceWinner = randomPlayer(final3);\n    const enduranceLosers = final3.filter((hg) => hg.id !== enduranceWinner.id);\n    const skillWinner = randomPlayer(final3, [enduranceWinner]);\n    const finalHoH = getById(newGameState, randomPlayer([enduranceWinner, skillWinner]).id);\n    finalHoH.hohWins++;\n    const scene: Scene = new Scene({\n        title: \"Final HoH Competition\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>The final 3 houseguests compete in the endurance competition.</Centered>\n                <Portraits houseguests={final3} centered={true} />\n                <Portrait houseguest={enduranceWinner} centered={true} />\n                <CenteredBold>{`${enduranceWinner.name} has won the endurance competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceLosers[0].name} and ${enduranceLosers[1].name} compete in the skill competition.`}</Centered>\n                <Portraits houseguests={enduranceLosers} centered={true} />\n                <Portrait houseguest={skillWinner} centered={true} />\n                <CenteredBold>{`${skillWinner.name} has won the skill competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceWinner.name} and ${skillWinner.name} compete in the quiz competition.`}</Centered>\n                <Portraits houseguests={[enduranceWinner, skillWinner]} centered={true} />\n                <Portrait houseguest={finalHoH} centered={true} />\n                <CenteredBold>{`Congratulations ${finalHoH.name}, you are the final Head of Household!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, finalHoH];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { HoHVote, NomineeVote } from \"../../../model/logging/voteType\";\nimport { evictHouseguest } from \"../utilities/evictHouseguest\";\n\nexport function finalEvictionScene(initialGameState: GameState, HoH: Houseguest): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const nominees = nonEvictedHouseguests(newGameState).filter((hg) => hg.id !== HoH.id);\n    newGameState.currentLog.nominationsPostVeto = nominees.map((hg) => hg.name);\n    const { decision: vote, reason } = castEvictionVote(HoH, nominees, newGameState);\n    const evictee = nominees[vote];\n    const survivor = nominees[vote == 1 ? 0 : 1];\n    newGameState.currentLog.soleVoter = HoH.name;\n    newGameState.currentLog.votes[survivor.id] = new NomineeVote(false);\n    newGameState.currentLog.votes[HoH.id] = new HoHVote(evictee.id);\n    newGameState.currentLog.votesInMajority = 1;\n    newGameState.currentLog.outOf = 1;\n    const hoh: ProfileHouseguest = { ...HoH };\n    hoh.tooltip = reason;\n    evictHouseguest(newGameState, evictee.id);\n    const scene: Scene = new Scene({\n        title: \"Final Eviction\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    {`As the final HoH of the season, ${HoH.name}, you may now cast the sole vote to evict.`}\n                </Centered>\n                <Portrait houseguest={hoh} centered={true} />\n                <CenteredBold>{`I vote to evict ${evictee.name}.`}</CenteredBold>\n                <Portraits houseguests={nominees} centered={true} />\n                <Centered>\n                    It's official... {evictee.name}, you will be the final person leaving the Big Brother\n                    House.\n                </Centered>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene];\n}\n","import { Episode, EpisodeType } from \"./episodes\";\nimport { Scene } from \"./scenes/scene\";\nimport { GameState } from \"../../model\";\nimport { generateVotingTable } from \"./scenes/votingTable\";\nimport { evictHouseguest } from \"./utilities/evictHouseguest\";\n\nexport const GameOver: EpisodeType = {\n    canPlayWith: (_: number) => true,\n    eliminates: 1,\n    arrowsEnabled: false,\n    hasViewsbar: false,\n    description: \"\",\n    emoji: \"\",\n    name: \"Game Over\",\n    generate: generateGameOver,\n};\n\nexport function generateGameOver(gameState: GameState): Episode {\n    const title = \"Game Over\";\n    const scenes: Scene[] = [];\n    const content = generateVotingTable(gameState);\n    gameState.houseguests.forEach((hg) => {\n        evictHouseguest(gameState, hg.id);\n    });\n    return new Episode({ gameState, content, title, scenes, type: GameOver });\n}\n","import { Subscription } from \"rxjs\";\nimport { Sidebar } from \"./sidebar\";\nimport { EpisodeLibrary, Season } from \"../../model/season\";\nimport { Episode, nonEvictedHouseguests, getById } from \"../../model\";\nimport { Scene } from \"../episode/scenes/scene\";\nimport {\n    mainContentStream$,\n    episodes$,\n    switchEpisode$,\n    newEpisode,\n    switchSceneRelative,\n    getSelectedPlayer,\n    selectedPlayer$,\n    displayMode$,\n    season$,\n    pushToMainContentStream,\n} from \"../../subjects/subjects\";\nimport { popularityMode } from \"../../model/portraitDisplayMode\";\nimport { activeScreen$, Screens } from \"../topbar/topBar\";\n\ninterface IndexedScene {\n    scene: Scene;\n    index: number;\n}\n\nconst LEFT = 37;\nconst RIGHT = 39;\n\nexport class SidebarController {\n    private view: Sidebar;\n    private subscriptions: Subscription[] = [];\n    private season: Season = new Season();\n    private scenes: IndexedScene[] = [];\n    private selectedEpisode: number = 0;\n\n    public constructor(view: Sidebar) {\n        this.view = view;\n        this.subscriptions.push(\n            activeScreen$.subscribe((screen) => {\n                this.view.setState({ selectionsActive: screen === Screens.Other });\n            })\n        );\n        this.subscriptions.push(\n            episodes$.subscribe({\n                next: (episode) => this.onNewEpisode(episode),\n            })\n        );\n        this.subscriptions.push(\n            switchEpisode$.subscribe({\n                next: (value: number) => {\n                    this.switchSceneRelative(value);\n                },\n            })\n        );\n        this.subscriptions.push(\n            season$.subscribe({\n                next: (library: EpisodeLibrary) => {\n                    this.season = new Season(library);\n                    this.selectedEpisode = 0;\n                    displayMode$.next(popularityMode);\n                },\n            })\n        );\n    }\n\n    public getSelectedEpisode() {\n        return this.selectedEpisode;\n    }\n\n    public async switchToScene(id: number) {\n        pushToMainContentStream(this.scenes[id].scene.render, Screens.Other);\n        this.selectedEpisode = this.scenes[id].index;\n        await this.view.setState({ selectedScene: id });\n        if (getSelectedPlayer() !== null) {\n            selectedPlayer$.next(\n                getById(this.scenes[this.view.state.selectedScene].scene.gameState, getSelectedPlayer()!.id)\n            );\n        }\n    }\n\n    private switchSceneRelative = (delta: number) => {\n        const selectedScene = this.view.state.selectedScene;\n        const renderedScenes = this.scenes.length;\n        const targetScene = selectedScene + delta;\n        if (targetScene < 0) {\n            return;\n        }\n        const lastEpisode = this.view.state.episodes[this.view.state.episodes.length - 1];\n        if (targetScene < renderedScenes) {\n            // Go back to an earlier scene\n            this.switchToScene(targetScene);\n        } else if (targetScene === renderedScenes) {\n            // Generate a new scene, then jump to it\n            const currentGameState = lastEpisode.gameState;\n            const newPlayerCount = nonEvictedHouseguests(lastEpisode.gameState).length;\n            if (newPlayerCount > 0) {\n                newEpisode(this.season.renderEpisode(currentGameState));\n                this.switchSceneRelative(1);\n            }\n        }\n    };\n\n    get handleKeyDown(): (e: any) => void {\n        return this._handleKeyDown.bind(this);\n    }\n\n    private _handleKeyDown(event: any) {\n        const state = this.view.state;\n        if (\n            state.episodes[this.selectedEpisode] === undefined ||\n            !state.episodes[this.selectedEpisode].type.arrowsEnabled ||\n            activeScreen$.value !== Screens.Other\n        ) {\n            return;\n        }\n        if (event.keyCode === LEFT) {\n            switchSceneRelative(-1);\n        } else if (event.keyCode === RIGHT) {\n            switchSceneRelative(1);\n        }\n    }\n\n    private onNewEpisode(episode: Episode | null) {\n        if (!episode) {\n            this.view.setState({ episodes: [], selectedScene: 0 });\n            this.scenes = [];\n        } else {\n            const newState = { ...this.view.state };\n            // starts at -1: prevent OBOE\n            const latestIndex = this.scenes.length === 0 ? -1 : this.scenes[this.scenes.length - 1].index;\n            const index = latestIndex + 1;\n            this.scenes.push({ scene: episode, index });\n            episode.scenes.forEach((scene) => this.scenes.push({ scene, index }));\n            newState.episodes.push(episode);\n            this.view.setState(newState);\n        }\n    }\n\n    public destroy() {\n        this.subscriptions.forEach((sub) => sub.unsubscribe());\n    }\n}\n","import React from \"react\";\nimport { SidebarController } from \"./sidebarController\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { defaultJurySize, Episode, GameState, PlayerProfile } from \"../../model\";\nimport { Scene } from \"../episode/scenes/scene\";\nimport { cast$, newEpisode, pushToMainContentStream } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\nimport { HasText } from \"../layout/text\";\nimport { shuffle } from \"lodash\";\nimport { activeScreen$, Screens } from \"../topbar/topBar\";\ninterface SidebarState {\n    episodes: Episode[];\n    selectedScene: number;\n    selectionsActive: boolean;\n}\n\nlet firstLoad = true;\n\nexport class Sidebar extends React.Component<{}, SidebarState> {\n    private controller: SidebarController;\n    public constructor(props: {}) {\n        super(props);\n        this.controller = new SidebarController(this);\n        this.state = { episodes: [], selectedScene: 0, selectionsActive: true };\n    }\n    public async componentDidMount() {\n        document.addEventListener(\"keydown\", this.controller.handleKeyDown);\n        if (!firstLoad) {\n            firstLoad = false;\n            return;\n        }\n        let data = await (\n            await fetch(`https://raw.githubusercontent.com/spaulmark/img/master/bb.json`)\n        ).json();\n        const allBBs: PlayerProfile[] = [];\n        data = shuffle(data).slice(0, 16);\n        for (const player of data) {\n            let name = player.substr(0, player.lastIndexOf(\".\")) || player;\n            name = name.substr(name.indexOf(\"/\") + 1) || name;\n            allBBs.push({\n                name,\n                imageURL: `https://spaulmark.github.io/img/Big Brother ${player}`,\n            });\n        }\n\n        const episode: Episode = new PregameEpisode(\n            new GameState({ players: allBBs, jury: defaultJurySize(allBBs.length) })\n        );\n        newEpisode(episode);\n        cast$.next(allBBs);\n        if (activeScreen$.value === Screens.Other) {\n            pushToMainContentStream(episode.render, Screens.Other);\n        }\n    }\n\n    public componentWillUnmount() {\n        this.controller.destroy();\n    }\n\n    public render() {\n        return (\n            <Box style={{ minWidth: 180 }}>\n                <HasText>{this.getEpisodes()}</HasText>\n            </Box>\n        );\n    }\n\n    private getHighlight(title: string, key: number) {\n        if (key === this.state.selectedScene && this.state.selectionsActive) {\n            return <mark>{title}</mark>;\n        }\n        return title;\n    }\n\n    private getEpisodes() {\n        const result: JSX.Element[] = [];\n        // Weird OBOE to make keys start at 0\n        let episodeKey = -1;\n        let breakKey = 0;\n        this.state.episodes.forEach((episode: Episode) => {\n            const id = ++episodeKey;\n            result.push(\n                <b\n                    key={id}\n                    onClick={() => {\n                        this.controller.switchToScene(id);\n                    }}\n                >\n                    {this.getHighlight(episode.title, id)}\n                </b>\n            );\n            result.push(<br key={--breakKey} />);\n            episode.scenes.forEach((scene: Scene) => {\n                const id = ++episodeKey;\n                if (this.controller.getSelectedEpisode() === episode.gameState.phase) {\n                    result.push(\n                        <a key={id} onClick={() => this.controller.switchToScene(id)}>\n                            {this.getHighlight(scene.title, id)}\n                        </a>\n                    );\n                    result.push(<br key={--breakKey} />);\n                }\n            });\n        });\n        return result;\n    }\n}\n","import styled from \"styled-components\";\nimport React from \"react\";\nimport { mainContentStream$ } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\n\nconst MainContentAreaWrapper = styled(Box)`\n    overflow-x: auto;\n`;\n\nexport class MainContentArea extends React.Component<{}, { content: any }> {\n    // a simple class that displays whatever it gets fed through the main content stream.\n\n    private contentStream: any;\n\n    public constructor(props: any) {\n        super(props);\n        this.state = { content: null };\n    }\n\n    public componentDidMount() {\n        this.contentStream = mainContentStream$.subscribe((content) => {\n            this.setState({ content });\n        });\n    }\n\n    public componentDidUpdate(prevProps: never, prevState: any) {\n        if (prevState.content !== this.state.content) {\n            window.scrollTo(0, 0);\n        }\n    }\n\n    public componentWillUnmount() {\n        this.contentStream.unsubscribe();\n    }\n\n    public render() {\n        return <MainContentAreaWrapper>{this.state.content}</MainContentAreaWrapper>;\n    }\n}\n","import \"./bulma.scss\";\nimport React from \"react\";\nimport { Sidebar } from \"../sidebar/sidebar\";\nimport { Topbar } from \"../topbar/topBar\";\nimport { MainContentArea } from \"./mainContentArea\";\nimport { MainPageController } from \"./mainPageController\";\n\ninterface MainPageProps {\n    controller: MainPageController;\n}\n\ninterface MainPageState {\n    fullscreen: boolean;\n}\n\nexport class MainPage extends React.Component<MainPageProps, MainPageState> {\n    public constructor(props: MainPageProps) {\n        super(props);\n        this.state = { fullscreen: false };\n        props.controller.inject(this);\n    }\n    public componentDidMount() {\n        this.props.controller.subscribe();\n    }\n    public componentWillUnmount() {\n        this.props.controller.unsubscribe();\n    }\n\n    public render() {\n        const fullscreen = this.state.fullscreen;\n        const hideOnFullscreen = { display: fullscreen ? \"none\" : \"\" };\n        const wrapperStyle = fullscreen\n            ? { margin: \"auto\" }\n            : { margin: \"auto\", maxWidth: 1480, overflow: \"hidden\" };\n        return (\n            <div style={wrapperStyle}>\n                <Topbar style={hideOnFullscreen} />\n                <div className=\"columns\">\n                    <div className=\"column is-narrow\" style={hideOnFullscreen}>\n                        <Sidebar />\n                    </div>\n\n                    <div className=\"column\" style={{ overflowX: \"hidden\" }}>\n                        <MainContentArea />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","import { MainPage } from \"./mainPage\";\nimport { Subscription } from \"rxjs\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\n\nexport class MainPageController {\n    private view: MainPage = new MainPage({ controller: this });\n    private subscriptions: Subscription[] = [];\n    public inject(page: MainPage) {\n        this.view = page;\n    }\n\n    public subscribe(): void {\n        this.unsubscribe();\n        this.subscriptions.push(\n            isFullscreen$.subscribe((fullscreen: boolean) => {\n                this.view.setState({ fullscreen });\n            })\n        );\n    }\n\n    public unsubscribe(): void {\n        this.subscriptions.forEach(sub => sub.unsubscribe());\n    }\n}\n","export interface ColorTheme {\n    name: string;\n    bg: string;\n    text: string;\n    toggleBorder: string;\n    bodyArea: string;\n    link: string;\n    mark: string;\n    overlay: string;\n    evictedCell: string;\n    grayCell: string;\n    winnerCell: string;\n    lightGrayCell: string;\n    runnerUpCell: string;\n    saveCell: string;\n    nomineeCell: string;\n    hohCell: string;\n    portraitBorder: string;\n    tableCellBorder: string;\n}\n\n// export const lightTheme: ColorTheme = {\n//     name: \"light\",\n//     bg: \"#fff\",\n//     text: \"#363537\",\n//     toggleBorder: \"#FFF\",\n//     bodyArea: \"#fff\",\n//     link: \"blue\",\n//     mark: \"yellow\",\n//     overlay: \"fff\",\n//     evictedCell: \"#fa8072\",\n//     grayCell: \"#eaecf0\",\n//     lightGrayCell: \"#f8f9fa\",\n//     winnerCell: \"#73fb76\",\n//     runnerUpCell: \"#d1e8ef\",\n//     nomineeCell: \"#959ffd\",\n//     hohCell: \"#CCFFCC\",\n//     portraitBorder: \"gray\",\n//     tableCellBorder: \"#a2a9b1\",\n// };\n\nexport const darkTheme: ColorTheme = {\n    name: \"dark\",\n    bg: \"#121212\",\n    saveCell: \"#334d5e\",\n    text: \"#FAFAFA\",\n    bodyArea: \"#363537\",\n    toggleBorder: \"#6B8096\",\n    link: \"lightblue\",\n    mark: \"#7e006d\",\n    overlay: \"#444346\",\n    evictedCell: \"#9d4c43\",\n    grayCell: \"#5e5e5e\",\n    lightGrayCell: \"#404040\",\n    runnerUpCell: \"#9fbec882\",\n    nomineeCell: \"#6c75d0\",\n    winnerCell: \"#00ac04\",\n    hohCell: \"#3f783f\",\n    portraitBorder: \"#484848\",\n    tableCellBorder: \"#53575b\",\n};\n","import { createGlobalStyle } from \"styled-components\";\nimport { ColorTheme } from \"./theme\";\n\nexport const GlobalStyles = createGlobalStyle`\n  *,\n  *::after,\n  *::before {\n    box-sizing: border-box;\n  }\n\n  body {\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bg};\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n       transition: all 0.25s linear;\n  }`;\n","import React from \"react\";\nimport { MainPage } from \"./components/mainPage/mainPage\";\nimport { MainPageController } from \"./components/mainPage/mainPageController\";\nimport { ThemeProvider } from \"styled-components\";\nimport { ColorTheme, darkTheme } from \"./theme/theme\";\nimport { GlobalStyles } from \"./theme/globalTheme\";\nimport { theme$ } from \"./subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nclass App extends React.Component<{}, { theme: ColorTheme }> {\n    private sub: Subscription | null = null;\n    public constructor(props: any) {\n        super(props);\n        this.state = {\n            theme: darkTheme,\n        };\n    }\n\n    public componentDidMount() {\n        this.sub = theme$.subscribe((theme) => {\n            this.setState({ theme });\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    render() {\n        return (\n            <ThemeProvider theme={this.state.theme}>\n                <>\n                    <GlobalStyles />\n                    <MainPage controller={new MainPageController()} />\n                </>\n            </ThemeProvider>\n        );\n    }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}