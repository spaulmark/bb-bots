{"version":3,"sources":["model/playerProfile.ts","model/powerRanking.ts","model/houseguest.ts","utils/utilities.ts","utils/relationshipMap.ts","components/playerPortrait/selectedPortrait.ts","model/color.ts","components/playerPortrait/houseguestPortraitController.ts","components/playerPortrait/houseguestPortrait.tsx","components/playerPortrait/houseguestToPortrait.tsx","components/tooltip/tooltip.tsx","components/playerPortrait/portraits.tsx","components/memoryWall/memoryWall.tsx","components/nextEpisodeButton/nextEpisodeButton.tsx","components/playerPortrait/setupPortrait.tsx","utils/ai/classifyRelationship.ts","components/castingScreen/importLinks.tsx","components/playerPortrait/subtitle.tsx","model/portraitDisplayMode.ts","components/viewsBar/viewBarTag.tsx","components/viewsBar/viewBar.tsx","components/episode/episodes.tsx","components/episode/pregameEpisode.tsx","components/castingScreen/randomXButton.tsx","components/layout/text.ts","components/layout/centered.tsx","components/castingScreen/castingScreen.tsx","subjects/subjects.tsx","theme/theme.ts","components/topbar/themeSwitch.tsx","components/layout/box.tsx","components/deckScreen/deckScreen.tsx","components/topbar/topBar.tsx","components/pregameScreen/pregameScreen.tsx","utils/BbRandomGenerator.ts","model/gameState.ts","model/season.ts","components/episode/scene.tsx","utils/ai/aiUtils.ts","utils/ai/aiApi.ts","components/mainPage/fullscreenButton.tsx","components/episode/scenes/votingTable.tsx","model/logging/voteType.tsx","components/episode/scenes/juryVoteScene.tsx","components/episode/bigBrotherFinale.tsx","components/episode/scenes/finalHohCompScene.tsx","components/episode/scenes/finalEvictionScene.tsx","components/episode/gameOver.tsx","model/logging/episodelog.ts","utils/generateGraph.ts","utils/graphTest.ts","components/episode/episodeFactory.ts","components/episode/bigBrotherEpisode.tsx","components/episode/scenes/hohCompScene.tsx","components/episode/scenes/nomCeremonyScene.tsx","components/episode/scenes/vetoCompScene.tsx","components/episode/scenes/vetoCeremonyScene.tsx","components/episode/scenes/evictionScene.tsx","components/episode/allianceList.tsx","components/episode/bigBrotherWeekstartWrapper.tsx","components/sidebar/sidebarController.ts","components/sidebar/sidebar.tsx","components/mainPage/mainContentArea.tsx","components/mainPage/mainPage.tsx","components/mainPage/mainPageController.ts","theme/globalTheme.ts","App.tsx","serviceWorker.ts","index.tsx"],"names":["PlayerProfile","init","Object","classCallCheck","this","name","imageURL","assign","PowerRanking","beats","outOf","Error","createClass","key","get","Houseguest","_PlayerProfile","_this","possibleConstructorReturn","getPrototypeOf","call","isEvicted","isJury","id","nominations","hohWins","povWins","popularity","deltaPopularity","relationships","powerRanking","superiors","Set","getFriendEnemyCount","friends","enemies","assertThisInitialized","inherits","value","villain","roundTwoDigits","number","Math","round","newRelationshipMap","size","exclude","result","i","selectPlayer","player","getSelectedPlayer","selectedPlayer$","next","componentToHex","c","hex","toString","length","Rgb","r","g","b","concat","interpolateColor","min","max","percent","toHex","selectedColor","HouseguestPortraitController","view","subs","refreshData","data","props","setState","comparePowerRankings","defaultState","selectedPlayer","undefined","state","displayMode","backgroundColor","_this2","push","subscribe","displayMode$","forEach","sub","unsubscribe","has","Subtitle","styled","small","_templateObject","MemoryWallPortrait","div","_templateObject2","_ref","theme","portraitBorder","Evicted","_templateObject3","Jury","_templateObject4","Normal","img","_templateObject5","Grayscale","_templateObject6","Sepia","_templateObject7","HouseguestPortrait","_React$Component","controller","isNullOrUndefined","subtitle","Img","imageClass","getImageClass","generateSubtitle","detailed","Portrait","react_default","a","createElement","onClick","style","src","height","width","React","Component","houseguestToPortrait","houseguest","houseguestPortrait_HouseguestPortrait","Text","p","tooltip_templateObject","Tooltip","visible","Popover_default","position","isOpen","content","text","onMouseEnter","onMouseLeave","children","PortraitWrapper","className","centered","tooltip","tooltip_Tooltip","Portraits","rows","houseguests","memoryWallPortrait","MemoryWall","margin","maxWidth","NextEpisodeButton","switchSceneRelative","RelationshipType","EditPortrait","setupPortrait_templateObject","Noselect","input","setupPortrait_templateObject2","setupPortrait_templateObject3","XButton","setupPortrait_templateObject4","SetupPortrait","textAlign","onDoubleClick","onDelete","imageUrl","ImportLinks","lines","split","profiles","line","temp","pop","replace","substr","indexOf","onSubmit","onChange","event","target","RelationshipTypeToSymbol","FRIEND","ENEMY","PAWN","QUEEN","classifyRelationship","heroPopularity","villainPopularity","relationship","benefitsHero","benefitsVillain","Friend","Pawn","Queen","Enemy","addPopularityLine","hero","popularitySubtitle","deltaPop","statePopularity","getDeltaPopularity","addCompsLine","compWins","lineHeight","popularityMinColor","popularityMaxColor","popularityMode","minColor","maxColor","extremePopularity","x","xSquared","extremeValues","_addFriendshipCountTi","titles","friendOrEnemyTitle","map","txt","count","Relationship","friendEnemyCountTitle","addFriendshipCountTitles","arguments","powerMaxColor","powerMinColor","powerMode","toFloat","_","ViewBarTag","selected","mode","_this3","disabled","background","toRgba","cursor","ViewsBar","inJury","gameState","marginBottom","viewBarTag_ViewBarTag","Episode","scenes","title","initialGameState","type","arrowsEnabled","initialGamestate","viewsBar","hasViewsbar","viewBar_ViewsBar","PregameEpisodeType","eliminates","canPlayWith","n","PregameEpisode","_Episode","PregameScreen","cast","RandomButton","_useState","useState","_useState2","slicedToArray","setNumber","random","parseInt","NumericInput","marginLeft","test","HasText","text_templateObject","Input","text_templateObject2","_ref2","NoMargin","centered_templateObject","Center","centered_templateObject2","Centered","noMargin","CenteredBold","CenteredItallic","CastingScreen","appendProfiles","newState","objectSpread","profile","players","submit","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","newCast","cast$","mainContentStream$","newEpisode","GameState","stop","amount","shuffle","slice","handleUpload","handleFiles","files","handleDrop","newName","splice","_this4","setupPortrait_SetupPortrait","deleteMethod","handleChange","_this5","FileDrop","onDrop","importLinks_ImportLinks","text_Input","multiple","getFiles","file","match","lastIndexOf","URL","createObjectURL","lightTheme","bg","toggleBorder","gradient","bodyArea","link","overlay","evictedCell","grayCell","lightGrayCell","winnerCell","runnerUpCell","nomineeCell","hohCell","tableCellBorder","darkTheme","ThemeSwitcher","window","matchMedia","matches","setTheme","theme$","ShadowBox","box_templateObject","StyledBox","box_templateObject2","_ref3","DividerBox","Box","decksPerPage","baseUrl","imageCache","DeckStyle","deckScreen_templateObject","deckScreen_templateObject2","DeckText","deckScreen_templateObject3","_callee2","folder","links","image","_context2","abrupt","fetch","sent","json","sample","_callee3","imageLinks","playerProfiles","_context3","url","castingScreen_CastingScreen","Deck","_React$useState","_React$useState2","setImage","_React$useState3","_React$useState4","loading","setLoading","deck","randomImageFromFolder","then","selectCast","DeckList","commentNodes","j","display","DeckScreen","handlePageClick","page","decks","_componentDidMount","apply","deckScreen_Centered","dist_default","previousLabel","nextLabel","breakLabel","breakClassName","pageCount","ceil","marginPagesDisplayed","pageRangeDisplayed","onPageChange","containerClassName","activeClassName","TopbarLink","topBar_templateObject","AdvancedEditLink","ChooseCastLink","deckScreen_DeckScreen","Topbar","BehaviorSubject","episodes$","switchEpisode$","Subject","episode","weekStartTab$","isFullscreen$","BbRandomGenerator","seed","rng","prand","xorshift128plus","_this$rng$next","_this$rng$next2","_prand$uniformIntDist","uniformIntDistribution","_prand$uniformIntDist2","_this$rng$next3","_this$rng$next4","rng$","castNames","string","hash","charCodeAt","hashcode","getById","houseguestCache","inclusions","exclusions","excludedIds","hg","filter","includes","randomPlayer","options","randomInt","nonEvictedHouseguests","getJurors","remainingPlayers","finalJurySize","phase","previousHOH","log","cliques","Array","MutableGameState","copy","cloneDeep","Scene","render","favouriteIndex","callback","highestIndex","highestScore","Infinity","currentScore","lowestScore","lowestIndex","doesHeroWinTheFinale","hgs","jury","heroVotes","villainVotes","juror","heroShouldTargetSuperiors","totalPlayers","castEvictionVote","nominees","nom0","nom1","zeroIsInferior","oneIsInferior","cutthroatVote","nonVote","decision","reason","nonTarget","excuse","targetIsFriend","nonTargetIsNonFriend","nonTargetIsFriend","targetIsNonFriend","cutthroatVoteJury","r0","r1","vote","nominateNPlayers","hitlist","hitList","trueOptions","useGoldenVetoPreJury","save","rel0","relationshipWith","rel1","FullscreenIcon","fullscreenButton_templateObject","FullscreenButton","getValue","EndgameTableCell","td","votingTable_templateObject","EndgameTable","table","votingTable_templateObject2","Gray","votingTable_templateObject3","White","votingTable_templateObject4","_ref4","votingTable_templateObject5","_ref5","WinnerCell","votingTable_templateObject6","_ref6","RunnerUpCell","votingTable_templateObject7","_ref7","NomineeCell","_templateObject8","_ref8","HohCell","_templateObject9","_ref9","BlackRow","tr","_templateObject10","generateVotingTable","masterLog","houseguestCells","evictionOrder","topRowCells","preVetoCells","vetoCells","postVetoCells","evictedCells","winnerCells","cells","colSpan","generateTopRow","nominationsPreVeto","rowSpan","generatePreVetoRow","vetoWinner","generateVetoRow","nominationsPostVeto","generatePostVetoRow","voteTextLine1","soleVoter","votesInMajority","votingTable_Evicted","evicted","generateEvictedRow","runnerUp","winner","_arr","entries","votes","_i","_ref12","_ref11","WinnerVote","RunnerUpVote","winnerRow","topRow","preVetoRow","vetoRow","postVetoRow","blackRow","houseguestRows","evictedRow","evictionColSpan","weeks","reverse","weekText","tempList","voteKey","getKey","NormalVote","NomineeVote","HoHVote","hohText","hohVote","juryVoteScene","newGameState","jurors","finalists","castJuryVote","currentLog","votesFor0","votesFor1","voteCountText","scene","BigBrotherFinale","generateBbFinale","currentGameState","hohCompScene","finalHoH","finalEviction","_finalHohCompScene","final3","enduranceWinner","enduranceLosers","skillWinner","portraits_Portrait","finalHohCompScene","_finalHohCompScene2","_finalEvictionScene","HoH","_castEvictionVote","evictee","survivor","hoh","evictHouseguest","finalEvictionScene","_finalEvictionScene2","_juryVoteScene","_juryVoteScene2","juryScene","BigBrotherFinaleEpisode","GameOver","GameOverEpisode","EpisodeLog","EdgeMap","add","generateGraph","nodes","edges","stringId","villainId","_generateEdge","generateEdge","_generateEdge2","edge","neighbors","v","generateCliques","bronKerbosch","values","from","keys","rPrime","pPrime","toConsumableArray","node","xPrime","delete","clique","sort","EpisodeFactory","episodeType","iMap","jMap","impression","randomFloat","firstImpressions","heroWinsTheFinale","populateSuperiors","house","sum","targetId","calculatePopularity","updatePopularity","rel","updateFriendCounts","finalState","BigBrotherVanilla","nomCeremonyScene","_generateHohCompScene","previousHoh","newHoH","generateHohCompScene","_generateHohCompScene2","vetoCompScene","povWinner","_generateNomCeremonyS","nom2","noms","generateNomCeremonyScene","_generateNomCeremonyS2","vetoCeremonyScene","_generateVetoCompScen","choices","povPlayers","everyoneWillPlay","introText","extras","generateVetoCompScene","_generateVetoCompScen2","evictionScene","_generateVetoCeremony","initialNominees","povTarget","descisionText","vetoChoice","useGoldenVeto","replacementSpeech","nameAReplacement","finalNominees","replacementNom","replacementIndex","findIndex","generateVetoCeremonyScene","_generateVetoCeremony2","_generateEvictionScen","lastVoter","logic","tieVote","tieBreaker","displayHoH","generateEvictionScene","_generateEvictionScen2","Tabs","bigBrotherWeekstartWrapper_WeekStartWrapper","BigBrotherVanillaEpisode","generateBbVanilla","generateGameOver","AllianceList","elements","WeekStartWrapper","tab","TabItem","li","bigBrotherEpisode_templateObject","Tab","active","setActive","paddingLeft","Season","factory","nextEpisode","SidebarController","subscriptions","season","selectedEpisode","delta","selectedScene","renderedScenes","targetScene","lastEpisode","episodes","switchToScene","newPlayerCount","nextEpisodeType","whichEpisodeType","renderEpisode","onNewEpisode","_switchToScene","index","_x","keyCode","_handleKeyDown","bind","Sidebar","document","addEventListener","handleKeyDown","destroy","minWidth","getEpisodes","episodeKey","breakKey","getHighlight","getSelectedEpisode","MainContentAreaWrapper","mainContentArea_templateObject","MainContentArea","contentStream","prevProps","prevState","scrollTo","MainPage","fullscreen","inject","hideOnFullscreen","wrapperStyle","overflow","sidebar_Sidebar","overflowX","mainContentArea_MainContentArea","MainPageController","GlobalStyles","createGlobalStyle","globalTheme_templateObject","App","styled_components_browser_esm","Fragment","mainPage_MainPage","Boolean","location","hostname","ReactDOM","src_App","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.e0f24037.chunk.js","sourcesContent":["export class PlayerProfile {\n    readonly name: string = \"\";\n    readonly imageURL: string = \"\";\n    constructor(init: PlayerProfile) {\n        if (!init) {\n            return;\n        }\n        Object.assign(this, init);\n    }\n}\n","export class PowerRanking {\n    readonly beats: number;\n    readonly outOf: number;\n    get toFloat(): number {\n        return this.beats / this.outOf;\n    }\n\n    constructor(beats: number, outOf: number) {\n        if (outOf === 0) throw new Error(\"Power ranking attempted to divide by zero\");\n        this.beats = beats;\n        this.outOf = outOf;\n    }\n}\n","import { PlayerProfile } from \"./playerProfile\";\nimport { RelationshipMap } from \"../utils\";\nimport { PowerRanking } from \"./powerRanking\";\n\ninterface HouseguestInit extends PlayerProfile {\n    id: number;\n    relationships: RelationshipMap;\n}\n\nexport class Houseguest extends PlayerProfile {\n    public isEvicted: boolean = false;\n    public isJury: boolean = false;\n\n    readonly id: number = 0;\n\n    public nominations: number = 0;\n    public hohWins: number = 0;\n    public povWins: number = 0;\n\n    // Popularity ranges from -1 to 1\n    public popularity: number = 0;\n    public deltaPopularity: number = 0;\n    readonly relationships: RelationshipMap = {};\n\n    // power rankings range from 0 to 1\n    public powerRanking: PowerRanking = new PowerRanking(0, 1);\n    readonly superiors: Set<number> = new Set<number>();\n\n    public relationshipWith(villain: Houseguest): number {\n        return this.relationships[villain.id];\n    }\n\n    public getFriendEnemyCount: () => { friends: number; enemies: number } = () => {\n        return { friends: 0, enemies: 0 };\n    };\n\n    constructor(init: HouseguestInit) {\n        super(init);\n        Object.assign(this, init);\n    }\n}\n","export function hashcode(string: string): number {\n    let hash = 0,\n        i,\n        chr;\n    if (string.length === 0) return hash;\n    for (i = 0; i < string.length; i++) {\n        chr = string.charCodeAt(i);\n        hash = (hash << 5) - hash + chr;\n        hash |= 0;\n    }\n    return hash;\n}\n\nexport function roundTwoDigits(number: number | undefined) {\n    if (!number) {\n        return 0;\n    }\n    return Math.round(number * 100);\n}\n\nexport function max(a: number, b: number) {\n    return a > b ? a : b;\n}\n\nexport function extremeValues(x: number | undefined): number {\n    if (!x) {\n        return 0;\n    }\n    const xSquared = x * x;\n    if (x >= 0) {\n        return -xSquared + 2 * x;\n    } else {\n        return xSquared + 2 * x;\n    }\n}\n","export interface RelationshipMap {\n    [id: number]: number;\n}\n\nexport function newRelationshipMap(size: number, exclude: number): RelationshipMap {\n    const result: RelationshipMap = {};\n    for (let i = 0; i < size; i++) {\n        if (i !== exclude) result[i] = 0;\n    }\n    return result;\n}\n","import { Houseguest } from \"../../model\";\nimport { RelationshipMap } from \"../../utils\";\nimport { getSelectedPlayer, selectedPlayer$ } from \"../../subjects/subjects\";\n\nexport interface SelectedPlayerData {\n    id: number;\n    popularity: number;\n    relationships: RelationshipMap;\n    isEvicted: boolean;\n    superiors?: Set<number>;\n}\n\nexport function selectPlayer(player: SelectedPlayerData | null) {\n    if (!player || (getSelectedPlayer() && (getSelectedPlayer() as Houseguest).id === player.id)) {\n        selectedPlayer$.next(null);\n    } else {\n        selectedPlayer$.next(player);\n    }\n}\n","function componentToHex(c: any) {\n    var hex = Math.round(c).toString(16);\n    return hex.length == 1 ? \"0\" + hex : hex;\n}\n\nexport class Rgb {\n    public r: number;\n    public g: number;\n    public b: number;\n    public toHex() {\n        return \"#\" + componentToHex(this.r) + componentToHex(this.g) + componentToHex(this.b);\n    }\n    public toRgba(): string {\n        return `rgba(${this.r}, ${this.g}, ${this.b}, 1)`;\n    }\n    constructor(r: number, g: number, b: number) {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n    }\n}\n\nexport function interpolateColor(min: Rgb, max: Rgb, percent: number): string {\n    return new Rgb(\n        min.r + percent * (max.r - min.r),\n        min.g + percent * (max.g - min.g),\n        min.b + percent * (max.b - min.b)\n    ).toHex();\n}\n","import { PortraitProps, HouseguestPortrait, PortraitState } from \"../memoryWall\";\nimport { Subscription } from \"rxjs\";\nimport { selectedPlayer$, displayMode$, getSelectedPlayer } from \"../../subjects/subjects\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport { Rgb } from \"../../model/color\";\nimport { PowerRanking } from \"../../model/powerRanking\";\n\nconst selectedColor = new Rgb(51, 255, 249);\n\nexport class HouseguestPortraitController {\n    private subs: Subscription[] = [];\n    private view: HouseguestPortrait;\n    constructor(view: HouseguestPortrait) {\n        this.view = view;\n    }\n\n    get defaultState() {\n        return {\n            popularity: this.view.props.popularity,\n            displayMode: displayMode$.value,\n            powerRanking: this.view.props.powerRanking\n        };\n    }\n\n    public backgroundColor(props: PortraitProps): undefined | string {\n        const selectedPlayer = getSelectedPlayer();\n        if (selectedPlayer !== null && selectedPlayer.id === props.id) {\n            return selectedColor.toHex();\n        }\n        return props.isEvicted ? undefined : this.view.state.displayMode.backgroundColor(this.view.state);\n    }\n\n    public subscribe() {\n        const subs: Subscription[] = [];\n        subs.push(\n            selectedPlayer$.subscribe({\n                next: this.refreshData\n            })\n        );\n        subs.push(\n            displayMode$.subscribe({\n                next: displayMode => this.view.setState({ displayMode })\n            })\n        );\n        this.subs = subs;\n    }\n\n    public unsubscribe() {\n        this.subs.forEach(sub => sub.unsubscribe());\n    }\n\n    private comparePowerRankings(data: SelectedPlayerData): PowerRanking {\n        // 0 is blue. 1 is orange\n        if (!data.superiors) return new PowerRanking(0, 1);\n        const id = this.view.props.id === undefined ? -1 : this.view.props.id;\n        return data.superiors.has(id) ? new PowerRanking(1, 1) : new PowerRanking(0, 1);\n    }\n\n    private refreshData = (data: SelectedPlayerData | null) => {\n        if (!data) {\n            this.view.setState(this.defaultState);\n        } else {\n            if (data.id !== this.view.props.id) {\n                this.view.setState({\n                    popularity: data.relationships[this.view.props.id!],\n                    powerRanking: this.comparePowerRankings(data)\n                });\n            } else {\n                this.view.setState({ popularity: 2, powerRanking: new PowerRanking(2, 1) });\n            }\n        }\n    };\n}\n","import React from \"react\";\nimport { selectPlayer } from \"./selectedPortrait\";\nimport { isNullOrUndefined } from \"util\";\nimport { RelationshipMap } from \"../../utils\";\nimport _ from \"lodash\";\nimport { HouseguestPortraitController } from \"./houseguestPortraitController\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport { PowerRanking } from \"../../model/powerRanking\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst Subtitle = styled.small`\n    font-weight: 100;\n    font-size: small;\n`;\n\nconst MemoryWallPortrait = styled.div`\n    margin: 5px;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.portraitBorder};\n    color: black;\n    border-radius: 5px;\n    text-align: center;\n    font-weight: 600;\n    max-width: 7rem;\n    word-wrap: break-word;\n    -webkit-transition-property: none;\n    -moz-transition-property: none;\n    -o-transition-property: none;\n    transition-property: none;\n`;\n\nconst Evicted = styled(MemoryWallPortrait)`\n    font-weight: 100;\n    color: grey;\n    background-color: #111111;\n`;\n\nconst Jury = styled(MemoryWallPortrait)`\n    font-weight: 100;\n    color: #c3ae88;\n    background-color: #5d5340;\n    filter: brightness(0.6);\n`;\n\nconst Normal = styled.img`\n    min-width: 100px;\n    width: 100%;\n    width: -moz-available; /* For Mozzila */\n    width: -webkit-fill-available; /* For Chrome */\n    width: stretch; /* Unprefixed */\n    -webkit-transition-property: none;\n    -moz-transition-property: none;\n    -o-transition-property: none;\n    transition-property: none;\n`;\n\nconst Grayscale = styled(Normal)`\n    filter: grayscale(100%);\n`;\n\nconst Sepia = styled(Normal)`\n    filter: sepia(100%);\n`;\n\nexport interface PortraitProps {\n    imageURL: string;\n    name: string;\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    powerRanking?: PowerRanking;\n    deltaPopularity?: number;\n    detailed?: boolean;\n    superiors?: Set<number>;\n    getFriendEnemyCount?: () => { friends: number; enemies: number };\n}\n\nexport interface PortraitState {\n    popularity?: number;\n    powerRanking?: PowerRanking;\n    displayMode: PortraitDisplayMode;\n}\nexport class HouseguestPortrait extends React.Component<PortraitProps, PortraitState> {\n    private controller: HouseguestPortraitController;\n\n    public constructor(props: PortraitProps) {\n        super(props);\n        this.controller = new HouseguestPortraitController(this);\n        this.state = this.controller.defaultState;\n    }\n\n    public componentDidMount() {\n        if (isNullOrUndefined(this.props.id)) {\n            return;\n        }\n        this.controller.subscribe();\n    }\n\n    public componentWillUnmount() {\n        this.controller.unsubscribe();\n    }\n\n    private onClick(): void {\n        if (isNullOrUndefined(this.props.id) || !this.props.relationships) {\n            return;\n        }\n        const data = {\n            id: this.props.id,\n            relationships: this.props.relationships,\n            isEvicted: !!this.props.isEvicted,\n            popularity: this.props.popularity || 0,\n            superiors: this.props.superiors,\n        };\n        selectPlayer(data);\n    }\n\n    public render() {\n        const props = this.props;\n        const Img = getImageClass(props);\n        let subtitle: any[] = [];\n        subtitle = this.state.displayMode.generateSubtitle(this.props, this.state, !!props.detailed);\n\n        let Portrait = MemoryWallPortrait;\n        if (props.isJury) {\n            Portrait = Jury;\n        } else if (props.isEvicted) {\n            Portrait = Evicted;\n        }\n        return (\n            <Portrait\n                onClick={() => this.onClick()}\n                style={{\n                    backgroundColor: this.controller.backgroundColor(props),\n                }}\n            >\n                <Img src={props.imageURL} style={{ height: 100, width: \"-moz-available\" }} />\n                <br />\n                {props.name}\n                <br />\n                {<Subtitle>{subtitle}</Subtitle>}\n            </Portrait>\n        );\n    }\n}\n\nfunction getImageClass(props: PortraitProps) {\n    let imageClass = props.isEvicted ? Grayscale : Normal;\n    imageClass = props.isJury ? Sepia : imageClass;\n    return imageClass;\n}\n","import { ProfileHouseguest, HouseguestPortrait } from \"../memoryWall\";\nimport React from \"react\";\n\nexport function houseguestToPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={false} />;\n}\n\nexport function memoryWallPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={true} />;\n}\n","import React from \"react\";\nimport Popover from \"react-tiny-popover\";\nimport styled from \"styled-components\";\n\nconst Text = styled.p`\n    max-width: 200px;\n    padding: 3px 8px;\n    color: #fff;\n    text-align: center;\n    background-color: #000;\n    border-radius: 4px;\n`;\n\ninterface TooltipProps {\n    text: string;\n    children: any;\n}\n\ninterface ToolTipState {\n    visible: boolean;\n}\n\nexport class Tooltip extends React.Component<TooltipProps, ToolTipState> {\n    constructor(props: TooltipProps) {\n        super(props);\n        this.state = { visible: false };\n    }\n\n    public render() {\n        return (\n            <Popover\n                position={[\"top\", \"bottom\"]}\n                isOpen={this.state.visible}\n                content={<Text>{this.props.text}</Text>}\n            >\n                <div\n                    onMouseEnter={() => this.setState({ visible: true })}\n                    onMouseLeave={() => this.setState({ visible: false })}\n                >\n                    {this.props.children}\n                </div>\n            </Popover>\n        );\n    }\n}\n","import React from \"react\";\nimport { ProfileHouseguest } from \"../memoryWall\";\nimport { houseguestToPortrait, memoryWallPortrait } from \"./houseguestToPortrait\";\nimport { Tooltip } from \"../tooltip/tooltip\";\n\nlet key = -1;\n\nfunction PortraitWrapper(props: { centered?: boolean; children: any }): JSX.Element {\n    return (\n        <div\n            key={key++}\n            className={`columns is-gapless is-mobile is-multiline ${props.centered ? \"is-centered\" : \"\"}`}\n        >\n            {props.children}\n        </div>\n    );\n}\n\nexport function Portrait(props: { houseguest: ProfileHouseguest; centered?: boolean }): JSX.Element {\n    const result = (\n        <PortraitWrapper centered={props.centered}>{houseguestToPortrait(props.houseguest)}</PortraitWrapper>\n    );\n    if (props.houseguest.tooltip) {\n        return (\n            <PortraitWrapper centered={props.centered}>\n                <Tooltip text={props.houseguest.tooltip}>{houseguestToPortrait(props.houseguest)}</Tooltip>\n            </PortraitWrapper>\n        );\n    }\n    return result;\n}\n\nexport function Portraits(props: {\n    houseguests: ProfileHouseguest[];\n    centered?: boolean;\n    detailed?: boolean;\n}): JSX.Element {\n    const rows: JSX.Element[] = [];\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    props.houseguests.forEach((houseguest: ProfileHouseguest) => {\n        let result;\n        if (props.detailed) {\n            result = memoryWallPortrait(houseguest, key++);\n        } else {\n            result = houseguestToPortrait(houseguest, key++);\n        }\n        if (houseguest.tooltip) {\n            result = <Tooltip text={houseguest.tooltip}>{result}</Tooltip>;\n        }\n        rows.push(result);\n    });\n    return (\n        <div className={`columns is-gapless is-mobile is-multiline ${props.centered && \"is-centered\"}`}>\n            {rows}\n        </div>\n    );\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { Portraits } from \"../playerPortrait/portraits\";\nimport { RelationshipMap } from \"../../utils\";\nexport interface IMemoryWallProps {\n    readonly houseguests: ProfileHouseguest[];\n}\n\nexport interface ProfileHouseguest extends PlayerProfile {\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    deltaPopularity?: number;\n    hohWins?: number;\n    povWins?: number;\n    nominations?: number;\n    tooltip?: string;\n    getFriendEnemyCount?: () => { friends: number; enemies: number };\n}\n\nexport function MemoryWall(props: IMemoryWallProps): JSX.Element {\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    return (\n        <div\n            style={{\n                margin: \"auto\",\n                maxWidth: props.houseguests.length < 26 ? 700 : -1,\n            }}\n        >\n            <Portraits houseguests={props.houseguests} centered={true} detailed={true} />\n        </div>\n    );\n}\n","import React from \"react\";\nimport { switchSceneRelative } from \"../../subjects/subjects\";\n\nexport function NextEpisodeButton(): JSX.Element {\n    return (\n        <button className=\"button is-primary\" onClick={() => switchSceneRelative(1)}>\n            Continue\n        </button>\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\ninterface SetupPortraitProps {\n    name: string;\n    imageUrl: string;\n    onDelete: () => void;\n    onChange: (arg0: Event) => void;\n}\n\ninterface SetupPortraitState {\n    name: string;\n}\n\nconst EditPortrait = styled.div`\n    padding: 5px;\n    margin: 5px;\n    border: 1px solid grey;\n    background-color: grey;\n    color: black;\n    border-radius: 5px;\n    font-weight: 600;\n    max-width: 7rem;\n    word-wrap: break-word;\n`;\n\nconst Input = styled.input`\n    padding: 5px;\n    margin: 5px;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.portraitBorder};\n    color: black;\n    border-radius: 5px;\n    font-weight: 600;\n    max-width: 7rem;\n    word-wrap: break-word;\n`;\n\nconst Noselect = styled.div`\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -khtml-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n`;\n\nconst XButton = styled(Noselect)`\n    color: #300808;\n\n    :active {\n        color: #ff7133;\n        background-color: #ffd8c7;\n    }\n    :hover {\n        color: red;\n        background-color: #ffe1ea;\n    }\n`;\n\nexport class SetupPortrait extends React.Component<SetupPortraitProps, SetupPortraitState> {\n    public constructor(props: SetupPortraitProps) {\n        super(props);\n        this.state = { name: props.name };\n    }\n\n    public UNSAFE_componentWillReceiveProps(props: SetupPortraitProps) {\n        this.setState({ name: props.name });\n    }\n\n    public render() {\n        return (\n            <EditPortrait>\n                <div style={{ textAlign: \"center\" }}>\n                    <XButton onDoubleClick={() => this.props.onDelete()}></XButton>\n                    <img src={this.props.imageUrl} style={{ width: 100, height: 100 }} />\n                    <br />\n                    <p>{this.state.name} </p>\n                </div>\n            </EditPortrait>\n        );\n    }\n}\n","export enum RelationshipType {\n    Friend = \"FRIEND\",\n    Queen = \"QUEEN\",\n    Pawn = \"PAWN\",\n    Enemy = \"ENEMY\"\n}\n\nexport const RelationshipTypeToSymbol = { FRIEND: \"\", ENEMY: \"\", PAWN: \"PAWN\", QUEEN: \"QUEEN\" };\n\nexport function classifyRelationship(\n    heroPopularity: number,\n    villainPopularity: number,\n    relationship: number\n): RelationshipType {\n    const benefitsHero = relationship > heroPopularity;\n    const benefitsVillain = relationship > villainPopularity;\n    if (benefitsHero && benefitsVillain) {\n        return RelationshipType.Friend;\n    } else if (benefitsHero && !benefitsVillain) {\n        return RelationshipType.Pawn;\n    } else if (!benefitsHero && benefitsVillain) {\n        return RelationshipType.Queen;\n    }\n    return RelationshipType.Enemy;\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\n\ninterface ImportLinksProps {\n    onSubmit: (profiles: PlayerProfile[]) => void;\n    className?: string;\n}\n\nexport class ImportLinks extends React.Component<ImportLinksProps, any> {\n    public constructor(props: ImportLinksProps) {\n        super(props);\n        this.state = { text: \"\" };\n    }\n\n    private onSubmit() {\n        const lines = this.state.text.split(/\\r?\\n/);\n        // ugly, but it works.\n        const profiles: PlayerProfile[] = [];\n        lines.forEach((line: string) => {\n            const temp = line.split(\"/\").pop();\n            let name = temp\n                ? temp\n                      .split(\"#\")[0]\n                      .split(\"?\")[0]\n                      .replace(/\\.[^/.]+$/, \"\")\n                      .replace(/[-_]/g, \" \")\n                : null;\n\n            if (line.substr(0, line.indexOf(\" \"))) {\n                name = line.substr(line.indexOf(\" \") + 1);\n            }\n            if (name) {\n                profiles.push({\n                    name,\n                    imageURL: line\n                });\n            }\n        });\n        this.props.onSubmit(profiles);\n        this.setState({ text: \"\" });\n    }\n\n    public render() {\n        return (\n            <div className={this.props.className}>\n                <textarea\n                    className=\"textarea\"\n                    onChange={event => {\n                        this.setState({ text: event.target.value });\n                    }}\n                    value={this.state.text}\n                />\n                <button onClick={() => this.onSubmit()}>Import links</button>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { roundTwoDigits } from \"../../utils\";\nimport { ProfileHouseguest, PortraitProps, PortraitState } from \"../memoryWall\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport {\n    RelationshipTypeToSymbol,\n    RelationshipType as Relationship,\n    classifyRelationship\n} from \"../../utils/ai/classifyRelationship\";\nimport { getSelectedPlayer } from \"../../subjects/subjects\";\n\nexport function generatePowerSubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    _: boolean | undefined\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    key = addPopularityLine(state, hero, !!_, subtitle, key);\n    key = addCompsLine(hero, subtitle, key);\n    if (!hero.isEvicted && state.powerRanking) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            subtitle.push(<div key={key++}>{`${state.powerRanking!.beats > 0 ? \"LOSE\" : \"WIN\"}`}</div>);\n        } else if (data && data.id === hero.id) {\n            subtitle.push(<div key={key++}>I WOULD</div>);\n        } else {\n            subtitle.push(\n                <div key={key++}>{`WINS ${state.powerRanking.beats}/${state.powerRanking.outOf}`}</div>\n            );\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return subtitle;\n}\n\nexport function generatePopularitySubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    detailed: boolean = false\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    // popularity\n    key = addPopularityLine(state, hero, detailed, subtitle, key);\n    // competition wins\n    key = addCompsLine(hero, subtitle, key);\n    // friendship count / relationship classification titles\n    ({ subtitle, key } = addFriendshipCountTitles(hero, subtitle, key));\n    return subtitle;\n}\n\nfunction addFriendshipCountTitles(hero: PortraitProps, subtitle: any[], key: number) {\n    if (!hero.isEvicted) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            const titles = friendOrEnemyTitle(hero, data);\n            subtitle = subtitle.concat(titles.map(txt => <div key={key++}>{txt}</div>));\n        } else {\n            const titles = friendEnemyCountTitle(hero);\n            subtitle = subtitle.concat(titles.map(txt => <div key={key++}>{txt}</div>));\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return { subtitle, key };\n}\n\nfunction addPopularityLine(\n    state: { popularity?: number },\n    hero: PortraitProps,\n    detailed: boolean,\n    subtitle: any[],\n    key: number\n) {\n    let popularity = state.popularity;\n    if (popularity && (popularity > 1 || popularity < -1)) {\n        popularity = hero.popularity;\n    }\n    if (popularity && !hero.isEvicted) {\n        let popularitySubtitle = `${roundTwoDigits(popularity)}%`;\n        const deltaPop = getDeltaPopularity(hero, popularity);\n        if (detailed && deltaPop !== 0) {\n            const arrow = deltaPop > 0 ? \" | \" : \" | \";\n            popularitySubtitle += `${arrow} ${deltaPop}%`;\n        }\n        subtitle.push(<div key={key++}>{popularitySubtitle}</div>);\n    }\n    return key;\n}\n\nfunction addCompsLine(hero: PortraitProps, subtitle: any[], key: number) {\n    if (compWins(hero)) {\n        subtitle.push(<div key={key++}>{`${compWins(hero)}`}</div>);\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return key;\n}\n\nfunction getDeltaPopularity(houseguest: PortraitProps, statePopularity: number) {\n    if (roundTwoDigits(houseguest.popularity) !== roundTwoDigits(statePopularity)) {\n        return 0;\n    }\n    return houseguest.deltaPopularity ? roundTwoDigits(houseguest.deltaPopularity) : 0;\n}\n\nfunction compWins(houseguest: ProfileHouseguest): string {\n    return `${houseguest.hohWins ? ` ${houseguest.hohWins}` : \"\"}${\n        houseguest.povWins && houseguest.hohWins\n            ? `| ${houseguest.povWins}`\n            : houseguest.povWins\n            ? ` ${houseguest.povWins}`\n            : \"\"\n    }${(houseguest.hohWins || houseguest.povWins) && houseguest.nominations ? \"|\" : \"\"}${\n        houseguest.nominations ? ` ${houseguest.nominations}` : \"\"\n    }`;\n}\n\nfunction friendOrEnemyTitle(hero: PortraitProps, villain: SelectedPlayerData): string[] {\n    const titles: string[] = [];\n    titles.push(\n        RelationshipTypeToSymbol[\n            classifyRelationship(hero.popularity || 0, villain.popularity, hero.relationships![villain.id])\n        ]\n    );\n    return titles;\n}\n\nfunction friendEnemyCountTitle(hero: PortraitProps): string[] {\n    const titles: string[] = [];\n    const count = hero.getFriendEnemyCount ? hero.getFriendEnemyCount() : { friends: 0, enemies: 0 };\n    titles.push(\n        `${count.friends} ${RelationshipTypeToSymbol[Relationship.Friend]} | ${count.enemies} ${\n            RelationshipTypeToSymbol[Relationship.Enemy]\n        }`\n    );\n    return titles;\n}\n","import { Rgb, interpolateColor } from \"./color\";\nimport { PortraitState, PortraitProps } from \"../components/memoryWall\";\nimport { extremeValues } from \"../utils\";\nimport { generatePopularitySubtitle, generatePowerSubtitle } from \"../components/playerPortrait/subtitle\";\n\nexport interface PortraitDisplayMode {\n    minColor: Rgb;\n    maxColor: Rgb;\n    backgroundColor: (state: PortraitState) => string;\n    generateSubtitle: (props: PortraitProps, state: PortraitState, detailed?: boolean) => any[];\n}\n\nconst popularityMinColor = new Rgb(252, 137, 137);\nconst popularityMaxColor = new Rgb(137, 252, 137);\n\nexport const popularityMode: PortraitDisplayMode = {\n    minColor: popularityMinColor,\n    maxColor: popularityMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const popularity = state.popularity;\n\n        const extremePopularity = extremeValues(popularity);\n        const percent = (extremePopularity + 1) / 2;\n        return interpolateColor(popularityMinColor, popularityMaxColor, percent);\n    },\n    generateSubtitle: generatePopularitySubtitle\n};\n\nconst powerMaxColor = new Rgb(255, 204, 94);\nconst powerMinColor = new Rgb(192, 181, 255);\nexport const powerMode: PortraitDisplayMode = {\n    minColor: powerMinColor,\n    maxColor: powerMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const powerRanking = state.powerRanking;\n        if (powerRanking === undefined) return \"\";\n\n        return interpolateColor(powerMinColor, powerMaxColor, powerRanking.toFloat);\n    },\n    generateSubtitle: generatePowerSubtitle\n};\n","import React from \"react\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport { displayMode$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nfunction setDisplayMode(p: PortraitDisplayMode) {\n    displayMode$.next(p);\n}\n\ninterface ViewBarTagProps {\n    mode: PortraitDisplayMode;\n    text: string;\n    disabled?: boolean;\n}\n\nexport class ViewBarTag extends React.Component<ViewBarTagProps, { selected: boolean }> {\n    private sub: Subscription | null = null;\n\n    public constructor(props: ViewBarTagProps) {\n        super(props);\n        this.state = { selected: props.mode === displayMode$.value };\n    }\n\n    public componentDidMount() {\n        this.sub = displayMode$.subscribe({\n            next: (mode) => {\n                if (mode !== this.props.mode) {\n                    this.setState({ selected: false });\n                } else {\n                    this.setState({ selected: true });\n                }\n            },\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    public render() {\n        const name = \"level-item tag is-medium is-light\";\n        const style = getStyle(this.props);\n        return (\n            <span\n                className={name}\n                style={style}\n                onClick={() => {\n                    !this.props.disabled && setDisplayMode(this.props.mode);\n                    !this.props.disabled && this.setState({ selected: true });\n                }}\n            >\n                {styleText(this.props.text, this.state.selected)}\n            </span>\n        );\n    }\n}\n\nfunction styleText(text: string, selected: boolean): JSX.Element {\n    return selected ? <b>{text}</b> : <i>{text}</i>;\n}\n\nfunction getStyle(props: ViewBarTagProps) {\n    return props.disabled\n        ? {}\n        : {\n              background: `linear-gradient(90deg, ${props.mode.minColor.toRgba()} 0%, ${props.mode.maxColor.toRgba()} 100%)`,\n              cursor: \"pointer\",\n          };\n}\n","import React from \"react\";\nimport { popularityMode, powerMode } from \"../../model/portraitDisplayMode\";\nimport { ViewBarTag } from \"./viewBarTag\";\nimport { GameState, inJury } from \"../../model\";\nimport { displayMode$ } from \"../../subjects/subjects\";\n\nexport class ViewsBar extends React.Component<{ gameState: GameState }, {}> {\n    public constructor(props: { gameState: GameState }) {\n        super(props);\n    }\n\n    componentDidUpdate() {\n        if (!inJury(this.props.gameState) && displayMode$.value === powerMode) {\n            displayMode$.next(popularityMode);\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"level is-mobile\" key=\"viewsbar\" style={{ marginBottom: 0 }}>\n                <ViewBarTag mode={popularityMode} text={\"Relationships\"}></ViewBarTag>\n                {inJury(this.props.gameState) && (\n                    <ViewBarTag mode={powerMode} text={\"Power Rankings\"}></ViewBarTag>\n                )}\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { Scene } from \"./scene\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\n\nexport interface InitEpisode {\n    scenes: Scene[];\n    title: string;\n    content: JSX.Element;\n    gameState: GameState;\n    initialGamestate?: GameState;\n    type: EpisodeType;\n}\n\nexport class Episode {\n    readonly scenes: Scene[];\n    readonly title: string;\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly initialGameState: GameState;\n    readonly type: EpisodeType;\n    readonly arrowsEnabled: boolean = true;\n    get render(): JSX.Element {\n        const viewsBar = this.type.hasViewsbar ? <ViewsBar gameState={this.initialGameState} /> : null;\n        return (\n            <div>\n                {viewsBar}\n                {this.content}\n            </div>\n        );\n    }\n\n    constructor(init: InitEpisode) {\n        this.scenes = init.scenes;\n        this.title = init.title;\n        this.content = init.content;\n        this.gameState = init.gameState;\n        this.initialGameState = init.initialGamestate || init.gameState;\n        this.type = init.type;\n    }\n}\n\nexport interface EpisodeType {\n    readonly canPlayWith: (n: number) => boolean;\n    readonly eliminates: number;\n    readonly arrowsEnabled: boolean;\n    readonly hasViewsbar: boolean;\n}\n","import React from \"react\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { GameState } from \"../../model/gameState\";\n\nconst PregameEpisodeType: EpisodeType = {\n    eliminates: 0,\n    canPlayWith: (n: number) => {\n        return n > 2;\n    },\n    arrowsEnabled: true,\n    hasViewsbar: false\n};\n\nexport class PregameEpisode extends Episode {\n    readonly title = \"Pregame\";\n    readonly scenes = [];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = PregameEpisodeType;\n\n    public constructor(gameState: GameState) {\n        super({\n            title: \"Pregame\",\n            scenes: [],\n            content: <PregameScreen cast={gameState.houseguests} />,\n            gameState,\n            type: PregameEpisodeType\n        });\n        this.gameState = gameState;\n        this.content = <PregameScreen cast={gameState.houseguests} />;\n    }\n}\n","import React, { useState } from \"react\";\n\ninterface RandomButtonProps {\n    random: (n: number) => void;\n}\n\nexport function RandomButton(props: RandomButtonProps): JSX.Element {\n    const [number, setNumber] = useState(\"16\");\n    return (\n        <div>\n            <button\n                disabled={number === \"\"}\n                className=\"button is-primary\"\n                onClick={() => props.random(parseInt(number))}\n            >\n                Random\n            </button>\n            <NumericInput value={number} onChange={setNumber} />\n        </div>\n    );\n}\n\ninterface NumericInputProps {\n    value: string;\n    onChange: (newValue: string) => void;\n}\n\nfunction NumericInput(props: NumericInputProps) {\n    return (\n        <input\n            className=\"input\"\n            type=\"text\"\n            style={{ width: \"3em\", marginLeft: 5 }}\n            value={props.value}\n            onChange={event => {\n                const value = event.target.value;\n                if (/^\\d*$/g.test(value)) {\n                    props.onChange(value);\n                }\n            }}\n        />\n    );\n}\n","import styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nexport const HasText = styled.div`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport const Input = styled.input`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\ninterface TextProps {\n    noMargin?: boolean;\n    children?: any;\n}\n\nconst NoMargin = styled.div`\n    text-align: center;\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\nconst Center = styled.p`\n    text-align: center;\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport function Centered(props: TextProps): JSX.Element {\n    if (props.noMargin) return <NoMargin>{props.children}</NoMargin>;\n    return <Center>{props.children} </Center>;\n}\n\nexport function CenteredBold(props: TextProps): JSX.Element {\n    return (\n        <Centered noMargin={props.noMargin}>\n            <b>{props.children} </b>\n        </Centered>\n    );\n}\n\nexport function CenteredItallic(props: TextProps): JSX.Element {\n    return (\n        <Centered noMargin={props.noMargin}>\n            <i>{props.children} </i>\n        </Centered>\n    );\n}\n","import React from \"react\";\nimport FileDrop from \"react-file-drop\";\nimport { PlayerProfile, GameState } from \"../../model\";\nimport { SetupPortrait } from \"../playerPortrait/setupPortrait\";\nimport { ImportLinks } from \"./importLinks\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { shuffle } from \"lodash\";\nimport { RandomButton } from \"./randomXButton\";\nimport { selectPlayer } from \"../playerPortrait/selectedPortrait\";\nimport { mainContentStream$, newEpisode, updateCast } from \"../../subjects/subjects\";\nimport { HasText, Input } from \"../layout/text\";\nimport { Centered } from \"../layout/centered\";\n\ninterface CastingScreenState {\n    players: PlayerProfile[];\n}\n\ninterface CastingScreenProps {\n    cast?: PlayerProfile[];\n}\n\nexport class CastingScreen extends React.Component<CastingScreenProps, CastingScreenState> {\n    constructor(props: CastingScreenProps) {\n        super(props);\n        this.state = { players: props.cast || [] };\n    }\n\n    private handleChange(i: number) {\n        return (event: any) => {\n            const newName = event.target.value.replace(/\\r?\\n|\\r/g, \"\");\n            const newState = { ...this.state };\n            newState.players[i] = new PlayerProfile({\n                imageURL: newState.players[i].imageURL,\n                name: newName,\n            });\n            this.setState(newState);\n        };\n    }\n\n    private deleteMethod(i: number) {\n        return () => {\n            const newState = { ...this.state };\n            newState.players.splice(i, 1);\n            this.setState(newState);\n        };\n    }\n\n    private getFiles() {\n        const players = this.state.players;\n        if (!players) {\n            return;\n        }\n        const rows: JSX.Element[] = [];\n        let i = 0;\n        players.forEach((player) =>\n            rows.push(\n                <SetupPortrait\n                    name={player.name}\n                    imageUrl={player.imageURL}\n                    onDelete={this.deleteMethod(i)}\n                    onChange={this.handleChange(i)}\n                    key={(++i).toString()}\n                />\n            )\n        );\n        return <div className=\"columns is-gapless is-mobile is-multiline is-centered\">{rows}</div>;\n    }\n\n    private appendProfiles = (profiles: PlayerProfile[]) => {\n        const newState = { ...this.state };\n        profiles.forEach((profile) => newState.players.push(profile));\n        this.setState(newState);\n    };\n\n    private submit = async () => {\n        updateCast(this.state.players);\n        mainContentStream$.next(<PregameScreen cast={this.state.players} />);\n        selectPlayer(null);\n        await newEpisode(null);\n        await newEpisode(new PregameEpisode(new GameState(this.state.players)));\n    };\n\n    private random = (amount: number) => {\n        let players = this.state.players;\n        players = shuffle(players);\n        players = players.slice(0, amount);\n        this.setState({ players });\n    };\n\n    public render() {\n        return (\n            <FileDrop onDrop={this.handleDrop}>\n                <HasText className=\"level\">\n                    <ImportLinks onSubmit={this.appendProfiles} />\n                    <div className=\"level-item\">\n                        <button className=\"button is-danger\" onClick={() => this.setState({ players: [] })}>\n                            Delete all\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <RandomButton random={this.random} />\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-primary\"\n                            disabled={this.state.players.length < 3}\n                            onClick={this.submit}\n                        >\n                            Submit\n                        </button>\n                    </div>\n                </HasText>\n                <Input type=\"file\" multiple onChange={this.handleUpload} />\n                {this.state.players.length === 0 && <Centered>~ Drop images ~</Centered>}\n                {this.getFiles()}\n            </FileDrop>\n        );\n    }\n\n    private handleUpload = (event: any) => {\n        this.handleFiles(event.target.files);\n    };\n\n    private handleDrop = (files: FileList | null, event: React.DragEvent) => {\n        if (!files) return;\n        this.handleFiles(files);\n    };\n\n    private handleFiles(files: FileList) {\n        const newState = { ...this.state };\n        for (let i = 0; i < files.length; i++) {\n            const file = files[i];\n            if (file.type.match(/image\\/*/)) {\n                newState.players.push(\n                    new PlayerProfile({\n                        name: file.name.substr(0, file.name.lastIndexOf(\".\")) || file.name,\n                        imageURL: URL.createObjectURL(file),\n                    })\n                );\n            }\n        }\n        this.setState(newState);\n    }\n}\n","import { BehaviorSubject, Subject } from \"rxjs\";\nimport { PregameScreen } from \"../components/pregameScreen/pregameScreen\";\nimport { Episode, PlayerProfile } from \"../model\";\nimport { SelectedPlayerData } from \"../components/playerPortrait/selectedPortrait\";\nimport React from \"react\";\nimport { PortraitDisplayMode, popularityMode } from \"../model/portraitDisplayMode\";\nimport { ColorTheme, lightTheme } from \"../theme/theme\";\n\n// What is currently being displayed.\nexport const mainContentStream$ = new BehaviorSubject(<PregameScreen cast={[]} />);\n// Push episodes to this subject to add them to the sidebar. Null resets everything.\nexport const episodes$ = new BehaviorSubject<Episode | null>(null);\n// Forcibly switches to an episode. Used when adding a new episode.\nexport const switchEpisode$ = new Subject<number>();\nexport function newEpisode(episode: Episode | null) {\n    episodes$.next(episode);\n}\nexport function switchSceneRelative(n: number) {\n    switchEpisode$.next(n);\n}\n// the list of players in the game\nexport const cast$ = new BehaviorSubject<PlayerProfile[]>([]);\nexport function updateCast(newCast: PlayerProfile[]) {\n    cast$.next(newCast);\n}\nexport function getCast(): PlayerProfile[] {\n    return cast$.value;\n}\n// The player that the user has clicked on.\nexport const selectedPlayer$ = new BehaviorSubject<SelectedPlayerData | null>(null);\nexport function getSelectedPlayer() {\n    return selectedPlayer$.value;\n}\n\n// The tab selected on the start of each week.\nexport const weekStartTab$ = new BehaviorSubject<number>(0);\n\n// The display mode selected by the viewsbar.\nexport const displayMode$ = new BehaviorSubject<PortraitDisplayMode>(popularityMode);\n\n// If the screen is fullscreen or not.\nexport const isFullscreen$ = new BehaviorSubject<boolean>(false);\n\n// dark or light mode.\nexport const theme$ = new Subject<ColorTheme>();\n","export interface ColorTheme {\n    name: string;\n    bg: string;\n    text: string;\n    toggleBorder: string;\n    gradient: string;\n    bodyArea: string;\n    link: string;\n    mark: string;\n    overlay: string;\n    evictedCell: string;\n    grayCell: string;\n    winnerCell: string;\n    lightGrayCell: string;\n    runnerUpCell: string;\n    nomineeCell: string;\n    hohCell: string;\n    portraitBorder: string;\n    tableCellBorder: string;\n}\n\nexport const lightTheme: ColorTheme = {\n    name: \"light\",\n    bg: \"#fff\",\n    text: \"#363537\",\n    toggleBorder: \"#FFF\",\n    gradient: \"linear-gradient(#39598A, #79D7ED)\",\n    bodyArea: \"#fff\",\n    link: \"blue\",\n    mark: \"yellow\",\n    overlay: \"fff\",\n    evictedCell: \"#fa8072\",\n    grayCell: \"#eaecf0\",\n    lightGrayCell: \"#f8f9fa\",\n    winnerCell: \"#73fb76\",\n    runnerUpCell: \"#d1e8ef\",\n    nomineeCell: \"#959ffd\",\n    hohCell: \"#CCFFCC\",\n    portraitBorder: \"gray\",\n    tableCellBorder: \"#a2a9b1\",\n};\n\nexport const darkTheme: ColorTheme = {\n    name: \"dark\",\n    bg: \"#121212\",\n    text: \"#FAFAFA\",\n    bodyArea: \"#363537\",\n    toggleBorder: \"#6B8096\",\n    gradient: \"linear-gradient(#091236, #1E215D)\",\n    link: \"lightblue\",\n    mark: \"#7e006d\",\n    overlay: \"#444346\",\n    evictedCell: \"#9d4c43\",\n    grayCell: \"#5e5e5e\",\n    lightGrayCell: \"#404040\",\n    runnerUpCell: \"#9fbec882\",\n    nomineeCell: \"#6c75d0\",\n    winnerCell: \"#00ac04\",\n    hohCell: \"#3f783f\",\n    portraitBorder: \"#484848\",\n    tableCellBorder: \"#53575b\",\n};\n","import React, { useState } from \"react\";\nimport { theme$ } from \"../../subjects/subjects\";\nimport { darkTheme, lightTheme } from \"../../theme/theme\";\n\nexport function ThemeSwitcher() {\n    const [theme, setTheme] = useState(\n        window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches ? \"dark\" : \"light\"\n    );\n    const toggleTheme = () => {\n        if (theme === \"light\") {\n            setTheme(\"dark\");\n            theme$.next(darkTheme);\n        } else {\n            setTheme(\"light\");\n            theme$.next(lightTheme);\n        }\n    };\n\n    const className = `button ${theme === \"dark\" ? `is-dark` : \"is-light\"}`;\n    return (\n        <div className={className} onClick={toggleTheme}>\n            {theme === \"light\" ? \"Dark mode\" : \"Light mode\"}\n        </div>\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst ShadowBox = styled.div`\n    box-shadow: ${({ theme }: { theme: ColorTheme }) =>\n        theme.name === \"light\" ? \"0 2px 3px rgba(10, 10, 10, 0.1), 0 0 0 1px rgba(10, 10, 10, 0.1)\" : \"\"};\n    border-radius: 6px;\n    margin-left: 3px;\n    margin-right: 3px;\n    background: ${({ theme }: { theme: ColorTheme }) => theme.overlay};\n`;\n\nconst StyledBox = styled.div`\n    margin-left: 3px;\n    margin-right: 3px;\n    margin-bottom: 3px;\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bodyArea};\n`;\n\nexport function DividerBox(props: any): JSX.Element {\n    return <ShadowBox className={props.className || \"\"}>{props.children}</ShadowBox>;\n}\n\nexport function Box(props: any): JSX.Element {\n    return (\n        <StyledBox style={props.style} className={`box ${props.className || \"\"}`}>\n            {props.children}\n        </StyledBox>\n    );\n}\n","import React from \"react\";\nimport ReactPaginate from \"react-paginate\";\nimport { HasText } from \"../layout/text\";\nimport { shuffle, ceil } from \"lodash\";\nimport { PlayerProfile } from \"../../model\";\nimport { mainContentStream$ } from \"../../subjects/subjects\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport _ from \"lodash\";\nimport styled from \"styled-components\";\n\ninterface DeckScreenProps {}\n\ninterface DeckScreenState {\n    loading: boolean;\n    decks: string[];\n    i: number;\n}\n\nconst decksPerPage = 26;\nconst baseUrl = \"https://spaulmark.github.io/img/\";\n\nconst imageCache: { [id: string]: string } = {};\n\nconst DeckStyle = styled(HasText)`\n    display: flex;\n    cursor: pointer;\n    align-items: center;\n    :hover {\n        color: red;\n        background-color: #ffe1ea;\n    }\n`;\n\nconst Centered = styled.div`\n    display: flex;\n    justify-content: center;\n    align-items: center;\n`;\n\nconst DeckText = styled.p`\n    margin-left: 1rem;\n`;\n\n// TODO: add a search bar, add a sort alphebetically function.\n\nasync function randomImageFromFolder(folder: string) {\n    if (imageCache[folder]) return imageCache[folder];\n    const links = await (await fetch(`${baseUrl}${folder}/dir.json`)).json();\n    const image = _.sample(links[\"files\"]);\n    imageCache[folder] = `${baseUrl}${folder}/${image}`;\n    return `${baseUrl}${folder}/${image}`;\n}\n\nasync function selectCast(folder: string) {\n    const links = await (await fetch(`${baseUrl}${folder}/dir.json`)).json();\n    const imageLinks = links[\"files\"].map((file: string) => {\n        return { name: file, url: `${baseUrl}${folder}/${file}` };\n    });\n    const playerProfiles = imageLinks.map((image: { name: string; url: string }) => {\n        return new PlayerProfile({\n            name: image.name.substr(0, image.name.lastIndexOf(\".\")) || image.name,\n            imageURL: image.url,\n        });\n    });\n    mainContentStream$.next(<CastingScreen cast={playerProfiles} />);\n}\n\nfunction Deck(props: { deck: string }): JSX.Element {\n    const [img, setImage] = React.useState(\"\");\n    const [loading, setLoading] = React.useState(true);\n    const deck = props.deck;\n\n    if (loading)\n        randomImageFromFolder(deck).then((img) => {\n            setLoading(false);\n            setImage(img);\n        });\n    return (\n        <DeckStyle className=\"column is-6\" onClick={() => selectCast(deck)}>\n            <img src={img} style={{ width: 50, height: 50 }} />\n            <DeckText>{deck}</DeckText>\n        </DeckStyle>\n    );\n}\n\nfunction DeckList(props: { data: string[]; i: number }): JSX.Element {\n    let commentNodes: JSX.Element[] = [];\n    const i = props.i;\n    const data = props.data;\n    const min = i * decksPerPage;\n    for (let j = min; j < min + decksPerPage; j++) {\n        const deck = data[j];\n        if (!deck) continue;\n        commentNodes.push(<Deck key={`${deck}__${i}__${j}`} deck={deck} />);\n    }\n    return (\n        <div id=\"project-comments\" key={\"__commentList__\"} style={{ display: \"flex\" }}>\n            <div key={\"__ul__\"} className={\"columns is-multiline\"}>\n                {commentNodes}\n            </div>\n        </div>\n    );\n}\n\nexport class DeckScreen extends React.Component<DeckScreenProps, DeckScreenState> {\n    constructor(props: DeckScreenProps) {\n        super(props);\n        this.state = { loading: true, decks: [], i: 0 };\n    }\n    async componentDidMount() {\n        const data = await (await fetch(\"https://spaulmark.github.io/img/dir.json\")).json();\n        this.setState({ decks: shuffle(data.decks), loading: false });\n    }\n\n    private handlePageClick = (page: { selected: number }) => {\n        this.setState({ i: page.selected });\n    };\n\n    render() {\n        if (this.state.loading) return <div />;\n        return (\n            <div>\n                <DeckList key={\"comments\"} data={this.state.decks} i={this.state.i} />\n                <Centered>\n                    <ReactPaginate\n                        key={\"__list__\"}\n                        previousLabel={\"previous\"}\n                        nextLabel={\"next\"}\n                        breakLabel={\"...\"}\n                        breakClassName={\"break-me\"}\n                        pageCount={ceil(this.state.decks.length / decksPerPage)}\n                        marginPagesDisplayed={2}\n                        pageRangeDisplayed={3}\n                        onPageChange={this.handlePageClick}\n                        containerClassName={\"pagination\"}\n                        activeClassName={\"active\"}\n                    />\n                </Centered>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport { mainContentStream$, getCast } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\nimport { ThemeSwitcher } from \"./themeSwitch\";\nimport { ColorTheme } from \"../../theme/theme\";\nimport { Box } from \"../layout/box\";\nimport { DeckScreen } from \"../deckScreen/deckScreen\";\n\nconst TopbarLink = styled.div`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.link};\n    cursor: pointer;\n`;\n\nexport function AdvancedEditLink(): JSX.Element {\n    return (\n        <TopbarLink\n            onClick={() => {\n                mainContentStream$.next(<CastingScreen cast={getCast()} />);\n            }}\n        >\n            Edit / Upload Cast\n        </TopbarLink>\n    );\n}\n\nexport function ChooseCastLink(): JSX.Element {\n    return (\n        <TopbarLink\n            onClick={() => {\n                mainContentStream$.next(<DeckScreen />);\n            }}\n        >\n            Choose Cast\n        </TopbarLink>\n    );\n}\n\nexport function Topbar(props: { style?: any }): JSX.Element {\n    const style = { ...(props.style || {}) };\n    return (\n        <Box className=\"level is-mobile\" style={style}>\n            <div className=\"level-item\">\n                <ChooseCastLink />\n            </div>\n            <div className=\"level-item\">\n                <AdvancedEditLink />\n            </div>\n            <div className=\"level-item\">\n                <ThemeSwitcher />\n            </div>\n        </Box>\n    );\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { ChooseCastLink } from \"../topbar/topBar\";\nimport { HasText } from \"../layout/text\";\n\ninterface PregameScreenProps {\n    cast: PlayerProfile[];\n}\n\nexport function PregameScreen(props: PregameScreenProps): JSX.Element {\n    if (props.cast.length === 0) {\n        return (\n            <HasText>\n                Cast is empty. <ChooseCastLink />\n            </HasText>\n        );\n    }\n    return (\n        <HasText>\n            Welcome to Big Brother!\n            <MemoryWall houseguests={props.cast} />\n            <p>\n                <b> {\"You can use the <- and -> arrow keys to move forwards and backwards.\"}</b>\n            </p>\n            <NextEpisodeButton />\n        </HasText>\n    );\n}\n","import prand from \"pure-rand\";\nimport { BehaviorSubject } from \"rxjs\";\nimport { hashcode } from \"./utilities\";\nimport { cast$ } from \"../subjects/subjects\";\n\nexport class BbRandomGenerator {\n    private rng: prand.RandomGenerator;\n\n    public randomFloat(): number {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result / 2147483647.0;\n    }\n\n    public randomInt(a: number, b: number): number {\n        let result: number;\n        [result, this.rng] = prand.uniformIntDistribution(a, b, this.rng);\n        return result;\n    }\n\n    public flipCoin(): boolean {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result % 2 === 0;\n    }\n\n    public seed(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n\n    public constructor(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n}\n\nexport function rng() {\n    return rng$.value;\n}\n\nconst rng$ = new BehaviorSubject(new BbRandomGenerator(0));\n\nconst castSub = cast$.subscribe({\n    next: cast => {\n        let castNames = \"\";\n        cast.forEach(houseguest => (castNames += houseguest.name));\n        rng$.next(new BbRandomGenerator(hashcode(castNames)));\n    }\n});\n","import { Houseguest } from \"./houseguest\";\nimport { PlayerProfile } from \"./playerProfile\";\nimport _ from \"lodash\";\nimport { newRelationshipMap, rng } from \"../utils\";\nimport { finalJurySize, getFinalists } from \"./season\";\nimport { EpisodeLog } from \"./logging/episodelog\";\n\nexport function getById(gameState: GameState, id: number): Houseguest {\n    return gameState.houseguestCache[id];\n}\n\nexport function exclude(inclusions: Houseguest[], exclusions: Houseguest[]) {\n    const excludedIds = exclusions.map((hg) => hg.id);\n    return inclusions.filter((hg) => !excludedIds.includes(hg.id) && !hg.isEvicted);\n}\n\nexport function randomPlayer(inclusions: Houseguest[], exclusions: Houseguest[] = []): Houseguest {\n    if (inclusions.length === 0) {\n        throw new Error(\"Tried to get a random player from a list of 0 players.\");\n    }\n    const options = exclude(inclusions, exclusions);\n    const choice = rng().randomInt(0, options.length - 1);\n\n    return options[choice];\n}\n\nexport function nonEvictedHouseguests(gameState: GameState) {\n    return gameState.houseguests.filter((hg) => !hg.isEvicted);\n}\nexport function getJurors(gameState: GameState): Houseguest[] {\n    return gameState.houseguests.filter((hg) => hg.isJury);\n}\n\nexport function inJury(gameState: GameState): Boolean {\n    return gameState.remainingPlayers - getFinalists() <= finalJurySize();\n}\n\nexport function calculatePopularity(hero: Houseguest, house: Houseguest[]) {\n    let sum = 0;\n    let count = 0;\n    const targetId = hero.id;\n    house.forEach((houseguest) => {\n        if (houseguest.id !== targetId) {\n            count++;\n            sum += houseguest.relationships[targetId];\n        }\n    });\n    return count === 0 ? 0 : sum / count;\n}\n\nexport class GameState {\n    // Current state of the game after a phase.\n\n    readonly houseguestCache: { [id: number]: Houseguest } = {};\n    readonly houseguests: Houseguest[] = [];\n    readonly remainingPlayers: number = 0;\n    readonly phase: number = 0;\n    readonly previousHOH?: Houseguest;\n    readonly log: EpisodeLog[] = [];\n    readonly cliques: number[][] = [];\n    get currentLog() {\n        return this.log[this.phase];\n    }\n\n    public constructor(init: PlayerProfile[] | GameState) {\n        if (!(init instanceof Array)) {\n            Object.assign(this, init);\n        } else {\n            const profiles = init as PlayerProfile[];\n            this.remainingPlayers = profiles.length;\n            profiles.forEach((profile, i) => {\n                const hg: Houseguest = new Houseguest({\n                    ...profile,\n                    id: i,\n                    relationships: newRelationshipMap(profiles.length, i),\n                });\n                this.houseguestCache[i] = hg;\n                this.houseguests.push(hg);\n            });\n        }\n    }\n}\n\nexport class MutableGameState {\n    public houseguests: Houseguest[] = [];\n    public houseguestCache: { [id: number]: Houseguest } = {};\n    public remainingPlayers: number = 0;\n    public phase: number = 0;\n    public previousHOH?: Houseguest;\n    public cliques: number[][] = [];\n    public log: EpisodeLog[] = [];\n    get currentLog() {\n        return this.log[this.phase];\n    }\n\n    public constructor(init: GameState | MutableGameState) {\n        const copy = _.cloneDeep(init);\n        Object.assign(this, copy);\n    }\n}\n","import { BigBrotherVanilla } from \"../components/episode/bigBrotherEpisode\";\nimport { EpisodeFactory } from \"../components/episode/episodeFactory\";\nimport { GameState } from \"./gameState\";\nimport { EpisodeType, Episode } from \".\";\nimport { BigBrotherFinale } from \"../components/episode/bigBrotherFinale\";\nimport { cast$ } from \"../subjects/subjects\";\nimport { GameOver } from \"../components/episode/gameOver\";\n\nexport function finalJurySize() {\n    return jurors;\n}\n\nlet jurors = 7;\nconst sub = cast$.subscribe({\n    next: newCast => {\n        let players = newCast.length;\n        players = Math.round(players * 0.55);\n        if (players % 2 === 0) {\n            players--;\n        }\n        jurors = players;\n    }\n});\n\nexport function getFinalists() {\n    return 2;\n}\n\nexport class Season {\n    private factory: EpisodeFactory;\n\n    public constructor() {\n        this.factory = new EpisodeFactory();\n    }\n\n    // In the future, this would all be customizable,\n    // and not just all big brother episodes by default.\n\n    public renderEpisode(gameState: GameState, type: EpisodeType): Episode {\n        return this.factory.nextEpisode(gameState, type);\n    }\n\n    public whichEpisodeType(players: number) {\n        if (players === 3) {\n            return BigBrotherFinale;\n        }\n        if (players === 2) {\n            return GameOver;\n        }\n        return BigBrotherVanilla;\n    }\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\ninterface InitScene {\n    readonly title: string;\n    readonly gameState: GameState;\n    readonly content: JSX.Element;\n}\nexport class Scene {\n    readonly title: string = \"\";\n    readonly gameState: GameState = new GameState([]);\n    readonly content: JSX.Element = (<div>{`Error while rendering ${this.title}`}</div>);\n    public render: JSX.Element;\n    public constructor(init: Partial<InitScene>) {\n        Object.assign(this, init);\n        this.render = (\n            <div>\n                <ViewsBar gameState={this.gameState} />\n                {this.content}\n            </div>\n        );\n    }\n}\n","import { Houseguest, inJury, GameState } from \"../../model\";\n\nexport const relationship = (hero: Houseguest, villain: Houseguest) => hero.relationships[villain.id];\n\nexport function favouriteIndex(hero: Houseguest, options: Houseguest[]) {\n    // Return the index of the houseguest that hero has the best relationship with.\n    return highestScore(hero, options, relationship);\n}\n\nexport function highestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let highestIndex = 0;\n    let highestScore = -Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore > highestScore) {\n            highestIndex = i;\n            highestScore = currentScore;\n        }\n    });\n    return highestIndex;\n}\nexport function lowestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let lowestIndex = 0;\n    let lowestScore = Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore < lowestScore) {\n            lowestIndex = i;\n            lowestScore = currentScore;\n        }\n    });\n    return lowestIndex;\n}\n\nexport function doesHeroWinTheFinale(\n    hgs: { hero: Houseguest; villain: Houseguest },\n    jury: Houseguest[]\n): boolean {\n    const hero = hgs.hero;\n    const villain = hgs.villain;\n    let heroVotes = 0;\n    let villainVotes = 0;\n    jury.forEach(juror => {\n        if (juror.id === hero.id || juror.id === villain.id) {\n            return;\n        }\n        if (relationship(hero, juror) > relationship(villain, juror)) {\n            heroVotes++;\n        } else {\n            villainVotes++;\n        }\n    });\n    return heroVotes > villainVotes;\n}\n\nexport function heroShouldTargetSuperiors(hero: Houseguest, gameState: GameState): boolean {\n    const totalPlayers = gameState.remainingPlayers;\n    const superiors = hero.superiors.size;\n    // const inferiors = totalPlayers - 1 - hero.superiors.size;\n\n    // Old logic: Target the larger group. If they are equal, target superiors.\n    // return superiors >= inferiors;\n\n    // New logic: Target superiors unless you are in the top 25% of the playerlist.\n    return superiors / totalPlayers >= 0.25;\n}\n\n// TODO: this function can just honestly die. it's only used in nomination logic (which sucks anyways)\n// when I do the new logic, I think people who are dead center should target their superiors. works in F5.\n\nexport function hitList(hero: Houseguest, options: Houseguest[], gameState: GameState): Set<number> {\n    let result = options;\n    // jury logic is not affected by someone who is dead center in power rankings\n    if (inJury(gameState) && heroShouldTargetSuperiors(hero, gameState)) {\n        if (hero.superiors.size * 2 < gameState.remainingPlayers - 1) {\n            result = options.filter(hg => !hero.superiors.has(hg.id));\n        } else {\n            result = options.filter(hg => hero.superiors.has(hg.id));\n        }\n    } else {\n    }\n    return new Set(result.map(hg => hg.id));\n}\n","import { Houseguest, GameState, nonEvictedHouseguests, inJury, exclude } from \"../../model\";\nimport { favouriteIndex, relationship, lowestScore, hitList, heroShouldTargetSuperiors } from \"./aiUtils\";\nimport { classifyRelationship, RelationshipType as Relationship } from \"./classifyRelationship\";\n\ninterface NumberWithLogic {\n    decision: number;\n    reason: string;\n}\n\ninterface HouseguestWithLogic {\n    decision: Houseguest | null;\n    reason: string;\n}\n\n// Return the index of the eviction target.\nexport function castEvictionVote(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): NumberWithLogic {\n    if (inJury(gameState)) {\n        return cutthroatVoteJury(hero, nominees, gameState);\n    } else {\n        return cutthroatVote(hero, nominees);\n    }\n}\n\nfunction cutthroatVoteJury(hero: Houseguest, nominees: Houseguest[], gameState: GameState): NumberWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    const zeroIsInferior = !hero.superiors.has(nom0.id);\n    const oneIsInferior = !hero.superiors.has(nom1.id);\n    // if there is no sup/inf difference, no point in doing special logic for it\n    if (zeroIsInferior === oneIsInferior) {\n        return cutthroatVote(hero, nominees);\n    }\n    // Don't evict the last person in the game you can beat\n    if (gameState.remainingPlayers - hero.superiors.size - 1 === 1 && (zeroIsInferior || oneIsInferior)) {\n        const nonVote = zeroIsInferior ? 0 : 1;\n        return {\n            decision: zeroIsInferior ? 1 : 0,\n            reason: `I can't evict ${nominees[nonVote].name}, because they are the last person I can beat.`\n        };\n    }\n    const target = heroShouldTargetSuperiors(hero, gameState) === oneIsInferior ? 0 : 1;\n    const nonTarget = target ? 0 : 1;\n    const excuse = heroShouldTargetSuperiors(hero, gameState)\n        ? `I can't beat ${nominees[target].name} in the end.`\n        : `I need to keep ${nominees[nonTarget].name} around as a shield.`;\n    const targetIsFriend =\n        classifyRelationship(\n            hero.popularity,\n            nominees[target].popularity,\n            hero.relationships[nominees[target].id]\n        ) === Relationship.Friend;\n    const nonTargetIsNonFriend =\n        classifyRelationship(\n            hero.popularity,\n            nominees[nonTarget].popularity,\n            hero.relationships[nominees[nonTarget].id]\n        ) !== Relationship.Friend;\n    const nonTargetIsFriend = !nonTargetIsNonFriend;\n    const targetIsNonFriend = !targetIsFriend;\n    // the only reason to not evict your target is if he is your only friend on the block\n    if (targetIsFriend && nonTargetIsNonFriend) {\n        return { decision: nonTarget, reason: `${nominees[nonTarget].name} is my enemy.` };\n    } else if (targetIsFriend && nonTargetIsFriend) {\n        return { decision: target, reason: `Both noms are my friends, but ${excuse}` };\n    } else if (targetIsNonFriend && nonTargetIsNonFriend) {\n        return { decision: target, reason: `Neither of the noms are my friends, but ${excuse}` };\n    } else {\n        return { decision: target, reason: `${excuse}` };\n    }\n}\n\n// TODO: only works for 2 nominees\nfunction cutthroatVote(hero: Houseguest, nominees: Houseguest[]): NumberWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    const r0 = classifyRelationship(hero.popularity, nom0.popularity, hero.relationships[nom0.id]);\n    const r1 = classifyRelationship(hero.popularity, nom1.popularity, hero.relationships[nom1.id]);\n    if (r0 === Relationship.Enemy && r1 === Relationship.Enemy) {\n        return {\n            decision: nom0.popularity > nom1.popularity ? 0 : 1,\n            reason: \"Both noms are my enemies, so I voted for the more popular one.\"\n        };\n    } else if (\n        (r0 === Relationship.Enemy && r1 !== Relationship.Enemy) ||\n        (r1 === Relationship.Enemy && r0 !== Relationship.Enemy)\n    ) {\n        const vote = r0 === Relationship.Enemy ? 0 : 1;\n        return { decision: vote, reason: `${nominees[vote].name} is my enemy.` };\n    } else if (\n        (r0 !== Relationship.Friend && r1 === Relationship.Friend) ||\n        (r1 !== Relationship.Friend && r0 === Relationship.Friend)\n    ) {\n        const vote = r0 !== Relationship.Friend ? 0 : 1;\n        const nonVote = vote === 0 ? 1 : 0;\n        return { decision: vote, reason: `${nominees[nonVote].name} is my friend.` };\n    }\n    const vote = lowestScore(hero, nominees, relationship);\n    return {\n        decision: vote,\n        reason: `Both noms are my friends. but I like ${nominees[vote === 0 ? 1 : 0].name} more.`\n    };\n}\n\n// TODO: target and pawn based nominations, different pre and post jury.\nexport function nominateNPlayers(\n    hero: Houseguest,\n    options: Houseguest[],\n    gameState: GameState,\n    n: number\n): NumberWithLogic[] {\n    const result: NumberWithLogic[] = [];\n    const hitlist = hitList(hero, options, gameState);\n    let trueOptions = options.filter(hg => hitlist.has(hg.id));\n    if (trueOptions.length === 0) {\n        // if there are no options, we must sadly deviate from the hit list\n        trueOptions = options;\n    }\n    while (result.length < n) {\n        const decision = trueOptions[lowestScore(hero, trueOptions, relationship)];\n        const reason = \"I think you are ugly\";\n        result.push({ decision: decision.id, reason });\n        trueOptions = exclude(trueOptions, [decision]);\n        if (trueOptions.length === 0) {\n            trueOptions = options.filter(hg => !hitlist.has(hg.id));\n        }\n    }\n    return result;\n}\n\nexport function useGoldenVeto(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): HouseguestWithLogic {\n    let result: HouseguestWithLogic;\n    if (hero.id == nominees[0].id || hero.id == nominees[1].id) {\n        result = { decision: hero, reason: \"I am going to save myself.\" };\n    } else {\n        if (inJury(gameState)) {\n            // Note that I am currently not using the post-jury veto logic, primarily because it sucks at the moment\n            result = useGoldenVetoPreJury(hero, nominees);\n        } else {\n            result = useGoldenVetoPreJury(hero, nominees);\n        }\n        if (nonEvictedHouseguests(gameState).length === 4) {\n            result = {\n                decision: null,\n                reason: \"It doesn't make sense to use the veto here.\"\n            };\n        }\n    }\n    return result || null;\n}\n\n// works with any number of nominees\nfunction useGoldenVetoPostJury(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): HouseguestWithLogic {\n    let save = -1;\n    let reason = \"No reason specified.\";\n    let potentialSave: Houseguest | null = null;\n    let alwaysSave: Houseguest | null = null;\n    // identify potential save targets\n    nominees.forEach((nominee: Houseguest) => {\n        const relationship = classifyRelationship(\n            hero.popularity,\n            nominee.popularity,\n            hero.relationships[nominee.id]\n        );\n        const shouldTargetSuperiors = heroShouldTargetSuperiors(hero, gameState);\n        const nomineeIsSuperior: boolean = hero.superiors.has(nominee.id);\n        // always save the last person you can beat\n        if (gameState.remainingPlayers - hero.superiors.size - 1 === 1 && !nomineeIsSuperior) {\n            alwaysSave = nominee;\n            reason = `I have to save ${nominee.name}, because they are the last person I can beat.`;\n        }\n        // must be a friend and a non-target\n        // TODO: some people have the entire game as targets. they shouldn't be affected. --------------------------\n        if (relationship === Relationship.Friend && nomineeIsSuperior !== shouldTargetSuperiors) {\n            const excuse = heroShouldTargetSuperiors(hero, gameState)\n                ? `I can beat them in the end.`\n                : `I need to keep them around as a shield.`;\n            if (potentialSave) {\n                potentialSave =\n                    hero.relationshipWith(nominee) > hero.relationshipWith(potentialSave)\n                        ? nominee\n                        : potentialSave;\n            } else {\n                reason = `${nominee.name} is my friend, and ${excuse} `;\n                potentialSave = nominee;\n            }\n        }\n    });\n    if (alwaysSave) {\n        return { decision: alwaysSave, reason };\n    } else if (potentialSave) {\n        return { decision: potentialSave, reason };\n    } else {\n        return { decision: null, reason: \"Not sure what to put here yet.\" };\n    }\n}\n\nfunction useGoldenVetoPreJury(hero: Houseguest, nominees: Houseguest[]): HouseguestWithLogic {\n    let save = -1;\n    let reason = \"Neither of these nominees are my friends.\";\n    const rel0 = classifyRelationship(\n        hero.popularity,\n        nominees[0].popularity,\n        hero.relationshipWith(nominees[0])\n    );\n    const rel1 = classifyRelationship(\n        hero.popularity,\n        nominees[1].popularity,\n        hero.relationshipWith(nominees[1])\n    );\n    // basic logic that only saves friends. Doesn't take into account jury stuff.\n    if (rel0 === Relationship.Friend && rel1 !== Relationship.Friend) {\n        save = 0;\n        reason = `${nominees[0].name} is my friend.`;\n    } else if (rel1 === Relationship.Friend && rel0 !== Relationship.Friend) {\n        save = 1;\n        reason = `${nominees[1].name} is my friend.`;\n    } else if (rel0 === Relationship.Friend && rel1 === Relationship.Friend) {\n        save = Math.max(nominees[0].popularity, nominees[1].popularity) === nominees[0].popularity ? 0 : 1;\n        reason = `Both nominees are my friends, but I like ${nominees[save].name} more.`;\n    }\n    return { decision: nominees[save], reason };\n}\n\n// Returns the index of the finalist with the highest relationship with juror\nexport function castJuryVote(juror: Houseguest, finalists: Houseguest[]): number {\n    return favouriteIndex(juror, finalists);\n}\n","import React from \"react\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\n\nconst FullscreenIcon = styled.img`\n    position: -webkit-sticky;\n    position: sticky;\n    top: 20px;\n    right: 20px;\n`;\n\nexport function FullscreenButton(): JSX.Element {\n    return (\n        <FullscreenIcon\n            src={\n                \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAASElEQVRIiWNgGAUEACMa/z+R6ohWz0Sqi0gFLIRcQAAQDAGa+2DoWzAKRgH1wX8G3OULWfqHfkYbsNIUPR5IrQ/gYLQsGngAAEPgCRZjAdYSAAAAAElFTkSuQmCC\"\n            }\n            className=\"button is-rounded\"\n            onClick={() => {\n                isFullscreen$.next(!isFullscreen$.getValue());\n            }}\n        />\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { EpisodeLog } from \"../../../model/logging/episodelog\";\nimport { CenteredBold, Centered, CenteredItallic } from \"../../layout/centered\";\nimport { GameState, getById } from \"../../../model\";\nimport { VoteType, WinnerVote, RunnerUpVote } from \"../../../model/logging/voteType\";\nimport { FullscreenButton } from \"../../mainPage/fullscreenButton\";\nimport { ColorTheme } from \"../../../theme/theme\";\n\nexport const EndgameTableCell = styled.td`\n    padding: 0.1em 0.4em;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n`;\n\nconst EndgameTable = styled.table`\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n    border-collapse: collapse;\n`;\n\nconst Gray = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.grayCell};\n`;\n\nconst White = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.lightGrayCell};\n`;\n\nconst Evicted = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.evictedCell};\n`;\n\nexport const WinnerCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.winnerCell};\n`;\n\nexport const RunnerUpCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.runnerUpCell};\n`;\n\nexport const NomineeCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.nomineeCell};\n`;\n\nexport const HohCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.hohCell};\n`;\n\nconst BlackRow = styled.tr`\n    height: 0.4em;\n    background-color: #000000;\n`;\n\nexport function generateVotingTable(gameState: GameState): JSX.Element {\n    const masterLog: EpisodeLog[] = gameState.log;\n    const houseguestCells: JSX.Element[][] = [];\n    gameState.houseguests.forEach((hg, i) => {\n        houseguestCells[hg.id] = [\n            <Gray key={`hg-name---${i}`}>\n                <CenteredBold noMargin={true}>{hg.name}</CenteredBold>\n            </Gray>,\n        ];\n    });\n    const evictionOrder: number[] = [];\n    const topRowCells: JSX.Element[] = [];\n    const preVetoCells: JSX.Element[] = [];\n    const vetoCells: JSX.Element[] = [];\n    const postVetoCells: JSX.Element[] = [];\n    const evictedCells: JSX.Element[] = [];\n    const winnerCells: JSX.Element[] = [];\n    masterLog.forEach((log, i) => {\n        generateTopRow(log, i, topRowCells, masterLog.length - 1);\n        generatePreVetoRow(log, i, preVetoCells);\n        generateVetoRow(log, i, vetoCells);\n        generatePostVetoRow(log, i, postVetoCells);\n        generateEvictedRow(log, i, evictedCells, gameState);\n        if (!log) return;\n        evictionOrder.push(log.evicted);\n        if (log.runnerUp !== undefined) evictionOrder.push(log.runnerUp);\n        if (log.winner !== undefined) evictionOrder.push(log.winner);\n        // add each of the votes to the houseguest cells\n        for (const [key, value] of Object.entries(log.votes)) {\n            // typescript for .. in loops kinda suck so i need to do a sketchy type conversion\n            const id: number = (key as unknown) as number;\n            const vote: VoteType = value;\n            houseguestCells[id].push(vote.render(gameState));\n        }\n        if (log.winner !== undefined && log.runnerUp !== undefined) {\n            houseguestCells[log.winner].push(new WinnerVote().render(gameState));\n            houseguestCells[log.runnerUp].push(new RunnerUpVote().render(gameState));\n            evictedCells.push(\n                <RunnerUpCell>\n                    <CenteredBold noMargin={true}>{getById(gameState, log.runnerUp).name}</CenteredBold>\n                    <Centered noMargin={true}>\n                        <small>Finalist</small> {/** TODO: put \"X votes\" here instead. */}\n                    </Centered>\n                </RunnerUpCell>\n            );\n            winnerCells.push(\n                <WinnerCell>\n                    <CenteredBold noMargin={true}>{getById(gameState, log.winner).name}</CenteredBold>\n                    <Centered noMargin={true}>\n                        <small>Winner</small>\n                    </Centered>\n                </WinnerCell>\n            );\n        }\n    });\n    preVetoCells.push(\n        <White key={`preveto--finale`} rowSpan={3}>\n            <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n        </White>\n    );\n    const winnerRow = <tr>{winnerCells}</tr>;\n    const topRow = <tr>{topRowCells}</tr>;\n    const preVetoRow = <tr>{preVetoCells}</tr>;\n    const vetoRow = <tr>{vetoCells}</tr>;\n    const postVetoRow = <tr>{postVetoCells}</tr>;\n    const blackRow = (\n        <BlackRow>\n            <td colSpan={gameState.houseguests.length} />\n        </BlackRow>\n    );\n    const houseguestRows: JSX.Element[] = [];\n    const evictedRow = <tr>{evictedCells}</tr>;\n    let evictionColSpan = -1;\n    const weeks = evictionOrder.length;\n    evictionOrder.reverse().forEach((id, i) => {\n        if (evictionColSpan > 0) {\n            const weekText = i === 2 ? \"(Finale)\" : `(Week ${weeks - i})`;\n            const isJury = getById(gameState, id).isJury;\n            const colSpan = isJury ? evictionColSpan - 1 : evictionColSpan;\n            const evicted = (\n                <Evicted colSpan={colSpan} key={`evicted-week-${weeks - i}`}>\n                    <CenteredItallic noMargin={true}>Evicted</CenteredItallic>\n                    <CenteredItallic noMargin={true}>\n                        <small>{weekText}</small>\n                    </CenteredItallic>\n                </Evicted>\n            );\n            if (!isJury) {\n                houseguestCells[id].push(evicted); // not jury, they dead\n            } else {\n                const tempList = houseguestCells[id].slice(0, -1);\n                tempList.push(evicted);\n                tempList.push(houseguestCells[id][houseguestCells[id].length - 1]);\n                houseguestCells[id] = tempList;\n            }\n        }\n        houseguestRows.push(<tr key={`hgrow--${id}`}>{houseguestCells[id]}</tr>);\n        evictionColSpan++;\n    });\n\n    return (\n        <div>\n            <FullscreenButton />\n            <EndgameTable>\n                <tbody>\n                    {topRow}\n                    {preVetoRow}\n                    {vetoRow}\n                    {postVetoRow}\n                    {blackRow}\n                    {houseguestRows}\n                    {blackRow}\n                    {evictedRow}\n                    {winnerRow}\n                </tbody>\n            </EndgameTable>\n        </div>\n    );\n}\n\nfunction generateEvictedRow(\n    log: EpisodeLog | undefined,\n    i: number,\n    cells: JSX.Element[],\n    gameState: GameState\n) {\n    if (!log) {\n        cells.push(\n            <Gray key={i} rowSpan={2}>\n                <CenteredBold noMargin={true}>Evicted</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n\n    const voteTextLine1 =\n        log.soleVoter !== undefined\n            ? `${log.soleVoter}'s choice`\n            : `${log.votesInMajority} of ${log.outOf} votes`;\n\n    cells.push(\n        <Evicted key={i} rowSpan={2}>\n            <Centered noMargin={true}>\n                <b>{getById(gameState, log.evicted).name}</b>\n                <br />\n                <small>\n                    {voteTextLine1} <br />\n                    to evict\n                </small>\n            </Centered>\n        </Evicted>\n    );\n}\n\nfunction generatePostVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`postVeto--${i}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(post-veto)</small>\n                </CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`postVeto--${i}`}>\n            <Centered noMargin={true}>\n                {log.nominationsPostVeto[0]}\n                <br /> {log.nominationsPostVeto[1]}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`veto--${i}`}>\n                <CenteredBold noMargin={true}>Veto Winner</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    if (log.vetoWinner === undefined) return;\n\n    cells.push(\n        <White key={`veto--${i}`}>\n            <Centered noMargin={true}>{log.vetoWinner}</Centered>\n        </White>\n    );\n}\n\nfunction generatePreVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`preveto--${i}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(pre-veto)</small>\n                </CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    if (log.nominationsPreVeto.length === 0) {\n        cells.push(\n            <White key={`preveto--${i}`} rowSpan={2}>\n                <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n            </White>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`preveto--${i}`}>\n            <Centered noMargin={true}>\n                {log.nominationsPreVeto[0]}\n                <br /> {log.nominationsPreVeto[1]}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateTopRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[], max: number) {\n    if (!log) {\n        cells.push(<Gray key={`toprow--${i}`} />);\n        return;\n    }\n    if (i === max) {\n        cells.push(\n            <Gray key={`toprow--${i}`} colSpan={2}>\n                <CenteredBold noMargin={true}>Finale</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    cells.push(\n        <Gray key={`toprow--${i}`}>\n            <CenteredBold noMargin={true}>Week {i}</CenteredBold>\n        </Gray>\n    );\n}\n","import React from \"react\";\nimport { GameState, getById } from \"../gameState\";\nimport { CenteredItallic, Centered } from \"../../components/layout/centered\";\nimport {\n    EndgameTableCell,\n    WinnerCell,\n    RunnerUpCell,\n    NomineeCell,\n    HohCell,\n} from \"../../components/episode/scenes/votingTable\";\n\nlet voteKey = 0;\n\nfunction getKey(): string {\n    return `${voteKey++}-- vote key`;\n}\n\nexport interface VoteType {\n    id: number;\n    render: (state: GameState) => JSX.Element;\n}\n\nexport class NormalVote implements VoteType {\n    id: number;\n    render = (state: GameState) => (\n        <EndgameTableCell key={getKey()}>\n            <Centered noMargin={true}>{getById(state, this.id).name}</Centered>\n        </EndgameTableCell>\n    );\n    constructor(id: number) {\n        this.id = id;\n    }\n}\n\nexport class WinnerVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <WinnerCell>\n            <Centered noMargin={true}>Winner</Centered>\n        </WinnerCell>\n    );\n}\n\nexport class RunnerUpVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <RunnerUpCell>\n            <Centered noMargin={true}>Finalist</Centered>\n        </RunnerUpCell>\n    );\n}\n\nexport class NomineeVote implements VoteType {\n    id: number = -1;\n    evicted: boolean;\n    render = (state: GameState) => (\n        <NomineeCell key={getKey()}>\n            <CenteredItallic noMargin={true}>Nominated</CenteredItallic>\n        </NomineeCell>\n    );\n    constructor(evicted: boolean) {\n        this.evicted = evicted;\n    }\n}\n\nexport class HoHVote implements VoteType {\n    id: number;\n\n    get hohText(): JSX.Element {\n        return (\n            <CenteredItallic noMargin={true}>\n                Head of\n                <br />\n                Household\n            </CenteredItallic>\n        );\n    }\n\n    private hohVote(state: GameState): JSX.Element {\n        return <CenteredItallic noMargin={true}>{getById(state, this.id).name}</CenteredItallic>;\n    }\n\n    render = (state: GameState) => {\n        return <HohCell key={getKey()}>{this.id == -1 ? this.hohText : this.hohVote(state)}</HohCell>;\n    };\n    constructor(id?: number) {\n        this.id = id === undefined ? -1 : id;\n    }\n}\n","import { GameState, getJurors, nonEvictedHouseguests, MutableGameState, Houseguest } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { castJuryVote } from \"../../../utils/ai/aiApi\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport React from \"react\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport { NormalVote } from \"../../../model/logging/voteType\";\n\nexport function juryVoteScene(initialGameState: GameState): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const jurors: Houseguest[] = getJurors(newGameState);\n    const finalists = nonEvictedHouseguests(newGameState);\n    const votes: Array<ProfileHouseguest[]> = [[], []];\n    jurors.forEach(juror => {\n        const decision = castJuryVote(juror, finalists);\n        const result: ProfileHouseguest = { ...juror };\n        votes[decision].push(result);\n        newGameState.currentLog.votes[juror.id] = new NormalVote(finalists[decision].id);\n    });\n    const votesFor0 = votes[0].length;\n    const votesFor1 = votes[1].length;\n    const isUnanimous = votesFor0 === 0 || votesFor1 === 0;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${votesFor0} to ${votesFor1}...`;\n\n    const winner = votesFor0 > votesFor1 ? finalists[0] : finalists[1];\n    const runnerUp = votesFor0 < votesFor1 ? finalists[0] : finalists[1];\n    newGameState.currentLog.winner = winner.id;\n    newGameState.currentLog.runnerUp = runnerUp.id;\n    const scene = new Scene({\n        title: \"Jury Votes\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[0]} centered={true} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[1]} centered={true} />\n                    </DividerBox>\n                </div>\n                <Portraits houseguests={finalists} centered={true} />\n                <CenteredBold>{`Congratulations, ${winner.name}... you are the winner of Big Brother!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [newGameState, scene];\n}\n","import React from \"react\";\nimport { EpisodeType, Episode, InitEpisode } from \"./episodes\";\nimport { Scene } from \"./scene\";\nimport { GameState } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { finalHohCompScene } from \"./scenes/finalHohCompScene\";\nimport { finalEvictionScene } from \"./scenes/finalEvictionScene\";\nimport { juryVoteScene } from \"./scenes/juryVoteScene\";\nimport { HasText } from \"../layout/text\";\n\nexport const BigBrotherFinale: EpisodeType = {\n    canPlayWith: (n: number) => n === 3,\n    eliminates: 2,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n};\n\nexport function generateBbFinale(initialGameState: GameState): BigBrotherFinaleEpisode {\n    const title = \"Finale\";\n    const content = (\n        <HasText>\n            <MemoryWall houseguests={initialGameState.houseguests} /> <br />\n            <NextEpisodeButton />\n        </HasText>\n    );\n    let currentGameState;\n    let hohCompScene;\n    let finalHoH;\n    const scenes = [];\n    [currentGameState, hohCompScene, finalHoH] = finalHohCompScene(initialGameState);\n    scenes.push(hohCompScene);\n    let finalEviction;\n    [currentGameState, finalEviction] = finalEvictionScene(currentGameState, finalHoH);\n    scenes.push(finalEviction);\n    const [gameState, juryScene] = juryVoteScene(currentGameState);\n    scenes.push(juryScene);\n    return new BigBrotherFinaleEpisode({ gameState, content, title, scenes, type: BigBrotherFinale });\n}\n\nexport class BigBrotherFinaleEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = BigBrotherFinale;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portraits, Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\n\nexport function finalHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n    const final3 = nonEvictedHouseguests(initialGameState);\n    const enduranceWinner = randomPlayer(final3);\n    const enduranceLosers = final3.filter(hg => hg.id !== enduranceWinner.id);\n    const skillWinner = randomPlayer(final3, [enduranceWinner]);\n    const finalHoH = getById(newGameState, randomPlayer([enduranceWinner, skillWinner]).id);\n    finalHoH.hohWins++;\n    const scene: Scene = new Scene({\n        title: \"Final HoH Competition\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>The final 3 houseguests compete in the endurance competition.</Centered>\n                <Portraits houseguests={final3} centered={true} />\n                <Portrait houseguest={enduranceWinner} centered={true} />\n                <CenteredBold>{`${enduranceWinner.name} has won the endurance competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceLosers[0].name} and ${enduranceLosers[1].name} compete in the skill competition.`}</Centered>\n                <Portraits houseguests={enduranceLosers} centered={true} />\n                <Portrait houseguest={skillWinner} centered={true} />\n                <CenteredBold>{`${skillWinner.name} has won the skill competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceWinner.name} and ${skillWinner.name} compete in the quiz competition.`}</Centered>\n                <Portraits houseguests={[enduranceWinner, skillWinner]} centered={true} />\n                <Portrait houseguest={finalHoH} centered={true} />\n                <CenteredBold>{`Congratulations ${finalHoH.name}, you are the final Head of Household!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene, finalHoH];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { evictHouseguest } from \"../bigBrotherEpisode\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { HoHVote, NomineeVote } from \"../../../model/logging/voteType\";\n\nexport function finalEvictionScene(initialGameState: GameState, HoH: Houseguest): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const nominees = nonEvictedHouseguests(newGameState).filter((hg) => hg.id !== HoH.id);\n    newGameState.currentLog.nominationsPostVeto = nominees.map((hg) => hg.name);\n    const { decision: vote, reason } = castEvictionVote(HoH, nominees, newGameState);\n    const evictee = nominees[vote];\n    const survivor = nominees[vote == 1 ? 0 : 1];\n    newGameState.currentLog.soleVoter = HoH.name;\n    newGameState.currentLog.votes[survivor.id] = new NomineeVote(false);\n    newGameState.currentLog.votes[HoH.id] = new HoHVote(evictee.id);\n    newGameState.currentLog.votesInMajority = 1;\n    newGameState.currentLog.outOf = 1;\n    const hoh: ProfileHouseguest = { ...HoH };\n    hoh.tooltip = reason;\n    evictHouseguest(newGameState, evictee.id);\n    const scene: Scene = new Scene({\n        title: \"Final Eviction\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    {`As the final HoH of the season, ${HoH.name}, you may now cast the sole vote to evict.`}\n                    <Portrait houseguest={hoh} centered={true} />\n                    <CenteredBold>{`I vote to evict ${evictee.name}.`}</CenteredBold>\n                    <Portraits houseguests={nominees} centered={true} />\n                    <Centered>\n                        It's official... {evictee.name}, you will be the final person leaving the Big Brother\n                        House.\n                    </Centered>\n                </Centered>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene];\n}\n","import { Episode, InitEpisode, EpisodeType } from \"./episodes\";\nimport { Scene } from \"./scene\";\nimport { GameState } from \"../../model\";\nimport { evictHouseguest } from \"./bigBrotherEpisode\";\nimport { generateVotingTable } from \"./scenes/votingTable\";\n\nexport const GameOver: EpisodeType = {\n    canPlayWith: (n: number) => n === 1,\n    eliminates: 1,\n    arrowsEnabled: false,\n    hasViewsbar: false\n};\n\nexport function generateGameOver(gameState: GameState): GameOverEpisode {\n    const title = \"Game Over\";\n    const scenes: Scene[] = [];\n    const content = generateVotingTable(gameState);\n    gameState.houseguests.forEach(hg => {\n        evictHouseguest(gameState, hg.id);\n    });\n    return new GameOverEpisode({ gameState, content, title, scenes, type: GameOver });\n}\n\nexport class GameOverEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import { VoteType } from \"./voteType\";\n\nexport class EpisodeLog {\n    public nominationsPreVeto: string[] = [];\n    public vetoWinner?: string;\n    public winner?: number;\n    public runnerUp?: number;\n    public nominationsPostVeto: string[] = [];\n    public evicted: number = -1;\n    public votes: { [id: string]: VoteType } = {};\n    public votesInMajority: number = -1;\n    public outOf: number = -1;\n    public soleVoter?: string;\n}\n","import { Houseguest, GameState, nonEvictedHouseguests, getById } from \"../model\";\n\nimport { classifyRelationship, RelationshipType } from \"./ai/classifyRelationship\";\n\nimport _ from \"lodash\";\nimport { Graph } from \"./graphTest\";\n\nclass EdgeMap {\n    public data: { [id: number]: Set<number> } = {};\n    public add(key: number, value: number) {\n        if (!this.data[key]) {\n            this.data[key] = new Set<number>([value]);\n        } else {\n            this.data[key].add(value);\n        }\n    }\n}\n\nfunction generateEdge(\n    hero: Houseguest,\n    villain: Houseguest,\n    relationship: number\n): [number[] | null, number] {\n    const relationshipType = classifyRelationship(hero.popularity, villain.popularity, relationship);\n    if (relationshipType === RelationshipType.Friend) {\n        return [[hero.id, villain.id], 1];\n    }\n    // no edge for non-mutual friends\n    return [null, 0];\n}\n\nexport default function generateGraph(gameState: GameState): Graph {\n    // TODO: this algorithm assumes every relationship is mutual,\n    // and will need a face lift once we start getting non-mutual relationships.\n    const players = nonEvictedHouseguests(gameState);\n    const nodes: number[] = [];\n    const edges: EdgeMap = new EdgeMap();\n    players.forEach(player => {\n        let friendCount = 0;\n        _.forEach(player.relationships, (relationship, stringId) => {\n            const villainId = parseInt(stringId);\n            const [edge, friends] = generateEdge(player, getById(gameState, villainId), relationship);\n            friendCount += friends;\n            if (villainId > player.id) {\n                if (edge) {\n                    edges.add(player.id, villainId);\n                    edges.add(villainId, player.id);\n                }\n            }\n        });\n        // nodes[player.id] = friendCount; TODO: for pivot later on, thats why friendcount is there unused\n        nodes.push(player.id);\n    });\n    return { nodes, neighbors: (v: number) => edges.data[v] || new Set([]) };\n}\n","import { GameState, getById } from \"../model\";\nimport generateGraph from \"./generateGraph\";\n\nlet result: number[][] = [];\nexport interface Graph {\n    nodes: number[];\n    neighbors: (v: number) => Set<number>;\n}\n\nexport function generateCliques(gameState: GameState): number[][] {\n    const g = generateGraph(gameState);\n    result = [];\n    bronKerbosch(new Set<number>([]), new Set(g.nodes), new Set<number>([]), g);\n    result.forEach((clique) => clique.map((id) => getById(gameState, id)));\n    result = result.filter((clique) => clique.length > 2).sort((a, b) => b.length - a.length);\n    return result;\n}\n\nfunction bronKerbosch(r: Set<number>, p: Set<number>, x: Set<number>, g: Graph) {\n    if (p.size === 0 && x.size === 0) {\n        const values = Array.from(r.values());\n        result.push(values);\n        return;\n    }\n    Array.from(p.keys()).forEach((v) => {\n        const rPrime = new Set(r.values()).add(v);\n        const pPrime = new Set([...p].filter((node) => g.neighbors(v).has(node)));\n        const xPrime = new Set([...x].filter((node) => g.neighbors(v).has(node)));\n        bronKerbosch(rPrime, pPrime, xPrime, g);\n        p.delete(v);\n        x.add(v);\n    });\n}\n","import {\n    GameState,\n    MutableGameState,\n    calculatePopularity,\n    nonEvictedHouseguests,\n    inJury,\n    getJurors,\n} from \"../../model/gameState\";\nimport { Episode, Houseguest } from \"../../model\";\nimport { EpisodeType } from \"./episodes\";\nimport { BigBrotherVanilla, generateBbVanilla } from \"./bigBrotherEpisode\";\nimport { BigBrotherFinale, generateBbFinale } from \"./bigBrotherFinale\";\nimport { rng, roundTwoDigits } from \"../../utils\";\nimport { doesHeroWinTheFinale as heroWinsTheFinale } from \"../../utils/ai/aiUtils\";\nimport { classifyRelationship, RelationshipType as Relationship } from \"../../utils/ai/classifyRelationship\";\nimport { PowerRanking } from \"../../model/powerRanking\";\nimport { GameOver, generateGameOver } from \"./gameOver\";\nimport { EpisodeLog } from \"../../model/logging/episodelog\";\nimport { generateCliques } from \"../../utils/graphTest\";\n\nfunction firstImpressions(houseguests: Houseguest[]) {\n    for (let i = 0; i < houseguests.length; i++) {\n        const iMap = houseguests[i].relationships;\n        for (let j = i + 1; j < houseguests.length; j++) {\n            // creates a bunch of 100% random mutual relationships\n            const jMap = houseguests[j].relationships;\n            const impression = rng().randomFloat();\n            jMap[i] = impression;\n            iMap[j] = impression;\n        }\n    }\n}\n\nfunction populateSuperiors(houseguests: Houseguest[]) {\n    for (let i = 0; i < houseguests.length; i++) {\n        const hero = houseguests[i];\n        for (let j = i + 1; j < houseguests.length; j++) {\n            const villain = houseguests[j];\n            if (heroWinsTheFinale({ hero, villain }, houseguests)) {\n                villain.superiors.add(hero.id);\n            } else {\n                hero.superiors.add(villain.id);\n            }\n        }\n    }\n}\n\nfunction updatePowerRankings(houseguests: Houseguest[]) {\n    houseguests.forEach((hg) => {\n        hg.powerRanking = new PowerRanking(\n            houseguests.length - 1 - hg.superiors.size,\n            houseguests.length - 1\n        );\n    });\n}\n\nfunction updatePopularity(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach((hg) => {\n        const result = calculatePopularity(hg, nonEvictedHouseguests(gameState));\n        hg.deltaPopularity = (roundTwoDigits(result) - roundTwoDigits(hg.popularity)) / 100;\n        hg.popularity = result;\n    });\n}\n\nfunction updateFriendCounts(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach((hero) => {\n        hero.getFriendEnemyCount = () => {\n            let friends = 0;\n            let enemies = 0;\n            houseguests.forEach((villain) => {\n                const rel = classifyRelationship(\n                    hero.popularity,\n                    villain.popularity,\n                    hero.relationshipWith(villain)\n                );\n                if (hero.id === villain.id) {\n                    return;\n                } else if (rel === Relationship.Friend) {\n                    friends++;\n                } else if (rel === Relationship.Enemy) {\n                    enemies++;\n                }\n            });\n            return { friends, enemies };\n        };\n    });\n}\n\nexport class EpisodeFactory {\n    public nextEpisode(gameState: GameState, episodeType: EpisodeType): Episode {\n        let newState = new MutableGameState(gameState);\n        if (gameState.phase === 0) {\n            firstImpressions(newState.houseguests);\n        }\n        newState.phase++;\n        if (nonEvictedHouseguests(gameState).length > 2) {\n            newState.log[newState.phase] = new EpisodeLog();\n        }\n        // If jury starts this episode, populate superior/inferior data. In the future, every jury ep. (dynamic rels)\n        if (inJury(gameState) && getJurors(gameState).length === 0) {\n            populateSuperiors(nonEvictedHouseguests(newState));\n        }\n        if (inJury(gameState)) {\n            updatePowerRankings(nonEvictedHouseguests(newState));\n        }\n        updatePopularity(newState);\n        updateFriendCounts(newState);\n        newState.cliques = generateCliques(newState);\n        const finalState = new GameState(newState);\n        switch (episodeType) {\n            case BigBrotherVanilla:\n                return generateBbVanilla(finalState);\n            case BigBrotherFinale:\n                return generateBbFinale(finalState);\n            case GameOver:\n                return generateGameOver(finalState);\n            default:\n                throw new Error(\"Unsupported Episode Type\");\n        }\n    }\n}\n","import {\n    MutableGameState,\n    getById,\n    inJury,\n    nonEvictedHouseguests,\n    GameState,\n    Houseguest,\n    EpisodeType,\n    Episode,\n    InitEpisode,\n} from \"../../model\";\nimport { getFinalists, finalJurySize } from \"../../model/season\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateNomCeremonyScene } from \"./scenes/nomCeremonyScene\";\nimport { generateVetoCompScene } from \"./scenes/vetoCompScene\";\nimport { generateVetoCeremonyScene } from \"./scenes/vetoCeremonyScene\";\nimport { generateEvictionScene } from \"./scenes/evictionScene\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Scene } from \"./scene\";\nimport { HasText } from \"../layout/text\";\nimport styled from \"styled-components\";\nimport { weekStartTab$ } from \"../../subjects/subjects\";\nimport { WeekStartWrapper } from \"./bigBrotherWeekstartWrapper\";\n\nexport const BigBrotherVanilla: EpisodeType = {\n    canPlayWith: (n: number) => {\n        return n > 1;\n    },\n    eliminates: 1,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n};\n\nconst TabItem = styled.li`\n    cursor: pointer;\n`;\n\n// Refactoring ideas\n/**\n * Might be best to start passing ids instead of houseguests for HoH/nominees/veto winner\n */\n\nexport function evictHouseguest(gameState: MutableGameState, id: number) {\n    const evictee = getById(gameState, id);\n    if (gameState.currentLog) gameState.currentLog.evicted = evictee.id;\n    evictee.isEvicted = true;\n    if (gameState.remainingPlayers - getFinalists() <= finalJurySize()) {\n        evictee.isJury = true;\n    }\n    if (inJury(gameState)) {\n        nonEvictedHouseguests(gameState).forEach((hg) => {\n            hg.superiors.delete(evictee.id);\n        });\n    }\n    gameState.remainingPlayers--;\n}\n\nfunction Tab(props: { text: string; active: number; id: number; setActive: any }): JSX.Element {\n    return (\n        <TabItem\n            className={props.active === props.id ? \"is-active\" : \"\"}\n            onClick={() => {\n                props.setActive(props.id);\n                weekStartTab$.next(props.id);\n            }}\n        >\n            <a>{props.text}</a>\n        </TabItem>\n    );\n}\n\nfunction Tabs(): JSX.Element {\n    const [active, setActive] = React.useState(weekStartTab$.value);\n    return (\n        <div className=\"tabs is-centered is-fullwidth is-medium\" style={{ marginBottom: 0 }}>\n            <ul style={{ paddingLeft: 0 }}>\n                <Tab text={\"Memory Wall\"} active={active} setActive={setActive} id={0} />\n                <Tab text={\"Alliances\"} active={active} setActive={setActive} id={1} />\n            </ul>\n        </div>\n    );\n}\n\nexport function generateBbVanilla(initialGamestate: GameState): BigBrotherVanillaEpisode {\n    let currentGameState;\n    let hohCompScene;\n    let hoh: Houseguest;\n    const scenes = [];\n    [currentGameState, hohCompScene, hoh] = generateHohCompScene(initialGamestate);\n    scenes.push(hohCompScene);\n\n    let nomCeremonyScene;\n    let nominees: Houseguest[];\n    [currentGameState, nomCeremonyScene, nominees] = generateNomCeremonyScene(currentGameState, hoh);\n    scenes.push(nomCeremonyScene);\n\n    let vetoCompScene;\n    let povWinner: Houseguest;\n    [currentGameState, vetoCompScene, povWinner] = generateVetoCompScene(\n        currentGameState,\n        hoh,\n        nominees[0],\n        nominees[1]\n    );\n    scenes.push(vetoCompScene);\n    let vetoCeremonyScene;\n\n    [currentGameState, vetoCeremonyScene, nominees] = generateVetoCeremonyScene(\n        currentGameState,\n        hoh,\n        nominees,\n        povWinner\n    );\n    scenes.push(vetoCeremonyScene);\n\n    let evictionScene;\n    [currentGameState, evictionScene] = generateEvictionScene(currentGameState, hoh, nominees);\n    scenes.push(evictionScene);\n\n    const title = `Week ${currentGameState.phase}`;\n    const content = (\n        <HasText>\n            <Tabs />\n            <WeekStartWrapper gameState={initialGamestate} />\n            <br />\n            {currentGameState.phase === 1 && <b>Try clicking on houseguests to view their relationships.</b>}\n            <br />\n            <NextEpisodeButton />\n        </HasText>\n    );\n    const gameState = new GameState(currentGameState);\n    return new BigBrotherVanillaEpisode({\n        title,\n        scenes,\n        content,\n        gameState,\n        initialGamestate,\n        type: BigBrotherVanilla,\n    });\n}\nexport class BigBrotherVanillaEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly initialGamestate: GameState;\n    readonly gameState: GameState;\n    readonly type = BigBrotherVanilla;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n        this.initialGamestate = init.initialGamestate || init.gameState;\n    }\n}\n","import { GameState, Houseguest, MutableGameState, randomPlayer } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { HoHVote } from \"../../../model/logging/voteType\";\n\nexport function generateHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    const previousHoh = initialGameState.previousHOH ? [initialGameState.previousHOH] : [];\n    const newHoH: Houseguest = randomPlayer(newGameState.houseguests, previousHoh);\n    newGameState.previousHOH = newHoH;\n    newGameState.currentLog.votes[newHoH.id] = new HoHVote();\n\n    newHoH.hohWins += 1;\n\n    const scene = new Scene({\n        title: \"HoH Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>\n                    {previousHoh.length > 0 &&\n                        `Houseguests, it's time to find a new Head of Household. As outgoing HoH, ${previousHoh[0].name} will not compete. `}\n                </Centered>\n                <Portrait centered={true} houseguest={newHoH} />\n                <CenteredBold>{newHoH.name} has won Head of Household!</CenteredBold>\n                <br />\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n\n    return [new GameState(newGameState), scene, newHoH];\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    exclude,\n    nonEvictedHouseguests,\n    getById\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { shuffle } from \"lodash\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { nominateNPlayers } from \"../../../utils/ai/aiApi\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\n\nexport function generateNomCeremonyScene(\n    initialGameState: GameState,\n    HoH: Houseguest\n): [GameState, Scene, Houseguest[]] {\n    const newGameState = new MutableGameState(initialGameState);\n    const options = exclude(nonEvictedHouseguests(newGameState), [HoH]);\n    const nom1 = getById(newGameState, nominateNPlayers(HoH, options, newGameState, 2)[0].decision);\n    const nom2 = getById(\n        newGameState,\n        nominateNPlayers(HoH, exclude(options, [nom1]), newGameState, 2)[1].decision\n    );\n    nom1.nominations++;\n    nom2.nominations++;\n    newGameState.currentLog.nominationsPreVeto = [nom1.name, nom2.name];\n    const noms = shuffle([nom1, nom2]);\n    const scene = new Scene({\n        title: \"Nomination Ceremony\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    This is the nomination ceremony. It is my responsibility as the Head of Household to\n                    nominate two houseguests for eviction.\n                </Centered>\n                <Portrait centered={true} houseguest={HoH} />\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Centered> My first nominee is...</Centered>\n                        <Portrait centered={true} houseguest={noms[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Centered>My second nominee is...</Centered>\n                        <Portrait centered={true} houseguest={noms[1]} />\n                    </DividerBox>\n                </div>\n                <CenteredBold>{`I have nominated you, ${noms[0].name} and you, ${noms[1].name} for eviction.`}</CenteredBold>\n                <br />\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene, [nom1, nom2]];\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\n\nexport function generateVetoCompScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    nom1: Houseguest,\n    nom2: Houseguest\n): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    // pick players\n    const choices = nonEvictedHouseguests(newGameState);\n    let povPlayers: any[] = [];\n    const everyoneWillPlay = choices.length <= 6;\n\n    if (everyoneWillPlay) {\n        povPlayers.push({ ...HoH });\n        povPlayers.push({ ...nom1 });\n        povPlayers.push({ ...nom2 });\n        while (povPlayers.length < choices.length) {\n            povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        }\n    } else {\n        // TODO: houseguests choice picks\n        povPlayers.push({ ...HoH });\n        povPlayers.push({ ...nom1 });\n        povPlayers.push({ ...nom2 });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n    }\n    let povWinner = randomPlayer(povPlayers);\n    povWinner = getById(newGameState, povWinner.id);\n    povWinner.povWins++;\n    newGameState.currentLog.vetoWinner = povWinner.name;\n    let introText: string;\n    if (everyoneWillPlay) {\n        introText = \"Everyone left in the house will compete in this challenge.\";\n    } else {\n        introText = `${HoH.name}, as Head of Household, and ${nom1.name} and ${nom2.name} as nominees, will compete, as well as 3 others chosen by random draw.`;\n    }\n    const extras = [povPlayers[3]];\n    povPlayers[4] && extras.push(povPlayers[4]);\n    povPlayers[5] && extras.push(povPlayers[5]);\n    const scene = new Scene({\n        title: \"Veto Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>It's time to pick players for the veto competition.</Centered>\n                <Portraits centered={true} houseguests={[HoH, nom1, nom2]} />\n                <Centered>{introText}</Centered>\n                <Portraits centered={true} houseguests={extras} />\n                <Centered>...</Centered>\n                <Portraits centered={true} houseguests={[povWinner]} />\n                <CenteredBold>{`${povWinner.name} has won the Golden Power of Veto!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene, povWinner];\n}\n","import { GameState, Houseguest, getById, exclude } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { useGoldenVeto, nominateNPlayers } from \"../../../utils/ai/aiApi\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\n\nexport function generateVetoCeremonyScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    initialNominees: Houseguest[],\n    povWinner: Houseguest\n): [GameState, Scene, Houseguest[]] {\n    let povTarget: Houseguest | null = null;\n    let descisionText = \"\";\n    initialNominees[0] = getById(initialGameState, initialNominees[0].id);\n    initialNominees[1] = getById(initialGameState, initialNominees[1].id);\n    HoH = getById(initialGameState, HoH.id);\n    const vetoChoice = useGoldenVeto(povWinner, initialNominees, initialGameState);\n    povTarget = vetoChoice.decision;\n    if (!povTarget) {\n        descisionText += \"... not to use the power of veto.\";\n    } else if (povWinner.id == initialNominees[0].id || povWinner.id == initialNominees[1].id) {\n        descisionText += \"...to use the power of veto on myself.\";\n    } else {\n        descisionText += `...to use the power of veto on ${povTarget.name}.`;\n    }\n    let replacementSpeech = \"\";\n    let nameAReplacement = \"\";\n    let finalNominees: any[] = [...initialNominees];\n    if (povTarget) {\n        nameAReplacement += ` ${HoH.name}, since I have just vetoed one of your nominations, you must name a replacement nominee.`;\n        const replacementNom = {\n            ...getById(\n                initialGameState,\n                nominateNPlayers(\n                    HoH,\n                    exclude(initialGameState.houseguests, [\n                        HoH,\n                        initialNominees[0],\n                        initialNominees[1],\n                        povWinner\n                    ]),\n                    initialGameState,\n                    1\n                )[0].decision\n            )\n        };\n        const replacementIndex = initialNominees.findIndex(hg => hg.id === vetoChoice.decision!.id);\n        finalNominees[replacementIndex] = replacementNom;\n        replacementNom.nominations++;\n        getById(initialGameState, replacementNom.id).nominations++;\n        replacementSpeech = `My replacement nominee is ${replacementNom.name}.`;\n    }\n    const scene = new Scene({\n        title: \"Veto Ceremony\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>This is the Veto Ceremony.</Centered>\n                <Centered>\n                    {`${initialNominees[0].name} and ${initialNominees[1].name} have been nominated for eviction, \n                    but I have the power to veto one of these nominations.`}\n                </Centered>\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={initialNominees[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={initialNominees[1]} />\n                    </DividerBox>\n                </div>\n                <CenteredBold>\n                    I have decided... <br />\n                </CenteredBold>\n                <Portrait centered={true} houseguest={{ ...povWinner, tooltip: vetoChoice.reason }} />\n                <CenteredBold noMargin={true}>{descisionText}</CenteredBold>\n                <Centered>{nameAReplacement}</Centered>\n                {replacementSpeech && <Portrait centered={true} houseguest={HoH} />}\n                <CenteredBold>{replacementSpeech}</CenteredBold>\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={finalNominees[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={finalNominees[1]} />\n                    </DividerBox>\n                </div>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    initialGameState.currentLog.nominationsPostVeto = [finalNominees[0].name, finalNominees[1].name];\n    return [initialGameState, scene, finalNominees];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests, getById } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { shuffle } from \"lodash\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { evictHouseguest } from \"../bigBrotherEpisode\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NomineeVote, NormalVote, HoHVote } from \"../../../model/logging/voteType\";\n\nexport function generateEvictionScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    nominees: Houseguest[]\n): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    nominees = shuffle(nominees);\n    const votes: Array<ProfileHouseguest[]> = [[], []];\n    let lastVoter: Houseguest;\n    nonEvictedHouseguests(newGameState).forEach(hg => {\n        if (hg.id !== nominees[0].id && hg.id !== nominees[1].id && hg.id !== HoH.id) {\n            const logic = castEvictionVote(hg, nominees, newGameState);\n            const result: ProfileHouseguest = { ...hg };\n            result.tooltip = logic.reason;\n            newGameState.currentLog.votes[hg.id] = new NormalVote(nominees[logic.decision].id);\n            votes[logic.decision].push(result);\n            lastVoter = hg;\n        }\n    });\n    const votesFor0 = votes[0].length;\n    const votesFor1 = votes[1].length;\n    newGameState.currentLog.outOf = votesFor0 + votesFor1;\n    if (votesFor0 + votesFor1 === 1) {\n        newGameState.currentLog.soleVoter = lastVoter!!.name;\n    }\n    let tieVote = votesFor0 === votesFor1;\n    let tieBreaker = { decision: 0, reason: \"Error you should not be seeing this\" };\n    if (tieVote) {\n        newGameState.currentLog.outOf++;\n        tieBreaker = castEvictionVote(HoH, nominees, newGameState);\n        newGameState.currentLog.votes[HoH.id] = new HoHVote(nominees[tieBreaker.decision].id);\n    }\n    let evictee: Houseguest;\n    if (votesFor0 > votesFor1) {\n        evictee = nominees[0];\n        newGameState.currentLog.votesInMajority = votesFor0;\n    } else if (votesFor1 > votesFor0) {\n        evictee = nominees[1];\n        newGameState.currentLog.votesInMajority = votesFor1;\n    } else {\n        evictee = nominees[tieBreaker.decision];\n        newGameState.currentLog.votesInMajority = votesFor1 + 1;\n    }\n    newGameState.currentLog.votes[nominees[0].id] = new NomineeVote(evictee.id === nominees[0].id);\n    newGameState.currentLog.votes[nominees[1].id] = new NomineeVote(evictee.id !== nominees[0].id);\n\n    evictHouseguest(newGameState, evictee.id);\n    const isUnanimous = votesFor0 === 0 || votesFor1 === 0;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${votesFor0} to ${votesFor1}...`;\n\n    const displayHoH: ProfileHouseguest = { ...HoH };\n    displayHoH.tooltip = tieBreaker.reason;\n    const scene = new Scene({\n        title: \"Live Eviction\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[0]} centered={true} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[1]} centered={true} />\n                    </DividerBox>\n                </div>\n                {tieVote && (\n                    <div>\n                        <CenteredBold> We have a tie.</CenteredBold>\n                        <Centered>{`${HoH.name}, as current Head of Household, you must cast the sole vote to evict.`}</Centered>\n                        <Portraits houseguests={[displayHoH]} centered={true} />\n                        <CenteredBold>I vote to evict {`${evictee.name}.`}</CenteredBold>\n                    </div>\n                )}\n                <Portraits\n                    houseguests={[\n                        getById(newGameState, nominees[0].id),\n                        getById(newGameState, nominees[1].id)\n                    ]}\n                    centered={true}\n                />\n                <CenteredBold>{`${evictee.name}... you have been evicted from the Big Brother House.`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [newGameState, scene];\n}\n","import React from \"react\";\nimport { GameState, getById } from \"../../model\";\nimport { Portraits } from \"../playerPortrait/portraits\";\n\ninterface AllianceListProps {\n    gameState: GameState;\n}\n\nexport function AllianceList(props: AllianceListProps) {\n    const cliques = props.gameState.cliques;\n    const elements: JSX.Element[] = cliques.map((clique, i) => (\n        <Portraits\n            centered={true}\n            detailed={true}\n            key={`${clique}, ${i}, ${props.gameState.phase}`}\n            houseguests={clique.map((id) => getById(props.gameState, id))}\n        />\n    ));\n    return <div>{elements}</div>;\n}\n// TODO: clicking someone ON THE ALLIANCE PAGE shows only their alliances???\n","import React from \"react\";\nimport { GameState } from \"../../model\";\nimport { weekStartTab$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { AllianceList } from \"./allianceList\";\n\ninterface WeekStartWrapperProps {\n    gameState: GameState;\n}\n\ninterface WeekStartWrapperState {\n    tab: number;\n}\n\nexport class WeekStartWrapper extends React.Component<WeekStartWrapperProps, WeekStartWrapperState> {\n    private subs: Subscription[] = [];\n    constructor(props: Readonly<WeekStartWrapperProps>) {\n        super(props);\n        this.state = { tab: weekStartTab$.value };\n    }\n    componentDidMount() {\n        this.subs.push(weekStartTab$.subscribe((tab) => this.setState({ tab })));\n    }\n    componentWillUnmount() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    render() {\n        if (this.state.tab === 0) {\n            return <MemoryWall houseguests={this.props.gameState.houseguests} />;\n        }\n        return <AllianceList gameState={this.props.gameState} />;\n    }\n}\n","import { Subscription } from \"rxjs\";\nimport { Sidebar } from \"./sidebar\";\nimport { Season } from \"../../model/season\";\nimport { Episode, nonEvictedHouseguests, getById } from \"../../model\";\nimport { Scene } from \"../episode/scene\";\nimport {\n    mainContentStream$,\n    episodes$,\n    switchEpisode$,\n    newEpisode,\n    switchSceneRelative,\n    cast$,\n    getSelectedPlayer,\n    selectedPlayer$,\n    displayMode$,\n} from \"../../subjects/subjects\";\nimport { popularityMode } from \"../../model/portraitDisplayMode\";\n\ninterface IndexedScene {\n    scene: Scene;\n    index: number;\n}\n\nconst LEFT = 37;\nconst RIGHT = 39;\n\nexport class SidebarController {\n    private view: Sidebar;\n    private subscriptions: Subscription[] = [];\n    private season: Season = new Season();\n    private scenes: IndexedScene[] = [];\n    private selectedEpisode: number = 0;\n\n    public constructor(view: Sidebar) {\n        this.view = view;\n        this.subscriptions.push(\n            episodes$.subscribe({\n                next: (episode) => this.onNewEpisode(episode),\n            })\n        );\n        this.subscriptions.push(\n            switchEpisode$.subscribe({\n                next: (value: number) => {\n                    this.switchSceneRelative(value);\n                },\n            })\n        );\n        this.subscriptions.push(\n            cast$.subscribe({\n                next: () => {\n                    this.season = new Season();\n                    this.selectedEpisode = 0;\n                    displayMode$.next(popularityMode);\n                },\n            })\n        );\n    }\n\n    public getSelectedEpisode() {\n        return this.selectedEpisode;\n    }\n\n    public async switchToScene(id: number) {\n        mainContentStream$.next(this.scenes[id].scene.render);\n        this.selectedEpisode = this.scenes[id].index;\n        await this.view.setState({ selectedScene: id });\n        if (getSelectedPlayer() !== null) {\n            selectedPlayer$.next(\n                getById(this.scenes[this.view.state.selectedScene].scene.gameState, getSelectedPlayer()!.id)\n            );\n        }\n    }\n\n    private switchSceneRelative = (delta: number) => {\n        const selectedScene = this.view.state.selectedScene;\n        const renderedScenes = this.scenes.length;\n        const targetScene = selectedScene + delta;\n        if (targetScene < 0) {\n            return;\n        }\n        const lastEpisode = this.view.state.episodes[this.view.state.episodes.length - 1];\n        if (targetScene < renderedScenes) {\n            // Go back to an earlier scene\n            this.switchToScene(targetScene);\n        } else if (targetScene === renderedScenes) {\n            // Generate a new scene, then jump to it\n            const currentGameState = lastEpisode.gameState;\n            const newPlayerCount = nonEvictedHouseguests(lastEpisode.gameState).length;\n            const nextEpisodeType = this.season.whichEpisodeType(newPlayerCount);\n            if (newPlayerCount > 0) {\n                newEpisode(this.season.renderEpisode(currentGameState, nextEpisodeType));\n                this.switchSceneRelative(1);\n            }\n        }\n    };\n\n    get handleKeyDown(): (e: any) => void {\n        return this._handleKeyDown.bind(this);\n    }\n\n    private _handleKeyDown(event: any) {\n        const state = this.view.state;\n        if (\n            state.episodes[this.selectedEpisode] === undefined ||\n            !state.episodes[this.selectedEpisode].type.arrowsEnabled\n        ) {\n            return;\n        }\n        if (event.keyCode === LEFT) {\n            switchSceneRelative(-1);\n        } else if (event.keyCode === RIGHT) {\n            switchSceneRelative(1);\n        }\n    }\n\n    private onNewEpisode(episode: Episode | null) {\n        if (!episode) {\n            this.view.setState({ episodes: [], selectedScene: 0 });\n            this.scenes = [];\n        } else {\n            const newState = { ...this.view.state };\n            // starts at -1: prevent OBOE\n            const latestIndex = this.scenes.length === 0 ? -1 : this.scenes[this.scenes.length - 1].index;\n            const index = latestIndex + 1;\n            this.scenes.push({ scene: episode, index });\n            episode.scenes.forEach((scene) => this.scenes.push({ scene, index }));\n            newState.episodes.push(episode);\n            this.view.setState(newState);\n        }\n    }\n\n    public destroy() {\n        this.subscriptions.forEach((sub) => sub.unsubscribe());\n    }\n}\n","import React from \"react\";\nimport { SidebarController } from \"./sidebarController\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { Episode, GameState } from \"../../model\";\nimport { Scene } from \"../episode/scene\";\nimport { newEpisode } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\nimport { HasText } from \"../layout/text\";\ninterface SidebarState {\n    episodes: Episode[];\n    selectedScene: number;\n}\n\nexport class Sidebar extends React.Component<{}, SidebarState> {\n    private controller: SidebarController;\n    public constructor(props: {}) {\n        super(props);\n        this.controller = new SidebarController(this);\n        this.state = { episodes: [], selectedScene: 0 };\n        newEpisode(new PregameEpisode(new GameState([])));\n    }\n\n    public componentDidMount() {\n        document.addEventListener(\"keydown\", this.controller.handleKeyDown);\n    }\n\n    public componentWillUnmount() {\n        this.controller.destroy();\n    }\n\n    public render() {\n        return (\n            <Box style={{ minWidth: 180 }}>\n                <HasText>{this.getEpisodes()}</HasText>\n            </Box>\n        );\n    }\n\n    private getHighlight(title: string, key: number) {\n        if (key === this.state.selectedScene) {\n            return <mark>{title}</mark>;\n        }\n        return title;\n    }\n\n    private getEpisodes() {\n        const result: JSX.Element[] = [];\n        // Weird OBOE to make keys start at 0\n        let episodeKey = -1;\n        let breakKey = 0;\n        this.state.episodes.forEach((episode: Episode) => {\n            const id = ++episodeKey;\n            result.push(\n                <b\n                    key={id}\n                    onClick={() => {\n                        this.controller.switchToScene(id);\n                    }}\n                >\n                    {this.getHighlight(episode.title, id)}\n                </b>\n            );\n            result.push(<br key={--breakKey} />);\n            episode.scenes.forEach((scene: Scene) => {\n                const id = ++episodeKey;\n                if (this.controller.getSelectedEpisode() === episode.gameState.phase) {\n                    result.push(\n                        <a key={id} onClick={() => this.controller.switchToScene(id)}>\n                            {this.getHighlight(scene.title, id)}\n                        </a>\n                    );\n                    result.push(<br key={--breakKey} />);\n                }\n            });\n        });\n        return result;\n    }\n}\n","import styled from \"styled-components\";\nimport React from \"react\";\nimport { mainContentStream$ } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\n\nconst MainContentAreaWrapper = styled(Box)`\n    overflow-x: auto;\n`;\n\nexport class MainContentArea extends React.Component<{}, { content: any }> {\n    // a simple class that displays whatever it gets fed through the main content stream.\n\n    private contentStream: any;\n\n    public constructor(props: any) {\n        super(props);\n        this.state = { content: null };\n    }\n\n    public componentDidMount() {\n        this.contentStream = mainContentStream$.subscribe((content) => {\n            this.setState({ content });\n        });\n    }\n\n    public componentDidUpdate(prevProps: never, prevState: any) {\n        if (prevState.content !== this.state.content) {\n            window.scrollTo(0, 0);\n        }\n    }\n\n    public componentWillUnmount() {\n        this.contentStream.unsubscribe();\n    }\n\n    public render() {\n        return <MainContentAreaWrapper>{this.state.content}</MainContentAreaWrapper>;\n    }\n}\n","import \"./bulma.scss\";\nimport React from \"react\";\nimport { Sidebar } from \"../sidebar/sidebar\";\nimport { Topbar } from \"../topbar/topBar\";\nimport { MainContentArea } from \"./mainContentArea\";\nimport { MainPageController } from \"./mainPageController\";\n\ninterface MainPageProps {\n    controller: MainPageController;\n}\n\ninterface MainPageState {\n    fullscreen: boolean;\n}\n\nexport class MainPage extends React.Component<MainPageProps, MainPageState> {\n    public constructor(props: MainPageProps) {\n        super(props);\n        this.state = { fullscreen: false };\n        props.controller.inject(this);\n    }\n    public componentDidMount() {\n        this.props.controller.subscribe();\n    }\n    public componentWillUnmount() {\n        this.props.controller.unsubscribe();\n    }\n\n    public render() {\n        const fullscreen = this.state.fullscreen;\n        const hideOnFullscreen = { display: fullscreen ? \"none\" : \"\" };\n        const wrapperStyle = fullscreen\n            ? { margin: \"auto\" }\n            : { margin: \"auto\", maxWidth: 1380, overflow: \"hidden\" };\n        return (\n            <div style={wrapperStyle}>\n                <Topbar style={hideOnFullscreen} />\n                <div className=\"columns\">\n                    <div className=\"column is-narrow\" style={hideOnFullscreen}>\n                        <Sidebar />\n                    </div>\n\n                    <div className=\"column\" style={{ overflowX: \"hidden\" }}>\n                        <MainContentArea />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","import { MainPage } from \"./mainPage\";\nimport { Subscription } from \"rxjs\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\n\nexport class MainPageController {\n    private view: MainPage = new MainPage({ controller: this });\n    private subscriptions: Subscription[] = [];\n    public inject(page: MainPage) {\n        this.view = page;\n    }\n\n    public subscribe(): void {\n        this.unsubscribe();\n        this.subscriptions.push(\n            isFullscreen$.subscribe((fullscreen: boolean) => {\n                this.view.setState({ fullscreen });\n            })\n        );\n    }\n\n    public unsubscribe(): void {\n        this.subscriptions.forEach(sub => sub.unsubscribe());\n    }\n}\n","import { createGlobalStyle } from \"styled-components\";\nimport { ColorTheme } from \"./theme\";\n\nexport const GlobalStyles = createGlobalStyle`\n  *,\n  *::after,\n  *::before {\n    box-sizing: border-box;\n  }\n\n  body {\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bg};\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n       transition: all 0.25s linear;\n  }`;\n","import React from \"react\";\nimport { MainPage } from \"./components/mainPage/mainPage\";\nimport { MainPageController } from \"./components/mainPage/mainPageController\";\nimport { ThemeProvider } from \"styled-components\";\nimport { lightTheme, ColorTheme, darkTheme } from \"./theme/theme\";\nimport { GlobalStyles } from \"./theme/globalTheme\";\nimport { theme$ } from \"./subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nclass App extends React.Component<{}, { theme: ColorTheme }> {\n    private sub: Subscription | null = null;\n    public constructor(props: any) {\n        super(props);\n        this.state = {\n            theme:\n                window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches\n                    ? darkTheme\n                    : lightTheme,\n        };\n    }\n\n    public componentDidMount() {\n        this.sub = theme$.subscribe((theme) => {\n            this.setState({ theme });\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    render() {\n        return (\n            <ThemeProvider theme={this.state.theme}>\n                <>\n                    <GlobalStyles />\n                    <MainPage controller={new MainPageController()} />\n                </>\n            </ThemeProvider>\n        );\n    }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {});\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {});\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {});\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}