{"version":3,"sources":["model/houseguest.ts","model/playerProfile.ts","utils/utilities.ts","utils/relationshipMap.ts","model/color.ts","utils/ai/classifyRelationship.ts","components/playerPortrait/subtitle.tsx","model/portraitDisplayMode.ts","components/playerPortrait/selectedPortrait.ts","subjects/subjects.tsx","components/playerPortrait/houseguestPortraitController.ts","components/playerPortrait/houseguestPortrait.tsx","components/playerPortrait/houseguestToPortrait.tsx","components/playerPortrait/setupPortrait.tsx","components/tooltip/tooltip.tsx","components/playerPortrait/portraits.tsx","components/memoryWall/memoryWall.tsx","components/layout/text.ts","components/castingScreen/numericInput.tsx","components/castingScreen/randomXButton.tsx","components/layout/centered.tsx","components/episode/allianceList.tsx","components/viewsBar/viewBarTag.tsx","components/viewsBar/viewBar.tsx","components/seasonEditor/seasonEditorList.tsx","components/seasonEditor/twistAdder.tsx","components/episode/episodes.tsx","components/episode/bigBrotherEpisode.tsx","components/episode/scenes/scene.tsx","components/nextEpisodeButton/nextEpisodeButton.tsx","components/mainPage/fullscreenButton.tsx","components/votingTable/votingTable.tsx","model/logging/voteType.tsx","utils/listStrings.ts","components/episode/scenes/hohCompScene.tsx","components/layout/box.tsx","utils/fft.ts","utils/poissonbinomial.ts","utils/ai/aiUtils.ts","utils/ai/targets.ts","utils/ai/aiApi.ts","components/episode/scenes/botbNomCeremonyScene.tsx","components/episode/veto/veto.tsx","components/episode/botbEpisode.tsx","components/episode/scenes/botbScene.tsx","components/episode/boomerangVetoEpisode.tsx","components/episode/scenes/nomCeremonyScene.tsx","components/episode/scenes/vetoCompScene.tsx","components/episode/scenes/vetoCeremonyScene.tsx","components/episode/utilities/evictHouseguest.ts","model/season.ts","model/gameState.ts","components/episode/scenes/evictionScene.tsx","components/episode/coHoHEpisode.tsx","components/episode/diamondVetoEpisode.tsx","components/episode/doubleEvictionEpisode.tsx","components/episode/forcedVetoEpisode.tsx","components/episode/instantEvictionEpisode.tsx","components/episode/noVetoEpisode.tsx","components/episode/pregameEpisode.tsx","components/episode/tripleEvictionEpisodeCad.tsx","model/tribe.ts","components/seasonEditor/teamsAdder.tsx","components/seasonEditor/teamsAdderList.tsx","model/logging/episodelog.ts","components/seasonEditor/getEpisodeLibrary.tsx","components/episode/safetyChain.tsx","components/episode/scenes/safetyChainScene.tsx","components/seasonEditor/seasonEditorPage.tsx","components/castingScreen/castingScreen.tsx","components/deckScreen/deckScreen.tsx","components/topbar/topBar.tsx","components/pregameScreen/pregameScreen.tsx","utils/BbRandomGenerator.ts","utils/generateGraph.ts","utils/generateCliques.ts","components/episode/episodeFactory.ts","components/episode/bigBrotherWeekstartWrapper.tsx","components/episode/scenes/juryVoteScene.tsx","components/episode/bigBrotherFinale.tsx","components/episode/scenes/finalHohCompScene.tsx","components/episode/scenes/finalEvictionScene.tsx","components/episode/gameOver.tsx","components/sidebar/sidebarController.ts","components/sidebar/sidebar.tsx","components/mainPage/mainContentArea.tsx","components/mainPage/mainPage.tsx","components/mainPage/mainPageController.ts","theme/theme.ts","theme/globalTheme.ts","App.tsx","index.tsx"],"names":["Houseguest","_PlayerProfile","init","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","isEvicted","isJury","tribe","id","nominations","hohWins","povWins","compatibility","popularity","deltaPopularity","previousPopularity","relationships","targets","powerRanking","superiors","friends","enemies","targetingMe","assign","assertThisInitialized","inherits","createClass","key","value","villain","PlayerProfile","name","imageURL","castingScreenId","roundTwoDigits","number","Math","round","intersection","setA","setB","_intersection","Set","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","elem","has","add","err","return","difference","_difference","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","delete","isWellDefined","x","isNotWellDefined","magnitude","result","forEach","pow","angleBetween","y","length","Error","concat","acos","_","i","dot","newRelationshipMap","size","exclude","componentToHex","c","hex","toString","RelationshipType","TwoWayRelationshipType","Rgb","r","g","b","getRandomColor","floor","random","interpolateColor","min","max","percent","toHex","textColor","bg","color","charAt","substring","parseInt","map","col","RelationshipTypeToSymbol","FRIEND","ENEMY","PAWN","QUEEN","classifyRelationship","heroPopularity","villainPopularity","relationship","benefitsHero","benefitsVillain","Friend","Pawn","Queen","Enemy","classifyTwoWayRelationship","PawnQueen","heroIsPregame","hero","addPopularityLine","state","detailed","subtitle","popularitySubtitle","deltaPop","houseguest","statePopularity","getDeltaPopularity","push","react_default","a","createElement","addCompsLine","compWins","style","lineHeight","popularityMinColor","popularityMaxColor","popularityMode","minColor","maxColor","backgroundColor","extremePopularity","xSquared","extremeValues","generateSubtitle","_addFriendshipCountTi","data","getSelectedPlayer","titles","friendOrEnemyTitle","txt","count","Relationship","friendEnemyCountTitle","addFriendshipCountTitles","arguments","powerMaxColor","powerMinColor","powerMode","selectPlayer","player","selectedPlayer$","displayMode$","keys","selectCastPlayer","selectedCastPlayers","selectedCastPlayer$","selectedColor","HouseguestPortraitController","view","subs","refreshData","props","setState","comparePowerRankings","defaultState","shuffle","selectedPlayer","displayMode","_this2","subscribe","sub","unsubscribe","get","Subtitle","styled","small","_templateObject","MemoryWallPortrait","div","_templateObject2","_ref","theme","portraitBorder","Evicted","_templateObject3","Jury","_templateObject4","Normal","img","_templateObject5","Grayscale","_templateObject6","Sepia","_templateObject7","HouseguestPortrait","_React$Component","controller","Img","imageClass","getImageClass","tribeStyle","Portrait","borderTop","borderBottom","TribeStyle","imageStyle","height","width","onClick","src","React","Component","_templateObject8","houseguestToPortrait","houseguestPortrait_HouseguestPortrait","EditPortrait","setupPortrait_templateObject","unselectable","Noselect","setupPortrait_templateObject2","XButton","setupPortrait_templateObject3","EditButton","setupPortrait_templateObject4","SetupPortrait","selected","textAlign","maxHeight","display","onDoubleClick","onDelete","event","stopPropagation","onRename","imageUrl","common","Text","p","tooltip_templateObject","WideText","tooltip_templateObject2","Tooltip","visible","Txt","wide","Popover_default","position","isOpen","content","text","onMouseEnter","onMouseLeave","children","PortraitWrapper","className","centered","tooltip","tooltip_Tooltip","Portraits","rows","houseguests","justifyContent","alignItems","memoryWallPortrait","MemoryWall","margin","maxWidth","HasText","text_templateObject","Input","input","text_templateObject2","_ref2","NumericInputStyle","numericInput_templateObject","NumericInput","type","placeholder","onChange","target","test","RandomButton","_useState","useState","_useState2","slicedToArray","setNumber","disabled","NoMargin","centered_templateObject","Center","centered_templateObject2","Centered","noMargin","CenteredBold","CenteredItallic","HelpLink","allianceList_templateObject","link","AllianceList","canDisplayCliques","gameState","elements","cliques","clique","affiliates","phase","core","getById","entries","toConsumableArray","href","rel","ViewBarTag","mode","_this3","background","toRgba","cursor","setDisplayMode","ViewsBar","inJury","marginBottom","viewBarTag_ViewBarTag","InvalidDragItem","seasonEditorList_templateObject","DragItem","seasonEditorList_templateObject2","_items","_castSize","ListItem","item","provided","snapshot","Item","isValid","ref","innerRef","draggableProps","dragHandleProps","weekText","episode","BigBrotherVanilla","getEmoji","twistCapacity$","BehaviorSubject","shouldIncrement","items","pseudo","nextItem","chainable","j","nextNextItem","SeasonEditorList","castSize","week","newCapacity","twist","updateTwistCapacity","eliminates","maxCapacity","newItems","Array","from","nonChainableInsertAt","array","n","match","startAt","splice","removeFirstNMatching","chainableInsertAt","findIndex","index","newItem","refreshItems","removeLast1Matching","equalTeamsLookupIds","teamsLookupId","twist$","addRemoveTwist","addIndex","finalItems","playerCount","increment","isValidChain","canPlayWith","unshift","setTwistsValid","every","react_beautiful_dnd_esm","onDragEnd","destination","_newItems$splice","source","removed","droppableId","droppableProps","draggableId","seasonEditorList_ListItem","Subject","emoji","TwistAdder","twistCount","twistCapacity","overCapacity","atCapacity","isDisabled","border","borderRadius","description","Label","readOnly","Episode","initialGameState","scenes","title","initialGamestate","Tabs","bigBrotherWeekstartWrapper_WeekStartWrapper","NextEpisodeButton","viewsBar","hasViewsbar","viewBar_ViewsBar","Scene","GameState","players","jury","render","switchSceneRelative","FullscreenIcon","fullscreenButton_templateObject","FullscreenButton","isFullscreen$","getValue","PaddedCell","td","votingTable_templateObject","EndgameTableCell","votingTable_templateObject2","tableCellBorder","EndgameTable","table","votingTable_templateObject3","GrayCell","votingTable_templateObject4","_ref3","grayCell","SaveCell","votingTable_templateObject5","_ref4","saveCell","NotEligibleCell","votingTable_templateObject6","White","votingTable_templateObject7","_ref5","lightGrayCell","votingTable_templateObject8","_ref6","evictedCell","WinnerCell","_templateObject9","_ref7","winnerCell","RunnerUpCell","_templateObject10","_ref8","runnerUpCell","NomineeCell","_templateObject11","_ref9","nomineeCell","HohCell","_templateObject12","_ref10","hohCell","PoVCell","_templateObject13","BlackRow","tr","_templateObject14","anotherKey","generateVotingTable","masterLog","log","houseguestCells","hg","evictionOrder","topRowCells","preVetoCells","vetoCells","postVetoCells","evictedCells","winnerCells","logs","cells","colspan","colSpan","generateTopRow","pseudoCount","noNomsPreVeto","nominationsPreVeto","noVetoWinner","vetoWinner","noNomsPostveto","nominationsPostVeto","rowSpan","interleave","strikethroughNominees","generatePreVetoRow","generateVetoRow","generatePostVetoRow","saveOrEvict","soleVoter","votingTo","toLowerCase","customEvicted","names","customEvictedText","evicted","voteTextLine1","values","votes","filter","vote","votesInMajority","outOf","votingTable_Evicted","generateEvictedRow","runnerUp","winner","_arr","_i","_ref13","_ref12","WinnerVote","RunnerUpVote","winnerRow","topRow","preVetoRow","vetoRow","postVetoRow","houseguestRows","evictedRow","desiredLength","reverse","_ref14","_ref15","tempList","slice","blackRow","Number","MAX_SAFE_INTEGER","arr","thing","_ref16","apply","voteKey","getKey","SaveVote","NormalVote","NomineeVote","PoVvote","GrayVote","_this4","HoHVote","_this5","hohText","hohVote","TeamVote","_this6","EndTeamVote","_this7","listNames","join","generateHohCompScene","options","newGameState","MutableGameState","coHoH","coHohIsFinal","doubleEviction","previousHoh","previousHOH","competitors","newHoH","randomPlayer","newHoH2","skipHoHWin","currentLog","portraitLine","portraits_Portrait","wonText","bottomText","scene","customText","__logindex__","h","ShadowBox","box_templateObject","overlay","StyledBox","box_templateObject2","bodyArea","DividerBox","Box","fft","real","imag","levels","cosTable","sinTable","cos","PI","sin","reverseBits","temp","halfsize","tablestep","k","l","tpre","tpim","val","transformRadix2","m","areal","newArrayOfZeros","aimag","breal","bimag","creal","cimag","convolveComplex","transformBluestein","xreal","ximag","yreal","yimag","outreal","outimag","pbincdf","pp","zeros","ones","num","cdf","nPlusOne","ω","sigmaLogModulusZ","sum","p_j","e1","e2","sigmaPrincipalArgz","atan2","ceil","d","exp","sigmaArgZ","ξ","_pbincdf","pHeroWinsTheFinale","hgs","juror","pJurorVotesForHero","deadValue","pHeroWins","winrate","villianName","getRelationshipSummary","doIWin","WinrateStrategy","TargetStrategy","Targets","firstTarget","secondTarget","choices","backdoorNPlayers","nonEvictedHouseguests","decision","determineStrategy","MoR","StatusQuo","Underdog","isBetterTargetWithLogic","old","neww","reason","strategy","winrateStrategy","High","Low","Medium","determineWinrateStrategy","r0","r1","voteBasedonWinrate","voteBasedOnRelationship","isBetterTargetStatusQuo","morStrategy","targetEnemies","voteBasedOnCentrality","isBetterTargetMoR","underdogStrategy","isBetterTargetUnderdog","isBetterTarget","internalCallback","nominees","condition","_computeLocalPopulari","nonFriends","relationshipWith","oldPop","oldHg","newPop","newHg","computeLocalPopularity","isMoreCentral","callback","_targetEnemies","nom0","nom1","heroBeatsnom0","heroBeatsnom1","lowestIndex","lowestScore","Infinity","currentScore","castVoteToSave","currentSave","nominee","evictionTarget","castEvictionVote","remainingPlayers","castF3Vote","HoH","evictNom0","winningOddsF3","evictNom1","castF4vote","houseguestCache","villain1","villain2","heroVs1","heroVs2","v1Vs2","getWorstTarget","sortedOptions","sort","hg1","hg2","forcedOptions","nonTeammates","tribeId","option","generateBotbNomCeremonyScene","hoh1","hoh2","exclusions","noms1","noms2","nextNom","nom","block","noms","hoh","finalStatement","GoldenVeto","use","useGoldenVeto","DiamondVeto","checks","basicVetoChecks","ids1","ids2","worseTarget","SpotlightVeto","invertedDecision","BoomerangVeto","veto1","veto2","potentialSave","immunePlayers","BattleOfTheBlock","arrowsEnabled","generate","hohArray","hohCompScene","nomCeremonyScene","currentGameState","_generateHohCompScene","_generateHohCompScene2","botbscene","finalhoh","finalnoms","botbWinners","_generateBotbNomCerem","_generateBotbNomCerem2","_generateBotbScene","nomsArray","hoh0wins","rng","flipCoin","winners","require","hohIndex","nomIndex","block0","block1","w","generateBotbScene","_generateBotbScene2","vetostuff","generateVetoScenesOnwards","BoomerangVetoEpisode","generateBBVanillaScenes","generateNomCeremonyScene","hohList","nom3","nom2","thirdNominee","shuffleOrDont","myOur","theHoH","firstText","secondText","generateVetoCompScene","HoHs","veto","povPlayers","everyoneWillPlay","objectSpread","introText","povWinner","firstRow","extras","generateVetoCeremonyScene","initialNominees","immuneHgs","povTarget","descisionText","vetoChoice","nomineeWonPov","tousethepov","replacementSpeech","nameAReplacement","finalNominees","HoHnamer","replacementNomineeNamer","HoHwonPoV","aReplacementNominee","oneOf","you","exclusion","replacementNoms","v","replacementNom","nomineeNames","evictHouseguest","evictee","finalJurySize","refreshHgStats","updateDelta","getJurors","populateSuperiors","xi","average","house","targetId","calculatePopularity","updatePopularity","refreshTargets","getTargets","updateFriendCounts","generateEvictionScene","castVote","lastVoter","nonVoters","logic","voteCounts","pluralities","numbers","highest","reduce","acc","cur","getHighestIndicies","tieVote","tieBreaker","tieBreakerHg","tiebreakerDecision","voteType","evictees","safe","evicteesSet","votesPerEvictee","voteCountText","listVotes","compWinner","soleVoteText","displayHoH","marginTop","voters","CoHoH","vetoCompScene","_generateNomCeremonyS","_generateNomCeremonyS2","vetoCeremonyScene","_generateVetoCompScen","_generateVetoCompScen2","evictionScene","_generateVetoCeremony","_generateVetoCeremony2","_generateEvictionScen","_generateEvictionScen2","DiamondVetoEpisode","DoubleEviction","incrementLogIndex","ForcedVetoEpisode","InstantEviction","NoVeto","PregameEpisodeType","PregameEpisode","_Episode","pregameScreen_PregameScreen","cast","TripleEvictionCad","tripleScenes","getTribe","Team","team","onChangeName","onChangeColor","removeTeam","TeamsAdder","teams","Teams","addTeam","endsWhen","onChangeNumber","deleteSelf","_teams","TeamsAdderList","newState","bind","getTwist","teamsAdder_TeamsAdder","invertColor","getOnChangeName","getOnChangeColor","getOnDelete","getOnDeleteSelf","newTeam","EpisodeLog","hasLogBeenModified","getEpisodeLibrary","episodes","teamListContents","finalX","teamIdtoFinalX","Map","mappedItems","set","dynamicEpisodeType","logWasModified","hgid","totalPlayers","endsAt","startsAt","invalid","teamId","endTeamsEpisodeType","toDelete","playersRemaining","previousItem","pseudoItem","firstEpisode","secondEpisode","oldEpisode","newEpisode","SafetyChain","safetyChainScene","_generateSafetyChainS","chainOrder","HoHscene","chainStarter","safeSpots","currentChooser","sceneContent","first","newSafeIndex","indexOf","safetyComp2scene","safeHg","leftOut","_generateHohCompScene3","_generateHohCompScene4","generateSafetyChainScene","_generateSafetyChainS2","Subheader","h3","seasonEditorPage_templateObject","label","seasonEditorPage_templateObject2","twists","submit","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","season$","pushToMainContentStream","cast$","Screens","Other","stop","_x","SeasonEditorPage","castLength","defaultJurySize","jurySize","setJurySize","validJurySize","validateJurySize","_useState3","_useState4","areTwistsValid","seasonEditorList_SeasonEditorList","padding","twistAdder_TwistAdder","teamsAdderList_TeamsAdderList","paddingTop","paddingRight","float","CastingScreen","newCast","Season","_amount","amount","allPlayers","unselectedPlayers","selectedPlayers","handleUpload","handleFiles","files","handleDrop","newName","prompt","setupPortrait_SetupPortrait","deleteMethod","rename","FileDrop","onDrop","multiple","getFiles","file","substr","lastIndexOf","URL","createObjectURL","decksPerPage","baseUrl","imageCache","DeckStyle","deckScreen_templateObject","deckScreen_templateObject2","DeckText","deckScreen_templateObject3","_callee2","folder","links","image","_context2","abrupt","fetch","sent","json","sample","_callee3","casts","playerProfiles","_loop","_context4","imageLinks","folderProfiles","_context3","url","delegateYield","t1","finish","castingScreen_CastingScreen","Casting","Deck","_React$useState","_React$useState2","setImage","_React$useState3","_React$useState4","loading","setLoading","deck","randomImageFromFolder","then","selectDeckSubject","DeckList","decks","DeckScreen","handlePageClick","page","debounceSearch","debounce","nextValue","debouncedSearchText","handleSearch","searchText","sortedDecks","selectedDecks","isSorted","_componentDidMount","selectedDecks$","minWidth","submitCasts","deckScreen_Centered","dist_default","previousLabel","nextLabel","breakLabel","breakClassName","pageCount","marginPagesDisplayed","pageRangeDisplayed","onPageChange","containerClassName","activeClassName","activeScreen$","TopbarLink","topBar_templateObject","ActiveTopbarLink","topBar_templateObject2","CastingScreenLink","LinkStyle","JSON","parse","stringify","EditSeasonLink","ChooseCastLink","deckScreen_DeckScreen","Topbar","tab","PregameScreen","textShadow","mainContentStream$","episodes$","switchEpisode$","weekStartTab$","theme$","BbRandomGenerator","seed","prand","xorshift128plus","_this$rng$next","_this$rng$next2","_prand$uniformIntDist","uniformIntDistribution","_prand$uniformIntDist2","_this$rng$next3","_this$rng$next4","rng$","castNames","string","hash","charCodeAt","hashcode","inclusions","excludedIds","includes","randomInt","_GameState","jurors","_GameState2","_init","profiles","profile","_GameState3","copy","cloneDeep","EdgeMap","generateGraph","nodes","edges","stringId","villainId","_generateEdge","generateEdge","_generateEdge2","edge","neighbors","newCliquesLength","generateCliques","bronKerbosch","rPrime","pPrime","node","xPrime","mergeCandidates","clq","cliqueI","cliqueJ","affiliatesI","affiliatesJ","blacklist","candidate","nextEpisode","episodeType","u","randomFloat","abs","θ","φ","iMap","jMap","impression","firstImpressions","resetLogIndex","finalState","WeekStartWrapper","helpText1","helptext2","TabItem","li","bigBrotherEpisode_templateObject","Tab","active","setActive","paddingLeft","juryVoteScene","finalists","castJuryVote","votesFor0","votesFor1","BigBrotherFinale","finalHoH","finalEviction","_finalHohCompScene","final3","enduranceWinner","enduranceLosers","skillWinner","finalHohCompScene","_finalHohCompScene2","_finalEvictionScene","_castEvictionVote","survivor","finalEvictionScene","_finalEvictionScene2","_juryVoteScene","_juryVoteScene2","juryScene","GameOver","episodeLibrary","whichEpisodeType","SidebarController","subscriptions","season","selectedEpisode","delta","selectedScene","renderedScenes","targetScene","lastEpisode","switchToScene","renderEpisode","screen","selectionsActive","onNewEpisode","library","_switchToScene","keyCode","_handleKeyDown","firstLoad","Sidebar","allBBs","document","addEventListener","handleKeyDown","t0","destroy","getEpisodes","episodeKey","breakKey","getHighlight","getSelectedEpisode","MainContentAreaWrapper","mainContentArea_templateObject","MainContentArea","contentStream","prevProps","prevState","window","scrollTo","MainPage","fullscreen","inject","hideOnFullscreen","wrapperStyle","overflow","topBar_Topbar","sidebar_Sidebar","overflowX","mainContentArea_MainContentArea","MainPageController","darkTheme","toggleBorder","GlobalStyles","createGlobalStyle","globalTheme_templateObject","App","styled_components_browser_esm","Fragment","mainPage_MainPage","ReactDOM","src_App","getElementById"],"mappings":"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","file":"static/js/main.1f7aa8d8.chunk.js","sourcesContent":["import { PlayerProfile } from \"./playerProfile\";\nimport { RelationshipMap } from \"../utils\";\nimport { Tribe } from \"./tribe\";\n\ninterface HouseguestInit extends PlayerProfile {\n    id: number;\n    relationships: RelationshipMap;\n}\n\nexport class Houseguest extends PlayerProfile {\n    public isEvicted: boolean = false;\n    public isJury: boolean = false;\n    public tribe?: Tribe;\n    readonly id: number = 0;\n\n    public nominations: number = 0;\n    public hohWins: number = 0;\n    public povWins: number = 0;\n\n    // Popularity ranges from -1 to 1\n    public compatibility: [number, number, number] = [0, 0, 0];\n    public popularity: number = 0;\n    public deltaPopularity: number = 0;\n    public previousPopularity: number = 0;\n    readonly relationships: RelationshipMap = {};\n\n    public targets: [number, number] = [this.id, this.id];\n\n    // power rankings range from 0 to 1\n    public powerRanking: number = 0;\n    readonly superiors: { [id: number]: number } = {}; // { id : pHeroWins }\n\n    public relationshipWith(villain: Houseguest): number {\n        return this.relationships[villain.id];\n    }\n    public friends = 0;\n    public enemies = 0;\n    public targetingMe = 0;\n\n    constructor(init: HouseguestInit) {\n        super(init);\n        Object.assign(this, init);\n    }\n}\n","interface InitPlayerProfile {\n    readonly name: string;\n    readonly imageURL: string;\n}\n\nexport class PlayerProfile {\n    public name: string = \"\";\n    readonly imageURL: string = \"\";\n    public castingScreenId?: number | undefined = 0;\n    constructor(init: InitPlayerProfile) {\n        if (!init) {\n            return;\n        }\n        Object.assign(this, init);\n    }\n}\n","export function hashcode(string: string): number {\n    let hash = 0,\n        i,\n        chr;\n    if (string.length === 0) return hash;\n    for (i = 0; i < string.length; i++) {\n        chr = string.charCodeAt(i);\n        hash = (hash << 5) - hash + chr;\n        hash |= 0;\n    }\n    return hash;\n}\n\nexport function roundTwoDigits(number: number | undefined) {\n    if (!number) {\n        return 0;\n    }\n    return Math.round(number * 100);\n}\n\nexport function max(a: number, b: number) {\n    return a > b ? a : b;\n}\n\nexport function intersection<T>(setA: Set<T>, setB: Set<T>): Set<T> {\n    let _intersection = new Set<T>();\n    for (let elem of setB) {\n        if (setA.has(elem)) {\n            _intersection.add(elem);\n        }\n    }\n    return _intersection;\n}\nexport function difference<T>(setA: Set<T>, setB: Set<T>): Set<T> {\n    let _difference = new Set<T>(setA);\n    for (let elem of setB) {\n        _difference.delete(elem);\n    }\n    return _difference;\n}\n\nexport function extremeValues(x: number | undefined): number {\n    if (!x) {\n        return 0;\n    }\n    const xSquared = x * x;\n    if (x >= 0) {\n        return -xSquared + 2 * x;\n    } else {\n        return xSquared + 2 * x;\n    }\n}\n\nexport function average(x: number[]): number {\n    let sum = 0;\n    x.forEach((xi) => (sum += xi));\n    return sum / x.length;\n}\n\nexport function isWellDefined(x: any): boolean {\n    return !isNotWellDefined(x);\n}\n\nexport function isNotWellDefined(x: any): x is null | undefined {\n    return x === null || x === undefined;\n}\n\nexport function dot(x: number[], y: number[]) {\n    if (x.length !== y.length)\n        throw new Error(\n            `Tried to get the dot product between two vectors of non-equal length: ${x.length} !== ${y.length}`\n        );\n    let result = 0;\n    x.forEach((_, i) => {\n        result += x[i] * y[i];\n    });\n    return result;\n}\n\nexport function magnitude(x: number[]): number {\n    let result = 0;\n    x.forEach((x) => (result += x ** 2));\n    return result;\n}\n\n// returns a value between 0 and pi\n\nexport function angleBetween(x: number[], y: number[]): number {\n    if (x.length !== y.length)\n        throw new Error(\n            `Tried to get the angle between two vectors of non-equal length: ${x.length} !== ${y.length}`\n        );\n    return Math.acos((dot(x, y) / magnitude(x)) * magnitude(y));\n}\n\n// takes in an array, a number n, and a match function, then removes the first n elements from the array for which the match function returns true\n// returns the index for which something was removed\nexport function removeFirstNMatching(\n    array: any[],\n    n: number,\n    match: (x: any) => boolean,\n    startAt?: number\n): number {\n    let i = startAt || 0;\n    while (i < array.length && n > 0) {\n        if (match(array[i])) {\n            n--;\n            array.splice(i, 1);\n            i--;\n        }\n        i++;\n    }\n    return i;\n}\n\n// takes in an array, a number n, and a match function, then removes the last elements from the array for which the match function returns true\n// returns the index of the first element that does not match, or -1\n\nexport function removeLast1Matching(array: any[], match: (x: any) => boolean): number {\n    let i = array.length - 1;\n    while (i >= 0) {\n        if (match(array[i])) {\n            array.splice(i, 1);\n            return i;\n        }\n        i--;\n    }\n    return -1;\n}\n","export interface RelationshipMap {\n    [id: number]: number;\n}\n\nexport function newRelationshipMap(size: number, exclude: number): RelationshipMap {\n    const result: RelationshipMap = {};\n    for (let i = 0; i < size; i++) {\n        if (i !== exclude) result[i] = 0;\n    }\n    return result;\n}\n","function componentToHex(c: any) {\n    var hex = Math.round(c).toString(16);\n    return hex.length == 1 ? \"0\" + hex : hex;\n}\n\nexport class Rgb {\n    public r: number;\n    public g: number;\n    public b: number;\n    public toHex() {\n        return \"#\" + componentToHex(this.r) + componentToHex(this.g) + componentToHex(this.b);\n    }\n    public toRgba(): string {\n        return `rgba(${this.r}, ${this.g}, ${this.b}, 1)`;\n    }\n    constructor(r: number, g: number, b: number) {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n    }\n}\n\nexport function getRandomColor(): Rgb {\n    var r = Math.floor(Math.random() * 255);\n    var g = Math.floor(Math.random() * 255);\n    var b = Math.floor(Math.random() * 255);\n    return new Rgb(r, g, b);\n}\n\nexport function invertColor(color: Rgb): Rgb {\n    return new Rgb(255 - color.r, 255 - color.g, 255 - color.b);\n}\n\nexport function interpolateColor(min: Rgb, max: Rgb, percent: number): string {\n    return new Rgb(\n        min.r + percent * (max.r - min.r),\n        min.g + percent * (max.g - min.g),\n        min.b + percent * (max.b - min.b)\n    ).toHex();\n}\nexport function textColor(bg: string): \"#000000\" | \"#ffffff\" {\n    var color = bg.charAt(0) === \"#\" ? bg.substring(1, 7) : bg;\n    var r = parseInt(color.substring(0, 2), 16); // hexToR\n    var g = parseInt(color.substring(2, 4), 16); // hexToG\n    var b = parseInt(color.substring(4, 6), 16); // hexToB\n    var uicolors = [r / 255, g / 255, b / 255];\n    var c = uicolors.map((col) => {\n        if (col <= 0.03928) {\n            return col / 12.92;\n        }\n        return Math.pow((col + 0.055) / 1.055, 2.4);\n    });\n    var L = 0.2126 * c[0] + 0.7152 * c[1] + 0.0722 * c[2];\n    return L > 0.179 ? \"#000000\" : \"#ffffff\";\n}\n","export enum RelationshipType {\n    Friend = \"FRIEND\",\n    Queen = \"QUEEN\",\n    Pawn = \"PAWN\",\n    Enemy = \"ENEMY\",\n}\nexport enum TwoWayRelationshipType {\n    Friend = \"FRIEND\",\n    PawnQueen = \"PAWN/QUEEN\",\n    Enemy = \"ENEMY\",\n}\n\nexport const RelationshipTypeToSymbol = { FRIEND: \"♥\", ENEMY: \"💔\", PAWN: \"PAWN\", QUEEN: \"QUEEN\" };\n\nexport function classifyRelationship(\n    heroPopularity: number,\n    villainPopularity: number,\n    relationship: number\n): RelationshipType {\n    const benefitsHero = relationship > heroPopularity;\n    const benefitsVillain = relationship > villainPopularity;\n    if (benefitsHero && benefitsVillain) {\n        return RelationshipType.Friend;\n    } else if (benefitsHero && !benefitsVillain) {\n        return RelationshipType.Pawn;\n    } else if (!benefitsHero && benefitsVillain) {\n        return RelationshipType.Queen;\n    }\n    return RelationshipType.Enemy;\n}\n\nexport function classifyTwoWayRelationship(\n    heroPopularity: number,\n    villainPopularity: number,\n    relationship: number\n): TwoWayRelationshipType {\n    const benefitsHero = relationship > heroPopularity;\n    const benefitsVillain = relationship > villainPopularity;\n    if (benefitsHero && benefitsVillain) {\n        return TwoWayRelationshipType.Friend;\n    } else if (!benefitsHero && !benefitsVillain) {\n        return TwoWayRelationshipType.Enemy;\n    }\n    return TwoWayRelationshipType.PawnQueen;\n}\n","import React from \"react\";\nimport { isWellDefined, roundTwoDigits } from \"../../utils\";\nimport { ProfileHouseguest, PortraitProps, PortraitState } from \"../memoryWall\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport {\n    RelationshipTypeToSymbol,\n    RelationshipType as Relationship,\n    classifyRelationship,\n} from \"../../utils/ai/classifyRelationship\";\nimport { getSelectedPlayer } from \"../../subjects/subjects\";\n\nexport function heroIsPregame(hero: PortraitProps): boolean {\n    const heroIsZero =\n        hero.friends === 0 && hero.enemies === 0 && hero.popularity === 0 && hero.targetingMe === 0;\n    return heroIsZero || (hero.friends === undefined && hero.enemies === undefined);\n}\n\nexport function generatePowerSubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    _: boolean | undefined\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    key = addPopularityLine(state, hero, !!_, subtitle, key);\n    key = addCompsLine(hero, subtitle, key);\n    if (!hero.isEvicted && state.powerRanking !== undefined) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            subtitle.push(<div key={key++}>{`WIN ${roundTwoDigits(state.powerRanking!)}%`}</div>);\n        } else if (data && data.id === hero.id) {\n            subtitle.push(<div key={key++}>I WOULD</div>);\n        } else {\n            subtitle.push(\n                <div key={key++}>{`WIN ${roundTwoDigits(state.powerRanking)}%${\n                    hero.targetingMe ? ` | 🎯 ${hero.targetingMe}` : \"\"\n                }`}</div>\n            );\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return subtitle;\n}\n\nexport function generatePopularitySubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    detailed: boolean = false\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    // popularity\n    key = addPopularityLine(state, hero, detailed, subtitle, key);\n    // competition wins\n    key = addCompsLine(hero, subtitle, key);\n    // friendship count / relationship classification titles\n    ({ subtitle, key } = addFriendshipCountTitles(hero, subtitle, key));\n    return subtitle;\n}\n\nfunction addFriendshipCountTitles(hero: PortraitProps, subtitle: any[], key: number) {\n    if (heroIsPregame(hero)) {\n        subtitle = subtitle.concat(<br key={key++} />);\n        return { subtitle, key };\n    }\n    if (!hero.isEvicted) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            const titles = friendOrEnemyTitle(hero, data);\n            subtitle = subtitle.concat(titles.map((txt) => <div key={key++}>{txt}</div>));\n        } else {\n            const titles = friendEnemyCountTitle(hero);\n            subtitle = subtitle.concat(titles.map((txt) => <div key={key++}>{txt}</div>));\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return { subtitle, key };\n}\n\nfunction addPopularityLine(\n    state: { popularity?: number },\n    hero: PortraitProps,\n    detailed: boolean,\n    subtitle: any[],\n    key: number\n) {\n    let popularity = state.popularity;\n    if (popularity && (popularity > 1 || popularity < -1)) {\n        popularity = hero.popularity;\n    }\n    if (popularity && !hero.isEvicted) {\n        let popularitySubtitle = `${roundTwoDigits(popularity)}%`;\n        const deltaPop = getDeltaPopularity(hero, popularity);\n        if (detailed && deltaPop !== 0) {\n            const arrow = deltaPop > 0 ? \" | ↑\" : \" | ↓\";\n            popularitySubtitle += `${arrow} ${deltaPop}%`;\n        }\n        subtitle.push(<div key={key++}>{popularitySubtitle}</div>);\n    }\n    return key;\n}\n\nfunction addCompsLine(hero: PortraitProps, subtitle: any[], key: number) {\n    if (compWins(hero)) {\n        subtitle.push(<div key={key++}>{`${compWins(hero)}`}</div>);\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return key;\n}\n\nfunction getDeltaPopularity(houseguest: PortraitProps, statePopularity: number) {\n    if (roundTwoDigits(houseguest.popularity) !== roundTwoDigits(statePopularity)) {\n        return 0;\n    }\n    return houseguest.deltaPopularity ? roundTwoDigits(houseguest.deltaPopularity) : 0;\n}\n\nfunction compWins(houseguest: ProfileHouseguest): string {\n    return `${houseguest.hohWins ? `♔ ${houseguest.hohWins}` : \"\"}${\n        houseguest.povWins && houseguest.hohWins\n            ? `|🛇 ${houseguest.povWins}`\n            : houseguest.povWins\n            ? `🛇 ${houseguest.povWins}`\n            : \"\"\n    }${(houseguest.hohWins || houseguest.povWins) && houseguest.nominations ? \"|\" : \"\"}${\n        houseguest.nominations ? `✘ ${houseguest.nominations}` : \"\"\n    }`;\n}\n\nfunction friendOrEnemyTitle(hero: PortraitProps, villain: SelectedPlayerData): string[] {\n    const titles: string[] = [];\n    titles.push(\n        RelationshipTypeToSymbol[\n            classifyRelationship(hero.popularity || 0, villain.popularity, hero.relationships![villain.id])\n        ]\n    );\n    return titles;\n}\n\nfunction friendEnemyCountTitle(hero: PortraitProps): string[] {\n    const titles: string[] = [];\n    const count =\n        isWellDefined(hero.friends) && isWellDefined(hero.enemies)\n            ? { friends: hero.friends, enemies: hero.enemies }\n            : { friends: 0, enemies: 0 };\n    titles.push(\n        `${count.friends} ${RelationshipTypeToSymbol[Relationship.Friend]}| ${count.enemies} ${\n            RelationshipTypeToSymbol[Relationship.Enemy]\n        }${hero.targetingMe ? `| 🎯 ${hero.targetingMe}` : \"\"}`\n    );\n    return titles;\n}\n","import { Rgb, interpolateColor } from \"./color\";\nimport { PortraitState, PortraitProps } from \"../components/memoryWall\";\nimport { extremeValues } from \"../utils\";\nimport { generatePopularitySubtitle, generatePowerSubtitle } from \"../components/playerPortrait/subtitle\";\n\nexport interface PortraitDisplayMode {\n    minColor: Rgb;\n    maxColor: Rgb;\n    backgroundColor: (state: PortraitState) => string;\n    generateSubtitle: (props: PortraitProps, state: PortraitState, detailed?: boolean) => any[];\n}\n\nconst popularityMinColor = new Rgb(252, 137, 137);\nconst popularityMaxColor = new Rgb(137, 252, 137);\n\nexport const popularityMode: PortraitDisplayMode = {\n    minColor: popularityMinColor,\n    maxColor: popularityMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const popularity = state.popularity;\n\n        const extremePopularity = extremeValues(popularity);\n        const percent = (extremePopularity + 1) / 2;\n        return interpolateColor(popularityMinColor, popularityMaxColor, percent);\n    },\n    generateSubtitle: generatePopularitySubtitle,\n};\n\nconst powerMaxColor = new Rgb(255, 204, 94);\nconst powerMinColor = new Rgb(192, 181, 255);\nexport const powerMode: PortraitDisplayMode = {\n    minColor: powerMinColor,\n    maxColor: powerMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const powerRanking = state.powerRanking;\n        if (powerRanking === undefined) return \"\";\n\n        return interpolateColor(powerMinColor, powerMaxColor, powerRanking);\n    },\n    generateSubtitle: generatePowerSubtitle,\n};\n","import { Houseguest } from \"../../model\";\nimport { RelationshipMap } from \"../../utils\";\nimport {\n    displayMode$,\n    getSelectedCastPlayers,\n    getSelectedPlayer,\n    selectedCastPlayer$,\n    selectedPlayer$,\n} from \"../../subjects/subjects\";\nimport { powerMode } from \"../../model/portraitDisplayMode\";\n\nexport interface SelectedPlayerData {\n    id: number;\n    popularity: number;\n    relationships: RelationshipMap;\n    isEvicted: boolean;\n    superiors?: { [id: number]: number };\n}\n\nexport function selectPlayer(player: SelectedPlayerData | null) {\n    if (!player || (getSelectedPlayer() && (getSelectedPlayer() as Houseguest).id === player.id)) {\n        selectedPlayer$.next(null);\n        return;\n    }\n    if (\n        !player.superiors ||\n        (displayMode$.value === powerMode && Object.keys(player.superiors).length === 0)\n    ) {\n        selectedPlayer$.next(null);\n        return;\n    }\n    selectedPlayer$.next(player);\n}\n\nexport function selectCastPlayer(id: number | null) {\n    if (id === null) {\n        selectedCastPlayer$.next(new Set());\n        return;\n    }\n    const selectedCastPlayers = getSelectedCastPlayers();\n    if (selectedCastPlayers.has(id)) {\n        // remove if exists\n        selectedCastPlayers.delete(id);\n    } else {\n        // else add\n        selectedCastPlayers.add(id);\n    }\n    selectedCastPlayer$.next(selectedCastPlayers);\n}\n","import { BehaviorSubject, Subject } from \"rxjs\";\nimport { PregameScreen } from \"../components/pregameScreen/pregameScreen\";\nimport { Episode, PlayerProfile } from \"../model\";\nimport { SelectedPlayerData } from \"../components/playerPortrait/selectedPortrait\";\nimport React from \"react\";\nimport { PortraitDisplayMode, popularityMode } from \"../model/portraitDisplayMode\";\nimport { ColorTheme } from \"../theme/theme\";\nimport { EpisodeLibrary } from \"../model/season\";\nimport { activeScreen$, Screens } from \"../components/topbar/topBar\";\n\n// What is currently being displayed.\nexport const mainContentStream$ = new BehaviorSubject(<PregameScreen cast={[]} />);\n\nexport function pushToMainContentStream(content: JSX.Element, tab?: Screens) {\n    tab && activeScreen$.next(tab);\n    mainContentStream$.next(content);\n}\n\n// Push episodes to this subject to add them to the sidebar. Null resets everything.\nexport const episodes$ = new BehaviorSubject<Episode | null>(null);\n// Forcibly switches to an episode. Used when adding a new episode.\nexport const switchEpisode$ = new Subject<number>();\nexport function newEpisode(episode: Episode | null) {\n    episodes$.next(episode);\n}\nexport function switchSceneRelative(n: number) {\n    switchEpisode$.next(n);\n}\n\n// pushed when a new season is created (may need to be upgraded to behavior subject in the future)\nexport const season$ = new Subject<EpisodeLibrary>();\n\n// the list of players in the game\nexport const cast$ = new BehaviorSubject<PlayerProfile[]>([]);\nexport function updateCast(newCast: PlayerProfile[]) {\n    cast$.next(newCast);\n}\nexport function getCast(): PlayerProfile[] {\n    return cast$.value;\n}\n// The player that the user has clicked on.\nexport const selectedPlayer$ = new BehaviorSubject<SelectedPlayerData | null>(null);\nexport function getSelectedPlayer() {\n    return selectedPlayer$.value;\n}\n\n// The cast member(s) that the user has clicked on.\n// Used for the casting screen.\nexport const selectedCastPlayer$ = new BehaviorSubject<Set<number>>(new Set<number>());\n\nexport function getSelectedCastPlayers() {\n    return selectedCastPlayer$.value;\n}\n\n// The decks that have been selected on the casting screen.\nexport const selectedDecks$ = new BehaviorSubject<Set<string>>(new Set<string>());\n\nexport function selectDeckSubject(deck: string | null) {\n    if (deck === null) {\n        selectedDecks$.next(new Set());\n        return;\n    }\n    const selectedDecks = selectedDecks$.value;\n    if (selectedDecks.has(deck)) {\n        // remove if exists\n        selectedDecks.delete(deck);\n    } else {\n        // else add\n        selectedDecks.add(deck);\n    }\n    selectedDecks$.next(selectedDecks);\n}\n\n// The tab selected on the start of each week.\nexport const weekStartTab$ = new BehaviorSubject<number>(0);\n\n// The display mode selected by the viewsbar.\nexport const displayMode$ = new BehaviorSubject<PortraitDisplayMode>(popularityMode);\n\n// If the screen is fullscreen or not.\nexport const isFullscreen$ = new BehaviorSubject<boolean>(false);\n\n// dark or light mode.\nexport const theme$ = new Subject<ColorTheme>();\n","import { PortraitProps, HouseguestPortrait, PortraitState } from \"../memoryWall\";\nimport { Subscription } from \"rxjs\";\nimport { selectedPlayer$, displayMode$, getSelectedPlayer } from \"../../subjects/subjects\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport { Rgb } from \"../../model/color\";\nimport { heroIsPregame } from \"./subtitle\";\nimport { shuffle } from \"lodash\";\n\nexport const selectedColor = new Rgb(51, 255, 249);\n\nexport class HouseguestPortraitController {\n    private subs: Subscription[] = [];\n    private view: HouseguestPortrait;\n    constructor(view: HouseguestPortrait) {\n        this.view = view;\n    }\n\n    get defaultState() {\n        return {\n            popularity: this.view.props.popularity,\n            displayMode: displayMode$.value,\n            powerRanking: this.view.props.powerRanking,\n        };\n    }\n\n    public backgroundColor(props: PortraitProps): undefined | string {\n        if (heroIsPregame(props)) {\n            return shuffle([\n                \"#ca9389\",\n                \"#cab389\",\n                \"#c0ca89\",\n                \"#cabb89\",\n                \"#c0ca89\",\n                \"#cabb89\",\n                \"#b9ca89\",\n                \"#98ca89\",\n            ])[0];\n        }\n        const selectedPlayer = getSelectedPlayer();\n        if (selectedPlayer !== null && selectedPlayer.id === props.id) {\n            return selectedColor.toHex();\n        }\n        return props.isEvicted ? undefined : this.view.state.displayMode.backgroundColor(this.view.state);\n    }\n\n    public subscribe() {\n        const subs: Subscription[] = [];\n        subs.push(\n            selectedPlayer$.subscribe({\n                next: this.refreshData,\n            })\n        );\n        subs.push(\n            displayMode$.subscribe({\n                next: (displayMode) => this.view.setState({ displayMode }),\n            })\n        );\n        this.subs = subs;\n    }\n\n    public unsubscribe() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    private comparePowerRankings(data: SelectedPlayerData): number {\n        // 0 is blue. 1 is orange\n        if (!data.superiors) return 0;\n        const id = this.view.props.id === undefined ? -1 : this.view.props.id;\n        return data.superiors[id];\n    }\n\n    private refreshData = (data: SelectedPlayerData | null) => {\n        if (!data) {\n            this.view.setState(this.defaultState);\n        } else {\n            if (data.id !== this.view.props.id) {\n                this.view.setState({\n                    popularity: data.relationships[this.view.props.id!],\n                    powerRanking: this.comparePowerRankings(data),\n                });\n            } else {\n                this.view.setState({ popularity: 2, powerRanking: 2 });\n            }\n        }\n    };\n}\n","import React from \"react\";\nimport { selectPlayer } from \"./selectedPortrait\";\nimport { isNotWellDefined, RelationshipMap, rng } from \"../../utils\";\nimport _ from \"lodash\";\nimport { HouseguestPortraitController } from \"./houseguestPortraitController\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\nimport { Tribe } from \"../../model/tribe\";\nimport { textColor } from \"../../model/color\";\n\nconst Subtitle = styled.small`\n    font-weight: 100;\n    font-size: small;\n`;\n\nconst MemoryWallPortrait = styled.div`\n    margin: 5px;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.portraitBorder};\n    color: black;\n    border-radius: 5px;\n    text-align: center;\n    font-weight: 600;\n    width: 7rem;\n    word-wrap: break-word;\n    -webkit-transition-property: none;\n    -moz-transition-property: none;\n    -o-transition-property: none;\n    transition-property: none;\n`;\n\nconst Evicted = styled(MemoryWallPortrait)`\n    font-weight: 100;\n    color: grey;\n    background-color: #111111;\n`;\n\nconst Jury = styled(MemoryWallPortrait)`\n    font-weight: 100;\n    color: #c3ae88;\n    background-color: #5d5340;\n    filter: brightness(0.6);\n`;\n\nconst Normal = styled.img`\n    min-width: 100px;\n    width: 100%;\n    width: -moz-available;\n    width: -webkit-fill-available;\n    width: stretch;\n    -webkit-transition-property: none;\n    -moz-transition-property: none;\n    -o-transition-property: none;\n    transition-property: none;\n`;\n\nconst Grayscale = styled(Normal)`\n    filter: grayscale(100%);\n`;\n\nconst Sepia = styled(Normal)`\n    filter: sepia(100%);\n`;\n\nexport interface PortraitProps {\n    imageURL: string;\n    name: string;\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    powerRanking?: number;\n    deltaPopularity?: number;\n    detailed?: boolean;\n    superiors?: { [id: number]: number };\n    friends?: number;\n    enemies?: number;\n    targetingMe?: number;\n    targets?: number[];\n    tribe?: Tribe;\n}\n\nexport interface PortraitState {\n    popularity?: number;\n    powerRanking?: number;\n    displayMode: PortraitDisplayMode;\n}\nexport class HouseguestPortrait extends React.Component<PortraitProps, PortraitState> {\n    private controller: HouseguestPortraitController;\n\n    public constructor(props: PortraitProps) {\n        super(props);\n        this.controller = new HouseguestPortraitController(this);\n        this.state = this.controller.defaultState;\n    }\n\n    public componentDidMount() {\n        if (isNotWellDefined(this.props.id)) {\n            return;\n        }\n        this.controller.subscribe();\n    }\n\n    public componentWillUnmount() {\n        this.controller.unsubscribe();\n    }\n\n    private onClick(): void {\n        if (\n            (this.props.targets && this.props.targets[0] === 0 && this.props.targets[1] == 0) ||\n            isNotWellDefined(this.props.id) ||\n            !this.props.relationships\n        ) {\n            return;\n        }\n        const data = {\n            id: this.props.id,\n            relationships: this.props.relationships,\n            isEvicted: !!this.props.isEvicted,\n            popularity: this.props.popularity || 0,\n            superiors: this.props.superiors,\n        };\n        selectPlayer(data);\n    }\n\n    public render() {\n        const props = this.props;\n        const Img = getImageClass(props);\n        let subtitle: any[] = [];\n        subtitle = this.state.displayMode.generateSubtitle(this.props, this.state, !!props.detailed);\n        let tribeStyle: any = props.tribe\n            ? { backgroundColor: props.tribe.color, color: textColor(props.tribe.color) }\n            : {};\n        let Portrait = MemoryWallPortrait;\n        if (props.isJury) {\n            Portrait = Jury;\n            tribeStyle = {\n                backgroundColor: \"#5d5340\",\n                color: \"#c3ae88\",\n                borderTop: \"1px solid #5d5340\",\n                borderBottom: \"1px solid #5d5340\",\n            };\n        } else if (props.isEvicted) {\n            Portrait = Evicted;\n            tribeStyle = { backgroundColor: \"#111111\", color: \"grey\" };\n        }\n\n        const tribe = props.tribe ? (\n            <TribeStyle style={tribeStyle}>\n                <small>{props.tribe.name}</small>\n            </TribeStyle>\n        ) : undefined;\n        const imageStyle: any = { height: 100, width: \"-moz-available\" };\n        if (props.tribe) imageStyle[\"display\"] = \"block\";\n        return (\n            <Portrait\n                onClick={() => this.onClick()}\n                style={{\n                    backgroundColor: this.controller.backgroundColor(props),\n                }}\n            >\n                <Img src={props.imageURL} style={imageStyle} />\n                {tribe}\n                {props.name}\n                <br />\n                {<Subtitle>{subtitle}</Subtitle>}\n            </Portrait>\n        );\n    }\n}\n\nconst TribeStyle = styled.div`\n    overflow: hidden;\n    white-space: nowrap;\n    width: 100%;\n    border-top: 1px solid black;\n    border-bottom: 1px solid black;\n    overflow: clip;\n    display: block;\n    min-height: 21px;\n    font-weight: normal;\n`;\n\nfunction getImageClass(props: PortraitProps) {\n    let imageClass = props.isEvicted ? Grayscale : Normal;\n    imageClass = props.isJury ? Sepia : imageClass;\n    return imageClass;\n}\n","import { ProfileHouseguest, HouseguestPortrait } from \"../memoryWall\";\nimport React from \"react\";\n\nexport function houseguestToPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={false} />;\n}\n\nexport function memoryWallPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={true} />;\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { selectedColor } from \"./houseguestPortraitController\";\n\nconst EditPortrait = styled.div`\n    padding: 5px;\n    margin: 5px;\n    border: 1px solid #9d9d9d;\n    background-color: #9d9d9d;\n    color: black;\n    border-radius: 5px;\n    font-weight: 600;\n    width: 7rem;\n    word-wrap: break-word;\n`;\n\nexport const unselectable = `   -webkit-touch-callout: none;\n-webkit-user-select: none;\n-khtml-user-select: none;\n-moz-user-select: none;\n-ms-user-select: none;\nuser-select: none;`;\n\nexport const Noselect = styled.div`\n    ${unselectable}\n`;\n\nconst XButton = styled(Noselect)`\n    color: #300808;\n    width: 50%;\n\n    :active {\n        color: #ff7133;\n        background-color: #ffd8c7;\n    }\n    :hover {\n        color: red;\n        background-color: #ffe1ea;\n    }\n`;\n\nconst EditButton = styled(Noselect)`\n    color: #300808;\n    width: 50%;\n\n    :active {\n        color: #ff7133;\n        background-color: #ffd8c7;\n    }\n    :hover {\n        color: orange;\n        background-color: #fff6e1;\n    }\n`;\n\ninterface SetupPortraitProps {\n    name: string;\n    imageUrl: string;\n    onDelete: () => void;\n    onRename: () => void;\n    onClick: () => void;\n    selected: boolean;\n}\n\ninterface SetupPortraitState {\n    name: string;\n}\n\nexport class SetupPortrait extends React.Component<SetupPortraitProps, SetupPortraitState> {\n    public constructor(props: SetupPortraitProps) {\n        super(props);\n        this.state = { name: props.name };\n    }\n\n    public UNSAFE_componentWillReceiveProps(props: SetupPortraitProps) {\n        this.setState({ name: props.name });\n    }\n\n    public render() {\n        const style = this.props.selected ? { backgroundColor: selectedColor.toHex() } : {};\n        return (\n            <EditPortrait onClick={() => this.props.onClick()} style={style}>\n                <div style={{ textAlign: \"center\" }}>\n                    <div style={{ maxHeight: 20, display: \"flex\" }}>\n                        <XButton\n                            onDoubleClick={() => this.props.onDelete()}\n                            onClick={(event) => event.stopPropagation()}\n                        >\n                            ✘\n                        </XButton>\n                        <EditButton\n                            onClick={(event) => {\n                                event.stopPropagation();\n                                this.props.onRename();\n                            }}\n                        >\n                            ✎\n                        </EditButton>\n                    </div>\n                    <img src={this.props.imageUrl} style={{ width: 100, height: 100 }} />\n                    <br />\n                    <p>{this.state.name}</p>\n                </div>\n            </EditPortrait>\n        );\n    }\n}\n","import React from \"react\";\nimport Popover from \"react-tiny-popover\";\nimport styled from \"styled-components\";\nimport { unselectable } from \"../playerPortrait/setupPortrait\";\n\nconst common = `\n${unselectable}\npadding: 3px 8px;\ncolor: #fff;\ntext-align: center;\nbackground-color: #000;\nborder-radius: 4px;`;\n\nconst Text = styled.p`\n    max-width: 200px;\n    ${common}\n`;\nconst WideText = styled.p`\n    max-width: 800px;\n    ${common}\n`;\ninterface TooltipProps {\n    text: string;\n    children: any;\n    wide?: boolean;\n}\n\ninterface ToolTipState {\n    visible: boolean;\n}\n\nexport class Tooltip extends React.Component<TooltipProps, ToolTipState> {\n    constructor(props: TooltipProps) {\n        super(props);\n        this.state = { visible: false };\n    }\n\n    public render() {\n        const Txt = this.props.wide ? WideText : Text;\n        return (\n            <Popover\n                position={[\"top\", \"bottom\"]}\n                isOpen={this.state.visible}\n                content={<Txt>{this.props.text}</Txt>}\n            >\n                <div\n                    onMouseEnter={() => this.setState({ visible: true })}\n                    onMouseLeave={() => this.setState({ visible: false })}\n                >\n                    {this.props.children}\n                </div>\n            </Popover>\n        );\n    }\n}\n","import React from \"react\";\nimport { ProfileHouseguest } from \"../memoryWall\";\nimport { houseguestToPortrait, memoryWallPortrait } from \"./houseguestToPortrait\";\nimport { Tooltip } from \"../tooltip/tooltip\";\n\nlet key = -1;\n\nfunction PortraitWrapper(props: { centered?: boolean; children: any }): JSX.Element {\n    return (\n        <div\n            key={key++}\n            className={`columns is-gapless is-mobile is-multiline ${props.centered ? \"is-centered\" : \"\"}`}\n        >\n            {props.children}\n        </div>\n    );\n}\n\nexport function Portrait(props: { houseguest: ProfileHouseguest; centered?: boolean }): JSX.Element {\n    const result = (\n        <PortraitWrapper centered={props.centered}>{houseguestToPortrait(props.houseguest)}</PortraitWrapper>\n    );\n    if (props.houseguest.tooltip) {\n        return (\n            <PortraitWrapper centered={props.centered}>\n                <Tooltip text={props.houseguest.tooltip}>{houseguestToPortrait(props.houseguest)}</Tooltip>\n            </PortraitWrapper>\n        );\n    }\n    return result;\n}\n\nexport function Portraits(props: {\n    houseguests: (ProfileHouseguest | \"⬅️\" | \"➡️\")[];\n    centered?: boolean;\n    detailed?: boolean;\n}): JSX.Element {\n    const rows: JSX.Element[] = [];\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    props.houseguests.forEach((houseguest: ProfileHouseguest | \"⬅️\" | \"➡️\") => {\n        let result;\n        if (houseguest === \"⬅️\" || houseguest === \"➡️\") {\n            result = (\n                <div\n                    key={`plus-${key++}`}\n                    style={{ display: \"flex\", justifyContent: \"center\", alignItems: \"center\" }}\n                    className=\"column is-narrow\"\n                >\n                    <p>{houseguest}</p>\n                </div>\n            );\n        } else if (props.detailed) {\n            result = memoryWallPortrait(houseguest, key++);\n        } else {\n            result = houseguestToPortrait(houseguest, key++);\n        }\n        if (houseguest !== \"⬅️\" && houseguest !== \"➡️\" && houseguest.tooltip) {\n            result = (\n                <Tooltip key={key++} text={houseguest.tooltip}>\n                    {result}\n                </Tooltip>\n            );\n        }\n        rows.push(result);\n    });\n    return (\n        <div className={`columns is-gapless is-mobile is-multiline ${props.centered && \"is-centered\"}`}>\n            {rows}\n        </div>\n    );\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { Portraits } from \"../playerPortrait/portraits\";\nimport { RelationshipMap } from \"../../utils\";\nimport { Tribe } from \"../../model/tribe\";\nexport interface MemoryWallProps {\n    readonly houseguests: ProfileHouseguest[];\n}\n\nexport interface ProfileHouseguest extends PlayerProfile {\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    deltaPopularity?: number;\n    hohWins?: number;\n    povWins?: number;\n    nominations?: number;\n    tooltip?: string;\n    friends?: number;\n    enemies?: number;\n    targetingMe?: number;\n    tribe?: Tribe;\n}\n\nexport function MemoryWall(props: MemoryWallProps): JSX.Element {\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    return (\n        <div\n            style={{\n                margin: \"auto\",\n                maxWidth: props.houseguests.length < 26 ? 800 : -1,\n            }}\n        >\n            <Portraits houseguests={props.houseguests} centered={true} detailed={true} />\n        </div>\n    );\n}\n","import styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nexport const HasText = styled.div`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport const Input = styled.input`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n","import React from \"react\";\nimport styled from \"styled-components\";\n\ninterface NumericInputProps {\n    value: string;\n    onChange: (newValue: string) => void;\n    style?: any;\n    className?: string;\n    placeholder?: string;\n}\n\nexport const NumericInputStyle = styled.input`\n    width: 3em;\n`;\n\nexport function NumericInput(props: NumericInputProps) {\n    const style = props.style || {};\n    return (\n        <NumericInputStyle\n            type=\"text\"\n            className={`input${props.className ? ` ${props.className}` : \"\"}`}\n            style={style}\n            value={props.value}\n            placeholder={props.placeholder || \"\"}\n            onChange={(event) => {\n                const value = event.target.value;\n                if (/^\\d*$/g.test(value)) {\n                    props.onChange(value);\n                }\n            }}\n        />\n    );\n}\n","import React, { useState } from \"react\";\nimport { Tooltip } from \"../tooltip/tooltip\";\nimport { NumericInput } from \"./numericInput\";\n\ninterface RandomButtonProps {\n    random: (n: number) => void;\n}\n\nexport function RandomButton(props: RandomButtonProps): JSX.Element {\n    const [number, setNumber] = useState(\"16\");\n    return (\n        <div className=\"field has-addons\" style={{ display: \"flex\" }}>\n            <div className=\"control\">\n                <Tooltip text={\"Selected cast members will always be chosen.\"}>\n                    <button\n                        disabled={number === \"\"}\n                        className=\"button is-primary\"\n                        onClick={() => props.random(parseInt(number))}\n                    >\n                        Random\n                    </button>\n                </Tooltip>\n            </div>\n            <div className=\"control\">\n                <NumericInput value={number} onChange={setNumber} />\n            </div>\n        </div>\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\ninterface TextProps {\n    noMargin?: boolean;\n    children?: any;\n    style?: any;\n    className?: string;\n}\n\nconst NoMargin = styled.div`\n    text-align: center;\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\nconst Center = styled.p`\n    text-align: center;\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport function Centered(props: TextProps): JSX.Element {\n    if (props.noMargin) return <NoMargin>{props.children}</NoMargin>;\n    return (\n        <Center className={props.className || \"\"} style={props.style || {}}>\n            {props.children}\n        </Center>\n    );\n}\n\nexport function CenteredBold(props: TextProps): JSX.Element {\n    return (\n        <Centered className={props.className || \"\"} style={props.style || {}} noMargin={props.noMargin}>\n            <b>{props.children} </b>\n        </Centered>\n    );\n}\n\nexport function CenteredItallic(props: TextProps): JSX.Element {\n    return (\n        <Centered className={props.className || \"\"} style={props.style || {}} noMargin={props.noMargin}>\n            <i>{props.children} </i>\n        </Centered>\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { canDisplayCliques, GameState, getById } from \"../../model\";\nimport { ColorTheme } from \"../../theme/theme\";\nimport { isNotWellDefined } from \"../../utils\";\nimport { Centered } from \"../layout/centered\";\nimport { HasText } from \"../layout/text\";\nimport { Portraits } from \"../playerPortrait/portraits\";\n\nexport const HelpLink = styled.a`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.link};\n    cursor: pointer;\n    font-weight: bold;\n    margin-top: 10px;\n    margin-bottom: 10px;\n`;\n\ninterface AllianceListProps {\n    gameState: GameState;\n}\n\nexport function AllianceList(props: AllianceListProps) {\n    if (!canDisplayCliques(props.gameState))\n        return (\n            <HasText>\n                <Centered>\n                    ⚠️ There are too many players left in the game to display the alliances! Try again when\n                    there are 30 or less! ⚠️\n                </Centered>\n            </HasText>\n        );\n    const cliques = props.gameState.cliques;\n    const elements: JSX.Element[] = cliques.map((clique, i) => {\n        if (isNotWellDefined(clique.affiliates)) {\n            return (\n                <Portraits\n                    centered={true}\n                    detailed={true}\n                    key={`${clique}, ${i}, ${props.gameState.phase}`}\n                    houseguests={clique.core.map((id) => getById(props.gameState, id))}\n                />\n            );\n        }\n        const entries: (number | \"⬅️\" | \"➡️\")[] = [\n            ...clique.affiliates[0],\n            \"➡️\",\n            ...clique.core,\n            \"⬅️\",\n            ...clique.affiliates[1],\n        ];\n        return (\n            <Portraits\n                centered={true}\n                detailed={true}\n                key={`${clique}, ${i}, ${props.gameState.phase}`}\n                houseguests={entries.map((id) => {\n                    if (id === \"⬅️\") return \"⬅️\";\n                    if (id === \"➡️\") return \"➡️\";\n                    return getById(props.gameState, id);\n                })}\n            />\n        );\n    });\n    return (\n        <div>\n            {elements}\n            {props.gameState.phase < 3 && (\n                <HelpLink\n                    href=\"https://github.com/spaulmark/bb-bots/blob/master/README.md#understanding-alliances-or-what-do-the-arrows-mean\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                >\n                    What do the arrows mean?\n                </HelpLink>\n            )}\n        </div>\n    );\n}\n","import React from \"react\";\nimport { PortraitDisplayMode, powerMode } from \"../../model/portraitDisplayMode\";\nimport { displayMode$, getSelectedPlayer, selectedPlayer$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nfunction setDisplayMode(p: PortraitDisplayMode) {\n    if (p === powerMode) {\n        const player = getSelectedPlayer();\n        if (player && (!player.superiors || Object.keys(player.superiors).length === 0)) {\n            selectedPlayer$.next(null);\n        }\n    }\n    displayMode$.next(p);\n}\n\ninterface ViewBarTagProps {\n    mode: PortraitDisplayMode;\n    text: string;\n    disabled?: boolean;\n}\n\nexport class ViewBarTag extends React.Component<ViewBarTagProps, { selected: boolean }> {\n    private sub: Subscription | null = null;\n\n    public constructor(props: ViewBarTagProps) {\n        super(props);\n        this.state = { selected: props.mode === displayMode$.value };\n    }\n\n    public componentDidMount() {\n        this.sub = displayMode$.subscribe({\n            next: (mode) => {\n                if (mode !== this.props.mode) {\n                    this.setState({ selected: false });\n                } else {\n                    this.setState({ selected: true });\n                }\n            },\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    public render() {\n        const name = \"level-item tag is-medium is-light\";\n        const style = getStyle(this.props);\n        return (\n            <span\n                className={name}\n                style={style}\n                onClick={() => {\n                    !this.props.disabled && setDisplayMode(this.props.mode);\n                    !this.props.disabled && this.setState({ selected: true });\n                }}\n            >\n                {styleText(this.props.text, this.state.selected)}\n            </span>\n        );\n    }\n}\n\nfunction styleText(text: string, selected: boolean): JSX.Element {\n    return selected ? <b>{text}</b> : <i>{text}</i>;\n}\n\nfunction getStyle(props: ViewBarTagProps) {\n    return props.disabled\n        ? {}\n        : {\n              background: `linear-gradient(90deg, ${props.mode.minColor.toRgba()} 0%, ${props.mode.maxColor.toRgba()} 100%)`,\n              cursor: \"pointer\",\n          };\n}\n","import React from \"react\";\nimport { popularityMode, powerMode } from \"../../model/portraitDisplayMode\";\nimport { ViewBarTag } from \"./viewBarTag\";\nimport { GameState, inJury } from \"../../model\";\nimport { displayMode$ } from \"../../subjects/subjects\";\n\nexport class ViewsBar extends React.Component<{ gameState: GameState }, {}> {\n    public constructor(props: { gameState: GameState }) {\n        super(props);\n        if (!inJury(this.props.gameState) && displayMode$.value === powerMode) {\n            displayMode$.next(popularityMode);\n        }\n    }\n\n    componentDidUpdate() {\n        if (!inJury(this.props.gameState) && displayMode$.value === powerMode) {\n            displayMode$.next(popularityMode);\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"level is-mobile\" key=\"viewsbar\" style={{ marginBottom: 0 }}>\n                <ViewBarTag mode={popularityMode} text={\"Relationships\"}></ViewBarTag>\n                {inJury(this.props.gameState) && (\n                    <ViewBarTag mode={powerMode} text={\"Endgame Winrate\"}></ViewBarTag>\n                )}\n            </div>\n        );\n    }\n}\n","import { DragDropContext, Droppable } from \"react-beautiful-dnd\";\nimport { Draggable } from \"react-beautiful-dnd\";\nimport React from \"react\";\nimport styled from \"styled-components\";\nimport { EpisodeType } from \"../episode/episodes\";\nimport { BigBrotherVanilla } from \"../episode/bigBrotherEpisode\";\nimport { BehaviorSubject, Subscription } from \"rxjs\";\nimport { getEmoji, twist$ } from \"./twistAdder\";\nimport { min } from \"lodash\";\nimport { removeFirstNMatching, removeLast1Matching } from \"../../utils\";\nimport { GameState, getById } from \"../../model/gameState\";\n\nconst common = `\npadding: 10px;\nborder-radius: 6px;\nbox-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);\nmargin: 0 0 3px 0;\nborder: 1px solid #6c6c6c;\ndisplay: grid;\nflex-direction: column;\n`;\n\nconst InvalidDragItem = styled.div`\n    ${common}\n    background: #ffe1ea;\n    color: red;\n`;\n\nconst DragItem = styled.div`\n    ${common}\n    background: #444346;\n    color: #fff;\n`;\n\nexport let _items: { episode: EpisodeType }[] = [];\nexport let _castSize: number = 0;\n\nexport function deleteTeams(gameState: GameState, toDelete: Set<number>): void {\n    gameState.nonEvictedHouseguests.forEach((hgid) => {\n        const hg = getById(gameState, hgid);\n        const tribe = hg.tribe;\n        if (!tribe) return;\n        if (toDelete.has(tribe.tribeId)) {\n            hg.tribe = undefined;\n        }\n    });\n}\n\nconst ListItem = ({\n    item,\n    provided,\n    snapshot,\n}: {\n    item: SeasonEditorListItem;\n    provided: any;\n    snapshot: any;\n}): JSX.Element => {\n    const Item = item.isValid ? DragItem : InvalidDragItem;\n    return (\n        <Item\n            ref={provided.innerRef}\n            snapshot={snapshot}\n            {...provided.draggableProps}\n            {...provided.dragHandleProps}\n        >\n            <span>{`${item.weekText}${\n                item.episode !== BigBrotherVanilla ? ` | ${getEmoji(item.episode) + item.episode.name}` : \"\"\n            }`}</span>\n        </Item>\n    );\n};\n\ninterface SeasonEditorListProps {\n    castSize: number;\n    setTwistsValid: (valid: boolean) => void;\n}\n\ninterface SeasonEditorListState {\n    items: SeasonEditorListItem[];\n}\n\ninterface SeasonEditorListItem {\n    id: string;\n    weekText: string;\n    episode: EpisodeType;\n    isValid: boolean;\n}\n\nexport const twistCapacity$ = new BehaviorSubject<number>(0);\n\nfunction shouldIncrement(items: SeasonEditorListItem[], i: number): boolean {\n    if (i + 1 >= items.length) return false; // there is no current item (or next item), so who cares\n    const item = items[i];\n    if (item.episode.pseudo) return false;\n    const nextItem = items[i + 1];\n    if (nextItem.episode.chainable) return false; // next is chainable\n    if (!nextItem.episode.pseudo) return true; // next is normal episode\n    // next is pseudo, so we need to check if there is a next next item until we find a non-pseudo\n    for (let j = i + 2; j < items.length; j++) {\n        const nextNextItem = items[j];\n        const notPseudo = !nextNextItem.episode.pseudo;\n        if (notPseudo) {\n            // false for chainable, true for normal\n            return !nextNextItem.episode.chainable;\n        }\n    }\n    return false; // exhausted the list, return false\n}\n\nexport class SeasonEditorList extends React.Component<SeasonEditorListProps, SeasonEditorListState> {\n    private id: number = 0;\n    private subs: Subscription[] = [];\n\n    public constructor(props: SeasonEditorListProps) {\n        super(props);\n        _castSize = props.castSize;\n        const elements: SeasonEditorListItem[] = [];\n        let week: number = 0;\n        for (let i = props.castSize; i > 3; i--) {\n            week++;\n            elements.push({\n                id: (this.id++).toString(),\n                weekText: `Week ${week}: F${i}`,\n                episode: BigBrotherVanilla,\n                isValid: true,\n            });\n        }\n        _items = elements;\n        this.state = { items: elements };\n    }\n\n    private maxCapacity(): number {\n        return this.props.castSize - 3;\n    }\n\n    private updateTwistCapacity(newCapacity: number) {\n        twistCapacity$.next(newCapacity);\n    }\n\n    private addRemoveTwist(twist: { type: EpisodeType; add: boolean }) {\n        this.updateTwistCapacity(\n            twist.add\n                ? min([twistCapacity$.value - twist.type.eliminates, this.maxCapacity()]) || 0\n                : twistCapacity$.value + twist.type.eliminates\n        );\n        // add or remove the twist\n        if (twist.add) {\n            // remove X vanilla episodes, then add the twist\n            const newItems = Array.from(this.state.items);\n            const nonChainableInsertAt = removeFirstNMatching(\n                newItems,\n                twist.type.eliminates,\n                (item) => item.episode === BigBrotherVanilla,\n                twist.type.chainable ? 1 : 0\n            );\n            // if chainable, add at index 1 instead\n            const chainableInsertAt = newItems.findIndex(\n                (value, index, _) => index > 0 && value.episode === BigBrotherVanilla\n            );\n            const newItem = {\n                id: (this.id++).toString(),\n                weekText: ``,\n                episode: twist.type,\n                isValid: true,\n            };\n\n            newItems.splice(twist.type.chainable ? chainableInsertAt : nonChainableInsertAt, 0, newItem);\n            this.refreshItems(newItems);\n        } else {\n            // remove the LAST instance of the twist, and add X vanilla episodes\n            const newItems = Array.from(this.state.items);\n            const i = removeLast1Matching(newItems, (item) => {\n                const equalTeamsLookupIds = twist.type.teamsLookupId\n                    ? twist.type.teamsLookupId === item.episode.teamsLookupId\n                    : false;\n                return item.episode === twist.type || equalTeamsLookupIds;\n            });\n            this.refreshItems(newItems, i);\n        }\n    }\n\n    public componentDidMount() {\n        twistCapacity$.next(this.maxCapacity());\n        this.subs.push(twist$.subscribe((twist) => this.addRemoveTwist(twist)));\n    }\n\n    public componentWillUnmount(): void {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    private refreshItems(newItems: SeasonEditorListItem[], addIndex?: number) {\n        const finalItems = [];\n        let week: number = 1;\n        let playerCount: number = this.props.castSize;\n        let i = 0;\n        for (const item of newItems) {\n            const increment = shouldIncrement(newItems, i);\n            const chainable: boolean = !!item.episode.chainable;\n            // FIXME: playerCount !== this.props.castSize // may become invalid when we do battlebacks\n            // because you could have a battleback to maxplayers immediately into a double eviction\n            const isValidChain: boolean = chainable ? playerCount !== this.props.castSize : true;\n            const isValid = item.episode.canPlayWith(playerCount) && isValidChain;\n            item.weekText = `Week ${week}: F${playerCount}`;\n            item.isValid = isValid;\n            playerCount -= item.episode.eliminates;\n            // delete all vanilla big brother episodes if player count is below 3\n            if (isValid || item.episode !== BigBrotherVanilla) {\n                finalItems.push(item);\n            }\n            increment && week++;\n            i++;\n        }\n        // if we have to add new vanilla episodes b/c we dont have enough to get to F4, add them\n        if (playerCount > 3) {\n            while (playerCount > 3) {\n                week++;\n                const item = {\n                    id: (this.id++).toString(),\n                    weekText: `Week ${week || 1}: F${playerCount}`,\n                    episode: BigBrotherVanilla,\n                    isValid: true,\n                };\n                if (addIndex !== undefined) {\n                    finalItems.splice(addIndex, 0, item);\n                } else {\n                    finalItems.unshift(item);\n                }\n                playerCount--;\n            }\n            this.refreshItems(finalItems);\n        }\n        _items = finalItems;\n        this.setState({ items: finalItems });\n        this.props.setTwistsValid(finalItems.every((item) => item.isValid));\n    }\n    public render() {\n        const onDragEnd = (result: any) => {\n            if (!result.destination) {\n                return;\n            }\n            const newItems = Array.from(this.state.items);\n            const [removed] = newItems.splice(result.source.index, 1);\n            newItems.splice(result.destination.index, 0, removed);\n            this.refreshItems(newItems);\n        };\n        const items = this.state.items;\n        return (\n            <DragDropContext onDragEnd={onDragEnd}>\n                <Droppable droppableId=\"droppable\">\n                    {(provided) => (\n                        <div {...provided.droppableProps} ref={provided.innerRef}>\n                            {items.map((item, index) => (\n                                <Draggable key={item.id} draggableId={item.id} index={index}>\n                                    {(provided, snapshot) => (\n                                        <ListItem provided={provided} snapshot={snapshot} item={item} />\n                                    )}\n                                </Draggable>\n                            ))}\n                            {provided.placeholder}\n                        </div>\n                    )}\n                </Droppable>\n            </DragDropContext>\n        );\n    }\n}\n","import React from \"react\";\nimport { Subject, Subscription } from \"rxjs\";\nimport { NumericInputStyle } from \"../castingScreen/numericInput\";\nimport { EpisodeType } from \"../episode/episodes\";\nimport { Tooltip } from \"../tooltip/tooltip\";\nimport { twistCapacity$ } from \"./seasonEditorList\";\nimport { Label } from \"./seasonEditorPage\";\n\nexport const twist$ = new Subject<{ type: EpisodeType; add: boolean }>();\n\nexport function getEmoji(episode: EpisodeType): string {\n    return episode.emoji ? `${episode.emoji} ` : \"\";\n}\n\ninterface TwistAdderProps {\n    type: EpisodeType;\n}\n\nexport class TwistAdder extends React.Component<\n    TwistAdderProps,\n    { twistCount: number; twistCapacity: number }\n> {\n    private subs: Subscription[];\n\n    public constructor(props: TwistAdderProps) {\n        super(props);\n        this.state = { twistCount: 0, twistCapacity: twistCapacity$.value };\n        this.subs = [];\n    }\n\n    public componentDidMount(): void {\n        this.subs.push(twistCapacity$.subscribe((twistCapacity) => this.setState({ twistCapacity })));\n    }\n\n    public componentWillUnmount(): void {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    public render(): JSX.Element {\n        const twistCount = this.state.twistCount;\n        const overCapacity = this.state.twistCapacity < this.props.type.eliminates;\n        const atCapacity = this.state.twistCapacity <= this.props.type.eliminates;\n        // chainables disable one early b/c they can't be the first episode\n        const isDisabled = this.props.type.chainable ? atCapacity : overCapacity;\n        return (\n            <div\n                className=\"column is-5-desktop is-5-widescreen is-5-fullhd is-12-tablet\"\n                style={{\n                    border: \"1px solid #808080\",\n                    borderRadius: \"4px\",\n                    backgroundColor: \"#444346\",\n                    margin: \"10px\",\n                }}\n            >\n                <Tooltip wide={true} text={this.props.type.description || \"\"}>\n                    <div className=\"field has-addons has-addons-centered\" style={{ textAlign: \"center\" }}>\n                        <p className=\"field-label is-normal control\">\n                            <Label className=\"label\">\n                                {getEmoji(this.props.type)}\n                                {this.props.type.name}\n                            </Label>\n                        </p>\n                        <p className=\"control\">\n                            <button\n                                className=\"button is-danger\"\n                                disabled={twistCount === 0}\n                                onClick={() => {\n                                    twist$.next({ type: this.props.type, add: false });\n                                    this.setState({ twistCount: twistCount - 1 });\n                                }}\n                            >\n                                -\n                            </button>\n                        </p>\n                        <p className=\"control\">\n                            <NumericInputStyle className=\"input\" readOnly value={`${twistCount}`} />\n                        </p>\n                        <p className=\"control\">\n                            <button\n                                className=\"button is-success\"\n                                onClick={() => {\n                                    twist$.next({ type: this.props.type, add: true });\n                                    this.setState({ twistCount: twistCount + 1 });\n                                }}\n                                disabled={isDisabled}\n                            >\n                                +\n                            </button>\n                        </p>\n                    </div>\n                </Tooltip>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { Scene } from \"./scenes/scene\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\nimport { defaultContent } from \"./bigBrotherEpisode\";\nimport { getEmoji } from \"../seasonEditor/twistAdder\";\n\nexport interface InitEpisode {\n    scenes: Scene[];\n    title?: string;\n    content?: JSX.Element;\n    gameState: GameState;\n    initialGamestate?: GameState;\n    type: EpisodeType;\n}\n\nexport class Episode {\n    readonly scenes: Scene[];\n    readonly title: string;\n    readonly content: JSX.Element;\n    readonly gameState: GameState; // State of the game after a phase.\n    readonly initialGameState: GameState;\n    readonly type: EpisodeType;\n    get render(): JSX.Element {\n        const viewsBar = this.type.hasViewsbar ? <ViewsBar gameState={this.scenes[0].gameState} /> : null;\n        return (\n            <div>\n                {viewsBar}\n                {this.content}\n            </div>\n        );\n    }\n\n    constructor(init: InitEpisode) {\n        this.scenes = init.scenes;\n        this.title = init.title || `Week ${init.gameState.phase} ${getEmoji(init.type)}`;\n        this.content = init.content || defaultContent(init.initialGamestate || init.gameState);\n        this.gameState = init.gameState;\n        this.initialGameState = init.initialGamestate || init.gameState;\n        this.type = init.type;\n    }\n}\n\nexport interface EpisodeType {\n    readonly canPlayWith: (n: number) => boolean;\n    readonly eliminates: number;\n    readonly arrowsEnabled?: boolean;\n    readonly hasViewsbar?: boolean;\n    readonly chainable?: boolean;\n    readonly pseudo?: boolean;\n    readonly name?: string;\n    readonly emoji?: string;\n    readonly description?: string;\n    readonly teamsLookupId?: number;\n    readonly generate: (gameState: GameState) => Episode;\n}\n","import { GameState, Houseguest, EpisodeType, Episode } from \"../../model\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateNomCeremonyScene } from \"./scenes/nomCeremonyScene\";\nimport { generateVetoCompScene } from \"./scenes/vetoCompScene\";\nimport { generateVetoCeremonyScene } from \"./scenes/vetoCeremonyScene\";\nimport { generateEvictionScene } from \"./scenes/evictionScene\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Scene } from \"./scenes/scene\";\nimport { HasText } from \"../layout/text\";\nimport styled from \"styled-components\";\nimport { weekStartTab$ } from \"../../subjects/subjects\";\nimport { WeekStartWrapper } from \"./bigBrotherWeekstartWrapper\";\nimport { GoldenVeto, Veto } from \"./veto/veto\";\n\nexport const BigBrotherVanilla: EpisodeType = {\n    canPlayWith: (n: number) => {\n        return n > 3;\n    },\n    eliminates: 1,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n    name: \"BigBrotherVanilla\",\n    emoji: \"\",\n    description: \"\",\n    generate: generateBbVanilla,\n};\n\nconst TabItem = styled.li`\n    cursor: pointer;\n`;\n\n// Refactoring ideas\n/**\n * Might be best to start passing ids instead of houseguests for HoH/nominees/veto winner\n */\n\nfunction Tab(props: { text: string; active: number; id: number; setActive: any }): JSX.Element {\n    return (\n        <TabItem\n            className={props.active === props.id ? \"is-active\" : \"\"}\n            onClick={() => {\n                props.setActive(props.id);\n                weekStartTab$.next(props.id);\n            }}\n        >\n            <a>{props.text}</a>\n        </TabItem>\n    );\n}\n\nexport function Tabs(): JSX.Element {\n    const [active, setActive] = React.useState(weekStartTab$.value);\n    return (\n        <div className=\"tabs is-centered is-fullwidth is-medium\" style={{ marginBottom: 0 }}>\n            <ul style={{ paddingLeft: 0 }}>\n                <Tab text={\"Memory Wall\"} active={active} setActive={setActive} id={0} />\n                <Tab text={\"Alliances\"} active={active} setActive={setActive} id={1} />\n            </ul>\n        </div>\n    );\n}\n\nexport function defaultContent(initialGameState: GameState) {\n    return (\n        <HasText>\n            <Tabs />\n            <WeekStartWrapper gameState={initialGameState} />\n            <br />\n            <NextEpisodeButton />\n        </HasText>\n    );\n}\n\nexport function generateBbVanilla(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, GoldenVeto);\n    return new Episode({\n        scenes: episode.scenes,\n        gameState: new GameState(episode.gameState),\n        initialGamestate,\n        type: BigBrotherVanilla,\n    });\n}\n\nexport function generateBBVanillaScenes(\n    initialGamestate: GameState,\n    veto: Veto | null,\n    doubleEviction: boolean = false\n): {\n    gameState: GameState;\n    scenes: Scene[];\n} {\n    let hohArray: Houseguest[];\n    let currentGameState: GameState;\n    let hohCompScene: Scene;\n    const scenes: Scene[] = [];\n\n    [currentGameState, hohCompScene, hohArray] = generateHohCompScene(initialGamestate, { doubleEviction });\n    const hoh = hohArray[0];\n    scenes.push(hohCompScene);\n\n    let nomCeremonyScene;\n    let nominees: Houseguest[];\n    [currentGameState, nomCeremonyScene, nominees] = generateNomCeremonyScene(currentGameState, [hoh], {\n        doubleEviction,\n    });\n    scenes.push(nomCeremonyScene);\n\n    return generateVetoScenesOnwards(veto, currentGameState, hoh, nominees, doubleEviction, scenes, []);\n}\nexport function generateVetoScenesOnwards(\n    veto: Veto | null,\n    currentGameState: GameState,\n    hoh: Houseguest,\n    nominees: Houseguest[],\n    doubleEviction: boolean,\n    scenes: Scene[],\n    immuneHgs: Houseguest[]\n) {\n    let povWinner: Houseguest | undefined = undefined;\n    if (veto) {\n        let vetoCompScene;\n        [currentGameState, vetoCompScene, povWinner] = generateVetoCompScene(\n            currentGameState,\n            [hoh],\n            nominees,\n            veto,\n            doubleEviction\n        );\n        scenes.push(vetoCompScene);\n        let vetoCeremonyScene;\n\n        [currentGameState, vetoCeremonyScene, nominees] = generateVetoCeremonyScene(\n            currentGameState,\n            [hoh],\n            nominees,\n            povWinner,\n            doubleEviction,\n            veto,\n            immuneHgs\n        );\n        scenes.push(vetoCeremonyScene);\n    }\n    let evictionScene;\n    [currentGameState, evictionScene] = generateEvictionScene(currentGameState, [hoh], nominees, {\n        doubleEviction,\n        votingTo: \"Evict\",\n    });\n    if (veto === null) {\n        currentGameState.currentLog.nominationsPostVeto = currentGameState.currentLog.nominationsPreVeto;\n    }\n    scenes.push(evictionScene);\n    return { gameState: currentGameState, scenes };\n}\n","import React from \"react\";\nimport { GameState } from \"../../../model/gameState\";\nimport { ViewsBar } from \"../../viewsBar/viewBar\";\ninterface InitScene {\n    readonly title: string;\n    readonly gameState: GameState;\n    readonly content: JSX.Element;\n}\nexport class Scene {\n    readonly title: string = \"\";\n    readonly gameState: GameState = new GameState({ players: [], jury: -1 });\n    readonly content: JSX.Element = (<div>{`Error while rendering ${this.title}`}</div>);\n    public render: JSX.Element;\n    public constructor(init: Partial<InitScene>) {\n        Object.assign(this, init);\n        this.render = (\n            <div>\n                <ViewsBar gameState={this.gameState} />\n                {this.content}\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { switchSceneRelative } from \"../../subjects/subjects\";\n\nexport function NextEpisodeButton(): JSX.Element {\n    return (\n        <button className=\"button is-primary\" onClick={() => switchSceneRelative(1)}>\n            Continue\n        </button>\n    );\n}\n","import React from \"react\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\n\nconst FullscreenIcon = styled.img`\n    position: -webkit-sticky;\n    position: sticky;\n    top: 20px;\n    right: 20px;\n`;\n\nexport function FullscreenButton(): JSX.Element {\n    return (\n        <FullscreenIcon\n            src={\n                \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAASElEQVRIiWNgGAUEACMa/z+R6ohWz0Sqi0gFLIRcQAAQDAGa+2DoWzAKRgH1wX8G3OULWfqHfkYbsNIUPR5IrQ/gYLQsGngAAEPgCRZjAdYSAAAAAElFTkSuQmCC\"\n            }\n            className=\"button is-rounded\"\n            onClick={() => {\n                isFullscreen$.next(!isFullscreen$.getValue());\n            }}\n        />\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { EpisodeLog } from \"../../model/logging/episodelog\";\nimport { CenteredBold, Centered, CenteredItallic } from \"../layout/centered\";\nimport { GameState, getById } from \"../../model\";\nimport { VoteType, WinnerVote, RunnerUpVote } from \"../../model/logging/voteType\";\nimport { FullscreenButton } from \"../mainPage/fullscreenButton\";\nimport { ColorTheme } from \"../../theme/theme\";\nimport _ from \"lodash\";\n\nexport const PaddedCell = styled.td`\n    padding: 0.1em 0.4em;\n`;\n\nexport const EndgameTableCell = styled(PaddedCell)`\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n`;\n\nconst EndgameTable = styled.table`\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n    border-collapse: collapse;\n`;\n\nconst GrayCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.grayCell};\n`;\n\nexport const SaveCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.saveCell};\n`;\n\nexport const NotEligibleCell = styled(EndgameTableCell)`\n    background-color: #7d7d7d;\n`;\n\nconst White = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.lightGrayCell};\n`;\n\nconst Evicted = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.evictedCell};\n`;\n\nexport const WinnerCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.winnerCell};\n`;\n\nexport const RunnerUpCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.runnerUpCell};\n`;\n\nexport const NomineeCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.nomineeCell};\n`;\n\nexport const HohCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.hohCell};\n`;\nexport const PoVCell = styled(EndgameTableCell)`\n    background-color: #78773f;\n`;\n\nconst BlackRow = styled.tr`\n    height: 0.4em;\n    background-color: #000000;\n`;\nlet anotherKey = 0;\nexport function generateVotingTable(gameState: GameState): JSX.Element {\n    const masterLog: EpisodeLog[][] = gameState.log;\n    const houseguestCells: JSX.Element[][] = [];\n    gameState.houseguests.forEach((hg, i) => {\n        houseguestCells[hg.id] = [\n            <GrayCell key={`hg-name---${i}`}>\n                <CenteredBold noMargin={true}>{hg.name}</CenteredBold>\n            </GrayCell>,\n        ];\n    });\n    const evictionOrder: [number, number][] = [];\n    const topRowCells: JSX.Element[] = [];\n    const preVetoCells: JSX.Element[] = [];\n    const vetoCells: JSX.Element[] = [];\n    const postVetoCells: JSX.Element[] = [];\n    const evictedCells: JSX.Element[] = [];\n    const winnerCells: JSX.Element[] = [];\n    masterLog.forEach((logs: EpisodeLog[] | undefined, week) => {\n        // multiple entries (ie. a double eviction) will all share the same toprow\n        generateTopRow(\n            logs ? logs[0] : undefined,\n            week,\n            topRowCells,\n            masterLog.length - 1,\n            logs ? logs.length : -1 // -1 doesn't matter because its unread\n        );\n        const iterateLogs = logs ? logs : [undefined]; // this is incredibly dank\n        let pseudoCount = 0;\n        iterateLogs.forEach((log: EpisodeLog | undefined) => {\n            // either no log (table headers) or a nonpseudo log\n            if (!log || !log.pseudo) {\n                generatePreVetoRow(log, week, preVetoCells, pseudoCount);\n                generateVetoRow(log, week, vetoCells, pseudoCount);\n                generatePostVetoRow(log, week, postVetoCells, pseudoCount);\n                generateEvictedRow(log, week, evictedCells, winnerCells, gameState, pseudoCount);\n            }\n            if (!log) return;\n            log.evicted.forEach((evicted) => evictionOrder.push([evicted, week]));\n\n            if (log.runnerUp !== undefined) evictionOrder.push([log.runnerUp, week]);\n            if (log.winner !== undefined) evictionOrder.push([log.winner, week]);\n            // add each of the votes to the houseguest cells\n            for (const [key, value] of Object.entries(log.votes)) {\n                // typescript for .. in loops kinda suck so i need to do a sketchy type conversion\n                const id: number = key as unknown as number;\n                const vote: VoteType = value;\n                houseguestCells[id].push(vote.render(gameState));\n            }\n            if (log.winner !== undefined && log.runnerUp !== undefined) {\n                houseguestCells[log.winner].push(new WinnerVote().render(gameState));\n                houseguestCells[log.runnerUp].push(new RunnerUpVote().render(gameState));\n                evictedCells.push(\n                    <RunnerUpCell key={\"runnerUp\"}>\n                        <CenteredBold noMargin={true}>{getById(gameState, log.runnerUp).name}</CenteredBold>\n                        <Centered noMargin={true}>\n                            <small>Finalist</small>\n                        </Centered>\n                    </RunnerUpCell>\n                );\n                winnerCells.push(\n                    <WinnerCell key={\"winner\"}>\n                        <CenteredBold noMargin={true}>{getById(gameState, log.winner).name}</CenteredBold>\n                        <Centered noMargin={true}>\n                            <small>Winner</small>\n                        </Centered>\n                    </WinnerCell>\n                );\n            }\n            if (log.pseudo) {\n                pseudoCount++;\n            } else {\n                pseudoCount = 0;\n            }\n        });\n    });\n    preVetoCells.push(\n        <White key={`preveto--finale`} rowSpan={3}>\n            <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n        </White>\n    );\n    const winnerRow = <tr>{winnerCells}</tr>;\n    const topRow = <tr>{topRowCells}</tr>;\n    const preVetoRow = <tr>{preVetoCells}</tr>;\n    const vetoRow = <tr>{vetoCells}</tr>;\n    const postVetoRow = <tr>{postVetoCells}</tr>;\n\n    const houseguestRows: JSX.Element[] = [];\n    const evictedRow = <tr>{evictedCells}</tr>;\n    let desiredLength = -1;\n    evictionOrder.reverse().forEach(([id, week], i) => {\n        if (i === 0) desiredLength = houseguestCells[id].length;\n        if (i > 1) {\n            const weekText = i === 2 ? \"(Finale)\" : `(Week ${week})`;\n            const evicted = (\n                <Evicted\n                    colSpan={desiredLength - houseguestCells[id].length}\n                    key={`evicted-week-${weekText}-${i}`}\n                >\n                    <CenteredItallic noMargin={true}>Evicted</CenteredItallic>\n                    <CenteredItallic noMargin={true}>\n                        <small>{weekText}</small>\n                    </CenteredItallic>\n                </Evicted>\n            );\n            if (!getById(gameState, id).isJury) {\n                houseguestCells[id].push(evicted); // not jury, they dead\n            } else {\n                const tempList = houseguestCells[id].slice(0, -1);\n                tempList.push(evicted);\n                tempList.push(houseguestCells[id][houseguestCells[id].length - 1]);\n                houseguestCells[id] = tempList;\n            }\n        }\n        houseguestRows.push(<tr key={`hgrow--${id}--${anotherKey++}`}>{houseguestCells[id]}</tr>);\n    });\n    // hey if it works it works\n    const blackRow = (\n        <BlackRow>\n            <td colSpan={Number.MAX_SAFE_INTEGER} />\n        </BlackRow>\n    );\n    return (\n        <div>\n            <FullscreenButton />\n            <EndgameTable>\n                <tbody>\n                    {topRow}\n                    {preVetoRow}\n                    {vetoRow}\n                    {postVetoRow}\n                    {blackRow}\n                    {houseguestRows}\n                    {blackRow}\n                    {evictedRow}\n                    {winnerRow}\n                </tbody>\n            </EndgameTable>\n        </div>\n    );\n}\n\nfunction generateEvictedRow(\n    log: EpisodeLog | undefined,\n    week: number,\n    cells: JSX.Element[],\n    winnerCells: JSX.Element[],\n    gameState: GameState,\n    pseudoCount: number\n) {\n    if (!log) {\n        cells.push(\n            <GrayCell key={`evicted${week}--${anotherKey++}`} rowSpan={2}>\n                <CenteredBold noMargin={true}>Evicted</CenteredBold>\n            </GrayCell>\n        );\n        return;\n    }\n    if (log.pseudo) return; // no evicted row for a pseudoepisode\n\n    const saveOrEvict =\n        log.soleVoter !== undefined ? \"evict\" : (log.votingTo && log.votingTo.toLowerCase()) || \"evict\";\n\n    const colspan = 1 + pseudoCount;\n    // for stuff like safety chain\n    if (log.customEvicted.length > 0) {\n        const names = log.customEvicted.map((hg) => [\n            <b key={`ev-name-${anotherKey++}`}>{getById(gameState, hg).name}</b>,\n            <br key={`ev-name-${anotherKey++}`} />,\n        ]);\n\n        const content = (\n            <NotEligibleCell key={`evicted${week}--${anotherKey++}`} rowSpan={2} colSpan={colspan}>\n                <Centered noMargin={true}>\n                    {names}\n                    <small>{log.customEvictedText}</small>\n                </Centered>\n            </NotEligibleCell>\n        );\n        cells.push(content);\n\n        return;\n    }\n\n    const rowSpan = log.evicted.length === 1 ? 2 : 1;\n    log.evicted.forEach((evicted, i) => {\n        const voteTextLine1 =\n            log.soleVoter !== undefined\n                ? `${log.soleVoter}'s choice`\n                : `${\n                      log.votingTo === \"Save\"\n                          ? Object.values(log.votes).filter((vote) => vote.id === evicted).length\n                          : log.votesInMajority\n                  } of ${log.outOf} votes`;\n\n        const content = (\n            <Evicted key={`evicted${i}--${anotherKey++}`} rowSpan={rowSpan} colSpan={colspan}>\n                <Centered noMargin={true}>\n                    <b>{getById(gameState, evicted).name}</b>\n                    <br />\n                    <small>\n                        {voteTextLine1} <br />\n                        to {saveOrEvict}\n                    </small>\n                </Centered>\n            </Evicted>\n        );\n        if (i === 0) cells.push(content);\n        else winnerCells.push(content);\n    });\n}\n\nfunction generatePostVetoRow(\n    log: EpisodeLog | undefined,\n    week: number,\n    cells: JSX.Element[],\n    pseudoCount: number\n) {\n    const colspan = 1 + pseudoCount;\n    if (!log) {\n        cells.push(\n            <GrayCell key={`postVeto--${week}-${anotherKey++}`} colSpan={colspan}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(post-veto)</small>\n                </CenteredBold>\n            </GrayCell>\n        );\n        return;\n    }\n    if (log.nominationsPostVeto.length === 0) return;\n    cells.push(\n        <White key={`preveto--${week}-${anotherKey++}`} colSpan={colspan}>\n            <Centered noMargin={true}>\n                {interleave(\n                    log.nominationsPostVeto as any,\n                    (key) => (\n                        <br key={`preveto--br--${week}-${key++}`} />\n                    ),\n                    anotherKey\n                )}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateVetoRow(\n    log: EpisodeLog | undefined,\n    week: number,\n    cells: JSX.Element[],\n    pseudoCount: number\n) {\n    const colspan = 1 + pseudoCount;\n\n    if (!log) {\n        cells.push(\n            <GrayCell key={`veto--${week}-${anotherKey++}`} colSpan={colspan}>\n                <CenteredBold noMargin={true}>Veto Winner</CenteredBold>\n            </GrayCell>\n        );\n        return;\n    }\n    if (log.vetoWinner === undefined) return;\n\n    cells.push(\n        <White key={`veto--${week}-${anotherKey++}`} colSpan={colspan}>\n            <Centered noMargin={true}>{log.vetoWinner}</Centered>\n        </White>\n    );\n}\n\n// javascript is my passion\nfunction interleave<T>(arr: T[], thing: (key: number) => T, key: number): T[] {\n    return ([] as T[]).concat(...arr.map((n: T) => [n, thing(key++)])).slice(0, -1);\n}\n\nfunction generatePreVetoRow(\n    log: EpisodeLog | undefined,\n    week: number,\n    cells: JSX.Element[],\n    pseudoCount: number\n) {\n    if (!log) {\n        cells.push(\n            <GrayCell key={`preveto--${week}-${anotherKey++}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(pre-veto)</small>\n                </CenteredBold>\n            </GrayCell>\n        );\n        return;\n    }\n    const noNomsPreVeto = log.nominationsPreVeto.length === 0;\n    const noVetoWinner = log.vetoWinner === undefined;\n    const noNomsPostveto = log.nominationsPostVeto.length === 0;\n    const colspan = 1 + pseudoCount;\n\n    if (noNomsPreVeto && noVetoWinner && noNomsPostveto) {\n        cells.push(\n            <White key={`preveto--${week}-${anotherKey++}`} rowSpan={3} colSpan={colspan}>\n                <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n            </White>\n        );\n        return;\n    }\n    if (noNomsPreVeto || noVetoWinner) {\n        cells.push(\n            <White key={`preveto--${week}-${anotherKey++}`} rowSpan={2} colSpan={colspan}>\n                <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n            </White>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`preveto--${week}-${anotherKey++}`} colSpan={colspan}>\n            <Centered noMargin={true}>\n                {interleave(\n                    [\n                        ...log.nominationsPreVeto,\n                        ...log.strikethroughNominees.map((txt) => <del>{txt}</del>),\n                    ] as any,\n                    (key) => (\n                        <br key={`preveto--br--${week}-${key++}`} />\n                    ),\n                    anotherKey\n                )}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateTopRow(\n    log: EpisodeLog | undefined,\n    week: number,\n    cells: JSX.Element[],\n    max: number,\n    colspan: number\n) {\n    if (!log) {\n        cells.push(<GrayCell key={`toprow--${week}`} />);\n        return;\n    }\n    if (week === max) {\n        cells.push(\n            <GrayCell key={`toprow--${week}`} colSpan={2}>\n                <CenteredBold noMargin={true}>Finale</CenteredBold>\n            </GrayCell>\n        );\n        return;\n    }\n    cells.push(\n        <GrayCell key={`toprow--${week}`} colSpan={colspan}>\n            <CenteredBold noMargin={true}>Week {week}</CenteredBold>\n        </GrayCell>\n    );\n}\n","import React from \"react\";\nimport { GameState, getById } from \"../gameState\";\nimport { CenteredItallic, Centered } from \"../../components/layout/centered\";\nimport {\n    EndgameTableCell,\n    WinnerCell,\n    RunnerUpCell,\n    NomineeCell,\n    HohCell,\n    SaveCell,\n    PoVCell,\n    NotEligibleCell,\n    PaddedCell,\n} from \"../../components/votingTable/votingTable\";\n\nlet voteKey = 0;\n\nfunction getKey(): string {\n    return `${voteKey++}-- vote key`;\n}\n\nexport interface VoteType {\n    id: number;\n    render: (state: GameState) => JSX.Element;\n}\n\nexport class SaveVote implements VoteType {\n    id: number;\n    text: string = \"\";\n    render = (state: GameState) => (\n        <SaveCell key={getKey()}>\n            <Centered noMargin={true}>{this.text ? this.text : getById(state, this.id).name}</Centered>\n        </SaveCell>\n    );\n    constructor(id: number, text?: string) {\n        this.id = id;\n        text !== undefined && (this.text = text);\n    }\n}\n\nexport class NormalVote implements VoteType {\n    id: number;\n    render = (state: GameState) => (\n        <EndgameTableCell key={getKey()}>\n            <Centered noMargin={true}>{getById(state, this.id).name}</Centered>\n        </EndgameTableCell>\n    );\n    constructor(id: number) {\n        this.id = id;\n    }\n}\n\nexport class WinnerVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <WinnerCell key={\"winner---\"}>\n            <Centered noMargin={true}>Winner</Centered>\n        </WinnerCell>\n    );\n}\n\nexport class RunnerUpVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <RunnerUpCell key={\"runnerUp---\"}>\n            <Centered noMargin={true}>Finalist</Centered>\n        </RunnerUpCell>\n    );\n}\n\nexport class NomineeVote implements VoteType {\n    id: number = -1;\n    evicted: boolean;\n    render = (state: GameState) => (\n        <NomineeCell key={getKey()}>\n            <CenteredItallic noMargin={true}>Nominated</CenteredItallic>\n        </NomineeCell>\n    );\n    constructor(evicted: boolean) {\n        this.evicted = evicted;\n    }\n}\n\nexport class PoVvote implements VoteType {\n    id: number;\n    render = (state: GameState) => {\n        return (\n            <PoVCell key={getKey()}>\n                <CenteredItallic noMargin={true}>{getById(state, this.id).name}</CenteredItallic>\n            </PoVCell>\n        );\n    };\n    constructor(id: number) {\n        this.id = id;\n    }\n}\n\nexport class GrayVote implements VoteType {\n    id: number = -1;\n    text: string = \"\";\n    render = (state: GameState) => {\n        return (\n            <NotEligibleCell key={getKey()}>\n                <CenteredItallic noMargin={true}>{this.text} </CenteredItallic>\n            </NotEligibleCell>\n        );\n    };\n    constructor(text: string) {\n        this.text = text;\n    }\n}\n\nexport class HoHVote implements VoteType {\n    id: number;\n\n    get hohText(): JSX.Element {\n        return (\n            <CenteredItallic noMargin={true}>\n                Head of\n                <br />\n                Household\n            </CenteredItallic>\n        );\n    }\n\n    private hohVote(state: GameState): JSX.Element {\n        return <CenteredItallic noMargin={true}>{getById(state, this.id).name}</CenteredItallic>;\n    }\n\n    render = (state: GameState) => {\n        return <HohCell key={getKey()}>{this.id == -1 ? this.hohText : this.hohVote(state)}</HohCell>;\n    };\n    constructor(id?: number) {\n        this.id = id === undefined ? -1 : id;\n    }\n}\n\nexport class TeamVote implements VoteType {\n    public id: number = -1;\n    private color: string;\n    render = (_: GameState): JSX.Element => {\n        return <EndgameTableCell key={getKey()} style={{ backgroundColor: this.color }} />;\n    };\n    constructor(color: string) {\n        this.color = color;\n    }\n}\n\nexport class EndTeamVote implements VoteType {\n    public id: number = -1;\n    private color: string;\n    render = (_: GameState): JSX.Element => {\n        return (\n            <PaddedCell key={getKey()} style={{ backgroundColor: this.color }}>\n                🏁\n            </PaddedCell>\n        );\n    };\n    constructor(color: string) {\n        this.color = color;\n    }\n}\n","export function listNames(names: string[]): string {\n    if (names.length === 0) {\n        return \"\";\n    }\n    if (names.length === 1) {\n        return names[0];\n    }\n    if (names.length === 2) {\n        return names[0] + \" and \" + names[1];\n    }\n    return names.slice(0, names.length - 1).join(\", \") + \", and \" + names[names.length - 1];\n}\n\nexport function listVotes(votes: string[]): string {\n    if (votes.length === 0) {\n        return \"\";\n    }\n    if (votes.length === 1) {\n        return votes[0];\n    }\n    if (votes.length === 2) {\n        return votes[0] + \" to \" + votes[1];\n    }\n    return votes.slice(0, votes.length - 1).join(` - `) + ` - ` + votes[votes.length - 1];\n}\n","import { exclude, GameState, Houseguest, MutableGameState, randomPlayer } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { HoHVote } from \"../../../model/logging/voteType\";\nimport { listNames } from \"../../../utils/listStrings\";\n\ninterface HohCompOptions {\n    doubleEviction?: boolean;\n    customText?: string;\n    coHoH?: boolean;\n    coHohIsFinal?: boolean;\n    skipHoHWin?: boolean;\n    compName?: string;\n    bottomText?: string;\n    competitors?: Houseguest[];\n}\n\nexport function generateHohCompScene(\n    initialGameState: GameState,\n    options: HohCompOptions\n): [GameState, Scene, Houseguest[]] {\n    const newGameState = new MutableGameState(initialGameState);\n    const coHoH = options.coHoH || false;\n    const coHohIsFinal = options.coHohIsFinal || false;\n    const doubleEviction: boolean = options.doubleEviction || false;\n    const previousHoh = initialGameState.previousHOH ? initialGameState.previousHOH : [];\n    const competitors = options.competitors || exclude(newGameState.houseguests, previousHoh);\n    const newHoH: Houseguest = randomPlayer(competitors);\n    const newHoH2: Houseguest = options.coHoH ? randomPlayer(competitors, [newHoH, ...previousHoh]) : newHoH;\n    // set previous hoh\n    if (!options.skipHoHWin) {\n        (!coHoH || coHohIsFinal) && (newGameState.previousHOH = [newHoH]);\n        coHoH && coHohIsFinal && (newGameState.previousHOH = [newHoH, newHoH2]);\n        // add hoh vote in whatever\n        (!coHoH || coHohIsFinal) && (newGameState.currentLog.votes[newHoH.id] = new HoHVote());\n        coHoH && coHohIsFinal && (newGameState.currentLog.votes[newHoH2.id] = new HoHVote());\n        // new hoh wins\n        newHoH.hohWins += 1;\n        coHoH && (newHoH2.hohWins += 1);\n    }\n    const portraitLine = coHoH ? (\n        <Portraits centered={true} houseguests={[newHoH, newHoH2]} />\n    ) : (\n        <Portrait centered={true} houseguest={newHoH} />\n    );\n    const wonText = options.bottomText\n        ? `${listNames([newHoH.name])} ${options.bottomText}`\n        : `${coHoH ? listNames([newHoH.name, newHoH2.name]) : newHoH.name} ${\n              coHoH ? \"have\" : \"has\"\n          } won Head of Household!`;\n\n    const scene = new Scene({\n        title: \"HoH Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                {options.customText !== undefined ? (\n                    <CenteredBold>{options.customText}</CenteredBold>\n                ) : (\n                    previousHoh.length > 0 &&\n                    (doubleEviction ? (\n                        <CenteredBold>\n                            Houseguests, please return to the living room. Tonight will be a{\" \"}\n                            {initialGameState.__logindex__ === 1 ? \"double\" : \"triple\"} eviction.\n                        </CenteredBold>\n                    ) : (\n                        <Centered>\n                            {`Houseguests, it's time to find a new Head of Household. As outgoing HoH, ${listNames(\n                                previousHoh.map((h) => h.name)\n                            )} will not compete.`}\n                        </Centered>\n                    ))\n                )}\n                {portraitLine}\n                <CenteredBold>{wonText}</CenteredBold>\n                <br />\n                {!doubleEviction && <NextEpisodeButton />}\n            </div>\n        ),\n    });\n\n    return [new GameState(newGameState), scene, coHoH ? [newHoH, newHoH2] : [newHoH]];\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst ShadowBox = styled.div`\n    box-shadow: ${({ theme }: { theme: ColorTheme }) =>\n        theme.name === \"light\" ? \"0 2px 3px rgba(10, 10, 10, 0.1), 0 0 0 1px rgba(10, 10, 10, 0.1)\" : \"\"};\n    border-radius: 6px;\n    margin-left: 3px;\n    margin-top: 3px;\n    margin-right: 3px;\n    background: ${({ theme }: { theme: ColorTheme }) => theme.overlay};\n`;\n\nconst StyledBox = styled.div`\n    margin-left: 3px;\n    margin-right: 3px;\n    margin-bottom: 3px;\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bodyArea};\n`;\n\nexport function DividerBox(props: any): JSX.Element {\n    return <ShadowBox className={props.className || \"\"}>{props.children}</ShadowBox>;\n}\n\nexport function Box(props: any): JSX.Element {\n    return (\n        <StyledBox style={props.style} className={`box ${props.className || \"\"}`}>\n            {props.children}\n        </StyledBox>\n    );\n}\n","/*\n * Free FFT and convolution (TypeScript)\n *\n * Copyright (c) 2020 Project Nayuki. (MIT License)\n * https://www.nayuki.io/page/free-small-fft-in-multiple-languages\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\n * this software and associated documentation files (the \"Software\"), to deal in\n * the Software without restriction, including without limitation the rights to\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\n * the Software, and to permit persons to whom the Software is furnished to do so,\n * subject to the following conditions:\n * - The above copyright notice and this permission notice shall be included in\n *   all copies or substantial portions of the Software.\n * - The Software is provided \"as is\", without warranty of any kind, express or\n *   implied, including but not limited to the warranties of merchantability,\n *   fitness for a particular purpose and noninfringement. In no event shall the\n *   authors or copyright holders be liable for any claim, damages or other\n *   liability, whether in an action of contract, tort or otherwise, arising from,\n *   out of or in connection with the Software or the use or other dealings in the\n *   Software.\n */\n\n/*\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\n * The vector can have any length. This is a wrapper function.\n */\nexport function fft(real: number[] | Float64Array, imag: number[] | Float64Array): void {\n    const n: number = real.length;\n    if (n != imag.length) throw \"Mismatched lengths\";\n    if (n == 0) return;\n    else if ((n & (n - 1)) == 0)\n        // Is power of 2\n        transformRadix2(real, imag);\n    // More complicated algorithm for arbitrary sizes\n    else transformBluestein(real, imag);\n}\n\n/*\n * Computes the inverse discrete Fourier transform (IDFT) of the given complex vector, storing the result back into the vector.\n * The vector can have any length. This is a wrapper function. This transform does not perform scaling, so the inverse is not a true inverse.\n */\nexport function inverseFFT(real: Array<number> | Float64Array, imag: Array<number> | Float64Array): void {\n    fft(imag, real);\n}\n\n/*\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\n * The vector's length must be a power of 2. Uses the Cooley-Tukey decimation-in-time radix-2 algorithm.\n */\nfunction transformRadix2(real: Array<number> | Float64Array, imag: Array<number> | Float64Array): void {\n    // Length variables\n    const n: number = real.length;\n    if (n != imag.length) throw \"Mismatched lengths\";\n    if (n == 1)\n        // Trivial transform\n        return;\n    let levels: number = -1;\n    for (let i = 0; i < 32; i++) {\n        if (1 << i == n) levels = i; // Equal to log2(n)\n    }\n    if (levels == -1) throw \"Length is not a power of 2\";\n\n    // Trigonometric tables\n    let cosTable = new Array<number>(n / 2);\n    let sinTable = new Array<number>(n / 2);\n    for (let i = 0; i < n / 2; i++) {\n        cosTable[i] = Math.cos((2 * Math.PI * i) / n);\n        sinTable[i] = Math.sin((2 * Math.PI * i) / n);\n    }\n\n    // Bit-reversed addressing permutation\n    for (let i = 0; i < n; i++) {\n        const j: number = reverseBits(i, levels);\n        if (j > i) {\n            let temp: number = real[i];\n            real[i] = real[j];\n            real[j] = temp;\n            temp = imag[i];\n            imag[i] = imag[j];\n            imag[j] = temp;\n        }\n    }\n\n    // Cooley-Tukey decimation-in-time radix-2 FFT\n    for (let size = 2; size <= n; size *= 2) {\n        const halfsize: number = size / 2;\n        const tablestep: number = n / size;\n        for (let i = 0; i < n; i += size) {\n            for (let j = i, k = 0; j < i + halfsize; j++, k += tablestep) {\n                const l: number = j + halfsize;\n                const tpre: number = real[l] * cosTable[k] + imag[l] * sinTable[k];\n                const tpim: number = -real[l] * sinTable[k] + imag[l] * cosTable[k];\n                real[l] = real[j] - tpre;\n                imag[l] = imag[j] - tpim;\n                real[j] += tpre;\n                imag[j] += tpim;\n            }\n        }\n    }\n\n    // Returns the integer whose value is the reverse of the lowest 'width' bits of the integer 'val'.\n    function reverseBits(val: number, width: number): number {\n        let result: number = 0;\n        for (let i = 0; i < width; i++) {\n            result = (result << 1) | (val & 1);\n            val >>>= 1;\n        }\n        return result;\n    }\n}\n\n/*\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\n * The vector can have any length. This requires the convolution function, which in turn requires the radix-2 FFT function.\n * Uses Bluestein's chirp z-transform algorithm.\n */\nfunction transformBluestein(real: Array<number> | Float64Array, imag: Array<number> | Float64Array): void {\n    // Find a power-of-2 convolution length m such that m >= n * 2 + 1\n    const n: number = real.length;\n    if (n != imag.length) throw \"Mismatched lengths\";\n    let m: number = 1;\n    while (m < n * 2 + 1) m *= 2;\n\n    // Trigonometric tables\n    let cosTable = new Array<number>(n);\n    let sinTable = new Array<number>(n);\n    for (let i = 0; i < n; i++) {\n        const j: number = (i * i) % (n * 2); // This is more accurate than j = i * i\n        cosTable[i] = Math.cos((Math.PI * j) / n);\n        sinTable[i] = Math.sin((Math.PI * j) / n);\n    }\n\n    // Temporary vectors and preprocessing\n    let areal: Array<number> = newArrayOfZeros(m);\n    let aimag: Array<number> = newArrayOfZeros(m);\n    for (let i = 0; i < n; i++) {\n        areal[i] = real[i] * cosTable[i] + imag[i] * sinTable[i];\n        aimag[i] = -real[i] * sinTable[i] + imag[i] * cosTable[i];\n    }\n    let breal: Array<number> = newArrayOfZeros(m);\n    let bimag: Array<number> = newArrayOfZeros(m);\n    breal[0] = cosTable[0];\n    bimag[0] = sinTable[0];\n    for (let i = 1; i < n; i++) {\n        breal[i] = breal[m - i] = cosTable[i];\n        bimag[i] = bimag[m - i] = sinTable[i];\n    }\n\n    // Convolution\n    let creal = new Array<number>(m);\n    let cimag = new Array<number>(m);\n    convolveComplex(areal, aimag, breal, bimag, creal, cimag);\n\n    // Postprocessing\n    for (let i = 0; i < n; i++) {\n        real[i] = creal[i] * cosTable[i] + cimag[i] * sinTable[i];\n        imag[i] = -creal[i] * sinTable[i] + cimag[i] * cosTable[i];\n    }\n}\n\n/*\n * Computes the circular convolution of the given real vectors. Each vector's length must be the same.\n */\nfunction convolveReal(\n    xvec: Array<number> | Float64Array,\n    yvec: Array<number> | Float64Array,\n    outvec: Array<number> | Float64Array\n): void {\n    const n: number = xvec.length;\n    if (n != yvec.length || n != outvec.length) throw \"Mismatched lengths\";\n    convolveComplex(xvec, newArrayOfZeros(n), yvec, newArrayOfZeros(n), outvec, newArrayOfZeros(n));\n}\n\n/*\n * Computes the circular convolution of the given complex vectors. Each vector's length must be the same.\n */\nfunction convolveComplex(\n    xreal: Array<number> | Float64Array,\n    ximag: Array<number> | Float64Array,\n    yreal: Array<number> | Float64Array,\n    yimag: Array<number> | Float64Array,\n    outreal: Array<number> | Float64Array,\n    outimag: Array<number> | Float64Array\n): void {\n    const n: number = xreal.length;\n    if (\n        n != ximag.length ||\n        n != yreal.length ||\n        n != yimag.length ||\n        n != outreal.length ||\n        n != outimag.length\n    )\n        throw \"Mismatched lengths\";\n\n    xreal = xreal.slice();\n    ximag = ximag.slice();\n    yreal = yreal.slice();\n    yimag = yimag.slice();\n    fft(xreal, ximag);\n    fft(yreal, yimag);\n\n    for (let i = 0; i < n; i++) {\n        const temp: number = xreal[i] * yreal[i] - ximag[i] * yimag[i];\n        ximag[i] = ximag[i] * yreal[i] + xreal[i] * yimag[i];\n        xreal[i] = temp;\n    }\n    inverseFFT(xreal, ximag);\n\n    for (let i = 0; i < n; i++) {\n        // Scaling (because this FFT implementation omits it)\n        outreal[i] = xreal[i] / n;\n        outimag[i] = ximag[i] / n;\n    }\n}\n\nfunction newArrayOfZeros(n: number): Array<number> {\n    let result: Array<number> = [];\n    for (let i = 0; i < n; i++) result.push(0);\n    return result;\n}\n","// Homebrew typescript implementation of this:\n// https://www.researchgate.net/publication/257017356_On_computing_the_distribution_function_for_the_Poisson_binomial_distribution?enrichId=rgreq-6ff78e1a69dcaf49a733e2dd0e9f2db6-XXX&enrichSource=Y292ZXJQYWdlOzI1NzAxNzM1NjtBUzo1NTg0MDU5OTE1MzA0OTZAMTUxMDE0NTc3MTQ0Mw%3D%3D&el=1_x_3&_esc=publicationCoverPdf\n\nimport _ from \"lodash\";\nimport { fft } from \"./fft\";\n\n// Due to the high complexity of this function, it has been optimized for readability.\n// And even then, it's still pretty spooky.\n\nexport function pbincdf(pp: number[]): number[] {\n    const p: number[] = [];\n    const zeros: number[] = [];\n    const ones: number[] = [];\n    pp.forEach((num) => {\n        num === 0 && zeros.push(0);\n        num === 1 && ones.push(1);\n        num !== 0 && num !== 1 && p.push(num);\n    });\n    const cdf = _pbincdf(p);\n    cdf.forEach((number, i) => (cdf[i] = 1 - number));\n    const result = ones.concat(cdf, zeros);\n    return result;\n}\n\nfunction _pbincdf(p: number[]): number[] {\n    const n = p.length;\n    const nPlusOne = n + 1;\n    const ω = (2 * Math.PI) / nPlusOne;\n    const a = [1];\n    const b = [0];\n    // STEP 1 OF THE ALGORITHM\n    const sigmaLogModulusZ = (l: number): number => {\n        let sum = 0;\n        p.forEach((p_j) => {\n            const e1 = (1 - p_j + p_j * Math.cos(ω * l)) ** 2;\n            const e2 = (p_j * Math.sin(ω * l)) ** 2;\n            sum += 0.5 * Math.log(e1 + e2);\n        });\n        return sum;\n    };\n    const sigmaPrincipalArgz = (l: number): number => {\n        let sum = 0;\n        p.forEach((p_j) => {\n            const y = p_j * Math.sin(ω * l);\n            const x = 1 - p_j + p_j * Math.cos(ω * l);\n            sum += Math.atan2(y, x);\n        });\n        return sum;\n    };\n    for (let l = 1; l <= Math.ceil(n / 2); l++) {\n        const d = Math.exp(sigmaLogModulusZ(l));\n        const sigmaArgZ = sigmaPrincipalArgz(l);\n        a[l] = d * Math.cos(sigmaArgZ);\n        b[l] = d * Math.sin(sigmaArgZ);\n    }\n    // STEP 2 OF THE ALGORITHM\n    for (let l = Math.ceil(n / 2) + 1; l <= n; l++) {\n        a[l] = a[nPlusOne - l];\n        b[l] = -b[nPlusOne - l];\n    }\n    // STEP 3 OF THE ALGORITHM\n    fft(a, b);\n    const ξ = a;\n    // STEP 4 OF THE ALGORITHM\n    const result: number[] = [];\n    ξ.forEach((a, i) => (ξ[i] = a / nPlusOne));\n    result[0] = ξ[0];\n    ξ.forEach((_, m) => {\n        if (m === 0) return;\n        result[m] = result[m - 1] + ξ[m];\n    });\n    return result;\n}\n","import { Houseguest } from \"../../model\";\nimport { pbincdf } from \"../poissonbinomial\";\nimport { pJurorVotesForHero } from \"./aiApi\";\n\nexport const relationship = (hero: Houseguest, villain: { id: number }) => hero.relationships[villain.id];\n\nexport function lowestScore<H, V>(hero: H, options: V[], callback: (hero: H, villain: V) => number) {\n    let lowestIndex = 0;\n    let lowestScore = Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore < lowestScore) {\n            lowestIndex = i;\n            lowestScore = currentScore;\n        }\n    });\n    return lowestIndex;\n}\n\n// returns the probability that the hero wins the f2 between hero and villian\nexport function pHeroWinsTheFinale(\n    hgs: { hero: Houseguest; villain: Houseguest },\n    jury: Houseguest[]\n): number {\n    const hero = hgs.hero;\n    const villain = hgs.villain;\n    const p: number[] = [];\n    jury.forEach((juror) => {\n        if (juror.id === hero.id || juror.id === villain.id) return;\n        p.push(pJurorVotesForHero(juror, hero, villain));\n    });\n    const cdf = pbincdf(p);\n    return cdf[Math.ceil((jury.length - 2) / 2) - 1];\n}\n","import _ from \"lodash\";\nimport { GameState, getById, Houseguest, inJury } from \"../../model\";\nimport { backdoorNPlayers, NumberWithLogic } from \"./aiApi\";\nimport { lowestScore, relationship } from \"./aiUtils\";\nimport { classifyRelationship, classifyTwoWayRelationship, RelationshipType } from \"./classifyRelationship\";\n\n// abandon all hope ye who enter here\n\ninterface RelationshipSummary {\n    type: RelationshipType;\n    relationship: number;\n    winrate: number;\n    id: number;\n    pHeroWins: number;\n    villainPopularity: number;\n    villianName: string;\n}\n\nconst deadValue: RelationshipSummary = {\n    type: RelationshipType.Friend,\n    id: -123456789, // to make debugging easier :)\n    pHeroWins: -1,\n    winrate: -1,\n    relationship: 2,\n    villainPopularity: 2,\n    villianName: \"This is an error\",\n};\n\nexport function getRelationshipSummary(hero: Houseguest, villain: Houseguest): RelationshipSummary {\n    const doIWin = hero.superiors[villain.id];\n    const type = classifyRelationship(hero.popularity, villain.popularity, hero.relationships[villain.id]);\n    return {\n        id: villain.id,\n        relationship: villain.relationships[hero.id],\n        type,\n        winrate: hero.powerRanking,\n        pHeroWins: doIWin,\n        villainPopularity: villain.popularity,\n        villianName: villain.name,\n    };\n}\n\nexport class Targets {\n    private firstTarget: RelationshipSummary = deadValue;\n    private secondTarget: RelationshipSummary = deadValue;\n    private hg: Houseguest;\n\n    constructor(hg: Houseguest) {\n        this.hg = hg;\n    }\n\n    public getTargets(): [number, number] {\n        return [this.firstTarget.id, this.secondTarget.id];\n    }\n    public refreshTargets(gameState: GameState) {\n        const choices = backdoorNPlayers(\n            this.hg,\n            Array.from(gameState.nonEvictedHouseguests).map((id) => getById(gameState, id)),\n            gameState,\n            2\n        );\n        this.firstTarget = getRelationshipSummary(this.hg, getById(gameState, choices[0].decision));\n        this.secondTarget = getRelationshipSummary(this.hg, getById(gameState, choices[1].decision));\n    }\n}\n\nenum WinrateStrategy {\n    Low,\n    Medium,\n    High,\n}\n\n// Statusquo goes with the status quo, underdog tries to disrupt & go after big targets, MoR goes after his personal targets\nexport enum TargetStrategy {\n    StatusQuo,\n    Underdog,\n    MoR,\n}\n\nfunction determineWinrateStrategy(hero: Houseguest): WinrateStrategy {\n    if (hero.powerRanking >= 0.45) return WinrateStrategy.High;\n    if (hero.powerRanking <= 1 / 3) return WinrateStrategy.Low;\n    return WinrateStrategy.Medium;\n}\n\nexport function determineStrategy(hero: Houseguest): TargetStrategy {\n    if (hero.friends === hero.enemies) return TargetStrategy.MoR;\n    return hero.friends > hero.enemies ? TargetStrategy.StatusQuo : TargetStrategy.Underdog;\n}\n\n// return the index of the better target\nexport function isBetterTargetWithLogic(\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    hero: Houseguest,\n    gameState: GameState\n): NumberWithLogic {\n    if (old.relationship === 2) return { decision: 1, reason: \"remove debug value\" };\n    if (neww.relationship === 2) return { decision: 0, reason: \"remove debug value\" };\n    const strategy = determineStrategy(hero);\n    const winrateStrategy = determineWinrateStrategy(hero);\n    if (strategy === TargetStrategy.StatusQuo)\n        return isBetterTargetStatusQuo(hero, old, neww, winrateStrategy, gameState);\n    else if (strategy === TargetStrategy.MoR) {\n        return isBetterTargetMoR(old, neww, gameState, hero, winrateStrategy);\n    } else {\n        return isBetterTargetUnderdog(old, neww, gameState, hero, winrateStrategy);\n    }\n}\n\nexport function isBetterTarget(\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    hero: Houseguest,\n    gameState: GameState\n): boolean {\n    return isBetterTargetWithLogic(old, neww, hero, gameState).decision === 1;\n}\n\nfunction voteBasedOnCentrality(\n    gameState: GameState,\n    internalCallback: (x: RelationshipType) => boolean\n): (hero: Houseguest, nominees: [RelationshipSummary, RelationshipSummary]) => NumberWithLogic {\n    return (hero: Houseguest, nominees: [RelationshipSummary, RelationshipSummary]): NumberWithLogic => {\n        const decision = isMoreCentral(hero, nominees[0], nominees[1], gameState, internalCallback) ? 1 : 0;\n        return {\n            decision,\n            reason: `${[nominees[0], nominees[1]][decision].villianName} is more popular among my enemies.`,\n        };\n    };\n}\n\nfunction targetEnemies(\n    hero: Houseguest,\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    callback: (\n        hero: Houseguest,\n        nominees: [RelationshipSummary, RelationshipSummary],\n        callback?: (hero: Houseguest, nominees: [RelationshipSummary, RelationshipSummary]) => NumberWithLogic\n    ) => NumberWithLogic\n): NumberWithLogic {\n    if (old.type !== RelationshipType.Enemy) return _targetEnemies();\n    if (neww.type !== RelationshipType.Enemy)\n        return { decision: 0, reason: `${old.villianName} is my enemy.` };\n    return callback(hero, [old, neww]);\n\n    function _targetEnemies() {\n        const decision = (neww.type === RelationshipType.Enemy ? true : neww.relationship < old.relationship)\n            ? 1\n            : 0;\n        return {\n            decision,\n            reason: `I like ${[old, neww][decision].villianName} the least of these noms.`,\n        };\n    }\n}\n\nfunction isBetterTargetMoR(\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    gameState: GameState,\n    hero: Houseguest,\n    winrateStrategy: WinrateStrategy\n): NumberWithLogic {\n    const morStrategy = (x: RelationshipType) => x === RelationshipType.Enemy;\n    if (winrateStrategy === WinrateStrategy.High || !inJury(gameState)) {\n        // prioritize targeting enemies, break ties based on enemy centrality\n        return targetEnemies(hero, old, neww, voteBasedOnCentrality(gameState, morStrategy));\n    } else if (winrateStrategy === WinrateStrategy.Medium) {\n        // prioritize targeting enemies, break ties based on if i can beat them, then break further ties based on centrality\n        return targetEnemies(hero, old, neww, (hero, [old, neww]) =>\n            voteBasedonWinrate(hero, old, neww, voteBasedOnCentrality(gameState, morStrategy))\n        );\n    } else {\n        // prioritize targeting high winrate, break ties based on friend/enemy status, then centrality\n        return voteBasedonWinrate(hero, old, neww, (hero, [old, neww]) =>\n            targetEnemies(hero, old, neww, voteBasedOnCentrality(gameState, morStrategy))\n        );\n    }\n}\n\nfunction isBetterTargetUnderdog(\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    gameState: GameState,\n    hero: Houseguest,\n    winrateStrategy: WinrateStrategy\n): NumberWithLogic {\n    const underdogStrategy = (x: RelationshipType) => x !== RelationshipType.Friend;\n    if (winrateStrategy === WinrateStrategy.High || !inJury(gameState)) {\n        // prioritize targeting enemies, break ties based on enemy centrality\n        return targetEnemies(hero, old, neww, voteBasedOnCentrality(gameState, underdogStrategy));\n    } else if (winrateStrategy === WinrateStrategy.Medium) {\n        // prioritize targeting enemies, break ties based on if i can beat them, then break further ties based on centrality\n        return targetEnemies(hero, old, neww, (hero, [old, neww]) =>\n            voteBasedonWinrate(hero, old, neww, voteBasedOnCentrality(gameState, underdogStrategy))\n        );\n    } else {\n        // prioritize targeting high winrate, break ties based on friend/enemy status, then centrality\n        return voteBasedonWinrate(hero, old, neww, (hero, [old, neww]) =>\n            targetEnemies(hero, old, neww, voteBasedOnCentrality(gameState, underdogStrategy))\n        );\n    }\n}\n\n// returns true if neww is more central than old\nfunction isMoreCentral(\n    hero: Houseguest,\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    gameState: GameState,\n    condition: (x: RelationshipType) => boolean\n): boolean {\n    let { oldPop, newPop }: { oldPop: number; newPop: number } = computeLocalPopularity(\n        gameState,\n        hero,\n        old,\n        neww,\n        condition\n    );\n    return oldPop < newPop;\n}\n\n// computes the popularity of houseguests old and neww,\n// only taking into account houseguests that have relationship type x with hero\n// satisfying the boolean condition you pass in\nfunction computeLocalPopularity(\n    gameState: GameState,\n    hero: Houseguest,\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    condition: (x: RelationshipType) => boolean\n) {\n    const nonFriends: Houseguest[] = Array.from(gameState.nonEvictedHouseguests)\n        .map((hg) => getById(gameState, hg))\n        .filter(\n            (villain) =>\n                condition(\n                    classifyRelationship(hero.popularity, villain.popularity, hero.relationshipWith(villain))\n                ) && hero.id !== villain.id\n        );\n    let oldPop: number = 0;\n    const oldHg: Houseguest = getById(gameState, old.id);\n    let newPop: number = 0;\n    const newHg: Houseguest = getById(gameState, neww.id);\n    nonFriends.forEach((hg) => {\n        if (hg.id !== oldHg.id) {\n            oldPop += oldHg.relationshipWith(hg);\n        }\n        if (hg.id !== newHg.id) {\n            newPop += newHg.relationshipWith(hg);\n        }\n    });\n    return { oldPop, newPop };\n}\n\nfunction isBetterTargetStatusQuo(\n    hero: Houseguest,\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    winrateStrategy: WinrateStrategy,\n    gameState: GameState\n): NumberWithLogic {\n    if (winrateStrategy === WinrateStrategy.High || !inJury(gameState)) {\n        return voteBasedOnRelationship(hero, [old, neww]);\n    } else if (winrateStrategy === WinrateStrategy.Medium) {\n        // with a sort of low winrate, break ties with winrate\n        const r0 = classifyTwoWayRelationship(\n            hero.popularity,\n            old.villainPopularity,\n            hero.relationships[old.id]\n        );\n        const r1 = classifyTwoWayRelationship(\n            hero.popularity,\n            neww.villainPopularity,\n            hero.relationships[neww.id]\n        );\n        return r0 === r1\n            ? voteBasedonWinrate(hero, old, neww, voteBasedOnRelationship)\n            : voteBasedOnRelationship(hero, [old, neww]);\n    } else {\n        return voteBasedonWinrate(hero, old, neww, voteBasedOnRelationship);\n    }\n}\n\nfunction voteBasedonWinrate(\n    hero: Houseguest,\n    nom0: RelationshipSummary,\n    nom1: RelationshipSummary,\n    callback: (hero: Houseguest, nominees: [RelationshipSummary, RelationshipSummary]) => NumberWithLogic\n): NumberWithLogic {\n    const heroBeatsnom0 = hero.powerRanking < hero.superiors[nom0.id];\n    const heroBeatsnom1 = hero.powerRanking < hero.superiors[nom1.id];\n    // if i am voting between 2 people who i can't beat, vote based on relationship\n    if (!heroBeatsnom0 && !heroBeatsnom1) {\n        return callback(hero, [nom0, nom1]);\n    }\n    // otherwise, vote based on winrate\n    const decision = hero.superiors[nom0.id] < hero.superiors[nom1.id] ? 0 : 1;\n    return {\n        decision,\n        reason: `I can't beat ${[nom0, nom1][decision].villianName} in the end.`,\n    };\n}\n\n// returns the index (0 or 1) of the vote\n// formerly known as cutthroatVote\nfunction voteBasedOnRelationship(\n    hero: Houseguest,\n    nominees: [RelationshipSummary, RelationshipSummary]\n): NumberWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    const r0 = classifyRelationship(hero.popularity, nom0.villainPopularity, hero.relationships[nom0.id]);\n    const r1 = classifyRelationship(hero.popularity, nom1.villainPopularity, hero.relationships[nom1.id]);\n\n    if (r0 === RelationshipType.Enemy && r1 === RelationshipType.Enemy) {\n        const decision = hero.relationships[nom0.id] < hero.relationships[nom1.id] ? 0 : 1;\n        return {\n            decision,\n            reason: `I dislike ${nominees[decision].villianName} the most of these enemies.`,\n        };\n    } else if (\n        (r0 === RelationshipType.Enemy && r1 !== RelationshipType.Enemy) ||\n        (r1 === RelationshipType.Enemy && r0 !== RelationshipType.Enemy)\n    ) {\n        const vote = r0 === RelationshipType.Enemy ? 0 : 1;\n        return { decision: vote, reason: `${nominees[vote].villianName} is my enemy.` };\n    } else if (\n        (r0 !== RelationshipType.Friend && r1 === RelationshipType.Friend) ||\n        (r1 !== RelationshipType.Friend && r0 === RelationshipType.Friend)\n    ) {\n        const vote = r0 !== RelationshipType.Friend ? 0 : 1;\n        const nonVote = vote === 0 ? 1 : 0;\n        return { decision: vote, reason: `${nominees[nonVote].villianName} is my friend.` };\n    }\n    const vote = lowestScore(hero, nominees, relationship);\n    return {\n        decision: vote,\n        reason: `I like ${nominees[vote === 0 ? 1 : 0].villianName} the most of these noms.`,\n    };\n}\n","import { Houseguest, GameState, exclude, inJury } from \"../../model\";\nimport { rng } from \"../BbRandomGenerator\";\nimport { getRelationshipSummary, isBetterTarget, isBetterTargetWithLogic } from \"./targets\";\n\nexport interface NumberWithLogic {\n    decision: number;\n    reason: string;\n}\n\nexport interface HouseguestWithLogic {\n    decision: Houseguest | null;\n    reason: string;\n}\n\n// Return the index of the eviction target.\n\n// vote to save, in the future, generalize this to n nominees instead of going 2 by 2\nexport function castVoteToSave(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): NumberWithLogic {\n    if (nominees.length === 0) throw new Error(\"Tried to cast a vote to save with no nominees.\");\n    let currentSave: NumberWithLogic = { decision: 0, reason: \"\" };\n    nominees.forEach((nominee, i) => {\n        if (i === 0) return;\n        const evictionTarget = castEvictionVote(hero, [nominee, nominees[currentSave.decision]], gameState);\n        if (!currentSave.reason) {\n            currentSave.reason = evictionTarget.reason;\n        }\n        if (evictionTarget.decision === 1) {\n            currentSave = { decision: i, reason: evictionTarget.reason };\n        }\n    });\n    return currentSave;\n}\n\n// returns the index in the array of the person you're voting to evict\nexport function castEvictionVote(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): NumberWithLogic {\n    // In the F3 vote, take the person who you have better odds against to F2\n    if (gameState.remainingPlayers === 3) {\n        return castF3Vote(hero, nominees[0], nominees[1]);\n    }\n    // In the F4 vote, do some genius level mathematics to predict what gives you the best odds of winning given that the\n    // person who wins the F3 HoH will evict the person they have the worst odds against\n    if (gameState.remainingPlayers === 4) {\n        // prevents 4 player games from crashing LULW\n        if (!inJury(gameState)) {\n            return isBetterTargetWithLogic(\n                getRelationshipSummary(hero, nominees[0]),\n                getRelationshipSummary(hero, nominees[1]),\n                hero,\n                gameState\n            );\n        }\n        return castF4vote(\n            hero,\n            nominees[0],\n            nominees[1],\n            // all this work just to get the HoH...\n            exclude(\n                Array.from(gameState.nonEvictedHouseguests.values()).map(\n                    (id) => gameState.houseguestCache[id]\n                ),\n                [nominees[0], nominees[1], hero]\n            )[0]\n        );\n    }\n    return isBetterTargetWithLogic(\n        getRelationshipSummary(hero, nominees[0]),\n        getRelationshipSummary(hero, nominees[1]),\n        hero,\n        gameState\n    );\n}\n\nfunction winningOddsF3(hero: Houseguest, villain1: Houseguest, villain2: Houseguest): number {\n    // chance that hero wins final HoH\n    const heroVs1: number = hero.superiors[villain1.id];\n    const heroVs2: number = hero.superiors[villain2.id];\n    const v1Vs2: number = villain1.superiors[villain2.id];\n\n    if (heroVs1 === undefined)\n        throw new Error(\n            `Tried to get a power comparison that does not exist between ${hero.name} and ${villain1.name} [1]`\n        );\n    if (heroVs2 === undefined)\n        throw new Error(\n            `Tried to get a power comparison that does not exist between ${hero.name} and ${villain2.name} [2]`\n        );\n    if (v1Vs2 === undefined)\n        throw new Error(\n            `Tried to get a power comparison that does not exist between ${villain1.name} and ${villain2.name} [3]`\n        );\n    const heroWins: number = Math.max(heroVs1, heroVs2); // evict the person who beats you more often\n    const v1wins: number = castF3Vote(villain1, hero, villain2).decision === 0 ? 0 : heroVs1;\n    const v2wins: number = castF3Vote(villain2, hero, villain1).decision === 0 ? 0 : heroVs2;\n    return (1 / 3) * heroWins + (1 / 3) * v1wins + (1 / 3) * v2wins;\n}\n\nfunction castF3Vote(hero: Houseguest, nom0: Houseguest, nom1: Houseguest): NumberWithLogic {\n    const decision = hero.superiors[nom0.id] < hero.superiors[nom1.id] ? 0 : 1;\n    return {\n        decision,\n        reason: `I have better odds of beating ${decision ? nom0.name : nom1.name} in the final 2.`,\n    };\n}\n\nfunction castF4vote(hero: Houseguest, nom0: Houseguest, nom1: Houseguest, HoH: Houseguest): NumberWithLogic {\n    const evictNom0 = winningOddsF3(hero, nom1, HoH);\n    const evictNom1 = winningOddsF3(hero, nom0, HoH);\n    const decision = evictNom0 > evictNom1 ? 0 : 1;\n    return {\n        decision,\n        reason: `Evicting ${\n            [nom0, nom1][decision].name\n        } gives me better odds of making it to the end and winning.`,\n    };\n}\n\nexport function getWorstTarget(hero: Houseguest, options: Houseguest[], gameState: GameState): Houseguest {\n    const sortedOptions = [...options];\n    // worst target is in position 0\n    sortedOptions.sort((hg1, hg2) => {\n        return isBetterTarget(\n            getRelationshipSummary(hero, hg1),\n            getRelationshipSummary(hero, hg2),\n            hero,\n            gameState\n        )\n            ? -1\n            : 1;\n    });\n    if (sortedOptions.length === 0) throw \"Tried to get a worst target from 0 options\";\n    return sortedOptions[0];\n}\n\n// returns the id of the houseguests you're backdooring\n// SHOULD ONLY BE USED for nominations, because it excludes teammates\nexport function backdoorNPlayers(\n    hero: Houseguest,\n    options: Houseguest[],\n    gameState: GameState,\n    n: number\n): NumberWithLogic[] {\n    // exclude teammates in options[], but if that gives an empty list never mind lol\n    const forcedOptions = [];\n    if (hero.tribe !== undefined) {\n        const teammates = gameState.houseguests.filter((hg) => {\n            if (hg.tribe === undefined) return false;\n            return hg.tribe.tribeId === hero.tribe!.tribeId;\n        });\n        const nonTeammates = exclude(options, teammates);\n        nonTeammates.length >= n && (options = nonTeammates);\n        // you are forced to nominate non-teammates along side some teammates here\n        if (nonTeammates.length < n && nonTeammates.length > 0) {\n            forcedOptions.push(...nonTeammates);\n            options = exclude(options, nonTeammates);\n        }\n    }\n\n    if (options.length < n) throw new Error(`Tried to backdoor ${n} players with ${options.length} options.`);\n    const result: NumberWithLogic[] = [];\n    for (let option of forcedOptions) {\n        result.push({\n            decision: option.id,\n            reason: `I am forced to nominate ${option.name}`,\n        });\n    }\n    const sortedOptions = [...options];\n    // negative value if first is less than second\n    sortedOptions.sort((hg1, hg2) => {\n        return isBetterTarget(\n            getRelationshipSummary(hero, hg1),\n            getRelationshipSummary(hero, hg2),\n            hero,\n            gameState\n        )\n            ? 1\n            : -1;\n    });\n\n    while (result.length < n) {\n        const decision = sortedOptions[result.length];\n        const reason = \"\";\n        result.push({ decision: decision.id, reason });\n    }\n    return result;\n}\n\nexport function pJurorVotesForHero(juror: Houseguest, hero: Houseguest, villain: Houseguest): number {\n    const r1 = juror.relationshipWith(hero);\n    const r2 = juror.relationshipWith(villain);\n    const delta = (r1 - r2) / 2;\n    let result = 0.5 + delta;\n    if (result > 1) result = 1;\n    if (result < 0) result = 0;\n    return result;\n}\n\n// Returns the index of the finalist with the highest relationship with juror\n// only works with 2 finalists\nexport function castJuryVote(juror: Houseguest, finalists: Houseguest[]): number {\n    const choice = Math.abs(rng().randomFloat());\n    return choice > pJurorVotesForHero(juror, finalists[0], finalists[1]) ? 1 : 0;\n}\n","import { GameState, Houseguest, MutableGameState, getById, exclude } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { backdoorNPlayers } from \"../../../utils/ai/aiApi\";\nimport { listNames } from \"../../../utils/listStrings\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\n\nexport function generateBotbNomCeremonyScene(\n    initialGameState: GameState,\n    hoh1: Houseguest,\n    hoh2: Houseguest\n): [GameState, Scene, Houseguest[][]] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    const exclusions = [hoh1, hoh2];\n    const noms1: Houseguest[] = [];\n    const noms2: Houseguest[] = [];\n    for (let i = 0; i < 4; i++) {\n        const hoh = i % 2 === 0 ? hoh1 : hoh2;\n        const nextNom: Houseguest = getById(\n            newGameState,\n            backdoorNPlayers(hoh, exclude(newGameState.houseguests, exclusions), newGameState, 1)[0].decision\n        );\n        exclusions.push(nextNom);\n        i % 2 === 0 ? noms1.push(nextNom) : noms2.push(nextNom);\n    }\n    [noms1, noms2].forEach((arr) => arr.forEach((nom) => nom.nominations++));\n\n    const finalStatement = (noms: Houseguest[]) =>\n        `I have nominated you, ${listNames(noms.map((n) => n.name))} for eviction. `;\n    const firstText = \"My first nominee is...\";\n    const secondText = \"My second nominee is...\";\n\n    const block = (noms: Houseguest[], hoh: ProfileHouseguest) => {\n        return (\n            <div className=\"column\">\n                <div className=\"column\">\n                    <div className=\"columns is-centered\">\n                        <div className=\"column\">\n                            <Portrait centered={true} houseguest={hoh} />\n                        </div>\n                    </div>\n                    <div className=\"columns is-centered\">\n                        <DividerBox className=\"column is-5\">\n                            <Centered> {firstText}</Centered>\n                            <Portrait centered={true} houseguest={noms[0]} />\n                        </DividerBox>\n                        <DividerBox className=\"column is-5\">\n                            <Centered> {secondText}</Centered>\n                            <Portrait centered={true} houseguest={noms[1]} />\n                        </DividerBox>\n                    </div>\n                </div>\n                <div className=\"column\">\n                    <CenteredBold>{finalStatement(noms)}</CenteredBold>\n                </div>\n            </div>\n        );\n    };\n\n    const scene = new Scene({\n        title: \"Nomination Ceremony\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    This is the nomination ceremony. It is our responsibility as Heads of Household to each\n                    nominate two houseguests for eviction.\n                </Centered>\n                <div className=\"columns is-marginless is-centered\">\n                    {block(noms1, hoh1)}\n                    {block(noms2, hoh2)}\n                </div>\n                <br />\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, [noms1, noms2]];\n}\n","import { every } from \"lodash\";\nimport { Houseguest, GameState, exclude, getById, nonEvictedHouseguests } from \"../../../model\";\nimport { backdoorNPlayers, HouseguestWithLogic, NumberWithLogic } from \"../../../utils/ai/aiApi\";\nimport { classifyRelationship, RelationshipType } from \"../../../utils/ai/classifyRelationship\";\nimport {\n    isBetterTarget,\n    getRelationshipSummary,\n    isBetterTargetWithLogic,\n    determineStrategy,\n    TargetStrategy,\n} from \"../../../utils/ai/targets\";\n\nexport interface Veto {\n    name: string;\n    use: (\n        hero: Houseguest,\n        nominees: Houseguest[],\n        gameState: GameState,\n        HoH: number,\n        exclusions: Houseguest[]\n    ) => HouseguestWithLogic;\n}\n\nexport const GoldenVeto: Veto = {\n    name: \"Golden Power of Veto\",\n    use: useGoldenVeto,\n};\n\nexport const DiamondVeto: Veto = {\n    name: \"💎 Diamond Power of Veto\",\n    use: useDiamondVeto,\n};\n\nexport const SpotlightVeto: Veto = {\n    name: \"🔦 Spotlight Power of Veto\",\n    use: useSpotlightVeto,\n};\n\nexport const BoomerangVeto: Veto = {\n    name: \"🪃 Boomerang Power of Veto\",\n    use: useBoomerangVeto,\n};\n\n// only works for 2 nominees\nfunction useBoomerangVeto(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState,\n    HoH: number,\n    exclusions: Houseguest[]\n): HouseguestWithLogic {\n    if (nominees.length !== 2) throw new Error(\"Boomerang veto only works for 2 nominees.\");\n    const checks = basicVetoChecks(hero, nominees, gameState, HoH, exclusions);\n    if (checks) return checks;\n    // Need an additional check for boomerang veto, since there are 2 replacement noms\n    if (gameState.remainingPlayers - 1 - nominees.length === 2) {\n        return {\n            decision: null,\n            reason: \"It doesn't make sense to use the veto here.\",\n        };\n    }\n\n    // if you wouldn't use gold veto on either of them, discard\n    const veto1 = useGoldenVeto(hero, [nominees[0]], gameState, HoH, exclusions);\n    const veto2 = useGoldenVeto(hero, [nominees[1]], gameState, HoH, exclusions);\n    if (veto1.decision === null && veto2.decision === null) {\n        return { decision: null, reason: \"I don't want to save either of these noms.\" };\n    }\n    // if you would use gold veto on both of them, use\n    if (veto1.decision !== null && veto2.decision !== null) {\n        return { decision: nominees[0], reason: \"I want to save both of these noms.\" };\n    }\n    // if you would only use it on one of them, only use it if you have low friend counts\n    const strategy = determineStrategy(hero);\n    if (strategy === TargetStrategy.StatusQuo) {\n        return { decision: null, reason: \"I want to evict at least one of these noms.\" };\n    } else {\n        return { decision: nominees[0], reason: \"I want to save at least one of these noms.\" };\n    }\n}\n\nfunction useSpotlightVeto(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState,\n    HoH: number,\n    exclusions: Houseguest[]\n): HouseguestWithLogic {\n    // basically ya forced to use it\n    const checks = basicVetoChecks(hero, nominees, gameState, HoH, exclusions);\n    if (checks && checks.decision !== null) return checks;\n    // use the veto on whoever is the worse target between the 2 nominees\n    const invertedDecision = isBetterTargetWithLogic(\n        getRelationshipSummary(hero, nominees[0]),\n        getRelationshipSummary(hero, nominees[1]),\n        hero,\n        gameState\n    );\n    const decision = invertedDecision.decision === 0 ? 1 : 0;\n    return { decision: nominees[decision], reason: invertedDecision.reason };\n}\n\nfunction useGoldenVeto(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState,\n    HoH: number,\n    exclusions: Houseguest[]\n): HouseguestWithLogic {\n    const checks = basicVetoChecks(hero, nominees, gameState, HoH, exclusions);\n    if (checks) return checks;\n    let reason = \"None of these nominees are my friends.\";\n    let potentialSave: Houseguest | null = null;\n    let alwaysSave: Houseguest | null = null;\n    nominees.forEach((nominee) => {\n        const relationship = classifyRelationship(\n            hero.popularity,\n            nominee.popularity,\n            hero.relationshipWith(nominee)\n        );\n        if (relationship === RelationshipType.Friend) {\n            if (potentialSave) {\n                potentialSave =\n                    hero.relationshipWith(nominee) > hero.relationshipWith(potentialSave)\n                        ? nominee\n                        : potentialSave;\n                reason = `Of these noms, I like ${potentialSave.name} the most.`;\n            } else {\n                reason = `${nominee.name} is my friend.`;\n                potentialSave = nominee;\n            }\n        }\n    });\n    if (alwaysSave) {\n        return { decision: alwaysSave, reason };\n    } else if (potentialSave) {\n        return { decision: potentialSave, reason };\n    } else {\n        return { decision: null, reason };\n    }\n}\n\n// only works with 2 nominees\nfunction useDiamondVeto(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState,\n    HoH: number,\n    exclusions: Houseguest[],\n    skipChecks: boolean = false\n): HouseguestWithLogic {\n    if (!skipChecks) {\n        const checks = basicVetoChecks(hero, nominees, gameState, HoH, exclusions);\n        if (checks) return checks;\n    }\n    // get the 2 best targets out of the pool of all options\n    const idealTargets: NumberWithLogic[] = backdoorNPlayers(\n        hero,\n        exclude(nonEvictedHouseguests(gameState), [hero, getById(gameState, HoH)]),\n        gameState,\n        2\n    );\n    // if ideal targets is equal to nominees, do nothing\n    const ids1 = idealTargets.map((n) => n.decision);\n    const ids2 = nominees.map((n) => n.id);\n    if ((ids1[0] === ids2[0] && ids1[1] === ids2[1]) || (ids1[0] === ids2[1] && ids1[1] === ids2[0])) {\n        return {\n            decision: null,\n            reason: \"These are my ideal nominations.\",\n        };\n    }\n    // otherwise, replace the person i least want gone\n    const worseTarget: number = isBetterTarget(\n        getRelationshipSummary(hero, nominees[0]),\n        getRelationshipSummary(hero, nominees[1]),\n        hero,\n        gameState\n    )\n        ? 0\n        : 1;\n\n    return { decision: nominees[worseTarget], reason: \"I would rather see someone else nominated.\" };\n}\n\nfunction basicVetoChecks(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState,\n    HoH: number,\n    immunePlayers: Houseguest[] = []\n): HouseguestWithLogic | null {\n    if (hero.id === HoH) {\n        return {\n            decision: null,\n            reason: \"These are my ideal nominations.\",\n        };\n    }\n    for (const nom of nominees) {\n        if (hero.id === nom.id) return { decision: hero, reason: \"I am going to save myself.\" };\n    }\n    // if player is not immune, don't use the veto if you are the only replacement nominee\n    if (\n        every(immunePlayers, (player) => player.id !== hero.id) &&\n        gameState.remainingPlayers - 1 - immunePlayers.length - nominees.length === 1\n    ) {\n        return {\n            decision: null,\n            reason: \"It doesn't make sense to use the veto here.\",\n        };\n    }\n    return null;\n}\n","import { GameState, Houseguest, MutableGameState } from \"../../model\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport { Scene } from \"./scenes/scene\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateBotbNomCeremonyScene } from \"./scenes/botbNomCeremonyScene\";\nimport { generateVetoScenesOnwards } from \"./bigBrotherEpisode\";\nimport { GoldenVeto } from \"./veto/veto\";\nimport { generateBotbScene } from \"./scenes/botbScene\";\n\nexport const BattleOfTheBlock: EpisodeType = {\n    canPlayWith: (n: number) => n >= 6,\n    eliminates: 1,\n    arrowsEnabled: true,\n    emoji: \"⚔️\",\n    hasViewsbar: true,\n    name: \"Battle of the Block\",\n    description:\n        \"Two HoHs name a total of four nominees. The nominees compete in a competition, and the winners are safe for the week and dethrone the HoH who nominated them.\",\n    generate: generateBoB,\n};\n\nfunction generateBoB(initialGamestate: GameState): Episode {\n    // generate (co)-hoh scene\n    let currentGameState = new MutableGameState(initialGamestate);\n    let hohArray: Houseguest[];\n    let hohCompScene: Scene;\n    const scenes: Scene[] = [];\n    [currentGameState, hohCompScene, hohArray] = generateHohCompScene(currentGameState, {\n        coHoH: true,\n        coHohIsFinal: false,\n    });\n    scenes.push(hohCompScene);\n    // nominations, but with TWO sets of nominees\n    let nomCeremonyScene;\n    let nominees: Houseguest[][];\n    [currentGameState, nomCeremonyScene, nominees] = generateBotbNomCeremonyScene(\n        currentGameState,\n        hohArray[0],\n        hohArray[1]\n    );\n    scenes.push(nomCeremonyScene);\n    // then battle of the block where one of the HoHs is dethroned\n    let botbscene;\n    let finalhoh;\n    let finalnoms;\n    let botbWinners;\n    [currentGameState, botbscene, finalhoh, finalnoms, botbWinners] = generateBotbScene(\n        currentGameState,\n        hohArray,\n        [...nominees[0], ...nominees[1]]\n    );\n    scenes.push(botbscene);\n    // then veto onwards plays normally except\n    // the winning pair is somehow immune for the week: they can't be backdoored.\n    const vetostuff = generateVetoScenesOnwards(\n        GoldenVeto,\n        currentGameState,\n        finalhoh,\n        finalnoms,\n        false,\n        scenes,\n        botbWinners\n    );\n    currentGameState = vetostuff.gameState;\n\n    return new Episode({\n        gameState: new GameState(currentGameState),\n        initialGamestate,\n        scenes: vetostuff.scenes,\n        type: BattleOfTheBlock,\n    });\n}\n","import { GameState, Houseguest, MutableGameState } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { rng } from \"../../../utils\";\nimport { listNames } from \"../../../utils/listStrings\";\nimport { HoHVote } from \"../../../model/logging/voteType\";\n\nexport function generateBotbScene(\n    initialGameState: GameState,\n    hohArray: Houseguest[],\n    nomsArray: Houseguest[]\n): [GameState, Scene, Houseguest, Houseguest[], Houseguest[]] {\n    const newGameState = new MutableGameState(initialGameState);\n    const hoh0wins = rng().flipCoin();\n    const hoh = hohArray[hoh0wins ? 0 : 1];\n    newGameState.previousHOH = [hoh];\n    newGameState.currentLog.votes[hoh.id] = new HoHVote();\n    const noms = hoh0wins ? [nomsArray[0], nomsArray[1]] : [nomsArray[2], nomsArray[3]];\n    const winners = hoh0wins ? [nomsArray[2], nomsArray[3]] : [nomsArray[0], nomsArray[1]];\n\n    newGameState.currentLog.nominationsPreVeto = require(\"alphanum-sort\")(noms.map((nom) => nom.name));\n    newGameState.currentLog.strikethroughNominees = require(\"alphanum-sort\")(winners.map((nom) => nom.name));\n\n    const block = (hohIndex: number, nomIndex: number) => {\n        return (\n            <div className=\"column\">\n                <div className=\"columns is-centered\">\n                    <div className=\"column\">\n                        <Portrait centered={true} houseguest={hohArray[hohIndex]} />\n                    </div>\n                </div>\n                <div className=\"columns is-centered\">\n                    <DividerBox className={`column is-11`}>\n                        <Portraits\n                            centered={true}\n                            houseguests={[nomsArray[nomIndex], nomsArray[nomIndex + 1]]}\n                        />\n                    </DividerBox>\n                </div>\n            </div>\n        );\n    };\n    const block0 = block(0, 0);\n    const block1 = block(1, 2);\n\n    const scene = new Scene({\n        title: \"Battle of the Block\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    {`This is the Battle of the Block competition. ${hohArray[0].name}'s nominees will battle ${hohArray[1].name}'s nominees to save themselves from the block. The winning pair will win safety for the week, and dethrone the HoH that nominated them.`}\n                </Centered>\n                <div className=\"columns is-centered\">\n                    {block0} {block1}\n                </div>\n                <Centered>...</Centered>\n                <Portraits centered={true} houseguests={winners} />\n                <CenteredBold>\n                    {`${listNames(winners.map((w) => w.name))} have won the Battle of the Block!`}\n                </CenteredBold>\n\n                <div className=\"column\">\n                    <div className=\"columns is-centered\">\n                        <div className=\"column\">\n                            <Portrait centered={true} houseguest={hoh} />\n                        </div>\n                    </div>\n                    <div className=\"columns is-centered\">\n                        <DividerBox className=\"column is-5\">\n                            <Portrait centered={true} houseguest={noms[0]} />\n                        </DividerBox>\n                        <DividerBox className=\"column is-5\">\n                            <Portrait centered={true} houseguest={noms[1]} />\n                        </DividerBox>\n                    </div>\n                </div>\n\n                <CenteredBold>\n                    {`${listNames([hoh.name])} will remain as HoH, with ${listNames(\n                        noms.map((n) => n.name)\n                    )} as nominees.`}\n                </CenteredBold>\n                <br />\n                {<NextEpisodeButton />}\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, hoh, noms, winners];\n}\n","import { GameState } from \"../../model\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { EpisodeType, Episode } from \"./episodes\";\nimport { BoomerangVeto } from \"./veto/veto\";\n\nexport const BoomerangVetoEpisode: EpisodeType = {\n    canPlayWith: (n: number) => n >= 5,\n    eliminates: 1,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n    emoji: \"🪃\",\n    description: \"A veto that must be discarded or used to save both nominees.\",\n    name: \"Boomerang Veto\",\n    generate: generate,\n};\n\nfunction generate(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, BoomerangVeto);\n    return new Episode({\n        gameState: new GameState(episode.gameState),\n        initialGamestate,\n        scenes: episode.scenes,\n        type: BoomerangVetoEpisode,\n    });\n}\n","import { GameState, Houseguest, MutableGameState, getById, exclude } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { shuffle } from \"lodash\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { backdoorNPlayers } from \"../../../utils/ai/aiApi\";\nimport { listNames } from \"../../../utils/listStrings\";\n\ninterface NomCeremonyOptions {\n    doubleEviction?: boolean;\n    thirdNominee?: boolean;\n}\n\nexport function generateNomCeremonyScene(\n    initialGameState: GameState,\n    hohList: Houseguest[],\n    options: NomCeremonyOptions\n): [GameState, Scene, Houseguest[]] {\n    const newGameState = new MutableGameState(initialGameState);\n    const HoH = hohList[0];\n    const coHoH = hohList.length > 1 ? hohList[1] : undefined;\n    const doubleEviction = options.doubleEviction || false;\n\n    const nom1: Houseguest = getById(\n        newGameState,\n        backdoorNPlayers(\n            HoH,\n            exclude(newGameState.houseguests, coHoH ? [HoH, coHoH] : [HoH]),\n            newGameState,\n            1\n        )[0].decision\n    );\n\n    const nom2 = coHoH\n        ? getById(\n              newGameState,\n              backdoorNPlayers(\n                  coHoH,\n                  exclude(newGameState.houseguests, [HoH, coHoH, nom1]),\n                  newGameState,\n                  1\n              )[0].decision\n          )\n        : getById(\n              newGameState,\n              backdoorNPlayers(HoH, exclude(newGameState.houseguests, [HoH, nom1]), newGameState, 1)[0]\n                  .decision\n          );\n    nom1.nominations++;\n    nom2.nominations++;\n    newGameState.currentLog.nominationsPreVeto = [nom1.name, nom2.name];\n    let nom3: Houseguest | undefined;\n    if (options.thirdNominee) {\n        nom3 = getById(\n            newGameState,\n            backdoorNPlayers(HoH, exclude(newGameState.houseguests, [HoH, nom1, nom2]), newGameState, 1)[0]\n                .decision\n        );\n        nom3.nominations++;\n        newGameState.currentLog.nominationsPreVeto.push(nom3.name);\n    }\n    newGameState.currentLog.nominationsPreVeto = require(\"alphanum-sort\")(\n        newGameState.currentLog.nominationsPreVeto\n    );\n    const shuffleOrDont = coHoH ? (a: Houseguest[]): Houseguest[] => a : shuffle;\n    const noms = nom3 ? shuffleOrDont([nom1, nom2, nom3]) : shuffleOrDont([nom1, nom2]);\n    const weI = coHoH ? \"We\" : \"I\";\n    const finalStatement = `${weI} have nominated you, ${listNames(noms.map((n) => n.name))} for eviction. `;\n    const myOur = coHoH ? \"our\" : \"my\";\n    const theHoH = coHoH ? \"Heads of Household\" : \"the Head of Household\";\n    const firstText = coHoH ? `${HoH.name} has nominated...` : \"My first nominee is...\";\n    const secondText = coHoH ? `${coHoH.name} has nominated...` : \"My second nominee is...\";\n    const scene = new Scene({\n        title: \"Nomination Ceremony\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    {!doubleEviction &&\n                        `This is the nomination ceremony. It is ${myOur} responsibility as ${theHoH} to\n                    nominate ${options.thirdNominee ? `three` : `two`} houseguests for eviction.`}\n                </Centered>\n                {!doubleEviction && <Portraits centered={true} houseguests={hohList} />}\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Centered>{firstText}</Centered>\n                        <Portrait centered={true} houseguest={noms[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Centered>{secondText}</Centered>\n                        <Portrait centered={true} houseguest={noms[1]} />\n                    </DividerBox>\n                    {options.thirdNominee && (\n                        <DividerBox className=\"column\">\n                            <Centered>My third nominee is...</Centered>\n                            <Portrait centered={true} houseguest={noms[2]} />\n                        </DividerBox>\n                    )}\n                </div>\n                <CenteredBold>{finalStatement}</CenteredBold>\n                <br />\n                {!doubleEviction && <NextEpisodeButton />}\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, noms];\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById,\n} from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { listNames } from \"../../../utils/listStrings\";\nimport { Veto } from \"../veto/veto\";\n\nexport function generateVetoCompScene(\n    initialGameState: GameState,\n    HoHs: Houseguest[],\n    nominees: Houseguest[],\n    veto: Veto,\n    doubleEviction: boolean = false\n): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    // pick players\n    const choices = nonEvictedHouseguests(newGameState);\n    let povPlayers: any[] = [];\n    const everyoneWillPlay = choices.length <= 6;\n\n    if (everyoneWillPlay) {\n        HoHs.forEach((hoh) => povPlayers.push({ ...hoh }));\n        nominees.forEach((nominee) => povPlayers.push({ ...nominee }));\n        while (povPlayers.length < choices.length) {\n            povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        }\n    } else {\n        HoHs.forEach((hoh) => povPlayers.push({ ...hoh }));\n        nominees.forEach((nominee) => povPlayers.push({ ...nominee }));\n        while (povPlayers.length < 6) {\n            povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        }\n    }\n    let povWinner = randomPlayer(povPlayers);\n    povWinner = getById(newGameState, povWinner.id);\n    povWinner.povWins++;\n    newGameState.currentLog.vetoWinner = povWinner.name;\n    let introText: string;\n    if (everyoneWillPlay) {\n        introText = \"Everyone left in the house will compete in this challenge.\";\n    } else {\n        introText = `${listNames(HoHs.map((h) => h.name))}, as Head of Household, and ${listNames(\n            nominees.map((nom) => nom.name)\n        )} as nominees, will compete, as well as ${\n            povPlayers.length - HoHs.length - nominees.length\n        } others chosen by random draw.`; // this line assumes hoh plays in veto (-1)\n    }\n    const firstRow = [...HoHs, ...nominees];\n    const extras = [];\n    for (let i = firstRow.length; i < povPlayers.length; i++) {\n        extras.push(povPlayers[i]);\n    }\n    const scene = new Scene({\n        title: \"Veto Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>\n                    {doubleEviction\n                        ? \"The houseguests compete in the veto competition.\"\n                        : \"It's time to pick players for the veto competition.\"}\n                </Centered>\n                <Portraits centered={true} houseguests={firstRow} />\n                {!doubleEviction && <Centered>{introText}</Centered>}\n                <Portraits centered={true} houseguests={extras} />\n                <Centered>...</Centered>\n                <Portraits centered={true} houseguests={[povWinner]} />\n                <CenteredBold>{`${povWinner.name} has won the ${veto.name}!`}</CenteredBold>\n                {!doubleEviction && <NextEpisodeButton />}\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, povWinner];\n}\n","import { GameState, Houseguest, getById, exclude } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { backdoorNPlayers } from \"../../../utils/ai/aiApi\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { listNames } from \"../../../utils/listStrings\";\nimport _ from \"lodash\";\nimport { BoomerangVeto, DiamondVeto, Veto } from \"../veto/veto\";\n\nexport function generateVetoCeremonyScene(\n    initialGameState: GameState,\n    hohArray: Houseguest[],\n    initialNominees: Houseguest[],\n    povWinner: Houseguest,\n    doubleEviction: boolean,\n    veto: Veto,\n    immuneHgs: Houseguest[]\n): [GameState, Scene, Houseguest[]] {\n    let povTarget: Houseguest | null = null;\n    let descisionText = \"\";\n\n    initialNominees = initialNominees.map((nominee) => {\n        return getById(initialGameState, nominee.id);\n    });\n    const HoH = hohArray[0];\n    const coHoH = hohArray.length > 1 ? hohArray[1] : undefined;\n\n    const vetoChoice = veto.use(povWinner, initialNominees, initialGameState, coHoH ? -1 : HoH.id, immuneHgs);\n\n    let nomineeWonPov = false;\n    initialNominees.forEach((nom) => nom.id === povWinner.id && (nomineeWonPov = true));\n\n    povTarget = vetoChoice.decision;\n    const tousethepov = \"to use the power of veto\";\n    if (!povTarget) {\n        descisionText += `... not ${tousethepov}.`;\n    } else if (veto === BoomerangVeto) {\n        descisionText += `... ${tousethepov}.`;\n    } else if (nomineeWonPov) {\n        descisionText += `...${tousethepov} on myself.`;\n    } else {\n        descisionText += `...${tousethepov} on ${povTarget.name}.`;\n    }\n    let replacementSpeech = \"\";\n    let nameAReplacement = \"\";\n    let finalNominees: any[] = [...initialNominees];\n    const HoHnamer = coHoH && povTarget ? (povTarget.id === initialNominees[1].id ? coHoH : HoH) : HoH;\n    const replacementNomineeNamer = veto === DiamondVeto ? povWinner : HoHnamer;\n    if (povTarget) {\n        const HoHwonPoV = HoH.id === povWinner.id && !coHoH;\n        const aReplacementNominee = veto === BoomerangVeto ? \"replacement nominees\" : \"a replacement nominee\";\n        const oneOf = veto !== BoomerangVeto ? \"one of \" : \"\";\n        const you = veto === DiamondVeto ? \"I\" : \"you\";\n        nameAReplacement += HoHwonPoV\n            ? `Since I have just vetoed one of my nominations, I must name ${aReplacementNominee}.`\n            : `${HoHnamer.name}, since I have just vetoed ${oneOf}your nominations, ${you} must name ${aReplacementNominee}.`;\n        // if the exclusion yielded no options, you may be forced to name the veto winner as a replacement\n        let exclusion = exclude(initialGameState.houseguests, [\n            HoH,\n            ...initialNominees,\n            povWinner,\n            ...immuneHgs,\n            coHoH || HoH,\n        ]);\n        if (exclusion.length === 0) {\n            exclusion = exclude(initialGameState.houseguests, [HoH, ...initialNominees, ...immuneHgs]);\n        }\n        const replacementCount = veto === BoomerangVeto ? 2 : 1;\n        const replacementNoms = backdoorNPlayers(\n            replacementNomineeNamer,\n            exclusion,\n            initialGameState,\n            replacementCount\n        ).map((v) => {\n            return getById(initialGameState, v.decision);\n        });\n        if (replacementNoms.length === 1) {\n            const replacementNom = replacementNoms[0];\n            const replacementIndex = initialNominees.findIndex((hg) => hg.id === vetoChoice.decision!.id);\n            finalNominees[replacementIndex] = replacementNom;\n            replacementNom.nominations++;\n            replacementSpeech = `My replacement nominee is ${replacementNom.name}.`;\n        } else {\n            finalNominees = replacementNoms;\n            finalNominees.forEach((nom) => nom.nominations++);\n            replacementSpeech = `My replacement nominees are ${listNames(\n                replacementNoms.map((n) => n.name)\n            )}.`;\n        }\n    }\n    const nomineeNames = initialNominees.map((nom) => nom.name);\n    const scene = new Scene({\n        title: \"Veto Ceremony\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                {!doubleEviction && <Centered>This is the Veto Ceremony.</Centered>}\n                {!doubleEviction && (\n                    <Centered>\n                        {`${listNames(nomineeNames)} have been nominated for eviction, \n                    but I have the power to veto one of these nominations.`}\n                    </Centered>\n                )}\n                <div className=\"columns is-marginless is-centered\">\n                    {initialNominees.map((nom, i) => (\n                        <DividerBox className=\"column\" key={`nominee-${i}`}>\n                            <Portrait centered={true} houseguest={nom} />\n                        </DividerBox>\n                    ))}\n                </div>\n                <CenteredBold>\n                    I have decided... <br />\n                </CenteredBold>\n                <Portrait centered={true} houseguest={{ ...povWinner, tooltip: vetoChoice.reason }} />\n                <CenteredBold noMargin={true}>{descisionText}</CenteredBold>\n                <Centered>{nameAReplacement}</Centered>\n                {replacementSpeech && <Portrait centered={true} houseguest={replacementNomineeNamer} />}\n                <CenteredBold>{replacementSpeech}</CenteredBold>\n                <div className=\"columns is-marginless is-centered\">\n                    {finalNominees.map((nom, i) => (\n                        <DividerBox className=\"column\" key={`final-nominee-${i}`}>\n                            <Portrait centered={true} houseguest={nom} />\n                        </DividerBox>\n                    ))}\n                </div>\n                {!doubleEviction && <NextEpisodeButton />}\n            </div>\n        ),\n    });\n    initialGameState.currentLog.nominationsPostVeto = require(\"alphanum-sort\")(\n        finalNominees.map((nom) => nom.name)\n    );\n    return [initialGameState, scene, finalNominees];\n}\n","import _ from \"lodash\";\nimport {\n    Houseguest,\n    GameState,\n    nonEvictedHouseguests,\n    calculatePopularity,\n    getById,\n    getJurors,\n    inJury,\n    MutableGameState,\n} from \"../../../model\";\nimport { getFinalists } from \"../../../model/season\";\nimport { average, roundTwoDigits } from \"../../../utils\";\nimport { pHeroWinsTheFinale } from \"../../../utils/ai/aiUtils\";\nimport { classifyRelationship, RelationshipType } from \"../../../utils/ai/classifyRelationship\";\nimport { Targets, getRelationshipSummary } from \"../../../utils/ai/targets\";\n\nexport function evictHouseguest(gameState: MutableGameState, id: number): GameState {\n    const evictee = getById(gameState, id);\n    if (gameState.currentLog) gameState.currentLog.evicted.push(evictee.id);\n    evictee.isEvicted = true;\n    if (gameState.remainingPlayers - getFinalists() <= gameState.finalJurySize()) {\n        evictee.isJury = true;\n    }\n    gameState.nonEvictedHouseguests.delete(evictee.id);\n    gameState.remainingPlayers--;\n    refreshHgStats(gameState);\n    return gameState;\n}\n\nexport function refreshHgStats(gameState: MutableGameState, updateDelta: boolean = false) {\n    if (inJury(gameState) && getJurors(gameState).length === 0) {\n        populateSuperiors(nonEvictedHouseguests(gameState));\n    }\n    if (inJury(gameState)) {\n        updatePowerRankings(nonEvictedHouseguests(gameState));\n    }\n    updatePopularity(gameState, updateDelta);\n    gameState.remainingPlayers > 2 && updateFriendCounts(gameState);\n}\n\nfunction populateSuperiors(houseguests: Houseguest[]) {\n    for (let i = 0; i < houseguests.length; i++) {\n        const hero = houseguests[i];\n        for (let j = i + 1; j < houseguests.length; j++) {\n            const villain = houseguests[j];\n            const pHeroWins = pHeroWinsTheFinale({ hero, villain }, houseguests);\n            hero.superiors[villain.id] = pHeroWins;\n            villain.superiors[hero.id] = 1 - pHeroWins;\n        }\n    }\n}\n\nfunction updatePowerRankings(houseguests: Houseguest[]) {\n    houseguests.forEach((hg) => {\n        let superiors: { [id: number]: number } = { ...hg.superiors };\n        const nonEvictedHouseguests: Set<number> = new Set<number>(houseguests.map((h) => h.id));\n        superiors = _.filter(superiors, (_, id) => nonEvictedHouseguests.has(parseInt(id)));\n        hg.powerRanking = average(Object.values(superiors));\n    });\n}\n\nfunction updatePopularity(gameState: GameState, updateDelta: boolean = false) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach((hg) => {\n        hg.targetingMe = 0;\n        const result = calculatePopularity(hg, nonEvictedHouseguests(gameState));\n        if (updateDelta)\n            hg.deltaPopularity = (roundTwoDigits(result) - roundTwoDigits(hg.previousPopularity)) / 100;\n        hg.popularity = result;\n    });\n}\n\nfunction updateFriendCounts(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach((hero: Houseguest) => {\n        let targets = new Targets(hero);\n        let friends = 0;\n        let enemies = 0;\n        houseguests.forEach((villain) => {\n            if (hero.id === villain.id) return;\n            const type = classifyRelationship(\n                hero.popularity,\n                villain.popularity,\n                hero.relationshipWith(villain)\n            );\n            if (type === RelationshipType.Friend) {\n                friends++;\n            } else if (type === RelationshipType.Enemy) {\n                enemies++;\n            }\n        });\n        hero.friends = friends;\n        hero.enemies = enemies;\n        targets.refreshTargets(gameState);\n        hero.targets = targets.getTargets();\n        hero.targets.forEach((target) => {\n            getById(gameState, target).targetingMe++;\n        });\n    });\n}\n","import { BigBrotherVanilla } from \"../components/episode/bigBrotherEpisode\";\nimport { GameState } from \"./gameState\";\nimport { Episode, EpisodeType, nextEpisode } from \".\";\nimport { BigBrotherFinale } from \"../components/episode/bigBrotherFinale\";\nimport { GameOver } from \"../components/episode/gameOver\";\n\nexport function getFinalists() {\n    return 2;\n}\n\nexport interface EpisodeLibrary {\n    [id: number]: EpisodeType;\n}\n\nexport class Season {\n    private episodeLibrary: EpisodeLibrary = {};\n\n    public constructor(episodeLibrary?: EpisodeLibrary) {\n        if (episodeLibrary) this.episodeLibrary = episodeLibrary;\n    }\n\n    public renderEpisode(gameState: GameState): Episode {\n        return nextEpisode(gameState, this.whichEpisodeType(gameState.remainingPlayers));\n    }\n\n    public whichEpisodeType(players: number) {\n        if (players === 3) {\n            return BigBrotherFinale;\n        }\n        if (players === 2) {\n            return GameOver;\n        }\n        if (this.episodeLibrary[players]) {\n            return this.episodeLibrary[players];\n        }\n        return BigBrotherVanilla;\n    }\n}\n","import { Houseguest } from \"./houseguest\";\nimport { PlayerProfile } from \"./playerProfile\";\nimport _ from \"lodash\";\nimport { newRelationshipMap, rng } from \"../utils\";\nimport { getFinalists } from \"./season\";\nimport { EpisodeLog } from \"./logging/episodelog\";\nimport { Cliques } from \"../utils/generateCliques\";\n\nexport function getById(gameState: GameState, id: number): Houseguest {\n    return gameState.houseguestCache[id];\n}\n\nexport function exclude(inclusions: Houseguest[], exclusions: Houseguest[]) {\n    const excludedIds = exclusions.map((hg) => hg.id);\n    return inclusions.filter((hg) => !excludedIds.includes(hg.id) && !hg.isEvicted);\n}\n\nexport function randomPlayer(inclusions: Houseguest[], exclusions: Houseguest[] = []): Houseguest {\n    if (inclusions.length === 0) {\n        throw new Error(\"Tried to get a random player from a list of 0 players.\");\n    }\n    const options = exclude(inclusions, exclusions);\n    const choice = rng().randomInt(0, options.length - 1);\n\n    return options[choice];\n}\n\nexport function nonEvictedHouseguests(gameState: GameState): Houseguest[] {\n    return [...gameState.nonEvictedHouseguests.entries()].map(([_, id]) => getById(gameState, id));\n}\nexport function getJurors(gameState: GameState): Houseguest[] {\n    return gameState.houseguests.filter((hg) => hg.isJury);\n}\n\nexport function inJury(gameState: GameState): Boolean {\n    return gameState.remainingPlayers - getFinalists() <= gameState.finalJurySize();\n}\n\nexport function calculatePopularity(hero: Houseguest, house: Houseguest[]) {\n    let sum = 0;\n    let count = 0;\n    const targetId = hero.id;\n    house.forEach((houseguest) => {\n        if (houseguest.id !== targetId) {\n            count++;\n            sum += houseguest.relationships[targetId];\n        }\n    });\n    return count === 0 ? 0 : sum / count;\n}\n\nexport function defaultJurySize(castSize: number): number {\n    castSize = Math.round(castSize * 0.55);\n    if (castSize % 2 === 0) {\n        castSize--;\n    }\n    return castSize;\n}\n\nexport function validateJurySize(j: number, castSize: number): boolean {\n    return j >= 1 && j % 2 === 1 && castSize - 2 >= j;\n}\n\nclass _GameState {\n    private jurors: number = 0;\n    readonly houseguests: Houseguest[] = [];\n\n    public finalJurySize() {\n        return this.jurors;\n    }\n    set jurySize(j: number) {\n        if (!validateJurySize(j, this.houseguests.length)) {\n            return;\n        }\n        this.jurors = j;\n    }\n}\n\ninterface InitGameState {\n    players: PlayerProfile[];\n    jury: number;\n}\n\nexport class GameState extends _GameState {\n    // State of the game after a phase.\n\n    readonly houseguestCache: { [id: number]: Houseguest } = {};\n    readonly nonEvictedHouseguests: Set<number> = new Set<number>();\n    readonly remainingPlayers: number = 0;\n    readonly phase: number = 0;\n    readonly previousHOH?: Houseguest[];\n    readonly log: EpisodeLog[][] = [];\n    readonly cliques: Cliques[] = [];\n\n    public __logindex__: number = 0;\n    get currentLog(): EpisodeLog {\n        if (!this.log[this.phase]) return new EpisodeLog(); // an unused episode log, kind of like /dev/null\n        return this.log[this.phase][this.__logindex__];\n    }\n    public incrementLogIndex() {\n        this.__logindex__++;\n        this.log[this.phase].push(new EpisodeLog());\n    }\n    public resetLogIndex() {\n        this.__logindex__ = 0;\n    }\n\n    public constructor(init: InitGameState | GameState) {\n        super();\n        if (init instanceof GameState || init instanceof MutableGameState) {\n            Object.assign(this, init);\n        } else {\n            const _init = init as InitGameState;\n            const profiles = _init.players;\n            this.remainingPlayers = profiles.length;\n            profiles.forEach((profile, i) => {\n                const hg: Houseguest = new Houseguest({\n                    ...profile,\n                    id: i,\n                    relationships: newRelationshipMap(profiles.length, i),\n                });\n                this.nonEvictedHouseguests.add(i);\n                this.houseguestCache[i] = hg;\n                this.houseguests.push(hg);\n            });\n            this.jurySize = _init.jury;\n        }\n        if (!this.finalJurySize()) {\n            this.jurySize = defaultJurySize(this.houseguests.length);\n        }\n    }\n}\n\nexport class MutableGameState extends _GameState {\n    public houseguestCache: { [id: number]: Houseguest } = {};\n    readonly nonEvictedHouseguests: Set<number> = new Set<number>();\n    public remainingPlayers: number = 0;\n    public phase: number = 0;\n    public previousHOH?: Houseguest[];\n    public cliques: Cliques[] = [];\n    public log: EpisodeLog[][] = [];\n\n    public __logindex__: number = 0;\n    get currentLog(): EpisodeLog {\n        if (!this.log[this.phase]) return new EpisodeLog();\n        return this.log[this.phase][this.__logindex__];\n    }\n    public incrementLogIndex() {\n        this.__logindex__++;\n        this.log[this.phase].push(new EpisodeLog());\n    }\n    public resetLogIndex() {\n        this.__logindex__ = 0;\n    }\n\n    public constructor(init: GameState | MutableGameState) {\n        super();\n        const copy = _.cloneDeep(init);\n        Object.assign(this, copy);\n    }\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests, getById } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { shuffle } from \"lodash\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { castEvictionVote, castVoteToSave, NumberWithLogic } from \"../../../utils/ai/aiApi\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NomineeVote, NormalVote, HoHVote, SaveVote, VoteType } from \"../../../model/logging/voteType\";\nimport { evictHouseguest } from \"../utilities/evictHouseguest\";\nimport { listNames, listVotes } from \"../../../utils/listStrings\";\n\nfunction getHighestIndicies(numbers: number[]): number[] {\n    const highest = Math.max(...numbers);\n    const highestIndicies = numbers.reduce((acc: any[], cur, i) => {\n        if (cur === highest) {\n            acc.push(i);\n        }\n        return acc;\n    }, []);\n    return highestIndicies;\n}\n\ninterface TieBreaker {\n    hg: Houseguest;\n    text: string;\n    voteType: (id: number) => VoteType;\n}\n\ninterface EvictionSceneOptions {\n    votingTo: \"Save\" | \"Evict\";\n    doubleEviction?: boolean;\n    tieBreaker?: TieBreaker;\n}\n\nexport function generateEvictionScene(\n    initialGameState: GameState,\n    hohArray: Houseguest[],\n    nominees: Houseguest[],\n    options: EvictionSceneOptions\n): [GameState, Scene] {\n    const doubleEviction = options.doubleEviction || false;\n    const castVote: (hero: Houseguest, noms: Houseguest[], gameState: GameState) => NumberWithLogic =\n        options.votingTo === \"Save\" ? castVoteToSave : castEvictionVote;\n    let newGameState = new MutableGameState(initialGameState);\n    newGameState.currentLog.votingTo = options.votingTo;\n    nominees = shuffle(nominees);\n    const votes: Array<ProfileHouseguest[]> = nominees.map((_) => []);\n    let lastVoter: Houseguest;\n    let outOf = 0;\n    const nonVoters = new Set<number>(nominees.map((hg) => hg.id));\n    hohArray.forEach((h) => nonVoters.add(h.id));\n    nonEvictedHouseguests(newGameState).forEach((hg) => {\n        if (!nonVoters.has(hg.id)) {\n            const logic = castVote(hg, nominees, newGameState);\n            const result: ProfileHouseguest = { ...hg };\n            result.tooltip = logic.reason;\n            newGameState.currentLog.votes[hg.id] =\n                options.votingTo === \"Evict\"\n                    ? new NormalVote(nominees[logic.decision].id)\n                    : new SaveVote(nominees[logic.decision].id);\n            votes[logic.decision].push(result);\n            lastVoter = hg;\n            outOf++;\n        }\n    });\n    const voteCounts: number[] = votes.map((vote) => vote.length);\n    const pluralities = getHighestIndicies(voteCounts);\n    newGameState.currentLog.outOf = outOf;\n    if (outOf === 1) {\n        newGameState.currentLog.soleVoter = lastVoter!!.name;\n    }\n    let tieVote = pluralities.length > 1;\n    let tieBreaker = { decision: -1, reason: \"\" };\n    const tieBreakerHg = options.tieBreaker ? options.tieBreaker.hg : hohArray[0];\n    if (tieVote) {\n        newGameState.currentLog.outOf++;\n        tieBreaker = castVote(\n            tieBreakerHg!,\n            pluralities.map((p) => nominees[p]),\n            newGameState\n        );\n        const tiebreakerDecision = nominees[pluralities[tieBreaker.decision]].id;\n        newGameState.currentLog.votes[tieBreakerHg!.id] = options.tieBreaker\n            ? options.tieBreaker.voteType(tiebreakerDecision)\n            : new HoHVote(tiebreakerDecision);\n    }\n    let evictees: Houseguest[] = [];\n\n    if (options.votingTo === \"Evict\") {\n        // voting to evict\n        if (tieBreaker.decision > -1) {\n            // there was a tie\n            evictees.push(nominees[pluralities[tieBreaker.decision]]);\n            newGameState.currentLog.votesInMajority = voteCounts[pluralities[tieBreaker.decision]] + 1;\n        } else {\n            // there wasn't a tie\n            evictees.push(nominees[pluralities[0]]);\n            newGameState.currentLog.votesInMajority = voteCounts[pluralities[0]];\n        }\n    } else {\n        // voting to save\n        if (tieBreaker.decision > -1) {\n            // there was a tie\n            const safe = nominees[pluralities[tieBreaker.decision]];\n            newGameState.currentLog.votesInMajority = voteCounts[pluralities[tieBreaker.decision]] + 1;\n            nominees.forEach((nom) => {\n                if (nom.id !== safe.id) {\n                    evictees.push(nom);\n                }\n            });\n        } else {\n            // there wasn't a tie\n            const safe = nominees[pluralities[0]];\n            newGameState.currentLog.votesInMajority = voteCounts[pluralities[0]];\n            nominees.forEach((nom) => {\n                if (nom.id !== safe.id) {\n                    evictees.push(nom);\n                }\n            });\n        }\n    }\n    const evicteesSet = new Set<number>(evictees.map((hg) => hg.id));\n    nominees.forEach((hg) => {\n        newGameState.currentLog.votes[hg.id] = new NomineeVote(evicteesSet.has(hg.id));\n    });\n\n    const votesPerEvictee: any = {};\n    nominees.forEach((hg, i) => {\n        if (!evicteesSet.has(hg.id)) return;\n        votesPerEvictee[hg.id] = voteCounts[i] + (tieBreaker.decision === i ? 1 : 0);\n    });\n\n    if (options.votingTo === \"Evict\") evictees.sort((a, b) => votesPerEvictee[b.id] - votesPerEvictee[a.id]);\n    else evictees.sort((a, b) => votesPerEvictee[a.id] - votesPerEvictee[b.id]);\n\n    evictees.forEach((evictee) => {\n        newGameState = evictHouseguest(newGameState, evictee.id);\n    });\n    const isUnanimous = voteCounts.filter((n) => n !== 0).length === 1;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${listVotes(voteCounts.map((v) => `${v}`))}...`;\n\n    const compWinner = options.tieBreaker ? options.tieBreaker.text : \"current Head of Household\";\n    const soleVoteText = `${\n        tieBreakerHg!.name\n    }, as ${compWinner}, you must cast the sole vote to ${options.votingTo.toLowerCase()}.`;\n\n    const displayHoH: ProfileHouseguest = { ...tieBreakerHg! };\n    displayHoH.tooltip = tieBreaker.reason;\n    const margin = doubleEviction ? { marginTop: 200 } : {};\n    const scene = new Scene({\n        title: \"Live Eviction\",\n        gameState: initialGameState,\n        content: (\n            <div style={margin}>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    {votes.map((voters, i) => (\n                        <DividerBox className=\"column\" key={`voters${i}`}>\n                            <Portraits houseguests={voters} centered={true} />\n                        </DividerBox>\n                    ))}\n                </div>\n                {tieVote && (\n                    <div>\n                        <CenteredBold> We have a tie.</CenteredBold>\n                        <Centered>{soleVoteText}</Centered>\n                        <Portraits houseguests={[displayHoH]} centered={true} />\n                        <CenteredBold>\n                            I vote to {options.votingTo.toLowerCase()}\n                            {` ${nominees[pluralities[tieBreaker.decision]].name}.`}\n                        </CenteredBold>\n                    </div>\n                )}\n                <Portraits houseguests={nominees.map((hg) => getById(newGameState, hg.id))} centered={true} />\n                {options.votingTo === \"Save\" && (\n                    <CenteredBold>{`${listNames(\n                        nominees.filter((nom) => !evicteesSet.has(nom.id)).map((hg) => hg.name)\n                    )}... you are safe.`}</CenteredBold>\n                )}\n                <CenteredBold>{`${options.votingTo === \"Save\" ? \"That means \" : \"\"}${listNames(\n                    evictees.map((hg) => hg.name)\n                )}... you have been evicted from the Big Brother House.`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [newGameState, scene];\n}\n","import { GameState, Houseguest, MutableGameState } from \"../../model\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport { Scene } from \"./scenes/scene\";\nimport { GoldenVeto } from \"./veto/veto\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateNomCeremonyScene } from \"./scenes/nomCeremonyScene\";\nimport { generateVetoCompScene } from \"./scenes/vetoCompScene\";\nimport { generateVetoCeremonyScene } from \"./scenes/vetoCeremonyScene\";\nimport { generateEvictionScene } from \"./scenes/evictionScene\";\nimport { PoVvote } from \"../../model/logging/voteType\";\n\nexport const CoHoH: EpisodeType = {\n    canPlayWith: (n: number) => n >= 5,\n    eliminates: 1,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n    name: \"Co-HoH\",\n    description:\n        \"Two HoHs each name one nominee, and are responsible for replacing the person they nominated if the veto is used on them.\",\n    emoji: \"👥\",\n    generate: generateCoHoH,\n};\n\nfunction generateCoHoH(initialGamestate: GameState): Episode {\n    // generate (co)-hoh scene\n    let currentGameState = new MutableGameState(initialGamestate);\n    let hohArray: Houseguest[];\n    let hohCompScene: Scene;\n    const scenes: Scene[] = [];\n    [currentGameState, hohCompScene, hohArray] = generateHohCompScene(currentGameState, {\n        coHoH: true,\n        coHohIsFinal: true,\n    });\n    scenes.push(hohCompScene);\n\n    // generate nominations scene\n    let nomCeremonyScene;\n    let nominees: Houseguest[];\n    [currentGameState, nomCeremonyScene, nominees] = generateNomCeremonyScene(currentGameState, hohArray, {});\n    scenes.push(nomCeremonyScene);\n    // veto comp\n    let vetoCompScene;\n    let povWinner: Houseguest;\n    [currentGameState, vetoCompScene, povWinner] = generateVetoCompScene(\n        currentGameState,\n        hohArray,\n        nominees,\n        GoldenVeto\n    );\n    scenes.push(vetoCompScene);\n    // veto replacement scene might be different because each hoh nominated one person, so whoever gets vetoed, that hoh replaces\n    let vetoCeremonyScene;\n\n    [currentGameState, vetoCeremonyScene, nominees] = generateVetoCeremonyScene(\n        currentGameState,\n        hohArray,\n        nominees,\n        povWinner,\n        false,\n        GoldenVeto,\n        []\n    );\n    scenes.push(vetoCeremonyScene);\n\n    // then eviction scene\n    let evictionScene;\n    [currentGameState, evictionScene] = generateEvictionScene(currentGameState, hohArray, nominees, {\n        votingTo: \"Evict\",\n        tieBreaker: { hg: povWinner, text: \"Power of Veto winner\", voteType: (id) => new PoVvote(id) },\n    });\n    scenes.push(evictionScene);\n    return new Episode({\n        gameState: new GameState(currentGameState),\n        initialGamestate,\n        scenes,\n        type: CoHoH,\n    });\n}\n","import { GameState } from \"../../model\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { EpisodeType, Episode } from \"./episodes\";\nimport { DiamondVeto } from \"./veto/veto\";\n\nexport const DiamondVetoEpisode: EpisodeType = {\n    canPlayWith: (n: number) => n >= 4,\n    eliminates: 1,\n    arrowsEnabled: true,\n    emoji: \"💎\",\n    hasViewsbar: true,\n    name: \"Diamond Veto\",\n    description: \"The veto winner has the right to name a replacement nominee.\",\n    generate: generateNoVeto,\n};\n\nfunction generateNoVeto(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, DiamondVeto);\n    return new Episode({\n        gameState: new GameState(episode.gameState),\n        initialGamestate,\n        scenes: episode.scenes,\n        type: DiamondVetoEpisode,\n    });\n}\n","import { GameState, MutableGameState } from \"../../model\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport React from \"react\";\nimport { Scene } from \"./scenes/scene\";\nimport { GoldenVeto } from \"./veto/veto\";\n\nexport const DoubleEviction: EpisodeType = {\n    canPlayWith: (n: number) => n >= 4,\n    eliminates: 1,\n    arrowsEnabled: true,\n    emoji: \"⏩\",\n    hasViewsbar: true,\n    chainable: true,\n    name: \"Double Eviction\",\n    description: \"A second round of Big Brother plays out in a single scene.\",\n    generate: generateDoubleEviction,\n};\n\nfunction generateDoubleEviction(initialGamestate: GameState): Episode {\n    let currentGameState = new MutableGameState(initialGamestate);\n    const scenes: Scene[] = [];\n\n    currentGameState.incrementLogIndex();\n    const doubleEviction = generateBBVanillaScenes(currentGameState, GoldenVeto, true);\n    currentGameState = doubleEviction.gameState;\n    scenes.push(\n        new Scene({\n            title: \"Double Eviction\",\n            content: <div>{doubleEviction.scenes.map((scene) => scene.content)}</div>,\n            gameState: doubleEviction.gameState,\n        })\n    );\n\n    return new Episode({\n        gameState: new GameState(currentGameState),\n        initialGamestate,\n        scenes,\n        type: DoubleEviction,\n    });\n}\n","import { GameState } from \"../../model\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { EpisodeType, Episode } from \"./episodes\";\nimport { SpotlightVeto } from \"./veto/veto\";\n\nexport const ForcedVetoEpisode: EpisodeType = {\n    canPlayWith: (n: number) => n >= 5,\n    eliminates: 1,\n    arrowsEnabled: true,\n    emoji: \"🔦\",\n    hasViewsbar: true,\n    name: \"Forced Veto\",\n    description: \"The veto winner must use the veto.\",\n    generate: generateForcedVeto,\n};\n\nfunction generateForcedVeto(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, SpotlightVeto);\n    return new Episode({\n        gameState: new GameState(episode.gameState),\n        initialGamestate,\n        scenes: episode.scenes,\n        type: ForcedVetoEpisode,\n    });\n}\n","import React from \"react\";\nimport { GameState, MutableGameState } from \"../../model\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { EpisodeType, Episode } from \"./episodes\";\nimport { Scene } from \"./scenes/scene\";\n\nexport const InstantEviction: EpisodeType = {\n    canPlayWith: (n: number) => n >= 4,\n    eliminates: 1,\n    arrowsEnabled: true,\n    emoji: \"⚡\",\n    hasViewsbar: true,\n    chainable: true,\n    name: \"Instant Eviction\",\n    description: \"A double eviction without a veto.\",\n    generate: generateInstantEviction,\n};\n\nfunction generateInstantEviction(initialGamestate: GameState): Episode {\n    let currentGameState = new MutableGameState(initialGamestate);\n    const scenes: Scene[] = [];\n\n    currentGameState.incrementLogIndex();\n    const doubleEviction = generateBBVanillaScenes(currentGameState, null, true);\n    currentGameState = doubleEviction.gameState;\n\n    scenes.push(\n        new Scene({\n            title: \"Instant Eviction\",\n            content: <div>{doubleEviction.scenes.map((scene) => scene.content)}</div>,\n            gameState: doubleEviction.gameState,\n        })\n    );\n\n    return new Episode({\n        gameState: new GameState(currentGameState),\n        initialGamestate,\n        scenes,\n        type: InstantEviction,\n    });\n}\n","import { GameState } from \"../../model\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { EpisodeType, Episode } from \"./episodes\";\n\nexport const NoVeto: EpisodeType = {\n    canPlayWith: (n: number) => n >= 4,\n    eliminates: 1,\n    arrowsEnabled: true,\n    emoji: \"🚫\",\n    hasViewsbar: true,\n    name: \"No Veto\",\n    description: \"A week without a veto.\",\n    generate: generateNoVeto,\n};\n\nfunction generateNoVeto(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, null);\n    return new Episode({\n        gameState: new GameState(episode.gameState),\n        initialGamestate,\n        scenes: episode.scenes,\n        type: NoVeto,\n    });\n}\n","import React from \"react\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { GameState } from \"../../model/gameState\";\n\nconst PregameEpisodeType: EpisodeType = {\n    eliminates: 0,\n    canPlayWith: (n: number) => {\n        return n > 2;\n    },\n    arrowsEnabled: true,\n    emoji: \"\",\n    hasViewsbar: false,\n    name: \"Pregame\",\n    description: \"\",\n    generate: (gameState: GameState) => new PregameEpisode(gameState),\n};\n\nexport class PregameEpisode extends Episode {\n    readonly title = \"Pregame\";\n    readonly scenes = [];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = PregameEpisodeType;\n\n    public constructor(gameState: GameState) {\n        super({\n            title: \"Pregame\",\n            scenes: [],\n            content: <PregameScreen cast={gameState.houseguests} />,\n            gameState,\n            type: PregameEpisodeType,\n        });\n        this.gameState = gameState;\n        this.content = <PregameScreen cast={gameState.houseguests} />;\n    }\n}\n","import { Episode, EpisodeType, GameState, Houseguest, MutableGameState } from \"../../model\";\nimport React from \"react\";\nimport { Scene } from \"./scenes/scene\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateNomCeremonyScene } from \"./scenes/nomCeremonyScene\";\nimport { generateVetoCompScene } from \"./scenes/vetoCompScene\";\nimport { generateVetoCeremonyScene } from \"./scenes/vetoCeremonyScene\";\nimport { generateEvictionScene } from \"./scenes/evictionScene\";\nimport { GoldenVeto } from \"./veto/veto\";\n\nexport const TripleEvictionCad: EpisodeType = {\n    canPlayWith: (n: number) => n >= 5,\n    eliminates: 2,\n    arrowsEnabled: true,\n    emoji: \"🇨🇦\",\n    chainable: true,\n    hasViewsbar: true,\n    name: \"Triple Eviction\",\n    description:\n        \"A double eviction with three nominees. Houseguests vote to save one, and the other two are evicted.\",\n    generate: generateTripleEvictionCad,\n};\n\nexport function generateTripleEvictionCad(initialGamestate: GameState): Episode {\n    let currentGameState = new MutableGameState(initialGamestate);\n    const scenes: Scene[] = [];\n\n    currentGameState.incrementLogIndex();\n\n    let hohArray: Houseguest[];\n    let hohCompScene: Scene;\n    const tripleScenes: Scene[] = [];\n    [currentGameState, hohCompScene, hohArray] = generateHohCompScene(currentGameState, {\n        doubleEviction: true,\n        customText: \"Houseguests, please return to the living room. Tonight will be a triple eviction.\",\n    });\n    tripleScenes.push(hohCompScene);\n    const hoh = hohArray[0];\n\n    let nomCeremonyScene;\n    let nominees: Houseguest[];\n    [currentGameState, nomCeremonyScene, nominees] = generateNomCeremonyScene(currentGameState, [hoh], {\n        doubleEviction: true,\n        thirdNominee: true,\n    });\n    tripleScenes.push(nomCeremonyScene);\n\n    let vetoCompScene;\n    let povWinner: Houseguest;\n    [currentGameState, vetoCompScene, povWinner] = generateVetoCompScene(\n        currentGameState,\n        [hoh],\n        nominees,\n        GoldenVeto,\n        true\n    );\n    tripleScenes.push(vetoCompScene);\n\n    let vetoCeremonyScene;\n\n    [currentGameState, vetoCeremonyScene, nominees] = generateVetoCeremonyScene(\n        currentGameState,\n        [hoh],\n        nominees,\n        povWinner,\n        true,\n        GoldenVeto,\n        []\n    );\n    tripleScenes.push(vetoCeremonyScene);\n\n    let evictionScene;\n    [currentGameState, evictionScene] = generateEvictionScene(currentGameState, [hoh], nominees, {\n        doubleEviction: true,\n        votingTo: \"Save\",\n    });\n    tripleScenes.push(evictionScene);\n\n    scenes.push(\n        new Scene({\n            title: \"Triple Eviction\",\n            content: <div>{tripleScenes.map((scene) => scene.content)}</div>,\n            gameState: currentGameState,\n        })\n    );\n\n    return new Episode({\n        gameState: new GameState(currentGameState),\n        initialGamestate,\n        scenes,\n        type: TripleEvictionCad,\n    });\n}\n","export interface Tribe {\n    color: string;\n    name: string;\n    tribeId: number;\n}\n\nlet tribeId = 0;\n\nexport function getTribe(name: string, color: string): Tribe {\n    return {\n        color: color,\n        name: name,\n        tribeId: tribeId++,\n    };\n}\n","import React from \"react\";\nimport { Tribe } from \"../../model/tribe\";\nimport { NumericInput } from \"../castingScreen/numericInput\";\nimport { CenteredBold } from \"../layout/centered\";\nimport { Label } from \"./seasonEditorPage\";\n\nfunction Team(props: { team: ChangableTeam; disabled: boolean; i: number }) {\n    const data = props.team;\n    return (\n        <div className=\"field has-addons\" style={{ textAlign: \"center\" }} key={data.tribeId}>\n            <p className=\"field-label is-normal control\">\n                <Label className=\"label\">#{props.i} Name:</Label>\n            </p>\n            <p className=\"control\">\n                <input\n                    className=\"input\"\n                    value={data.name}\n                    onChange={(event) => props.team.onChangeName(event.target.value)}\n                />\n            </p>\n            <p className=\"field-label is-normal control\">\n                <Label className=\"label\">Color</Label>\n            </p>\n            <p className=\"control\">\n                <input\n                    type=\"color\"\n                    value={data.color}\n                    onChange={(event) => props.team.onChangeColor(event.target.value)}\n                />\n            </p>\n            <p className=\"control\">\n                <button className=\"button is-danger\" disabled={props.disabled} onClick={data.removeTeam}>\n                    X\n                </button>\n            </p>\n        </div>\n    );\n}\n\nexport interface ChangableTeam extends Tribe {\n    onChangeName: (name: string) => void;\n    onChangeColor: (color: string) => void;\n    removeTeam: () => void;\n}\n\nexport interface TeamAdderProps {\n    id: number;\n    Teams: { [id: number]: ChangableTeam };\n    endsWhen: string;\n    onChangeNumber: (n: string) => void;\n    addTeam: () => void;\n    deleteSelf: () => void;\n}\n\nexport class TeamsAdder extends React.Component<TeamAdderProps, {}> {\n    public render() {\n        const teams = Object.values(this.props.Teams);\n        return (\n            <div\n                className=\"column is-12-desktop is-12-widescreen is-12-fullhd is-12-tablet\"\n                style={{\n                    border: \"1px solid #808080\",\n                    borderRadius: \"4px\",\n                    backgroundColor: \"#444346\",\n                    margin: \"10px\",\n                }}\n                key={this.props.id}\n            >\n                <CenteredBold>Team Phase {this.props.id}</CenteredBold>\n                {teams.map((tribe, i) => (\n                    <Team team={tribe} key={i} disabled={teams.length <= 2} i={1 + i} />\n                ))}\n                <div className=\"level is-marginless\">\n                    <div className=\"level-item\">\n                        <button className=\"button is-primary\" onClick={this.props.addTeam}>\n                            Add Team\n                        </button>\n                    </div>\n                </div>\n                <div className=\"level\">\n                    <Label className=\"label\">🏁 Ends at Final</Label>\n                    <NumericInput\n                        className=\"input\"\n                        value={this.props.endsWhen}\n                        onChange={this.props.onChangeNumber}\n                    />\n                    <button className=\"button is-danger\" onClick={this.props.deleteSelf}>\n                        Delete Team Phase\n                    </button>\n                </div>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { getRandomColor, invertColor } from \"../../model/color\";\nimport { getTribe, Tribe } from \"../../model/tribe\";\nimport { EpisodeType } from \"../episode/episodes\";\nimport { ChangableTeam, TeamAdderProps, TeamsAdder } from \"./teamsAdder\";\nimport { twist$ } from \"./twistAdder\";\n\ninterface TeamsAdderListState {\n    items: { [id: number]: TeamAdderProps };\n    id: number;\n}\n\nlet _teams: { [id: number]: TeamAdderProps } = {};\n\nexport function getTeamsListContents(): { [id: number]: TeamAdderProps } {\n    return { ..._teams };\n}\n\nexport class TeamsAdderList extends React.Component<{}, TeamsAdderListState> {\n    public constructor(props: {}) {\n        super(props);\n        _teams = {};\n        this.state = { items: {}, id: 1 };\n    }\n\n    public componentDidUpdate(): void {\n        _teams = { ...this.state.items };\n    }\n\n    private getOnChangeName(id: number, tribeId: number): (name: string) => void {\n        return ((name: string) => {\n            const newState = this.state;\n            newState.items[id].Teams[tribeId].name = name;\n            this.setState(newState);\n        }).bind(this);\n    }\n    private getOnChangeColor(id: number, tribeId: number): (name: string) => void {\n        return ((color: string) => {\n            const newState = this.state;\n            newState.items[id].Teams[tribeId].color = color;\n            this.setState(newState);\n        }).bind(this);\n    }\n    private getOnDelete(id: number, tribeId: number): () => void {\n        return (() => {\n            const newState = this.state;\n            delete newState.items[id].Teams[tribeId];\n            this.setState(newState);\n        }).bind(this);\n    }\n\n    private getTwist(id: number): EpisodeType {\n        return {\n            canPlayWith: (n: number) => n > 3,\n            eliminates: 0,\n            pseudo: true,\n            teamsLookupId: id,\n            name: `Team Phase ${id}`,\n            emoji: \"🎌\",\n            generate: (_) => {\n                throw \"UNREACHABLE\";\n            },\n        };\n    }\n\n    private getOnDeleteSelf(id: number): () => void {\n        return (() => {\n            const newState = this.state;\n            twist$.next({ type: this.getTwist(id), add: false });\n            delete newState.items[id];\n            this.setState(newState);\n        }).bind(this);\n    }\n    public render(): JSX.Element {\n        const items = this.state.items;\n\n        return (\n            <div>\n                {Object.values(items).map((item, i) => (\n                    <TeamsAdder {...item} key={i} />\n                ))}\n                <button\n                    className=\"button is-primary\"\n                    onClick={() => {\n                        const newItems = { ...items };\n                        const id = this.state.id;\n                        const color = getRandomColor();\n                        const tribe1: Tribe = getTribe(\"\", color.toHex());\n                        const tribe2: Tribe = getTribe(\"\", invertColor(color).toHex());\n                        const Teams: { [id: number]: ChangableTeam } = {};\n                        for (let tribe of [tribe1, tribe2]) {\n                            const tribeId = tribe.tribeId;\n                            Teams[tribeId] = {\n                                ...tribe,\n                                onChangeName: this.getOnChangeName(id, tribeId),\n                                onChangeColor: this.getOnChangeColor(id, tribeId),\n                                removeTeam: this.getOnDelete(id, tribeId),\n                            };\n                        }\n                        newItems[id] = {\n                            id,\n                            endsWhen: \"2\",\n                            onChangeNumber: ((n: string) => {\n                                const newState = { ...this.state };\n                                newState.items[id].endsWhen = n;\n                                this.setState(newState);\n                            }).bind(this),\n                            Teams,\n                            deleteSelf: this.getOnDeleteSelf(id),\n                            addTeam: () => {\n                                const newState = { ...this.state };\n                                const newTeam = getTribe(\"\", getRandomColor().toHex());\n                                const tribeId = newTeam.tribeId;\n                                newState.items[id].Teams[tribeId] = {\n                                    ...newTeam,\n                                    onChangeName: this.getOnChangeName(id, tribeId),\n                                    onChangeColor: this.getOnChangeColor(id, tribeId),\n                                    removeTeam: this.getOnDelete(id, tribeId),\n                                };\n                                newState.id = id + 1;\n                                this.setState(newState);\n                            },\n                        };\n                        twist$.next({\n                            add: true,\n                            type: this.getTwist(id),\n                        });\n                        this.setState({\n                            items: newItems,\n                            id: id + 1,\n                        });\n                    }}\n                >\n                    🎌 Add Teams Twist\n                </button>\n            </div>\n        );\n    }\n}\n","import { VoteType } from \"./voteType\";\n\nexport class EpisodeLog {\n    public nominationsPreVeto: string[] = [];\n    public vetoWinner?: string;\n    public winner?: number;\n    public runnerUp?: number;\n    public nominationsPostVeto: string[] = [];\n    public evicted: number[] = [];\n    public customEvicted: number[] = [];\n    public customEvictedText: string = \"\";\n    public votes: { [id: string]: VoteType } = {};\n    public votesInMajority: number = -1;\n    public outOf: number = -1;\n    public soleVoter?: string;\n    public votingTo?: string;\n    public pseudo?: boolean = false;\n    public strikethroughNominees: string[] = [];\n}\n\nexport function hasLogBeenModified(log: EpisodeLog): boolean {\n    return (\n        log.nominationsPreVeto.length > 0 ||\n        log.nominationsPostVeto.length > 0 ||\n        log.evicted.length > 0 ||\n        log.customEvicted.length > 0 ||\n        log.customEvictedText.length > 0 ||\n        Object.keys(log.votes).length > 0 ||\n        log.votesInMajority !== -1 ||\n        log.outOf !== -1 ||\n        log.soleVoter !== undefined ||\n        log.votingTo !== undefined ||\n        !!log.pseudo\n    );\n}\n","import { Episode, EpisodeType } from \"../episode/episodes\";\nimport { BigBrotherVanilla } from \"../episode/bigBrotherEpisode\";\nimport { shuffle, sum } from \"lodash\";\nimport { EpisodeLibrary } from \"../../model/season\";\nimport { GameState, getById, MutableGameState } from \"../../model/gameState\";\nimport { getTeamsListContents } from \"./teamsAdderList\";\nimport { EndTeamVote, TeamVote } from \"../../model/logging/voteType\";\nimport { hasLogBeenModified } from \"../../model/logging/episodelog\";\nimport { TeamAdderProps } from \"./teamsAdder\";\nimport { _items, deleteTeams, _castSize } from \"./seasonEditorList\";\nimport { isNotWellDefined } from \"../../utils\";\n\nexport function getEpisodeLibrary(): EpisodeLibrary {\n    const generate = (_: any) => {\n        throw \"UNREACHABLE\";\n    };\n    const episodes: EpisodeType[] = [];\n    const teamListContents = getTeamsListContents();\n    // generate teams\n    let finalX = _castSize;\n    const teamIdtoFinalX = new Map<number, number>();\n    const _mappedItems = _items.map((item) => {\n        if (item.episode.teamsLookupId !== undefined) {\n            // if a team ends when it starts, don't use it\n            if (parseInt(teamListContents[item.episode.teamsLookupId!].endsWhen) == finalX) return;\n            teamIdtoFinalX.set(item.episode.teamsLookupId, finalX);\n            const dynamicEpisodeType = {\n                canPlayWith: (n: number) => n > 3,\n                eliminates: 0,\n                pseudo: true,\n                emoji: \"🎌\",\n                teamsLookupId: item.episode.teamsLookupId,\n            };\n            item.episode = {\n                ...dynamicEpisodeType,\n                generate: (initialGamestate: GameState) => {\n                    let currentGameState = new MutableGameState(initialGamestate);\n                    const teams = Object.values(teamListContents[item.episode.teamsLookupId!].Teams);\n                    const nonEvictedHouseguests: number[] = shuffle(\n                        Array.from(currentGameState.nonEvictedHouseguests)\n                    );\n                    // if we are in a log that has been modified, increment log index to make a new one for teams //\n                    const logWasModified = hasLogBeenModified(currentGameState.currentLog);\n                    // if the log was modified, jump to a new one for teams //\n                    logWasModified && currentGameState.incrementLogIndex();\n\n                    // now assign them to teams using the modulo operator\n                    nonEvictedHouseguests.forEach((hgid, i) => {\n                        const hg = getById(currentGameState, hgid);\n                        const team = teams[i % teams.length];\n                        hg.tribe = team;\n                        currentGameState.currentLog.votes[hg.id] = new TeamVote(team.color);\n                    });\n                    currentGameState.currentLog.pseudo = true;\n                    // if the log was not modified earlier, make a new one so we will have something to write to\n                    // for the upcoming episode\n                    !logWasModified && currentGameState.incrementLogIndex();\n                    // add all the teams as team votes\n                    return new Episode({\n                        gameState: new GameState(currentGameState),\n                        initialGamestate: new GameState(currentGameState),\n                        scenes: [],\n                        type: {\n                            ...dynamicEpisodeType,\n                            generate,\n                        },\n                    });\n                },\n            };\n        }\n        finalX -= item.episode.eliminates;\n        return item;\n    });\n\n    // typescript is retarded so it is unable to realize that i am REMOVING the undefined items in this filter statement\n    const mappedItems: any[] = _mappedItems.filter((item) => !isNotWellDefined(item));\n    // FIXME: 3 is a magic number because you can't have twists after F4\n    // this may need to change in the future if we add final 3 endgames\n    const totalPlayers = sum(mappedItems.map((item) => item.episode.eliminates)) + 3;\n\n    Object.values(teamListContents).forEach((item: TeamAdderProps) => {\n        const endsAt: number = parseInt(item.endsWhen);\n        const startsAt = teamIdtoFinalX.get(item.id)!;\n        // find startsAt, and if endsAt was before startsAt, don't bother ending\n        if (endsAt >= startsAt) return;\n        // similarly, if there is another team phase between startsAt and endsAt, also don't bother\n        // FIXME: this will break SO HARD when we do returnees\n        let invalid = false;\n        teamIdtoFinalX.forEach((finalX, teamId) => {\n            if (invalid) return;\n            if (teamId !== item.id && startsAt > finalX && endsAt < finalX) {\n                invalid = true;\n            }\n        });\n        if (invalid) return;\n\n        const teams: number[] = Object.keys(item.Teams).map((key) => parseInt(key));\n        const dynamicEpisodeType = {\n            pseudo: true,\n            canPlayWith: () => true,\n            eliminates: 0,\n            emoji: \"🏁\",\n        };\n        const endTeamsEpisodeType: EpisodeType = {\n            ...dynamicEpisodeType,\n            generate: (initialGamestate: GameState): Episode => {\n                let currentGameState = new MutableGameState(initialGamestate);\n                deleteTeams(currentGameState, new Set<number>(teams));\n\n                // if we are in a log that has been modified, increment log index to make a new one for teams //\n                const logWasModified = hasLogBeenModified(currentGameState.currentLog);\n                // if the log was modified, jump to a new one for teams //\n                logWasModified && currentGameState.incrementLogIndex();\n\n                // now assign them to teams using the modulo operator\n                currentGameState.nonEvictedHouseguests.forEach((hgid, i) => {\n                    const hg = getById(currentGameState, hgid);\n                    currentGameState.currentLog.votes[hg.id] = new EndTeamVote(\"black\");\n                });\n                currentGameState.currentLog.pseudo = true;\n                // if the log was not modified earlier, make a new one so we will have something to write to\n                // for the upcoming episode\n                !logWasModified && currentGameState.incrementLogIndex();\n\n                return new Episode({\n                    gameState: new GameState(currentGameState),\n                    initialGamestate,\n                    scenes: [],\n                    type: {\n                        ...dynamicEpisodeType,\n                        generate,\n                    },\n                });\n            },\n        };\n        if (endsAt < 3) return; // no point in ending teams that never end\n        let i = 0;\n        let playersRemaining = totalPlayers;\n        while (endsAt < playersRemaining && endsAt > 3) {\n            playersRemaining -= mappedItems[i].episode.eliminates;\n            i++;\n        }\n        mappedItems.splice(i, 0, { episode: endTeamsEpisodeType });\n    });\n\n    let previousItem: EpisodeType | undefined = undefined;\n    for (const item of mappedItems) {\n        if (item.episode.pseudo) {\n            previousItem = item.episode;\n            continue;\n        }\n        // if previous item is pseudo, chain it to the current one then continue running code\n        if (previousItem && previousItem.pseudo) {\n            // so basically the exact same thing as item, but emojis are chained\n            const pseudoItem = previousItem;\n            const newItem = item.episode;\n            const common = {\n                canPlayWith: () => true,\n                eliminates: pseudoItem.eliminates + newItem.eliminates,\n                emoji: `${pseudoItem.emoji} ${newItem.emoji}`,\n            };\n            item.episode = {\n                ...common,\n                chainable: !!newItem.chainable,\n                generate: (initialGamestate: GameState) => {\n                    const firstEpisode = pseudoItem.generate(initialGamestate);\n                    const secondEpisode = newItem.generate(firstEpisode.gameState);\n                    return new Episode({\n                        gameState: new GameState(secondEpisode.gameState),\n                        initialGamestate: new GameState(firstEpisode.gameState),\n                        scenes: secondEpisode.scenes,\n                        type: {\n                            ...newItem,\n                            ...common,\n                            generate,\n                        },\n                    });\n                },\n            };\n            previousItem = undefined;\n        }\n        // if not chainable, push to newItems\n        if (!item.episode.chainable) {\n            episodes.push(item.episode);\n        } else {\n            // if chainable, merge most recent newItems item\n            const oldEpisode = episodes[episodes.length - 1];\n            const newEpisode = item.episode;\n            const dynamicEpisodeType = {\n                arrowsEnabled: oldEpisode.arrowsEnabled || newEpisode.arrowsEnabled,\n                canPlayWith: () => true,\n                eliminates: oldEpisode.eliminates + newEpisode.eliminates,\n                hasViewsbar: oldEpisode.hasViewsbar || newEpisode.hasViewsbar,\n                emoji: `${oldEpisode.emoji} ${newEpisode.emoji}`,\n            };\n            const newItem: EpisodeType = {\n                ...dynamicEpisodeType,\n                generate: (initialGamestate) => {\n                    const firstEpisode = oldEpisode.generate(initialGamestate);\n                    const secondEpisode = newEpisode.generate(firstEpisode.gameState);\n                    return new Episode({\n                        gameState: new GameState(secondEpisode.gameState),\n                        // extremely important: pseudo stuff like teams happens in the initial gamestate\n                        initialGamestate: firstEpisode.initialGameState,\n                        scenes: firstEpisode.scenes.concat(secondEpisode.scenes),\n                        type: {\n                            ...dynamicEpisodeType,\n                            generate,\n                        },\n                    });\n                },\n            };\n            episodes[episodes.length - 1] = newItem;\n            previousItem = newItem;\n        }\n    }\n\n    const result: EpisodeLibrary = {};\n    let playersRemaining = _castSize;\n    for (const episode of episodes) {\n        if (episode !== BigBrotherVanilla) {\n            result[playersRemaining] = episode;\n        }\n        playersRemaining -= episode.eliminates;\n    }\n    return result;\n}\n","import { GameState } from \"../../model\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport { generateSafetyChainScene } from \"./scenes/safetyChainScene\";\n\nexport const SafetyChain: EpisodeType = {\n    canPlayWith: (n: number) => n >= 3,\n    eliminates: 1,\n    chainable: true,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n    name: \"Safety Chain\",\n    emoji: \"⛓️\",\n    description:\n        \"The winner of a competition gives safety to another houseguest, who gives safety to another houseguest, until 3 unsafe houseguests remain. They compete in a final safety competition, and the two losers face an eviction vote.\",\n    generate: generateSafetyChain,\n};\n\nexport function generateSafetyChain(initialGameState: GameState): Episode {\n    let currentGameState: GameState = initialGameState;\n    currentGameState.incrementLogIndex();\n    let safetyChainScene;\n    [currentGameState, safetyChainScene] = generateSafetyChainScene(initialGameState);\n    return new Episode({\n        gameState: new GameState(currentGameState),\n        scenes: [safetyChainScene],\n        type: SafetyChain,\n    });\n}\n","import React from \"react\";\nimport { GameState, getById, Houseguest, nonEvictedHouseguests } from \"../../../model\";\nimport { GrayVote, PoVvote, SaveVote } from \"../../../model/logging/voteType\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { Scene } from \"./scene\";\nimport { getWorstTarget } from \"../../../utils/ai/aiApi\";\nimport { listNames } from \"../../../utils/listStrings\";\nimport { generateHohCompScene } from \"./hohCompScene\";\nimport { generateEvictionScene } from \"./evictionScene\";\n\nexport function generateSafetyChainScene(initialGameState: GameState): [GameState, Scene] {\n    const chainOrder: Houseguest[] = [];\n    let [newGameState, HoHscene, HoHarray] = generateHohCompScene(initialGameState, {\n        doubleEviction: true,\n        customText:\n            \"Houseguests, please return to the living room. It is time for a Safety Chain Special Eviction.\",\n        skipHoHWin: true,\n        bottomText: \"has won the safety competition!\",\n    });\n    const chainStarter: Houseguest = HoHarray[0];\n    const options: Houseguest[] = nonEvictedHouseguests(newGameState).filter(\n        (hg) => hg.id !== chainStarter.id\n    );\n    chainOrder.push(chainStarter);\n    const safeSpots = newGameState.nonEvictedHouseguests.size - 3;\n    let currentChooser: Houseguest = chainStarter;\n    const sceneContent: JSX.Element[] = [];\n    let first = true;\n    while (chainOrder.length < safeSpots) {\n        const newSafeIndex = options.indexOf(getWorstTarget(currentChooser, options, newGameState));\n        chainOrder.push(options[newSafeIndex]);\n        newGameState.currentLog.votes[currentChooser.id] = first\n            ? new PoVvote(options[newSafeIndex].id)\n            : new SaveVote(options[newSafeIndex].id);\n        first = false;\n        options.splice(newSafeIndex, 1);\n        sceneContent.push(\n            <Centered key={`safetychain-${newGameState.phase}-${chainOrder.length}`}>\n                {currentChooser.name} has chosen {chainOrder[chainOrder.length - 1].name}!\n            </Centered>,\n            <Portraits\n                houseguests={[currentChooser, chainOrder[chainOrder.length - 1]]}\n                key={`safetychain-${newGameState.phase}-${chainOrder.length}-2`}\n                centered={true}\n            />\n        );\n        currentChooser = chainOrder[chainOrder.length - 1];\n    }\n    newGameState.currentLog.votes[currentChooser.id] = new SaveVote(-1, \"Not eligible\");\n\n    const leftOut = options.slice(0, 3);\n\n    leftOut.forEach((hg) => (newGameState.currentLog.votes[hg.id] = new GrayVote(\"Not eligible\")));\n    newGameState.currentLog.customEvictedText = \"not selected for safety\";\n    newGameState.currentLog.customEvicted = leftOut.map((hg) => hg.id);\n\n    sceneContent.push(\n        <CenteredBold key={`safetychain-final-${newGameState.phase}-${chainOrder.length}`}>\n            {listNames(leftOut.map((h) => h.name))} compete in a second safety competition.\n        </CenteredBold>,\n        <Portraits\n            houseguests={leftOut}\n            centered={true}\n            key={`safetychain-final-${newGameState.phase}-${chainOrder.length}-2`}\n        />\n    );\n    let safetyComp2scene;\n    let safeHg: Houseguest[];\n    [newGameState, safetyComp2scene, safeHg] = generateHohCompScene(newGameState, {\n        doubleEviction: true,\n        competitors: leftOut,\n        customText: ``,\n        skipHoHWin: true,\n        bottomText: \"has won the safety competition!\",\n    });\n\n    newGameState.incrementLogIndex();\n    const noms = leftOut.filter((hg) => hg.id !== safeHg[0].id).map((hg) => getById(newGameState, hg.id));\n\n    newGameState.currentLog.nominationsPostVeto = noms.map((n) => n.name);\n    let evictionScene;\n    noms.forEach((nom) => nom.nominations++);\n    [newGameState, evictionScene] = generateEvictionScene(newGameState, [], noms, {\n        votingTo: \"Evict\",\n        doubleEviction: true,\n        tieBreaker: {\n            hg: chainStarter,\n            text: \"Safety Competition winner\",\n            voteType: (id) => new PoVvote(id),\n        },\n    });\n\n    const scene: Scene = new Scene({\n        title: \"Chain Ceremony\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                {HoHscene.content}\n                {sceneContent}\n                <div style={{ marginTop: 50 }}>\n                    <Centered> ...</Centered>\n                </div>\n                {safetyComp2scene.content}\n                {evictionScene.content}\n            </div>\n        ),\n    });\n    return [newGameState, scene];\n}\n","import React, { useState } from \"react\";\nimport styled from \"styled-components\";\nimport { defaultJurySize, GameState, validateJurySize } from \"../../model/gameState\";\nimport { cast$, newEpisode, pushToMainContentStream, season$ } from \"../../subjects/subjects\";\nimport { NumericInput } from \"../castingScreen/numericInput\";\nimport { BattleOfTheBlock } from \"../episode/botbEpisode\";\nimport { BoomerangVetoEpisode } from \"../episode/boomerangVetoEpisode\";\nimport { CoHoH } from \"../episode/coHoHEpisode\";\nimport { DiamondVetoEpisode } from \"../episode/diamondVetoEpisode\";\nimport { DoubleEviction } from \"../episode/doubleEvictionEpisode\";\nimport { EpisodeType } from \"../episode/episodes\";\nimport { ForcedVetoEpisode } from \"../episode/forcedVetoEpisode\";\nimport { InstantEviction } from \"../episode/instantEvictionEpisode\";\nimport { NoVeto } from \"../episode/noVetoEpisode\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { TripleEvictionCad } from \"../episode/tripleEvictionEpisodeCad\";\nimport { HasText } from \"../layout/text\";\nimport { selectPlayer } from \"../playerPortrait/selectedPortrait\";\nimport { Noselect } from \"../playerPortrait/setupPortrait\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { Screens } from \"../topbar/topBar\";\nimport { SeasonEditorList } from \"./seasonEditorList\";\nimport { getEpisodeLibrary } from \"./getEpisodeLibrary\";\nimport { TwistAdder } from \"./twistAdder\";\nimport { SafetyChain } from \"../episode/safetyChain\";\nimport { TeamsAdderList } from \"./teamsAdderList\";\n\nconst Subheader = styled.h3`\n    text-align: center;\n    color: #fff;\n`;\n\nexport const Label = styled.label`\n    color: #fff;\n`;\n\nconst twists: EpisodeType[] = [\n    DoubleEviction,\n    TripleEvictionCad,\n    SafetyChain,\n    InstantEviction,\n    NoVeto,\n    DiamondVetoEpisode,\n    ForcedVetoEpisode,\n    BoomerangVetoEpisode,\n    CoHoH,\n    BattleOfTheBlock,\n];\n\nconst submit = async (jury: number): Promise<void> => {\n    season$.next(getEpisodeLibrary());\n\n    // reset stuff and start a new game\n    pushToMainContentStream(<PregameScreen cast={cast$.value} />, Screens.Other);\n    selectPlayer(null);\n    // vscode says the awaits are unnessecary here,\n    // but if you remove them then bad things happen\n    await newEpisode(null);\n    await newEpisode(new PregameEpisode(new GameState({ players: cast$.value, jury })));\n};\n\nexport function SeasonEditorPage(): JSX.Element {\n    const castLength = cast$.value.length;\n    const [jurySize, setJurySize] = useState(`${defaultJurySize(castLength)}`);\n    const validJurySize = validateJurySize(parseInt(jurySize), castLength);\n    const [areTwistsValid, setTwistsValid] = useState(true);\n    return (\n        <div className=\"columns\">\n            <div className=\"column is-one-quarter\">\n                <HasText>\n                    <h3 style={{ textAlign: \"center\" }}>Season Overview</h3>\n                </HasText>\n                <hr />\n                <Noselect>\n                    <SeasonEditorList setTwistsValid={setTwistsValid} castSize={castLength} />\n                </Noselect>\n            </div>\n            <div className=\"column\" style={{ padding: 20 }}>\n                <Subheader>Add Twists</Subheader>\n                <div className=\"columns is-multiline is-centered\">\n                    {twists.map((type) => (\n                        <TwistAdder type={type} key={`${type.name}${type.emoji}`} />\n                    ))}\n                    <div\n                        className=\"column is-4\"\n                        style={{\n                            border: \"1px solid #808080\",\n                            borderRadius: \"4px\",\n                            backgroundColor: \"#444346\",\n                            margin: \"10px\",\n                        }}\n                    >\n                        <HasText className=\"field is-horizontal centered\">\n                            <div className=\"field-label is-normal\">\n                                <Label className=\"label\" style={validJurySize ? {} : { color: \"#fb8a8a\" }}>\n                                    Jury Size:\n                                </Label>\n                            </div>\n                            <div className=\"field-body\">\n                                <div className=\"field\">\n                                    <div className=\"control\">\n                                        <NumericInput\n                                            className={validJurySize ? undefined : \"is-danger\"}\n                                            value={jurySize}\n                                            onChange={setJurySize}\n                                            placeholder={`${defaultJurySize(castLength)}`}\n                                        />\n                                    </div>\n                                    <p className=\"help\" style={validJurySize ? {} : { color: \"#fb8a8a\" }}>\n                                        {validJurySize\n                                            ? `(Jury starts at F${parseInt(jurySize) + 2})`\n                                            : `Jury must be an odd number < ${castLength - 2}`}\n                                    </p>\n                                </div>\n                            </div>\n                        </HasText>\n                    </div>\n                </div>\n                <Subheader>🎌 Add Teams</Subheader>\n                <TeamsAdderList />\n            </div>\n            <div className=\"column is-narrow\" style={{ paddingTop: 20, paddingRight: 20 }}>\n                <button\n                    className=\"button is-success\"\n                    style={{ float: \"right\" }}\n                    onClick={() => {\n                        submit(parseInt(jurySize));\n                    }}\n                    disabled={!validJurySize || !areTwistsValid}\n                >\n                    Submit\n                </button>\n            </div>\n        </div>\n    );\n}\n","import React from \"react\";\nimport FileDrop from \"react-file-drop\";\nimport { PlayerProfile } from \"../../model\";\nimport { SetupPortrait } from \"../playerPortrait/setupPortrait\";\nimport { shuffle } from \"lodash\";\nimport { RandomButton } from \"./randomXButton\";\nimport { selectCastPlayer } from \"../playerPortrait/selectedPortrait\";\nimport { pushToMainContentStream, selectedCastPlayer$, updateCast } from \"../../subjects/subjects\";\nimport { HasText, Input } from \"../layout/text\";\nimport { Centered } from \"../layout/centered\";\nimport { Subscription } from \"rxjs\";\nimport _ from \"lodash\";\nimport { HelpLink } from \"../episode/allianceList\";\nimport { SeasonEditorPage } from \"../seasonEditor/seasonEditorPage\";\nimport { Screens } from \"../topbar/topBar\";\n\ninterface CastingScreenProps {\n    cast?: PlayerProfile[];\n}\n\ninterface CastingScreenState {\n    players: PlayerProfile[];\n    selectedPlayers: Set<number>;\n}\n\nlet id = 1;\n\nexport class CastingScreen extends React.Component<CastingScreenProps, CastingScreenState> {\n    private sub: Subscription | null = null;\n\n    constructor(props: CastingScreenProps) {\n        super(props);\n        if (props.cast) {\n            selectCastPlayer(null);\n            props.cast.forEach((player) => (player.castingScreenId = id++));\n        }\n        this.state = { players: props.cast || [], selectedPlayers: new Set<number>() };\n    }\n\n    public componentDidMount() {\n        this.sub = selectedCastPlayer$.subscribe((selectedPlayers) => {\n            this.setState({ selectedPlayers });\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    private deleteMethod(i: number, castingScreenId: number) {\n        return () => {\n            const newState = { ...this.state };\n            newState.players.splice(i, 1);\n            if (newState.selectedPlayers.has(castingScreenId)) {\n                selectCastPlayer(castingScreenId);\n            }\n            this.setState(newState);\n        };\n    }\n\n    private rename(i: number) {\n        return () => {\n            const newState = { ...this.state };\n            const newName: string | null = prompt(`Enter a new name for ${newState.players[i].name}`);\n            if (!newName) return;\n            newState.players[i].name = newName;\n            this.setState(newState);\n        };\n    }\n\n    private getFiles() {\n        const players = this.state.players;\n        if (!players) {\n            return;\n        }\n        const rows: JSX.Element[] = [];\n        let i = 0;\n        players.forEach((player) =>\n            rows.push(\n                <SetupPortrait\n                    name={player.name}\n                    imageUrl={player.imageURL}\n                    onDelete={this.deleteMethod(i, player.castingScreenId || -1)}\n                    onClick={() => {\n                        selectCastPlayer(player.castingScreenId || -1);\n                    }}\n                    onRename={this.rename(i)}\n                    selected={this.state.selectedPlayers.has(player.castingScreenId || -1)}\n                    key={(++i).toString()}\n                />\n            )\n        );\n        return <div className=\"columns is-gapless is-mobile is-multiline is-centered\">{rows}</div>;\n    }\n\n    private submit = () => {\n        updateCast(this.state.players);\n        pushToMainContentStream(<SeasonEditorPage />, Screens.Season);\n    };\n\n    private random = (_amount: number) => {\n        // get all the selected players first\n        let result: PlayerProfile[] = [];\n        let amount = _amount;\n\n        const allPlayers = this.state.players;\n        let unselectedPlayers: PlayerProfile[] = [];\n\n        allPlayers.forEach((player) => {\n            if (this.state.selectedPlayers.has(player.castingScreenId || -1)) {\n                result.push(player);\n                amount--;\n            } else {\n                unselectedPlayers.push(player);\n            }\n        });\n\n        if (amount > 0) {\n            unselectedPlayers = shuffle(unselectedPlayers);\n            unselectedPlayers = unselectedPlayers.slice(0, amount);\n        }\n        let players = amount > 0 ? result.concat(unselectedPlayers) : result;\n        players = shuffle(players);\n        this.setState({ players });\n    };\n\n    public render() {\n        return (\n            <FileDrop onDrop={this.handleDrop}>\n                <HasText className=\"level\">\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-danger\"\n                            onClick={() => {\n                                this.setState({ players: [] });\n                                selectCastPlayer(null);\n                            }}\n                        >\n                            Delete all\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-danger\"\n                            disabled={this.state.selectedPlayers.size === 0}\n                            onClick={() => {\n                                const players = this.state.players.filter(\n                                    (player) => !this.state.selectedPlayers.has(player.castingScreenId || -1)\n                                );\n                                this.setState({ players });\n                                selectCastPlayer(null);\n                            }}\n                        >\n                            Delete selected\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-warning\"\n                            onClick={() => selectCastPlayer(null)}\n                            disabled={this.state.selectedPlayers.size === 0}\n                        >\n                            Unselect {this.state.selectedPlayers.size || \"all\"}\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <RandomButton random={this.random} />\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-success\"\n                            disabled={this.state.players.length < 3}\n                            onClick={this.submit}\n                        >\n                            Next\n                        </button>\n                    </div>\n                </HasText>\n                <Input type=\"file\" multiple onChange={this.handleUpload} />\n                {this.state.players.length === 0 && (\n                    <Centered>\n                        ~ Drop images here ~\n                        <br />\n                        <br />\n                        <HelpLink\n                            href=\"https://github.com/spaulmark/bb-bots/blob/master/README.md#choose-a-cast-of-characters\"\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            Need help setting up a game?\n                        </HelpLink>\n                    </Centered>\n                )}\n                {this.getFiles()}\n            </FileDrop>\n        );\n    }\n\n    private handleUpload = (event: any) => {\n        this.handleFiles(event.target.files);\n    };\n\n    private handleDrop = (files: FileList | null) => {\n        if (!files) return;\n        this.handleFiles(files);\n    };\n\n    private handleFiles(files: FileList) {\n        const newState = { ...this.state };\n        for (let i = 0; i < files.length; i++) {\n            const file = files[i];\n            if (file.type.match(/image\\/*/)) {\n                newState.players.push({\n                    name: file.name.substr(0, file.name.lastIndexOf(\".\")) || file.name,\n                    imageURL: URL.createObjectURL(file),\n                    castingScreenId: id++,\n                });\n            }\n        }\n        this.setState(newState);\n    }\n}\n","import React from \"react\";\nimport ReactPaginate from \"react-paginate\";\nimport { HasText } from \"../layout/text\";\nimport { shuffle, ceil, debounce } from \"lodash\";\nimport { pushToMainContentStream, selectDeckSubject, selectedDecks$ } from \"../../subjects/subjects\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport _ from \"lodash\";\nimport styled from \"styled-components\";\nimport { Subscription } from \"rxjs\";\nimport { selectedColor } from \"../playerPortrait/houseguestPortraitController\";\nimport { PlayerProfile } from \"../../model\";\nimport { Screens } from \"../topbar/topBar\";\n\ninterface DeckScreenProps {}\n\ninterface DeckScreenState {\n    loading: boolean;\n    decks: string[];\n    i: number;\n    sortedDecks: string[];\n    debouncedSearchText: string;\n    isSorted: boolean;\n    searchText: string;\n    selectedDecks: Set<string>;\n}\n\nconst decksPerPage = 26;\nexport const baseUrl = \"https://raw.githubusercontent.com/spaulmark/img/master/\";\n\nconst imageCache: { [id: string]: string } = {};\n\nconst DeckStyle = styled(HasText)`\n    display: flex;\n    cursor: pointer;\n    align-items: center;\n    :hover {\n        color: red;\n        background-color: #ffe1ea;\n    }\n`;\n\nconst Centered = styled.div`\n    display: flex;\n    justify-content: center;\n    align-items: center;\n`;\n\nconst DeckText = styled.p`\n    margin-left: 1rem;\n`;\n\nasync function randomImageFromFolder(folder: string) {\n    if (imageCache[folder]) return imageCache[folder];\n    const links = await (await fetch(`${baseUrl}${folder}/dir.json`)).json();\n    const image = _.sample(links[\"files\"]);\n    imageCache[folder] = `${baseUrl}${folder}/${image}`;\n    return `${baseUrl}${folder}/${image}`;\n}\n\nasync function submitCasts(casts: Set<string>) {\n    const playerProfiles: PlayerProfile[] = [];\n\n    for (const cast of casts) {\n        const links = await (await fetch(`${baseUrl}${cast}/dir.json`)).json();\n        const imageLinks = links[\"files\"].map((file: string) => {\n            return { name: file, url: `${baseUrl}${cast}/${file}` };\n        });\n        const folderProfiles = imageLinks.map((image: { name: string; url: string }) => {\n            return {\n                name: image.name.substr(0, image.name.lastIndexOf(\".\")) || image.name,\n                imageURL: image.url,\n            };\n        });\n        playerProfiles.push(...folderProfiles);\n    }\n\n    pushToMainContentStream(<CastingScreen cast={playerProfiles} />, Screens.Casting);\n}\n\nfunction Deck(props: { deck: string; selected: boolean }): JSX.Element {\n    const [img, setImage] = React.useState(\"\");\n    const [loading, setLoading] = React.useState(true);\n    const deck = props.deck;\n\n    if (loading)\n        randomImageFromFolder(deck).then((img) => {\n            setLoading(false);\n            setImage(img);\n        });\n    const style = props.selected ? { backgroundColor: selectedColor.toHex(), color: \"black\" } : {};\n    return (\n        <DeckStyle className=\"column is-6\" onClick={() => selectDeckSubject(props.deck)} style={style}>\n            <img src={img} style={{ width: 50, height: 50 }} />\n            <DeckText>{deck}</DeckText>\n        </DeckStyle>\n    );\n}\n\nfunction DeckList(props: { data: string[]; i: number; selected: Set<string> }): JSX.Element {\n    let decks: JSX.Element[] = [];\n    const i = props.i;\n    const data = props.data;\n    const min = i * decksPerPage;\n    for (let j = min; j < min + decksPerPage; j++) {\n        const deck = data[j];\n        if (!deck) continue;\n        decks.push(<Deck selected={props.selected.has(deck)} key={`${deck}__${i}__${j}`} deck={deck} />);\n    }\n    return (\n        <div key={\"__ul__\"} className={\"columns is-multiline\"}>\n            {decks}\n        </div>\n    );\n}\n\nexport class DeckScreen extends React.Component<DeckScreenProps, DeckScreenState> {\n    private subs: Subscription[] = [];\n\n    constructor(props: DeckScreenProps) {\n        super(props);\n        this.state = {\n            loading: true,\n            decks: [],\n            sortedDecks: [],\n            selectedDecks: new Set<string>(),\n            i: 0,\n            isSorted: false,\n            debouncedSearchText: \"\",\n            searchText: \"\",\n        };\n    }\n    async componentDidMount() {\n        selectDeckSubject(null);\n        this.subs.push(selectedDecks$.subscribe((selectedDecks) => this.setState({ selectedDecks })));\n        const data = await (await fetch(`${baseUrl}/dir.json`)).json();\n        this.setState({\n            sortedDecks: data.decks,\n            decks: shuffle(data.decks),\n            selectedDecks: new Set<string>(),\n            loading: false,\n        });\n    }\n    componentWillUnmount() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    private handlePageClick = (page: { selected: number }) => {\n        this.setState({ i: page.selected });\n    };\n\n    private debounceSearch = debounce((nextValue: string) => {\n        this.setState({ debouncedSearchText: nextValue, i: 0 });\n    }, 250);\n\n    private handleSearch = (event: { target: { value: string } }) => {\n        this.setState({ searchText: event.target.value });\n        this.debounceSearch(event.target.value);\n    };\n\n    render() {\n        if (this.state.loading) return <div />;\n        const decks = (this.state.isSorted ? this.state.sortedDecks : this.state.decks).filter((deck) =>\n            deck.toLowerCase().match(this.state.debouncedSearchText.toLowerCase())\n        );\n        return (\n            <div>\n                <div className=\"level\">\n                    <div className=\"level-item\">\n                        <input\n                            style={{ minWidth: \"50%\" }}\n                            className=\"input\"\n                            type=\"text\"\n                            placeholder=\"Search...\"\n                            onChange={this.handleSearch}\n                            value={this.state.searchText}\n                        ></input>\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className={`button ${this.state.isSorted ? \"is-danger\" : \"is-primary\"}`}\n                            onClick={() => this.setState({ isSorted: !this.state.isSorted })}\n                        >\n                            A/Z\n                        </button>\n                    </div>\n\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-warning\"\n                            onClick={() => selectDeckSubject(null)}\n                            disabled={this.state.selectedDecks.size === 0}\n                        >\n                            Unselect All\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <HasText>{`${this.state.selectedDecks.size} casts selected`}</HasText>\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-success\"\n                            disabled={this.state.selectedDecks.size === 0}\n                            onClick={() => submitCasts(this.state.selectedDecks)}\n                        >\n                            Next\n                        </button>\n                    </div>\n                </div>\n                <DeckList\n                    key={\"comments\"}\n                    selected={this.state.selectedDecks}\n                    data={decks}\n                    i={this.state.i}\n                />\n                <Centered>\n                    <ReactPaginate\n                        key={\"__list__\"}\n                        previousLabel={\"previous\"}\n                        nextLabel={\"next\"}\n                        breakLabel={\"...\"}\n                        breakClassName={\"break-me\"}\n                        pageCount={ceil(decks.length / decksPerPage)}\n                        marginPagesDisplayed={2}\n                        pageRangeDisplayed={3}\n                        onPageChange={this.handlePageClick}\n                        containerClassName={\"pagination\"}\n                        activeClassName={\"active\"}\n                    />\n                </Centered>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport { getCast, pushToMainContentStream } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\nimport { Box } from \"../layout/box\";\nimport { DeckScreen } from \"../deckScreen/deckScreen\";\nimport { SeasonEditorPage } from \"../seasonEditor/seasonEditorPage\";\nimport { BehaviorSubject, Subscription } from \"rxjs\";\n\nexport enum Screens {\n    Deck = \"choosecast\",\n    Casting = \"editcast\",\n    Season = \"editseason\",\n    Other = \"other\",\n}\n\n// for topbar minty colors\nexport const activeScreen$ = new BehaviorSubject<Screens>(Screens.Other);\n\nexport const TopbarLink = styled.a`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.link};\n    cursor: pointer;\n`;\n\nexport const ActiveTopbarLink = styled.mark`\n    cursor: pointer;\n    font-weight: bold;\n`;\n\nexport function CastingScreenLink(): JSX.Element {\n    const LinkStyle = activeScreen$.value === Screens.Casting ? ActiveTopbarLink : TopbarLink;\n    return (\n        <LinkStyle\n            onClick={() => {\n                pushToMainContentStream(\n                    <CastingScreen cast={JSON.parse(JSON.stringify(getCast()))} />,\n                    Screens.Casting\n                );\n            }}\n        >\n            Edit / Upload Cast\n        </LinkStyle>\n    );\n}\n\nexport function EditSeasonLink(): JSX.Element {\n    const LinkStyle = activeScreen$.value === Screens.Season ? ActiveTopbarLink : TopbarLink;\n    return (\n        <LinkStyle\n            onClick={() => {\n                pushToMainContentStream(<SeasonEditorPage />, Screens.Season);\n            }}\n        >\n            Edit Season/Twists\n        </LinkStyle>\n    );\n}\n\nexport function ChooseCastLink(): JSX.Element {\n    const LinkStyle = activeScreen$.value === Screens.Deck ? ActiveTopbarLink : TopbarLink;\n    return (\n        <LinkStyle\n            onClick={() => {\n                pushToMainContentStream(<DeckScreen />, Screens.Deck);\n            }}\n        >\n            Choose Cast\n        </LinkStyle>\n    );\n}\n\nexport class Topbar extends React.Component<{ style?: any }, { tab: Screens }> {\n    private subs: Subscription[] = [];\n    constructor(props: Readonly<{ style?: any }>) {\n        super(props);\n        this.state = { tab: Screens.Other };\n    }\n    componentDidMount() {\n        this.subs.push(activeScreen$.subscribe((tab) => this.setState({ tab })));\n    }\n    componentWillUnmount() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    public render(): JSX.Element {\n        const style = { ...(this.props.style || {}) };\n        return (\n            <Box className=\"level is-mobile\" style={style}>\n                <div className=\"level-item\">\n                    <ChooseCastLink />\n                </div>\n                <div className=\"level-item\">\n                    <CastingScreenLink />\n                </div>\n                <div className=\"level-item\">\n                    <EditSeasonLink />\n                </div>\n            </Box>\n        );\n    }\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { HasText } from \"../layout/text\";\nimport { popularityMode } from \"../../model/portraitDisplayMode\";\nimport { displayMode$, pushToMainContentStream, switchSceneRelative } from \"../../subjects/subjects\";\nimport { selectedColor } from \"../playerPortrait/houseguestPortraitController\";\nimport { Screens, TopbarLink } from \"../topbar/topBar\";\nimport { SeasonEditorPage } from \"../seasonEditor/seasonEditorPage\";\nimport { Centered, CenteredBold } from \"../layout/centered\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport { DeckScreen } from \"../deckScreen/deckScreen\";\n\ninterface PregameScreenProps {\n    cast: PlayerProfile[];\n}\n\nexport class PregameScreen extends React.Component<PregameScreenProps, {}> {\n    public componentDidMount() {\n        displayMode$.next(popularityMode);\n    }\n\n    public render() {\n        const props = this.props;\n        return (\n            <HasText>\n                <h2\n                    style={{\n                        color: selectedColor.toHex(),\n                        textShadow: \"rgb(114, 46, 123) 2px 2px 0px\",\n                        textAlign: \"center\",\n                    }}\n                >\n                    Big Brother Bots\n                </h2>\n                <CenteredBold>Big Brother Bots is a simulator for the reality show Big Brother.</CenteredBold>\n                <Centered>\n                    <TopbarLink\n                        onClick={() => {\n                            pushToMainContentStream(<DeckScreen />, Screens.Deck);\n                        }}\n                    >\n                        Choose characters\n                    </TopbarLink>{\" \"}\n                    from 300+ collections, or{\" \"}\n                    <TopbarLink\n                        onClick={() => {\n                            pushToMainContentStream(<CastingScreen cast={[]} />, Screens.Casting);\n                        }}\n                    >\n                        upload your own\n                    </TopbarLink>\n                    , then{\" \"}\n                    <TopbarLink\n                        onClick={() => {\n                            pushToMainContentStream(<SeasonEditorPage />, Screens.Season);\n                        }}\n                    >\n                        add twists\n                    </TopbarLink>{\" \"}\n                    and watch as everyone votes each other out until one winner remains!{\" \"}\n                </Centered>\n                {props.cast.length === 0 ? \"\" : <MemoryWall houseguests={props.cast} />}\n                {props.cast.length === 0 ? (\n                    \"\"\n                ) : (\n                    <p>\n                        <b> {\"You can use the ⬅️ and ➡️ arrow keys to move forwards and backwards.\"}</b>\n                    </p>\n                )}\n                {props.cast.length === 0 ? (\n                    \"\"\n                ) : (\n                    <button className=\"button is-success\" onClick={() => switchSceneRelative(1)}>\n                        Start Game\n                    </button>\n                )}\n            </HasText>\n        );\n    }\n}\n","import prand from \"pure-rand\";\nimport { BehaviorSubject } from \"rxjs\";\nimport { hashcode } from \"./utilities\";\nimport { cast$ } from \"../subjects/subjects\";\n\nexport class BbRandomGenerator {\n    private rng: prand.RandomGenerator;\n\n    // returns a random number between 0 and 1.\n    public randomFloat(): number {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result / 2147483647.0;\n    }\n\n    public randomInt(a: number, b: number): number {\n        let result: number;\n        [result, this.rng] = prand.uniformIntDistribution(a, b, this.rng);\n        return result;\n    }\n\n    public flipCoin(): boolean {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result % 2 === 0;\n    }\n\n    public seed(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n\n    public constructor(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n}\n\nexport function rng() {\n    return rng$.value;\n}\n\nconst rng$ = new BehaviorSubject(new BbRandomGenerator(0));\n\nconst castSub = cast$.subscribe({\n    next: (cast) => {\n        let castNames = \"\";\n        cast.forEach((houseguest) => (castNames += houseguest.name));\n        rng$.next(new BbRandomGenerator(hashcode(castNames)));\n    },\n});\n","import { Houseguest, GameState, nonEvictedHouseguests, getById } from \"../model\";\n\nimport { classifyRelationship, RelationshipType } from \"./ai/classifyRelationship\";\n\nimport _ from \"lodash\";\nimport { Graph } from \"./generateCliques\";\n\nclass EdgeMap {\n    public data: { [id: number]: Set<number> } = {};\n    public add(key: number, value: number) {\n        if (!this.data[key]) {\n            this.data[key] = new Set<number>([value]);\n        } else {\n            this.data[key].add(value);\n        }\n    }\n}\n\nfunction generateEdge(\n    hero: Houseguest,\n    villain: Houseguest,\n    relationship: number\n): [number[] | null, number] {\n    const relationshipType = classifyRelationship(hero.popularity, villain.popularity, relationship);\n    if (relationshipType === RelationshipType.Friend) {\n        return [[hero.id, villain.id], 1];\n    }\n    // no edge for non-mutual friends\n    return [null, 0];\n}\n\nexport default function generateGraph(gameState: GameState): Graph {\n    // this algorithm assumes every relationship is mutual,\n    // and will need a face lift if we get non-mutual relationships.\n    const players = nonEvictedHouseguests(gameState);\n    const nodes: number[] = [];\n    const edges: EdgeMap = new EdgeMap();\n    players.forEach((player) => {\n        let friendCount = 0;\n        _.forEach(player.relationships, (relationship, stringId) => {\n            const villainId = parseInt(stringId);\n            const [edge, friends] = generateEdge(player, getById(gameState, villainId), relationship);\n            friendCount += friends;\n            if (villainId > player.id) {\n                if (edge) {\n                    edges.add(player.id, villainId);\n                    edges.add(villainId, player.id);\n                }\n            }\n        });\n        // nodes[player.id] = friendCount; // for pivot later on, thats why friendcount is there unused\n        nodes.push(player.id);\n    });\n    return { nodes, neighbors: (v: number) => edges.data[v] || new Set([]) };\n}\n","import { intersection } from \".\";\nimport { GameState, getById } from \"../model\";\nimport generateGraph from \"./generateGraph\";\nimport { difference } from \"./utilities\";\n\nlet cliques: number[][] = [];\nexport interface Graph {\n    nodes: number[];\n    neighbors: (v: number) => Set<number>;\n}\n\nexport function newCliquesLength(a: Cliques): number {\n    return a.core.length + (a.affiliates ? a.affiliates[0].length + a.affiliates[1].length : 0);\n}\n\nexport interface Cliques {\n    core: number[];\n    affiliates?: [number[], number[]];\n}\n\nexport function generateCliques(gameState: GameState): Cliques[] {\n    const g = generateGraph(gameState);\n    cliques = [];\n    bronKerbosch(new Set<number>([]), new Set(g.nodes), new Set<number>([]), g);\n    cliques.forEach((clique) => clique.map((id) => getById(gameState, id)));\n    cliques = cliques.sort((a, b) => b.length - a.length);\n    const result: Cliques[] = [];\n    // ids of clique i, clique j, & overlap size\n    const mergeCandidates: [number, number, Cliques][] = [];\n    // generate overlap numbers for each clique (n^2)\n    cliques.forEach((clq, i) => {\n        const cliqueI = new Set(clq);\n        for (let j = i + 1; j < cliques.length; j++) {\n            const cliqueJ = new Set(cliques[j]);\n            const core = intersection(cliqueI, cliqueJ);\n            const affiliatesI: Set<number> = difference(cliqueI, core);\n            const affiliatesJ: Set<number> = difference(cliqueJ, core);\n            if (core.size > 0) {\n                mergeCandidates.push([\n                    i,\n                    j,\n                    {\n                        core: Array.from(core),\n                        affiliates: [Array.from(affiliatesI), Array.from(affiliatesJ)],\n                    },\n                ]);\n            }\n        }\n    });\n    // cliques that already have been merged get blacklisted\n    const blacklist: Set<number> = new Set<number>();\n\n    // merge cliques with highest overlap numbers until only unnacceptable overlap remains\n    // for example maybe if the size of both left and right affiliates is greater than the core\n    mergeCandidates.sort(\n        (a: [number, number, Cliques], b: [number, number, Cliques]) => b[2].core.length - a[2].core.length\n    );\n\n    mergeCandidates.forEach((candidate: [number, number, Cliques]) => {\n        const i = candidate[0];\n        const j = candidate[1];\n        if (blacklist.has(i) || blacklist.has(j)) return;\n        blacklist.add(i);\n        blacklist.add(j);\n        result.push(candidate[2]);\n    });\n    // add non merged cliques\n    cliques.forEach((clique, i) => {\n        if (blacklist.has(i)) return;\n        result.push({ core: clique });\n    });\n\n    // then sort and return result\n    result.sort((a: Cliques, b: Cliques) => newCliquesLength(b) - newCliquesLength(a));\n\n    return result;\n}\n\nfunction bronKerbosch(r: Set<number>, p: Set<number>, x: Set<number>, g: Graph) {\n    if (p.size === 0 && x.size === 0) {\n        const values = Array.from(r.values());\n        cliques.push(values);\n        return;\n    }\n    Array.from(p.keys()).forEach((v) => {\n        const rPrime = new Set(r.values()).add(v);\n        const pPrime = new Set([...p].filter((node) => g.neighbors(v).has(node)));\n        const xPrime = new Set([...x].filter((node) => g.neighbors(v).has(node)));\n        bronKerbosch(rPrime, pPrime, xPrime, g);\n        p.delete(v);\n        x.add(v);\n    });\n}\n","import { GameState, MutableGameState, nonEvictedHouseguests } from \"../../model/gameState\";\nimport { Episode, Houseguest } from \"../../model\";\nimport { EpisodeType } from \"./episodes\";\nimport { angleBetween, rng } from \"../../utils\";\nimport { EpisodeLog } from \"../../model/logging/episodelog\";\nimport { generateCliques } from \"../../utils/generateCliques\";\nimport _ from \"lodash\";\nimport { refreshHgStats } from \"./utilities/evictHouseguest\";\n\nexport function canDisplayCliques(newState: GameState): boolean {\n    return newState.remainingPlayers <= 30;\n}\n\nfunction firstImpressions(houseguests: Houseguest[]) {\n    const sin = Math.sin;\n    const cos = Math.cos;\n    houseguests.forEach((hg) => {\n        // generate random spherical co-ordinates on the unit sphere\n        const u = rng().randomFloat();\n        const v = Math.abs(rng().randomFloat());\n        const θ = 2 * Math.PI * u;\n        const φ = Math.acos(2 * v - 1);\n        // convert spherical co-ords to cartesian co-ords\n        hg.compatibility = [sin(θ) * cos(φ), sin(θ) * sin(φ), cos(θ)];\n    });\n    for (let i = 0; i < houseguests.length; i++) {\n        const iMap = houseguests[i].relationships;\n        for (let j = i + 1; j < houseguests.length; j++) {\n            // creates a bunch of mutual relationships based on points on a sphere\n            const jMap = houseguests[j].relationships;\n            const impression =\n                1 - (2 * angleBetween(houseguests[i].compatibility, houseguests[j].compatibility)) / Math.PI;\n            jMap[i] = impression;\n            iMap[j] = impression;\n        }\n    }\n}\n\nexport function nextEpisode(gameState: GameState, episodeType: EpisodeType): Episode {\n    let newState = new MutableGameState(gameState);\n    if (gameState.phase === 0) {\n        firstImpressions(newState.houseguests);\n    }\n    !episodeType.pseudo && newState.phase++;\n    !episodeType.pseudo && newState.resetLogIndex();\n    if (gameState.remainingPlayers > 2 && !episodeType.pseudo) {\n        newState.log[newState.phase] = [new EpisodeLog()];\n    }\n    refreshHgStats(newState, true);\n    nonEvictedHouseguests(newState).forEach((hg) => {\n        hg.previousPopularity = hg.popularity;\n    });\n    if (canDisplayCliques(newState)) newState.cliques = generateCliques(newState);\n    const finalState = new GameState(newState);\n    if (!episodeType.canPlayWith(finalState.remainingPlayers))\n        throw new Error(\n            `Episode type ${episodeType.name} not playable with ${finalState.remainingPlayers} players`\n        );\n    return episodeType.generate(finalState);\n}\n","import React from \"react\";\nimport { GameState } from \"../../model\";\nimport { weekStartTab$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { AllianceList, HelpLink } from \"./allianceList\";\n\ninterface WeekStartWrapperProps {\n    gameState: GameState;\n}\n\ninterface WeekStartWrapperState {\n    tab: number;\n}\n\nexport class WeekStartWrapper extends React.Component<WeekStartWrapperProps, WeekStartWrapperState> {\n    private subs: Subscription[] = [];\n    constructor(props: Readonly<WeekStartWrapperProps>) {\n        super(props);\n        this.state = { tab: weekStartTab$.value };\n    }\n    componentDidMount() {\n        this.subs.push(weekStartTab$.subscribe((tab) => this.setState({ tab })));\n    }\n    componentWillUnmount() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    render() {\n        const helpText1 =\n            this.props.gameState.phase === 1 ? (\n                <div key=\"helptext1\" style={{ marginTop: 10 }}>\n                    <b>Try clicking on houseguests to view their relationships.</b> <br />\n                </div>\n            ) : null;\n        const helptext2 =\n            this.props.gameState.phase === 2 ? (\n                <HelpLink\n                    key=\"helptext2\"\n                    href=\"https://github.com/spaulmark/bb-bots/blob/master/README.md#understanding-relationships\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                >\n                    What do the 🛇 ✘ ♥ 💔 🎯 symbols mean?\n                </HelpLink>\n            ) : null;\n        if (this.state.tab === 0) {\n            return [\n                <MemoryWall key=\"memorywall\" houseguests={this.props.gameState.houseguests} />,\n                helpText1,\n                helptext2,\n            ];\n        }\n        return <AllianceList gameState={this.props.gameState} />;\n    }\n}\n","import { GameState, getJurors, nonEvictedHouseguests, MutableGameState, Houseguest } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { castJuryVote } from \"../../../utils/ai/aiApi\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport React from \"react\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport { NormalVote } from \"../../../model/logging/voteType\";\n\nexport function juryVoteScene(initialGameState: GameState): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const jurors: Houseguest[] = getJurors(newGameState);\n    const finalists = nonEvictedHouseguests(newGameState);\n    const votes: Array<ProfileHouseguest[]> = [[], []];\n    jurors.forEach((juror) => {\n        const decision = castJuryVote(juror, finalists);\n        const result: ProfileHouseguest = { ...juror };\n        votes[decision].push(result);\n        newGameState.currentLog.votes[juror.id] = new NormalVote(finalists[decision].id);\n    });\n    const votesFor0 = votes[0].length;\n    const votesFor1 = votes[1].length;\n    const isUnanimous = votesFor0 === 0 || votesFor1 === 0;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${votesFor0} to ${votesFor1}...`;\n\n    const winner = votesFor0 > votesFor1 ? finalists[0] : finalists[1];\n    const runnerUp = votesFor0 < votesFor1 ? finalists[0] : finalists[1];\n    newGameState.currentLog.winner = winner.id;\n    newGameState.currentLog.runnerUp = runnerUp.id;\n    const scene = new Scene({\n        title: \"Jury Votes\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[0]} centered={true} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[1]} centered={true} />\n                    </DividerBox>\n                </div>\n                <Portraits houseguests={finalists} centered={true} />\n                <CenteredBold>{`Congratulations, ${winner.name}... you are the winner of Big Brother!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [newGameState, scene];\n}\n","import React from \"react\";\nimport { EpisodeType, Episode } from \"./episodes\";\nimport { GameState } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { finalHohCompScene } from \"./scenes/finalHohCompScene\";\nimport { finalEvictionScene } from \"./scenes/finalEvictionScene\";\nimport { juryVoteScene } from \"./scenes/juryVoteScene\";\nimport { HasText } from \"../layout/text\";\n\nexport const BigBrotherFinale: EpisodeType = {\n    canPlayWith: (n: number) => n === 3,\n    eliminates: 2,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n    generate: generateBbFinale,\n};\n\nexport function generateBbFinale(initialGameState: GameState): Episode {\n    const title = \"Finale\";\n    const content = (\n        <HasText>\n            <MemoryWall houseguests={initialGameState.houseguests} /> <br />\n            <NextEpisodeButton />\n        </HasText>\n    );\n    let currentGameState;\n    let hohCompScene;\n    let finalHoH;\n    const scenes = [];\n    [currentGameState, hohCompScene, finalHoH] = finalHohCompScene(initialGameState);\n    scenes.push(hohCompScene);\n    let finalEviction;\n    [currentGameState, finalEviction] = finalEvictionScene(currentGameState, finalHoH);\n    scenes.push(finalEviction);\n    const [gameState, juryScene] = juryVoteScene(currentGameState);\n    scenes.push(juryScene);\n    return new Episode({ gameState, content, title, scenes, type: BigBrotherFinale });\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById,\n} from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { Portraits, Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\n\nexport function finalHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n    const final3 = nonEvictedHouseguests(initialGameState);\n    const enduranceWinner = randomPlayer(final3);\n    const enduranceLosers = final3.filter((hg) => hg.id !== enduranceWinner.id);\n    const skillWinner = randomPlayer(final3, [enduranceWinner]);\n    const finalHoH = getById(newGameState, randomPlayer([enduranceWinner, skillWinner]).id);\n    finalHoH.hohWins++;\n    const scene: Scene = new Scene({\n        title: \"Final HoH Competition\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>The final 3 houseguests compete in the endurance competition.</Centered>\n                <Portraits houseguests={final3} centered={true} />\n                <Portrait houseguest={enduranceWinner} centered={true} />\n                <CenteredBold>{`${enduranceWinner.name} has won the endurance competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceLosers[0].name} and ${enduranceLosers[1].name} compete in the skill competition.`}</Centered>\n                <Portraits houseguests={enduranceLosers} centered={true} />\n                <Portrait houseguest={skillWinner} centered={true} />\n                <CenteredBold>{`${skillWinner.name} has won the skill competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceWinner.name} and ${skillWinner.name} compete in the quiz competition.`}</Centered>\n                <Portraits houseguests={[enduranceWinner, skillWinner]} centered={true} />\n                <Portrait houseguest={finalHoH} centered={true} />\n                <CenteredBold>{`Congratulations ${finalHoH.name}, you are the final Head of Household!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, finalHoH];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { HoHVote, NomineeVote } from \"../../../model/logging/voteType\";\nimport { evictHouseguest } from \"../utilities/evictHouseguest\";\n\nexport function finalEvictionScene(initialGameState: GameState, HoH: Houseguest): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const nominees = nonEvictedHouseguests(newGameState).filter((hg) => hg.id !== HoH.id);\n    newGameState.currentLog.nominationsPostVeto = nominees.map((hg) => hg.name);\n    const { decision: vote, reason } = castEvictionVote(HoH, nominees, newGameState);\n    const evictee = nominees[vote];\n    const survivor = nominees[vote == 1 ? 0 : 1];\n    newGameState.currentLog.soleVoter = HoH.name;\n    newGameState.currentLog.votes[survivor.id] = new NomineeVote(false);\n    newGameState.currentLog.votes[HoH.id] = new HoHVote(evictee.id);\n    newGameState.currentLog.votesInMajority = 1;\n    newGameState.currentLog.outOf = 1;\n    const hoh: ProfileHouseguest = { ...HoH };\n    hoh.tooltip = reason;\n    evictHouseguest(newGameState, evictee.id);\n    const scene: Scene = new Scene({\n        title: \"Final Eviction\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    {`As the final HoH of the season, ${HoH.name}, you may now cast the sole vote to evict.`}\n                </Centered>\n                <Portrait houseguest={hoh} centered={true} />\n                <CenteredBold>{`I vote to evict ${evictee.name}.`}</CenteredBold>\n                <Portraits houseguests={nominees} centered={true} />\n                <Centered>\n                    It's official... {evictee.name}, you will be the final person leaving the Big Brother\n                    House.\n                </Centered>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene];\n}\n","import { Episode, EpisodeType } from \"./episodes\";\nimport { Scene } from \"./scenes/scene\";\nimport { GameState } from \"../../model\";\nimport { generateVotingTable } from \"../votingTable/votingTable\";\nimport { evictHouseguest } from \"./utilities/evictHouseguest\";\n\nexport const GameOver: EpisodeType = {\n    canPlayWith: (_: number) => true,\n    eliminates: 1,\n    arrowsEnabled: false,\n    hasViewsbar: false,\n    description: \"\",\n    emoji: \"\",\n    name: \"Game Over\",\n    generate: generateGameOver,\n};\n\nexport function generateGameOver(gameState: GameState): Episode {\n    const title = \"Game Over\";\n    const scenes: Scene[] = [];\n    const content = generateVotingTable(gameState);\n    gameState.houseguests.forEach((hg) => {\n        evictHouseguest(gameState, hg.id);\n    });\n    return new Episode({ gameState, content, title, scenes, type: GameOver });\n}\n","import { Subscription } from \"rxjs\";\nimport { Sidebar } from \"./sidebar\";\nimport { EpisodeLibrary, Season } from \"../../model/season\";\nimport { Episode, nonEvictedHouseguests, getById } from \"../../model\";\nimport { Scene } from \"../episode/scenes/scene\";\nimport {\n    mainContentStream$,\n    episodes$,\n    switchEpisode$,\n    newEpisode,\n    switchSceneRelative,\n    getSelectedPlayer,\n    selectedPlayer$,\n    displayMode$,\n    season$,\n    pushToMainContentStream,\n} from \"../../subjects/subjects\";\nimport { popularityMode } from \"../../model/portraitDisplayMode\";\nimport { activeScreen$, Screens } from \"../topbar/topBar\";\n\ninterface IndexedScene {\n    scene: Scene;\n    index: number;\n}\n\nconst LEFT = 37;\nconst RIGHT = 39;\n\nexport class SidebarController {\n    private view: Sidebar;\n    private subscriptions: Subscription[] = [];\n    private season: Season = new Season();\n    private scenes: IndexedScene[] = [];\n    private selectedEpisode: number = 0;\n\n    public constructor(view: Sidebar) {\n        this.view = view;\n        this.subscriptions.push(\n            activeScreen$.subscribe((screen) => {\n                this.view.setState({ selectionsActive: screen === Screens.Other });\n            })\n        );\n        this.subscriptions.push(\n            episodes$.subscribe({\n                next: (episode) => this.onNewEpisode(episode),\n            })\n        );\n        this.subscriptions.push(\n            switchEpisode$.subscribe({\n                next: (value: number) => {\n                    this.switchSceneRelative(value);\n                },\n            })\n        );\n        this.subscriptions.push(\n            season$.subscribe({\n                next: (library: EpisodeLibrary) => {\n                    this.season = new Season(library);\n                    this.selectedEpisode = 0;\n                    displayMode$.next(popularityMode);\n                },\n            })\n        );\n    }\n\n    public getSelectedEpisode() {\n        return this.selectedEpisode;\n    }\n\n    public async switchToScene(id: number) {\n        pushToMainContentStream(this.scenes[id].scene.render, Screens.Other);\n        this.selectedEpisode = this.scenes[id].index;\n        await this.view.setState({ selectedScene: id });\n        if (getSelectedPlayer() !== null) {\n            selectedPlayer$.next(\n                getById(this.scenes[this.view.state.selectedScene].scene.gameState, getSelectedPlayer()!.id)\n            );\n        }\n    }\n\n    private switchSceneRelative = (delta: number) => {\n        const selectedScene = this.view.state.selectedScene;\n        const renderedScenes = this.scenes.length;\n        const targetScene = selectedScene + delta;\n        if (targetScene < 0) {\n            return;\n        }\n        const lastEpisode = this.view.state.episodes[this.view.state.episodes.length - 1];\n        if (targetScene < renderedScenes) {\n            // Go back to an earlier scene\n            this.switchToScene(targetScene);\n        } else if (targetScene === renderedScenes) {\n            // Generate a new scene, then jump to it\n            const currentGameState = lastEpisode.gameState;\n            const newPlayerCount = nonEvictedHouseguests(lastEpisode.gameState).length;\n            if (newPlayerCount > 0) {\n                newEpisode(this.season.renderEpisode(currentGameState));\n                this.switchSceneRelative(1);\n            }\n        }\n    };\n\n    get handleKeyDown(): (e: any) => void {\n        return this._handleKeyDown.bind(this);\n    }\n\n    private _handleKeyDown(event: any) {\n        const state = this.view.state;\n        if (\n            state.episodes[this.selectedEpisode] === undefined ||\n            !state.episodes[this.selectedEpisode].type.arrowsEnabled ||\n            activeScreen$.value !== Screens.Other\n        ) {\n            return;\n        }\n        if (event.keyCode === LEFT) {\n            switchSceneRelative(-1);\n        } else if (event.keyCode === RIGHT) {\n            switchSceneRelative(1);\n        }\n    }\n\n    private onNewEpisode(episode: Episode | null) {\n        if (!episode) {\n            this.view.setState({ episodes: [], selectedScene: 0 });\n            this.scenes = [];\n        } else {\n            const newState = { ...this.view.state };\n            // starts at -1: prevent OBOE\n            const latestIndex = this.scenes.length === 0 ? -1 : this.scenes[this.scenes.length - 1].index;\n            const index = latestIndex + 1;\n            this.scenes.push({ scene: episode, index });\n            episode.scenes.forEach((scene) => this.scenes.push({ scene, index }));\n            newState.episodes.push(episode);\n            this.view.setState(newState);\n        }\n    }\n\n    public destroy() {\n        this.subscriptions.forEach((sub) => sub.unsubscribe());\n    }\n}\n","import React from \"react\";\nimport { SidebarController } from \"./sidebarController\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { defaultJurySize, Episode, GameState, PlayerProfile } from \"../../model\";\nimport { Scene } from \"../episode/scenes/scene\";\nimport { cast$, newEpisode, pushToMainContentStream } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\nimport { HasText } from \"../layout/text\";\nimport { shuffle } from \"lodash\";\nimport { activeScreen$, Screens } from \"../topbar/topBar\";\nimport { baseUrl } from \"../deckScreen/deckScreen\";\ninterface SidebarState {\n    episodes: Episode[];\n    selectedScene: number;\n    selectionsActive: boolean;\n}\n\nlet firstLoad = true;\n\nexport class Sidebar extends React.Component<{}, SidebarState> {\n    private controller: SidebarController;\n    public constructor(props: {}) {\n        super(props);\n        this.controller = new SidebarController(this);\n        this.state = { episodes: [], selectedScene: 0, selectionsActive: true };\n    }\n    public async componentDidMount() {\n        document.addEventListener(\"keydown\", this.controller.handleKeyDown);\n        if (!firstLoad) {\n            firstLoad = false;\n            return;\n        }\n        let data = await (await fetch(`${baseUrl}/bb.json`)).json();\n        const allBBs: PlayerProfile[] = [];\n        data = shuffle(data).slice(0, 16);\n        for (const player of data) {\n            let name = player.substr(0, player.lastIndexOf(\".\")) || player;\n            name = name.substr(name.indexOf(\"/\") + 1) || name;\n            allBBs.push({\n                name,\n                imageURL: `${baseUrl}/Big Brother ${player}.png`,\n            });\n        }\n\n        const episode: Episode = new PregameEpisode(\n            new GameState({ players: allBBs, jury: defaultJurySize(allBBs.length) })\n        );\n        newEpisode(episode);\n        cast$.next(allBBs);\n        if (activeScreen$.value === Screens.Other) {\n            pushToMainContentStream(episode.render, Screens.Other);\n        }\n    }\n\n    public componentWillUnmount() {\n        this.controller.destroy();\n    }\n\n    public render() {\n        return (\n            <Box style={{ minWidth: 180, maxWidth: 250 }}>\n                <HasText>{this.getEpisodes()}</HasText>\n            </Box>\n        );\n    }\n\n    private getHighlight(title: string, key: number) {\n        if (key === this.state.selectedScene && this.state.selectionsActive) {\n            return <mark>{title}</mark>;\n        }\n        return title;\n    }\n\n    private getEpisodes() {\n        const result: JSX.Element[] = [];\n        // Weird OBOE to make keys start at 0\n        let episodeKey = -1;\n        let breakKey = 0;\n        this.state.episodes.forEach((episode: Episode) => {\n            const id = ++episodeKey;\n            result.push(\n                <b\n                    key={id}\n                    onClick={() => {\n                        this.controller.switchToScene(id);\n                    }}\n                >\n                    {this.getHighlight(episode.title, id)}\n                </b>\n            );\n            result.push(<br key={--breakKey} />);\n            episode.scenes.forEach((scene: Scene) => {\n                const id = ++episodeKey;\n                if (this.controller.getSelectedEpisode() === episode.gameState.phase) {\n                    result.push(\n                        <a key={id} onClick={() => this.controller.switchToScene(id)}>\n                            {this.getHighlight(scene.title, id)}\n                        </a>\n                    );\n                    result.push(<br key={--breakKey} />);\n                }\n            });\n        });\n        return result;\n    }\n}\n","import styled from \"styled-components\";\nimport React from \"react\";\nimport { mainContentStream$ } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\n\nconst MainContentAreaWrapper = styled(Box)`\n    overflow-x: auto;\n`;\n\nexport class MainContentArea extends React.Component<{}, { content: any }> {\n    // a simple class that displays whatever it gets fed through the main content stream.\n\n    private contentStream: any;\n\n    public constructor(props: any) {\n        super(props);\n        this.state = { content: null };\n    }\n\n    public componentDidMount() {\n        this.contentStream = mainContentStream$.subscribe((content) => {\n            this.setState({ content });\n        });\n    }\n\n    public componentDidUpdate(prevProps: never, prevState: any) {\n        if (prevState.content !== this.state.content) {\n            window.scrollTo(0, 0);\n        }\n    }\n\n    public componentWillUnmount() {\n        this.contentStream.unsubscribe();\n    }\n\n    public render() {\n        return <MainContentAreaWrapper>{this.state.content}</MainContentAreaWrapper>;\n    }\n}\n","import \"./bulma.scss\";\nimport React from \"react\";\nimport { Sidebar } from \"../sidebar/sidebar\";\nimport { Topbar } from \"../topbar/topBar\";\nimport { MainContentArea } from \"./mainContentArea\";\nimport { MainPageController } from \"./mainPageController\";\n\ninterface MainPageProps {\n    controller: MainPageController;\n}\n\ninterface MainPageState {\n    fullscreen: boolean;\n}\n\nexport class MainPage extends React.Component<MainPageProps, MainPageState> {\n    public constructor(props: MainPageProps) {\n        super(props);\n        this.state = { fullscreen: false };\n        props.controller.inject(this);\n    }\n    public componentDidMount() {\n        this.props.controller.subscribe();\n    }\n    public componentWillUnmount() {\n        this.props.controller.unsubscribe();\n    }\n\n    public render() {\n        const fullscreen = this.state.fullscreen;\n        const hideOnFullscreen = { display: fullscreen ? \"none\" : \"\" };\n        const wrapperStyle = fullscreen\n            ? { margin: \"auto\" }\n            : { margin: \"auto\", maxWidth: 1480, overflow: \"hidden\" };\n        return (\n            <div style={wrapperStyle}>\n                <Topbar style={hideOnFullscreen} />\n                <div className=\"columns\">\n                    <div className=\"column is-narrow\" style={hideOnFullscreen}>\n                        <Sidebar />\n                    </div>\n\n                    <div className=\"column\" style={{ overflowX: \"hidden\" }}>\n                        <MainContentArea />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","import { MainPage } from \"./mainPage\";\nimport { Subscription } from \"rxjs\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\n\nexport class MainPageController {\n    private view: MainPage = new MainPage({ controller: this });\n    private subscriptions: Subscription[] = [];\n    public inject(page: MainPage) {\n        this.view = page;\n    }\n\n    public subscribe(): void {\n        this.unsubscribe();\n        this.subscriptions.push(\n            isFullscreen$.subscribe((fullscreen: boolean) => {\n                this.view.setState({ fullscreen });\n            })\n        );\n    }\n\n    public unsubscribe(): void {\n        this.subscriptions.forEach(sub => sub.unsubscribe());\n    }\n}\n","export interface ColorTheme {\n    name: string;\n    bg: string;\n    text: string;\n    toggleBorder: string;\n    bodyArea: string;\n    link: string;\n    mark: string;\n    overlay: string;\n    evictedCell: string;\n    grayCell: string;\n    winnerCell: string;\n    lightGrayCell: string;\n    runnerUpCell: string;\n    saveCell: string;\n    nomineeCell: string;\n    hohCell: string;\n    portraitBorder: string;\n    tableCellBorder: string;\n}\n\n// export const lightTheme: ColorTheme = {\n//     name: \"light\",\n//     bg: \"#fff\",\n//     text: \"#363537\",\n//     toggleBorder: \"#FFF\",\n//     bodyArea: \"#fff\",\n//     link: \"blue\",\n//     mark: \"yellow\",\n//     overlay: \"fff\",\n//     evictedCell: \"#fa8072\",\n//     grayCell: \"#eaecf0\",\n//     lightGrayCell: \"#f8f9fa\",\n//     winnerCell: \"#73fb76\",\n//     runnerUpCell: \"#d1e8ef\",\n//     nomineeCell: \"#959ffd\",\n//     hohCell: \"#CCFFCC\",\n//     portraitBorder: \"gray\",\n//     tableCellBorder: \"#a2a9b1\",\n// };\n\nexport const darkTheme: ColorTheme = {\n    name: \"dark\",\n    bg: \"#121212\",\n    saveCell: \"#334d5e\",\n    text: \"#FAFAFA\",\n    bodyArea: \"#363537\",\n    toggleBorder: \"#6B8096\",\n    link: \"lightblue\",\n    mark: \"#7e006d\",\n    overlay: \"#444346\",\n    evictedCell: \"#9d4c43\",\n    grayCell: \"#5e5e5e\",\n    lightGrayCell: \"#404040\",\n    runnerUpCell: \"#9fbec882\",\n    nomineeCell: \"#6c75d0\",\n    winnerCell: \"#00ac04\",\n    hohCell: \"#3f783f\",\n    portraitBorder: \"#484848\",\n    tableCellBorder: \"#53575b\",\n};\n","import { createGlobalStyle } from \"styled-components\";\nimport { ColorTheme } from \"./theme\";\n\nexport const GlobalStyles = createGlobalStyle`\n  *,\n  *::after,\n  *::before {\n    box-sizing: border-box;\n  }\n\n  body {\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bg};\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n  }`;\n","import React from \"react\";\nimport { MainPage } from \"./components/mainPage/mainPage\";\nimport { MainPageController } from \"./components/mainPage/mainPageController\";\nimport { ThemeProvider } from \"styled-components\";\nimport { ColorTheme, darkTheme } from \"./theme/theme\";\nimport { GlobalStyles } from \"./theme/globalTheme\";\nimport { theme$ } from \"./subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nclass App extends React.Component<{}, { theme: ColorTheme }> {\n    private sub: Subscription | null = null;\n    public constructor(props: any) {\n        super(props);\n        this.state = {\n            theme: darkTheme,\n        };\n    }\n\n    public componentDidMount() {\n        this.sub = theme$.subscribe((theme) => {\n            this.setState({ theme });\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    render() {\n        return (\n            <ThemeProvider theme={this.state.theme}>\n                <>\n                    <GlobalStyles />\n                    <MainPage controller={new MainPageController()} />\n                </>\n            </ThemeProvider>\n        );\n    }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}