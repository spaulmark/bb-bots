{"version":3,"sources":["model/playerProfile.ts","model/powerRanking.ts","model/houseguest.ts","utils/utilities.ts","utils/relationshipMap.ts","components/playerPortrait/selectedPortrait.ts","model/color.ts","components/playerPortrait/houseguestPortraitController.ts","components/playerPortrait/houseguestPortrait.tsx","components/playerPortrait/houseguestToPortrait.tsx","components/tooltip/tooltip.tsx","components/playerPortrait/portraits.tsx","components/memoryWall/memoryWall.tsx","components/nextEpisodeButton/nextEpisodeButton.tsx","utils/ai/classifyRelationship.ts","components/playerPortrait/setupPortrait.tsx","components/castingScreen/importLinks.tsx","components/playerPortrait/subtitle.tsx","model/portraitDisplayMode.ts","components/viewsBar/viewBarTag.tsx","components/viewsBar/viewBar.tsx","components/episode/episodes.tsx","components/episode/pregameEpisode.tsx","components/castingScreen/randomXButton.tsx","components/castingScreen/castingScreen.tsx","subjects/subjects.tsx","components/topbar/topBar.tsx","components/pregameScreen/pregameScreen.tsx","utils/BbRandomGenerator.ts","model/gameState.ts","model/season.ts","components/episode/scene.tsx","components/layout/centered.tsx","utils/ai/aiUtils.ts","utils/ai/aiApi.ts","components/mainPage/fullscreenButton.tsx","components/episode/scenes/votingTable.tsx","model/logging/voteType.tsx","components/layout/box.tsx","components/episode/scenes/juryVoteScene.tsx","components/episode/bigBrotherFinale.tsx","components/episode/scenes/finalHohCompScene.tsx","components/episode/scenes/finalEvictionScene.tsx","components/episode/gameOver.tsx","model/logging/episodelog.ts","components/episode/episodeFactory.ts","components/episode/bigBrotherEpisode.tsx","components/episode/scenes/hohCompScene.tsx","components/episode/scenes/nomCeremonyScene.tsx","components/episode/scenes/vetoCompScene.tsx","components/episode/scenes/vetoCeremonyScene.tsx","components/episode/scenes/evictionScene.tsx","components/sidebar/sidebarController.ts","components/sidebar/sidebar.tsx","components/mainPage/mainContentArea.tsx","components/mainPage/mainPage.tsx","components/mainPage/mainPageController.ts","App.tsx","serviceWorker.ts","index.tsx"],"names":["PlayerProfile","init","Object","classCallCheck","this","name","imageURL","assign","PowerRanking","beats","outOf","Error","createClass","key","get","Houseguest","_PlayerProfile","_this","possibleConstructorReturn","getPrototypeOf","call","isEvicted","isJury","id","nominations","hohWins","povWins","popularity","deltaPopularity","relationships","powerRanking","superiors","Set","getFriendEnemyCount","friends","enemies","assertThisInitialized","inherits","value","villain","roundTwoDigits","number","Math","round","newRelationshipMap","size","exclude","result","i","selectPlayer","player","getSelectedPlayer","selectedPlayer$","next","componentToHex","c","hex","toString","length","Rgb","r","g","b","concat","interpolateColor","min","max","percent","toHex","selectedColor","HouseguestPortraitController","view","subs","refreshData","data","props","setState","comparePowerRankings","defaultState","selectedPlayer","undefined","state","displayMode","backgroundColor","_this2","push","subscribe","displayMode$","forEach","sub","unsubscribe","has","HouseguestPortrait","_React$Component","controller","isNullOrUndefined","subtitle","imageClass","getImageClass","generateSubtitle","detailed","className","react_default","a","createElement","onClick","style","src","width","height","React","Component","houseguestToPortrait","houseguest","houseguestPortrait_HouseguestPortrait","Text","styled","p","_templateObject","Tooltip","visible","Popover_default","position","isOpen","content","text","onMouseEnter","onMouseLeave","children","PortraitWrapper","centered","Portrait","tooltip","tooltip_Tooltip","Portraits","rows","houseguests","memoryWallPortrait","MemoryWall","margin","maxWidth","NextEpisodeButton","switchSceneRelative","RelationshipType","SetupPortrait","textAlign","onDoubleClick","onDelete","imageUrl","contentEditable","onChange","spellCheck","ImportLinks","lines","split","profiles","line","temp","pop","replace","substr","indexOf","onSubmit","event","target","RelationshipTypeToSymbol","FRIEND","ENEMY","PAWN","QUEEN","classifyRelationship","heroPopularity","villainPopularity","relationship","benefitsHero","benefitsVillain","Friend","Pawn","Queen","Enemy","addPopularityLine","hero","popularitySubtitle","deltaPop","statePopularity","getDeltaPopularity","addCompsLine","compWins","lineHeight","popularityMinColor","popularityMaxColor","popularityMode","minColor","maxColor","extremePopularity","x","xSquared","extremeValues","_addFriendshipCountTi","titles","friendOrEnemyTitle","map","txt","count","Relationship","friendEnemyCountTitle","addFriendshipCountTitles","arguments","powerMaxColor","powerMinColor","powerMode","toFloat","_","ViewBarTag","selected","mode","_this3","disabled","background","toRgba","cursor","ViewsBar","apply","viewBarTag_ViewBarTag","Episode","scenes","title","gameState","type","arrowsEnabled","viewsBar","hasViewsbar","viewBar_ViewsBar","PregameEpisodeType","eliminates","canPlayWith","n","PregameEpisode","_Episode","PregameScreen","cast","RandomButton","_useState","useState","_useState2","slicedToArray","setNumber","random","parseInt","NumericInput","marginLeft","test","CastingScreen","appendProfiles","newState","objectSpread","profile","players","submit","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","newCast","cast$","mainContentStream$","newEpisode","GameState","stop","amount","shuffle","slice","handleUpload","handleFiles","files","handleDrop","newName","splice","_this4","setupPortrait_SetupPortrait","deleteMethod","handleChange","_this5","FileDrop","onDrop","importLinks_ImportLinks","multiple","getFiles","file","match","lastIndexOf","URL","createObjectURL","TopbarLink","div","topBar_templateObject","EditCastLink","castingScreen_CastingScreen","getCast","EditSeasonLink","Topbar","marginTop","BehaviorSubject","episodes$","switchEpisode$","Subject","episode","isFullscreen$","BbRandomGenerator","seed","rng","prand","xorshift128plus","_this$rng$next","_this$rng$next2","_prand$uniformIntDist","uniformIntDistribution","_prand$uniformIntDist2","_this$rng$next3","_this$rng$next4","rng$","castNames","string","hash","charCodeAt","hashcode","getById","find","hg","inclusions","exclusions","excludedIds","filter","includes","randomPlayer","options","randomInt","nonEvictedHouseguests","getJurors","inJury","remainingPlayers","finalJurySize","phase","previousHOH","log","Array","MutableGameState","copy","cloneDeep","Scene","render","Centered","noMargin","CenteredBold","CenteredItallic","favouriteIndex","callback","highestIndex","highestScore","Infinity","currentScore","lowestScore","lowestIndex","doesHeroWinTheFinale","hgs","jury","heroVotes","villainVotes","juror","heroShouldTargetSuperiors","totalPlayers","castEvictionVote","nominees","nom0","nom1","zeroIsInferior","oneIsInferior","cutthroatVote","nonVote","decision","reason","nonTarget","excuse","targetIsFriend","nonTargetIsNonFriend","nonTargetIsFriend","targetIsNonFriend","cutthroatVoteJury","r0","r1","vote","nominateNPlayers","hitlist","hitList","trueOptions","useGoldenVetoPreJury","save","rel0","relationshipWith","rel1","FullscreenIcon","img","fullscreenButton_templateObject","FullscreenButton","getValue","EndgameTableCell","td","votingTable_templateObject","EndgameTable","table","_templateObject2","Gray","_templateObject3","White","_templateObject4","Evicted","_templateObject5","WinnerCell","_templateObject6","RunnerUpCell","_templateObject7","BlackRow","tr","_templateObject8","generateVotingTable","masterLog","houseguestCells","evictionOrder","topRowCells","preVetoCells","vetoCells","postVetoCells","evictedCells","winnerCells","cells","colSpan","generateTopRow","nominationsPreVeto","rowSpan","generatePreVetoRow","vetoWinner","generateVetoRow","nominationsPostVeto","generatePostVetoRow","voteTextLine1","soleVoter","votesInMajority","evicted","generateEvictedRow","runnerUp","winner","_arr","entries","votes","_i","_ref3","_ref2","WinnerVote","RunnerUpVote","winnerRow","topRow","preVetoRow","vetoRow","postVetoRow","blackRow","houseguestRows","evictedRow","evictionColSpan","weeks","reverse","weekText","tempList","voteKey","getKey","NormalVote","NomineeVote","HoHVote","hohText","hohVote","ShadowBox","box_templateObject","DividerBox","juryVoteScene","initialGameState","newGameState","jurors","finalists","castJuryVote","currentLog","votesFor0","votesFor1","voteCountText","scene","BigBrotherFinale","generateBbFinale","currentGameState","hohCompScene","finalHoH","finalEviction","_finalHohCompScene","final3","enduranceWinner","enduranceLosers","skillWinner","finalHohCompScene","_finalHohCompScene2","_finalEvictionScene","HoH","_castEvictionVote","evictee","survivor","hoh","evictHouseguest","finalEvictionScene","_finalEvictionScene2","_juryVoteScene","_juryVoteScene2","juryScene","BigBrotherFinaleEpisode","GameOver","GameOverEpisode","EpisodeLog","EpisodeFactory","episodeType","iMap","j","jMap","impression","randomFloat","firstImpressions","heroWinsTheFinale","add","populateSuperiors","house","sum","targetId","calculatePopularity","updatePopularity","rel","updateFriendCounts","finalState","BigBrotherVanilla","nomCeremonyScene","_generateHohCompScene","previousHoh","newHoH","generateHohCompScene","_generateHohCompScene2","vetoCompScene","povWinner","_generateNomCeremonyS","nom2","noms","generateNomCeremonyScene","_generateNomCeremonyS2","vetoCeremonyScene","_generateVetoCompScen","choices","povPlayers","everyoneWillPlay","introText","extras","generateVetoCompScene","_generateVetoCompScen2","evictionScene","_generateVetoCeremony","initialNominees","povTarget","descisionText","vetoChoice","useGoldenVeto","replacementSpeech","nameAReplacement","finalNominees","toConsumableArray","replacementNom","replacementIndex","findIndex","generateVetoCeremonyScene","_generateVetoCeremony2","_generateEvictionScen","lastVoter","logic","tieVote","tieBreaker","displayHoH","generateEvictionScene","_generateEvictionScen2","BigBrotherVanillaEpisode","generateBbVanilla","generateGameOver","delete","Season","factory","nextEpisode","SidebarController","subscriptions","season","selectedEpisode","delta","selectedScene","renderedScenes","targetScene","lastEpisode","episodes","switchToScene","newPlayerCount","nextEpisodeType","whichEpisodeType","renderEpisode","onNewEpisode","_switchToScene","index","_x","keyCode","_handleKeyDown","bind","Sidebar","document","addEventListener","handleKeyDown","destroy","minWidth","getEpisodes","episodeKey","breakKey","getHighlight","getSelectedEpisode","MainContentAreaWrapper","mainContentArea_templateObject","MainContentArea","contentStream","prevProps","prevState","window","scrollTo","MainPage","fullscreen","inject","hideOnFullscreen","display","wrapperStyle","overflow","sidebar_Sidebar","overflowX","mainContentArea_MainContentArea","MainPageController","page","App","mainPage_MainPage","Boolean","location","hostname","ReactDOM","src_App","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.d7e14d2d.chunk.js","sourcesContent":["export class PlayerProfile {\n    readonly name: string = \"\";\n    readonly imageURL: string = \"\";\n    constructor(init: PlayerProfile) {\n        if (!init) {\n            return;\n        }\n        Object.assign(this, init);\n    }\n}\n","export class PowerRanking {\n    readonly beats: number;\n    readonly outOf: number;\n    get toFloat(): number {\n        return this.beats / this.outOf;\n    }\n\n    constructor(beats: number, outOf: number) {\n        if (outOf === 0) throw new Error(\"Power ranking attempted to divide by zero\");\n        this.beats = beats;\n        this.outOf = outOf;\n    }\n}\n","import { PlayerProfile } from \"./playerProfile\";\nimport { RelationshipMap } from \"../utils\";\nimport { PowerRanking } from \"./powerRanking\";\n\ninterface HouseguestInit extends PlayerProfile {\n    id: number;\n    relationships: RelationshipMap;\n}\n\nexport class Houseguest extends PlayerProfile {\n    public isEvicted: boolean = false;\n    public isJury: boolean = false;\n\n    readonly id: number = 0;\n\n    public nominations: number = 0;\n    public hohWins: number = 0;\n    public povWins: number = 0;\n\n    // Popularity ranges from -1 to 1\n    public popularity: number = 0;\n    public deltaPopularity: number = 0;\n    readonly relationships: RelationshipMap = {};\n\n    // power rankings range from 0 to 1\n    public powerRanking: PowerRanking = new PowerRanking(0, 1);\n    readonly superiors: Set<number> = new Set<number>();\n\n    public relationshipWith(villain: Houseguest): number {\n        return this.relationships[villain.id];\n    }\n\n    public getFriendEnemyCount: () => { friends: number; enemies: number } = () => {\n        return { friends: 0, enemies: 0 };\n    };\n\n    constructor(init: HouseguestInit) {\n        super(init);\n        Object.assign(this, init);\n    }\n}\n","// spits out the next episode given a gamestate, in addition to the new gamestate.\n// allows for re-use, because you can give it the initial gamestate, and then just keep asking for the next season.\nexport function hashcode(string: string): number {\n    var hash = 0,\n        i,\n        chr;\n    if (string.length === 0) return hash;\n    for (i = 0; i < string.length; i++) {\n        chr = string.charCodeAt(i);\n        hash = (hash << 5) - hash + chr;\n        hash |= 0;\n    }\n    return hash;\n}\n\nexport function roundTwoDigits(number: number | undefined) {\n    if (!number) {\n        return 0;\n    }\n    return Math.round(number * 100);\n}\n\nexport function max(a: number, b: number) {\n    return a > b ? a : b;\n}\n\nexport function extremeValues(x: number | undefined): number {\n    if (!x) {\n        return 0;\n    }\n    const xSquared = x * x;\n    if (x >= 0) {\n        return -xSquared + 2 * x;\n    } else {\n        return xSquared + 2 * x;\n    }\n}\n","export interface RelationshipMap {\n    [id: number]: number;\n}\n\nexport function newRelationshipMap(size: number, exclude: number): RelationshipMap {\n    const result: RelationshipMap = {};\n    for (let i = 0; i < size; i++) {\n        if (i !== exclude) result[i] = 0;\n    }\n    return result;\n}\n","import { Houseguest } from \"../../model\";\nimport { RelationshipMap } from \"../../utils\";\nimport { getSelectedPlayer, selectedPlayer$ } from \"../../subjects/subjects\";\n\nexport interface SelectedPlayerData {\n    id: number;\n    popularity: number;\n    relationships: RelationshipMap;\n    isEvicted: boolean;\n    superiors?: Set<number>;\n}\n\nexport function selectPlayer(player: SelectedPlayerData | null) {\n    if (!player || (getSelectedPlayer() && (getSelectedPlayer() as Houseguest).id === player.id)) {\n        selectedPlayer$.next(null);\n    } else {\n        selectedPlayer$.next(player);\n    }\n}\n","function componentToHex(c: any) {\n    var hex = Math.round(c).toString(16);\n    return hex.length == 1 ? \"0\" + hex : hex;\n}\n\nexport class Rgb {\n    public r: number;\n    public g: number;\n    public b: number;\n    public toHex() {\n        return \"#\" + componentToHex(this.r) + componentToHex(this.g) + componentToHex(this.b);\n    }\n    public toRgba(): string {\n        return `rgba(${this.r}, ${this.g}, ${this.b}, 1)`;\n    }\n    constructor(r: number, g: number, b: number) {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n    }\n}\n\nexport function interpolateColor(min: Rgb, max: Rgb, percent: number): string {\n    return new Rgb(\n        min.r + percent * (max.r - min.r),\n        min.g + percent * (max.g - min.g),\n        min.b + percent * (max.b - min.b)\n    ).toHex();\n}\n","import { PortraitProps, HouseguestPortrait, PortraitState } from \"../memoryWall\";\nimport { Subscription } from \"rxjs\";\nimport { selectedPlayer$, displayMode$, getSelectedPlayer } from \"../../subjects/subjects\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport { Rgb } from \"../../model/color\";\nimport { PowerRanking } from \"../../model/powerRanking\";\n\nconst selectedColor = new Rgb(51, 255, 249);\n\nexport class HouseguestPortraitController {\n    private subs: Subscription[] = [];\n    private view: HouseguestPortrait;\n    constructor(view: HouseguestPortrait) {\n        this.view = view;\n    }\n\n    get defaultState() {\n        return {\n            popularity: this.view.props.popularity,\n            displayMode: displayMode$.value,\n            powerRanking: this.view.props.powerRanking\n        };\n    }\n\n    public backgroundColor(props: PortraitProps): undefined | string {\n        const selectedPlayer = getSelectedPlayer();\n        if (selectedPlayer !== null && selectedPlayer.id === props.id) {\n            return selectedColor.toHex();\n        }\n        return props.isEvicted ? undefined : this.view.state.displayMode.backgroundColor(this.view.state);\n    }\n\n    public subscribe() {\n        const subs: Subscription[] = [];\n        subs.push(\n            selectedPlayer$.subscribe({\n                next: this.refreshData\n            })\n        );\n        subs.push(\n            displayMode$.subscribe({\n                next: displayMode => this.view.setState({ displayMode })\n            })\n        );\n        this.subs = subs;\n    }\n\n    public unsubscribe() {\n        this.subs.forEach(sub => sub.unsubscribe());\n    }\n\n    private comparePowerRankings(data: SelectedPlayerData): PowerRanking {\n        // 0 is blue. 1 is orange\n        if (!data.superiors) return new PowerRanking(0, 1);\n        const id = this.view.props.id === undefined ? -1 : this.view.props.id;\n        return data.superiors.has(id) ? new PowerRanking(1, 1) : new PowerRanking(0, 1);\n    }\n\n    private refreshData = (data: SelectedPlayerData | null) => {\n        if (!data) {\n            this.view.setState(this.defaultState);\n        } else {\n            if (data.id !== this.view.props.id) {\n                this.view.setState({\n                    popularity: data.relationships[this.view.props.id!],\n                    powerRanking: this.comparePowerRankings(data)\n                });\n            } else {\n                this.view.setState({ popularity: 2, powerRanking: new PowerRanking(2, 1) });\n            }\n        }\n    };\n}\n","import React from \"react\";\nimport { selectPlayer } from \"./selectedPortrait\";\nimport { isNullOrUndefined } from \"util\";\nimport { RelationshipMap } from \"../../utils\";\nimport _ from \"lodash\";\nimport { HouseguestPortraitController } from \"./houseguestPortraitController\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport { PowerRanking } from \"../../model/powerRanking\";\n\nexport interface PortraitProps {\n    imageURL: string;\n    name: string;\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    powerRanking?: PowerRanking;\n    deltaPopularity?: number;\n    detailed?: boolean;\n    superiors?: Set<number>;\n    getFriendEnemyCount?: () => { friends: number; enemies: number };\n}\n\nexport interface PortraitState {\n    popularity?: number;\n    powerRanking?: PowerRanking;\n    displayMode: PortraitDisplayMode;\n}\nexport class HouseguestPortrait extends React.Component<PortraitProps, PortraitState> {\n    private controller: HouseguestPortraitController;\n\n    public constructor(props: PortraitProps) {\n        super(props);\n        this.controller = new HouseguestPortraitController(this);\n        this.state = this.controller.defaultState;\n    }\n\n    public componentDidMount() {\n        if (isNullOrUndefined(this.props.id)) {\n            return;\n        }\n        this.controller.subscribe();\n    }\n\n    public componentWillUnmount() {\n        this.controller.unsubscribe();\n    }\n\n    private onClick(): void {\n        if (isNullOrUndefined(this.props.id) || !this.props.relationships) {\n            return;\n        }\n        const data = {\n            id: this.props.id,\n            relationships: this.props.relationships,\n            isEvicted: !!this.props.isEvicted,\n            popularity: this.props.popularity || 0,\n            superiors: this.props.superiors\n        };\n        selectPlayer(data);\n    }\n\n    public render() {\n        const props = this.props;\n        const imageClass = getImageClass(props);\n        let subtitle: any[] = [];\n        subtitle = this.state.displayMode.generateSubtitle(this.props, this.state, !!props.detailed);\n\n        let className = \"\";\n        if (props.isJury) {\n            className = \"jury\";\n        } else if (props.isEvicted) {\n            className = \"evicted\";\n        }\n        return (\n            <div\n                onClick={() => this.onClick()}\n                style={{\n                    backgroundColor: this.controller.backgroundColor(props)\n                }}\n                className={`memory-wall-portrait ${className}`}\n            >\n                <img className={imageClass} src={props.imageURL} style={{ width: 100, height: 100 }} />\n                <br />\n                {props.name}\n                <br />\n                {<small className=\"portrait-history\">{subtitle}</small>}\n            </div>\n        );\n    }\n}\n\nfunction getImageClass(props: PortraitProps) {\n    let imageClass = props.isEvicted ? \"grayscale\" : \"\";\n    imageClass = props.isJury ? \"sepia\" : imageClass;\n    return imageClass;\n}\n","import { ProfileHouseguest, HouseguestPortrait } from \"../memoryWall\";\nimport React from \"react\";\n\nexport function houseguestToPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={false} />;\n}\n\nexport function memoryWallPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={true} />;\n}\n","import React from \"react\";\nimport Popover from \"react-tiny-popover\";\nimport styled from \"styled-components\";\n\nconst Text = styled.p`\n    max-width: 200px;\n    padding: 3px 8px;\n    color: #fff;\n    text-align: center;\n    background-color: #000;\n    border-radius: 4px;\n`;\n\ninterface TooltipProps {\n    text: string;\n    children: any;\n}\n\ninterface ToolTipState {\n    visible: boolean;\n}\n\nexport class Tooltip extends React.Component<TooltipProps, ToolTipState> {\n    constructor(props: TooltipProps) {\n        super(props);\n        this.state = { visible: false };\n    }\n\n    public render() {\n        return (\n            <Popover\n                position={[\"top\", \"bottom\"]}\n                isOpen={this.state.visible}\n                content={<Text>{this.props.text}</Text>}\n            >\n                <div\n                    onMouseEnter={() => this.setState({ visible: true })}\n                    onMouseLeave={() => this.setState({ visible: false })}\n                >\n                    {this.props.children}\n                </div>\n            </Popover>\n        );\n    }\n}\n","import React from \"react\";\nimport { ProfileHouseguest } from \"../memoryWall\";\nimport { houseguestToPortrait, memoryWallPortrait } from \"./houseguestToPortrait\";\nimport { Tooltip } from \"../tooltip/tooltip\";\n\nlet key = -1;\n\nfunction PortraitWrapper(props: { centered?: boolean; children: any }): JSX.Element {\n    return (\n        <div\n            key={key++}\n            className={`columns is-gapless is-mobile is-multiline ${props.centered ? \"is-centered\" : \"\"}`}\n        >\n            {props.children}\n        </div>\n    );\n}\n\nexport function Portrait(props: { houseguest: ProfileHouseguest; centered?: boolean }): JSX.Element {\n    const result = (\n        <PortraitWrapper centered={props.centered}>{houseguestToPortrait(props.houseguest)}</PortraitWrapper>\n    );\n    if (props.houseguest.tooltip) {\n        return (\n            <PortraitWrapper centered={props.centered}>\n                <Tooltip text={props.houseguest.tooltip}>{houseguestToPortrait(props.houseguest)}</Tooltip>\n            </PortraitWrapper>\n        );\n    }\n    return result;\n}\n\nexport function Portraits(props: {\n    houseguests: ProfileHouseguest[];\n    centered?: boolean;\n    detailed?: boolean;\n}): JSX.Element {\n    const rows: JSX.Element[] = [];\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    props.houseguests.forEach((houseguest: ProfileHouseguest) => {\n        let result;\n        if (props.detailed) {\n            result = memoryWallPortrait(houseguest, key++);\n        } else {\n            result = houseguestToPortrait(houseguest, key++);\n        }\n        if (houseguest.tooltip) {\n            result = <Tooltip text={houseguest.tooltip}>{result}</Tooltip>;\n        }\n        rows.push(result);\n    });\n    return (\n        <div className={`columns is-gapless is-mobile is-multiline ${props.centered && \"is-centered\"}`}>\n            {rows}\n        </div>\n    );\n}\n","import React from \"react\";\nimport \"./memoryWall.scss\";\nimport { PlayerProfile } from \"../../model\";\nimport { Portraits } from \"../playerPortrait/portraits\";\nimport { RelationshipMap } from \"../../utils\";\nexport interface IMemoryWallProps {\n    readonly houseguests: ProfileHouseguest[];\n}\n\nexport interface ProfileHouseguest extends PlayerProfile {\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    deltaPopularity?: number;\n    hohWins?: number;\n    povWins?: number;\n    nominations?: number;\n    tooltip?: string;\n    getFriendEnemyCount?: () => { friends: number; enemies: number };\n}\n\nexport function MemoryWall(props: IMemoryWallProps): JSX.Element {\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    return (\n        <div\n            style={{\n                margin: \"auto\",\n                maxWidth: props.houseguests.length < 26 ? 700 : -1\n            }}\n        >\n            <Portraits houseguests={props.houseguests} centered={true} detailed={true} />\n        </div>\n    );\n}\n","import React from \"react\";\nimport { switchSceneRelative } from \"../../subjects/subjects\";\n\nexport function NextEpisodeButton(): JSX.Element {\n    return (\n        <button className=\"button is-primary\" onClick={() => switchSceneRelative(1)}>\n            Continue\n        </button>\n    );\n}\n","export enum RelationshipType {\n    Friend = \"FRIEND\",\n    Queen = \"QUEEN\",\n    Pawn = \"PAWN\",\n    Enemy = \"ENEMY\"\n}\n\nexport const RelationshipTypeToSymbol = { FRIEND: \"\", ENEMY: \"\", PAWN: \"PAWN\", QUEEN: \"QUEEN\" };\n\nexport function classifyRelationship(\n    heroPopularity: number,\n    villainPopularity: number,\n    relationship: number\n): RelationshipType {\n    const benefitsHero = relationship > heroPopularity;\n    const benefitsVillain = relationship > villainPopularity;\n    if (benefitsHero && benefitsVillain) {\n        return RelationshipType.Friend;\n    } else if (benefitsHero && !benefitsVillain) {\n        return RelationshipType.Pawn;\n    } else if (!benefitsHero && benefitsVillain) {\n        return RelationshipType.Queen;\n    }\n    return RelationshipType.Enemy;\n}\n","import React from \"react\";\n\ninterface SetupPortraitProps {\n    name: string;\n    imageUrl: string;\n    onDelete: () => void;\n    onChange: (arg0: Event) => void;\n}\n\ninterface SetupPortraitState {\n    name: string;\n}\n\nexport class SetupPortrait extends React.Component<SetupPortraitProps, SetupPortraitState> {\n    // TODO: When you click on the text, you can edit the text.\n\n    public constructor(props: SetupPortraitProps) {\n        super(props);\n        this.state = { name: props.name };\n    }\n\n    public UNSAFE_componentWillReceiveProps(props: SetupPortraitProps) {\n        this.setState({ name: props.name });\n    }\n\n    public render() {\n        return (\n            <div className={`edit-portrait`}>\n                <div style={{ textAlign: \"center\" }}>\n                    <div className=\"x-button noselect\" onDoubleClick={() => this.props.onDelete()}>\n                        \n                    </div>\n                    <img src={this.props.imageUrl} style={{ width: 100, height: 100 }} />\n                    <br />\n                    <input\n                        className=\"memory-wall-portrait\"\n                        contentEditable={true}\n                        onChange={() => this.props.onChange}\n                        spellCheck={false}\n                        value={this.state.name}\n                    />\n                </div>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\n\ninterface ImportLinksProps {\n    onSubmit: (profiles: PlayerProfile[]) => void;\n    className?: string;\n}\n\nexport class ImportLinks extends React.Component<ImportLinksProps, any> {\n    public constructor(props: ImportLinksProps) {\n        super(props);\n        this.state = { text: \"\" };\n    }\n\n    private onSubmit() {\n        const lines = this.state.text.split(/\\r?\\n/);\n        // ugly, but it works.\n        const profiles: PlayerProfile[] = [];\n        lines.forEach((line: string) => {\n            const temp = line.split(\"/\").pop();\n            let name = temp\n                ? temp\n                      .split(\"#\")[0]\n                      .split(\"?\")[0]\n                      .replace(/\\.[^/.]+$/, \"\")\n                      .replace(/[-_]/g, \" \")\n                : null;\n\n            if (line.substr(0, line.indexOf(\" \"))) {\n                name = line.substr(line.indexOf(\" \") + 1);\n            }\n            if (name) {\n                profiles.push({\n                    name,\n                    imageURL: line\n                });\n            }\n        });\n        this.props.onSubmit(profiles);\n        this.setState({ text: \"\" });\n    }\n\n    public render() {\n        return (\n            <div className={this.props.className}>\n                <textarea\n                    className=\"textarea\"\n                    onChange={event => {\n                        this.setState({ text: event.target.value });\n                    }}\n                    value={this.state.text}\n                />\n                <button onClick={() => this.onSubmit()}>Import links</button>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { roundTwoDigits } from \"../../utils\";\nimport { ProfileHouseguest, PortraitProps, PortraitState } from \"../memoryWall\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport {\n    RelationshipTypeToSymbol,\n    RelationshipType as Relationship,\n    classifyRelationship\n} from \"../../utils/ai/classifyRelationship\";\nimport { getSelectedPlayer } from \"../../subjects/subjects\";\n\nexport function generatePowerSubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    _: boolean | undefined\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    key = addPopularityLine(state, hero, !!_, subtitle, key);\n    key = addCompsLine(hero, subtitle, key);\n    if (!hero.isEvicted && state.powerRanking) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            subtitle.push(<div key={key++}>{`${state.powerRanking!.beats > 0 ? \"LOSE\" : \"WIN\"}`}</div>);\n        } else if (data && data.id === hero.id) {\n            subtitle.push(<div key={key++}>I WOULD</div>);\n        } else {\n            subtitle.push(\n                <div key={key++}>{`WINS ${state.powerRanking.beats}/${state.powerRanking.outOf}`}</div>\n            );\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return subtitle;\n}\n\nexport function generatePopularitySubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    detailed: boolean = false\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    // popularity\n    key = addPopularityLine(state, hero, detailed, subtitle, key);\n    // competition wins\n    key = addCompsLine(hero, subtitle, key);\n    // friendship count / relationship classification titles\n    ({ subtitle, key } = addFriendshipCountTitles(hero, subtitle, key));\n    return subtitle;\n}\n\nfunction addFriendshipCountTitles(hero: PortraitProps, subtitle: any[], key: number) {\n    if (!hero.isEvicted) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            const titles = friendOrEnemyTitle(hero, data);\n            subtitle = subtitle.concat(titles.map(txt => <div key={key++}>{txt}</div>));\n        } else {\n            const titles = friendEnemyCountTitle(hero);\n            subtitle = subtitle.concat(titles.map(txt => <div key={key++}>{txt}</div>));\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return { subtitle, key };\n}\n\nfunction addPopularityLine(\n    state: { popularity?: number },\n    hero: PortraitProps,\n    detailed: boolean,\n    subtitle: any[],\n    key: number\n) {\n    let popularity = state.popularity;\n    if (popularity && (popularity > 1 || popularity < -1)) {\n        popularity = hero.popularity;\n    }\n    if (popularity && !hero.isEvicted) {\n        let popularitySubtitle = `${roundTwoDigits(popularity)}%`;\n        const deltaPop = getDeltaPopularity(hero, popularity);\n        if (detailed && deltaPop !== 0) {\n            const arrow = deltaPop > 0 ? \" | \" : \" | \";\n            popularitySubtitle += `${arrow} ${deltaPop}%`;\n        }\n        subtitle.push(<div key={key++}>{popularitySubtitle}</div>);\n    }\n    return key;\n}\n\nfunction addCompsLine(hero: PortraitProps, subtitle: any[], key: number) {\n    if (compWins(hero)) {\n        subtitle.push(<div key={key++}>{`${compWins(hero)}`}</div>);\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return key;\n}\n\nfunction getDeltaPopularity(houseguest: PortraitProps, statePopularity: number) {\n    if (roundTwoDigits(houseguest.popularity) !== roundTwoDigits(statePopularity)) {\n        return 0;\n    }\n    return houseguest.deltaPopularity ? roundTwoDigits(houseguest.deltaPopularity) : 0;\n}\n\nfunction compWins(houseguest: ProfileHouseguest): string {\n    return `${houseguest.hohWins ? ` ${houseguest.hohWins}` : \"\"}${\n        houseguest.povWins && houseguest.hohWins\n            ? `| ${houseguest.povWins}`\n            : houseguest.povWins\n            ? ` ${houseguest.povWins}`\n            : \"\"\n    }${(houseguest.hohWins || houseguest.povWins) && houseguest.nominations ? \"|\" : \"\"}${\n        houseguest.nominations ? ` ${houseguest.nominations}` : \"\"\n    }`;\n}\n\nfunction friendOrEnemyTitle(hero: PortraitProps, villain: SelectedPlayerData): string[] {\n    const titles: string[] = [];\n    titles.push(\n        RelationshipTypeToSymbol[\n            classifyRelationship(hero.popularity || 0, villain.popularity, hero.relationships![villain.id])\n        ]\n    );\n    return titles;\n}\n\nfunction friendEnemyCountTitle(hero: PortraitProps): string[] {\n    const titles: string[] = [];\n    const count = hero.getFriendEnemyCount ? hero.getFriendEnemyCount() : { friends: 0, enemies: 0 };\n    titles.push(\n        `${count.friends} ${RelationshipTypeToSymbol[Relationship.Friend]} | ${count.enemies} ${\n            RelationshipTypeToSymbol[Relationship.Enemy]\n        }`\n    );\n    return titles;\n}\n","import { Rgb, interpolateColor } from \"./color\";\nimport { PortraitState, PortraitProps } from \"../components/memoryWall\";\nimport { extremeValues } from \"../utils\";\nimport { generatePopularitySubtitle, generatePowerSubtitle } from \"../components/playerPortrait/subtitle\";\n\nexport interface PortraitDisplayMode {\n    minColor: Rgb;\n    maxColor: Rgb;\n    backgroundColor: (state: PortraitState) => string;\n    generateSubtitle: (props: PortraitProps, state: PortraitState, detailed?: boolean) => any[];\n}\n\nconst popularityMinColor = new Rgb(252, 137, 137);\nconst popularityMaxColor = new Rgb(137, 252, 137);\n\nexport const popularityMode: PortraitDisplayMode = {\n    minColor: popularityMinColor,\n    maxColor: popularityMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const popularity = state.popularity;\n\n        const extremePopularity = extremeValues(popularity);\n        const percent = (extremePopularity + 1) / 2;\n        return interpolateColor(popularityMinColor, popularityMaxColor, percent);\n    },\n    generateSubtitle: generatePopularitySubtitle\n};\n\nconst powerMaxColor = new Rgb(255, 204, 94);\nconst powerMinColor = new Rgb(192, 181, 255);\nexport const powerMode: PortraitDisplayMode = {\n    minColor: powerMinColor,\n    maxColor: powerMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const powerRanking = state.powerRanking;\n        if (powerRanking === undefined) return \"\";\n\n        return interpolateColor(powerMinColor, powerMaxColor, powerRanking.toFloat);\n    },\n    generateSubtitle: generatePowerSubtitle\n};\n","import React, { useState } from \"react\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport { displayMode$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nfunction setDisplayMode(p: PortraitDisplayMode) {\n    displayMode$.next(p);\n}\n\ninterface ViewBarTagProps {\n    mode: PortraitDisplayMode;\n    text: string;\n    disabled?: boolean;\n}\n\nexport class ViewBarTag extends React.Component<ViewBarTagProps, { selected: boolean }> {\n    private sub: Subscription | null = null;\n\n    public constructor(props: ViewBarTagProps) {\n        super(props);\n        this.state = { selected: props.mode === displayMode$.value };\n    }\n\n    public componentDidMount() {\n        this.sub = displayMode$.subscribe({\n            next: mode => {\n                if (mode !== this.props.mode) {\n                    this.setState({ selected: false });\n                }\n            }\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    public render() {\n        const name = \"level-item tag is-medium is-light\";\n        const style = getStyle(this.props);\n        return (\n            <span\n                className={name}\n                style={style}\n                onClick={() => {\n                    !this.props.disabled && setDisplayMode(this.props.mode);\n                    !this.props.disabled && this.setState({ selected: true });\n                }}\n            >\n                {styleText(this.props.text, this.state.selected)}\n            </span>\n        );\n    }\n}\n\nfunction styleText(text: string, selected: boolean): JSX.Element {\n    return selected ? <b>{text}</b> : <i>{text}</i>;\n}\n\nfunction getStyle(props: ViewBarTagProps) {\n    return props.disabled\n        ? {}\n        : {\n              background: `linear-gradient(90deg, ${props.mode.minColor.toRgba()} 0%, ${props.mode.maxColor.toRgba()} 100%)`,\n              cursor: \"pointer\"\n          };\n}\n","import React from \"react\";\nimport { popularityMode, powerMode } from \"../../model/portraitDisplayMode\";\nimport { ViewBarTag } from \"./viewBarTag\";\n\nexport class ViewsBar extends React.Component {\n    public render() {\n        return (\n            <div className=\"level box is-mobile\" key=\"viewsbar\">\n                <ViewBarTag mode={popularityMode} text={\"Relationships\"}></ViewBarTag>\n                <ViewBarTag mode={powerMode} text={\"Power Rankings\"}></ViewBarTag>\n                <ViewBarTag mode={powerMode} disabled={true} text={\"Cliques [Coming Soon]\"}></ViewBarTag>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { Scene } from \"./scene\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\n\nexport interface InitEpisode {\n    scenes: Scene[];\n    title: string;\n    content: JSX.Element;\n    gameState: GameState;\n    type: EpisodeType;\n}\n\nexport class Episode {\n    readonly scenes: Scene[];\n    readonly title: string;\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type: EpisodeType;\n    readonly arrowsEnabled: boolean = true;\n    get render(): JSX.Element {\n        const viewsBar = this.type.hasViewsbar ? <ViewsBar /> : null;\n        return (\n            <div>\n                {viewsBar}\n                {this.content}\n            </div>\n        );\n    }\n\n    constructor(init: InitEpisode) {\n        this.scenes = init.scenes;\n        this.title = init.title;\n        this.content = init.content;\n        this.gameState = init.gameState;\n        this.type = init.type;\n    }\n}\n\nexport interface EpisodeType {\n    readonly canPlayWith: (n: number) => boolean;\n    readonly eliminates: number;\n    readonly arrowsEnabled: boolean;\n    readonly hasViewsbar: boolean;\n}\n","import React from \"react\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { GameState } from \"../../model/gameState\";\n\nconst PregameEpisodeType: EpisodeType = {\n    eliminates: 0,\n    canPlayWith: (n: number) => {\n        return n > 2;\n    },\n    arrowsEnabled: true,\n    hasViewsbar: false\n};\n\nexport class PregameEpisode extends Episode {\n    readonly title = \"Pregame\";\n    readonly scenes = [];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = PregameEpisodeType;\n\n    public constructor(gameState: GameState) {\n        super({\n            title: \"Pregame\",\n            scenes: [],\n            content: <PregameScreen cast={gameState.houseguests} />,\n            gameState,\n            type: PregameEpisodeType\n        });\n        this.gameState = gameState;\n        this.content = <PregameScreen cast={gameState.houseguests} />;\n    }\n}\n","import React, { useState } from \"react\";\n\ninterface RandomButtonProps {\n    random: (n: number) => void;\n}\n\nexport function RandomButton(props: RandomButtonProps): JSX.Element {\n    const [number, setNumber] = useState(\"16\");\n    return (\n        <div>\n            <button\n                disabled={number === \"\"}\n                className=\"button is-primary\"\n                onClick={() => props.random(parseInt(number))}\n            >\n                Random\n            </button>\n            <NumericInput value={number} onChange={setNumber} />\n        </div>\n    );\n}\n\ninterface NumericInputProps {\n    value: string;\n    onChange: (newValue: string) => void;\n}\n\nfunction NumericInput(props: NumericInputProps) {\n    return (\n        <input\n            className=\"input\"\n            type=\"text\"\n            style={{ width: \"3em\", marginLeft: 5 }}\n            value={props.value}\n            onChange={event => {\n                const value = event.target.value;\n                if (/^\\d*$/g.test(value)) {\n                    props.onChange(value);\n                }\n            }}\n        />\n    );\n}\n","import React from \"react\";\nimport FileDrop from \"react-file-drop\";\nimport { PlayerProfile, GameState } from \"../../model\";\nimport { SetupPortrait } from \"../playerPortrait/setupPortrait\";\nimport { ImportLinks } from \"./importLinks\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { shuffle } from \"lodash\";\nimport { RandomButton } from \"./randomXButton\";\nimport { selectPlayer } from \"../playerPortrait/selectedPortrait\";\nimport { mainContentStream$, newEpisode, updateCast } from \"../../subjects/subjects\";\n\ninterface CastingScreenState {\n    players: PlayerProfile[];\n}\n\ninterface CastingScreenProps {\n    cast?: PlayerProfile[];\n}\n\nexport class CastingScreen extends React.Component<CastingScreenProps, CastingScreenState> {\n    constructor(props: CastingScreenProps) {\n        super(props);\n        this.state = { players: props.cast || [] };\n    }\n\n    private handleChange(i: number) {\n        return (event: any) => {\n            const newName = event.target.value.replace(/\\r?\\n|\\r/g, \"\");\n            const newState = { ...this.state };\n            newState.players[i] = new PlayerProfile({\n                imageURL: newState.players[i].imageURL,\n                name: newName\n            });\n            this.setState(newState);\n        };\n    }\n\n    private deleteMethod(i: number) {\n        return () => {\n            const newState = { ...this.state };\n            newState.players.splice(i, 1);\n            this.setState(newState);\n        };\n    }\n\n    private getFiles() {\n        const players = this.state.players;\n        if (!players) {\n            return;\n        }\n        const rows: JSX.Element[] = [];\n        let i = 0;\n        players.forEach(player =>\n            rows.push(\n                <SetupPortrait\n                    name={player.name}\n                    imageUrl={player.imageURL}\n                    onDelete={this.deleteMethod(i)}\n                    onChange={this.handleChange(i)}\n                    key={(++i).toString()}\n                />\n            )\n        );\n        return <div className=\"columns is-gapless is-mobile is-multiline is-centered\">{rows}</div>;\n    }\n\n    private appendProfiles = (profiles: PlayerProfile[]) => {\n        const newState = { ...this.state };\n        profiles.forEach(profile => newState.players.push(profile));\n        this.setState(newState);\n    };\n\n    private submit = async () => {\n        updateCast(this.state.players);\n        mainContentStream$.next(<PregameScreen cast={this.state.players} />);\n        selectPlayer(null);\n        await newEpisode(null);\n        await newEpisode(new PregameEpisode(new GameState(this.state.players)));\n    };\n\n    private random = (amount: number) => {\n        let players = this.state.players;\n        players = shuffle(players);\n        players = players.slice(0, amount);\n        this.setState({ players });\n    };\n\n    public render() {\n        return (\n            <FileDrop onDrop={this.handleDrop}>\n                <div className=\"level\">\n                    <ImportLinks onSubmit={this.appendProfiles} />\n                    <div className=\"level-item\">\n                        <button className=\"button is-danger\" onClick={() => this.setState({ players: [] })}>\n                            Delete all\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <RandomButton random={this.random} />\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-primary\"\n                            disabled={this.state.players.length < 3}\n                            onClick={this.submit}\n                        >\n                            Submit\n                        </button>\n                    </div>\n                </div>\n                ~ Drop images ~<input type=\"file\" multiple onChange={this.handleUpload} />\n                {this.getFiles()}\n            </FileDrop>\n        );\n    }\n\n    private handleUpload = (event: any) => {\n        this.handleFiles(event.target.files);\n    };\n\n    private handleDrop = (files: FileList | null, event: React.DragEvent) => {\n        if (!files) return;\n        this.handleFiles(files);\n    };\n\n    private handleFiles(files: FileList) {\n        const newState = { ...this.state };\n        for (let i = 0; i < files.length; i++) {\n            const file = files[i];\n            if (file.type.match(/image\\/*/)) {\n                newState.players.push(\n                    new PlayerProfile({\n                        name: file.name.substr(0, file.name.lastIndexOf(\".\")) || file.name,\n                        imageURL: URL.createObjectURL(file)\n                    })\n                );\n            }\n        }\n        this.setState(newState);\n    }\n}\n","import { BehaviorSubject, Subject } from \"rxjs\";\nimport { PregameScreen } from \"../components/pregameScreen/pregameScreen\";\nimport { Episode, PlayerProfile } from \"../model\";\nimport { SelectedPlayerData } from \"../components/playerPortrait/selectedPortrait\";\nimport React from \"react\";\nimport { PortraitDisplayMode, popularityMode } from \"../model/portraitDisplayMode\";\n\n// What is currently being displayed.\nexport const mainContentStream$ = new BehaviorSubject((<PregameScreen cast={[]} />));\n// Push episodes to this subject to add them to the sidebar. Null resets everything.\nexport const episodes$ = new BehaviorSubject<Episode | null>(null);\n// Forcibly switches to an episode. Used when adding a new episode.\nexport const switchEpisode$ = new Subject<number>();\nexport function newEpisode(episode: Episode | null) {\n    episodes$.next(episode);\n}\nexport function switchSceneRelative(n: number) {\n    switchEpisode$.next(n);\n}\n// the list of players in the game\nexport const cast$ = new BehaviorSubject<PlayerProfile[]>([]);\nexport function updateCast(newCast: PlayerProfile[]) {\n    cast$.next(newCast);\n}\nexport function getCast(): PlayerProfile[] {\n    return cast$.value;\n}\n// The player that the user has clicked on.\nexport const selectedPlayer$ = new BehaviorSubject<SelectedPlayerData | null>(null);\nexport function getSelectedPlayer() {\n    return selectedPlayer$.value;\n}\n\n// The display mode selected by the viewsbar.\nexport const displayMode$ = new BehaviorSubject<PortraitDisplayMode>(popularityMode);\n\n// If the screen is fullscreen or not.\nexport const isFullscreen$ = new BehaviorSubject<boolean>(false);\n","import React from \"react\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport { mainContentStream$, getCast } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\n\nconst TopbarLink = styled.div`\n    color: blue;\n    cursor: pointer;\n`;\n\nexport function EditCastLink(): JSX.Element {\n    return (\n        <TopbarLink\n            onClick={() => {\n                mainContentStream$.next(<CastingScreen cast={getCast()} />);\n            }}\n        >\n            Edit Cast\n        </TopbarLink>\n    );\n}\n\nexport function EditSeasonLink(): JSX.Element {\n    return (\n        <TopbarLink\n            onClick={() => {\n                mainContentStream$.next(<CastingScreen cast={getCast()} />);\n            }}\n        >\n            Edit Season\n        </TopbarLink>\n    );\n}\n\nexport function Topbar(props: { style?: any }): JSX.Element {\n    const style = { ...props.style, ...{ marginTop: 30 } };\n    return (\n        <div className=\"level box is-mobile\" style={style}>\n            <div className=\"level-item\">\n                <EditCastLink />\n            </div>\n            <div className=\"level-item\">\n                <EditSeasonLink />\n            </div>\n        </div>\n    );\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { EditCastLink } from \"../topbar/topBar\";\n\ninterface PregameScreenProps {\n    cast: PlayerProfile[];\n}\n\nexport function PregameScreen(props: PregameScreenProps): JSX.Element {\n    if (props.cast.length === 0) {\n        return (\n            <div>\n                Cast is empty. <EditCastLink />\n            </div>\n        );\n    }\n    return (\n        <div>\n            Welcome to Big Brother!\n            <MemoryWall houseguests={props.cast} />\n            <NextEpisodeButton />\n        </div>\n    );\n}\n","import prand from \"pure-rand\";\nimport { BehaviorSubject } from \"rxjs\";\nimport { hashcode } from \"./utilities\";\nimport { cast$ } from \"../subjects/subjects\";\n\nexport class BbRandomGenerator {\n    private rng: prand.RandomGenerator;\n\n    public randomFloat(): number {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result / 2147483647.0;\n    }\n\n    public randomInt(a: number, b: number): number {\n        let result: number;\n        [result, this.rng] = prand.uniformIntDistribution(a, b, this.rng);\n        return result;\n    }\n\n    public flipCoin(): boolean {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result % 2 === 0;\n    }\n\n    public seed(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n\n    public constructor(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n}\n\nexport function rng() {\n    return rng$.value;\n}\n\nconst rng$ = new BehaviorSubject(new BbRandomGenerator(0));\n\nconst castSub = cast$.subscribe({\n    next: cast => {\n        let castNames = \"\";\n        cast.forEach(houseguest => (castNames += houseguest.name));\n        rng$.next(new BbRandomGenerator(hashcode(castNames)));\n    }\n});\n","import { Houseguest } from \"./houseguest\";\nimport { PlayerProfile } from \"./playerProfile\";\nimport _ from \"lodash\";\nimport { newRelationshipMap, rng } from \"../utils\";\nimport { finalJurySize, getFinalists } from \"./season\";\nimport { EpisodeLog } from \"./logging/episodelog\";\n\n// TODO: might want to make houseguests a dictionary. {id: houseguest}\nexport function getById(gameState: GameState, id: number): Houseguest {\n    const result = gameState.houseguests.find(hg => hg.id === id);\n    if (!result) {\n        throw new Error(`Failed to find houseguest with id ${id}`);\n    }\n    return result;\n}\n\nexport function exclude(inclusions: Houseguest[], exclusions: Houseguest[]) {\n    const excludedIds = exclusions.map(hg => hg.id);\n    return inclusions.filter(hg => !excludedIds.includes(hg.id) && !hg.isEvicted);\n}\n\nexport function randomPlayer(inclusions: Houseguest[], exclusions: Houseguest[] = []): Houseguest {\n    if (inclusions.length === 0) {\n        throw new Error(\"Tried to get a random player from a list of 0 players.\");\n    }\n    const options = exclude(inclusions, exclusions);\n    const choice = rng().randomInt(0, options.length - 1);\n\n    return options[choice];\n}\n\nexport function nonEvictedHouseguests(gameState: GameState) {\n    return gameState.houseguests.filter(hg => !hg.isEvicted);\n}\nexport function getJurors(gameState: GameState): Houseguest[] {\n    return gameState.houseguests.filter(hg => hg.isJury);\n}\n\nexport function inJury(gameState: GameState): Boolean {\n    return gameState.remainingPlayers - getFinalists() <= finalJurySize();\n}\n\nexport function calculatePopularity(hero: Houseguest, house: Houseguest[]) {\n    let sum = 0;\n    let count = 0;\n    const targetId = hero.id;\n    house.forEach(houseguest => {\n        if (houseguest.id !== targetId) {\n            count++;\n            sum += houseguest.relationships[targetId];\n        }\n    });\n    return count === 0 ? 0 : sum / count;\n}\n\nexport class GameState {\n    // Current state of the game after a phase.\n\n    readonly houseguests: Houseguest[] = [];\n    readonly remainingPlayers: number = 0;\n    readonly phase: number = 0;\n    readonly previousHOH?: Houseguest;\n    readonly log: EpisodeLog[] = [];\n    get currentLog() {\n        return this.log[this.phase];\n    }\n\n    public constructor(init: PlayerProfile[] | GameState) {\n        if (!(init instanceof Array)) {\n            Object.assign(this, init);\n        } else {\n            const profiles = init as PlayerProfile[];\n            this.remainingPlayers = profiles.length;\n            let id = -1;\n            profiles.forEach(profile => {\n                this.houseguests.push(\n                    new Houseguest({\n                        ...profile,\n                        id: ++id,\n                        relationships: newRelationshipMap(profiles.length, id)\n                    })\n                );\n            });\n        }\n    }\n}\n\nexport class MutableGameState {\n    public houseguests: Houseguest[] = [];\n    public remainingPlayers: number = 0;\n    public phase: number = 0;\n    public previousHOH?: Houseguest;\n    public log: EpisodeLog[] = [];\n    get currentLog() {\n        return this.log[this.phase];\n    }\n\n    public constructor(init: GameState | MutableGameState) {\n        const copy = _.cloneDeep(init);\n        Object.assign(this, copy);\n    }\n}\n","import { BigBrotherVanilla } from \"../components/episode/bigBrotherEpisode\";\nimport { EpisodeFactory } from \"../components/episode/episodeFactory\";\nimport { GameState } from \"./gameState\";\nimport { EpisodeType, Episode } from \".\";\nimport { BigBrotherFinale } from \"../components/episode/bigBrotherFinale\";\nimport { cast$ } from \"../subjects/subjects\";\nimport { GameOver } from \"../components/episode/gameOver\";\n\nexport function finalJurySize() {\n    return jurors;\n}\n\nlet jurors = 7;\nconst sub = cast$.subscribe({\n    next: newCast => {\n        let players = newCast.length;\n        players = Math.round(players * 0.55);\n        if (players % 2 === 0) {\n            players--;\n        }\n        jurors = players;\n    }\n});\n\nexport function getFinalists() {\n    return 2;\n}\n\nexport class Season {\n    private factory: EpisodeFactory;\n\n    public constructor() {\n        this.factory = new EpisodeFactory();\n    }\n\n    // In the future, this would all be customizable,\n    // and not just all big brother episodes by default.\n\n    public renderEpisode(gameState: GameState, type: EpisodeType): Episode {\n        return this.factory.nextEpisode(gameState, type);\n    }\n\n    public whichEpisodeType(players: number) {\n        if (players === 3) {\n            return BigBrotherFinale;\n        }\n        if (players === 2) {\n            return GameOver;\n        }\n        return BigBrotherVanilla;\n    }\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\ninterface InitScene {\n    readonly title: string;\n    readonly gameState: GameState;\n    readonly content: JSX.Element;\n}\nexport class Scene {\n    readonly title: string = \"\";\n    readonly gameState: GameState = new GameState([]);\n    readonly content: JSX.Element = <div>{`Error while rendering ${this.title}`}</div>;\n    public render: JSX.Element;\n    public constructor(init: Partial<InitScene>) {\n        Object.assign(this, init);\n        this.render = (\n            <div>\n                <ViewsBar />\n                {this.content}\n            </div>\n        );\n    }\n}\n","import React from \"react\";\n\ninterface TextProps {\n    noMargin?: boolean;\n    children?: any;\n}\n\nexport function Centered(props: TextProps): JSX.Element {\n    if (props.noMargin) return <div style={{ textAlign: \"center\" }}>{props.children}</div>;\n    return <p style={{ textAlign: \"center\" }}>{props.children} </p>;\n}\n\nexport function CenteredBold(props: TextProps): JSX.Element {\n    return (\n        <Centered noMargin={props.noMargin}>\n            <b>{props.children} </b>\n        </Centered>\n    );\n}\n\nexport function CenteredItallic(props: TextProps): JSX.Element {\n    return (\n        <Centered noMargin={props.noMargin}>\n            <i>{props.children} </i>\n        </Centered>\n    );\n}\n","import { Houseguest, inJury, GameState } from \"../../model\";\n\nexport const relationship = (hero: Houseguest, villain: Houseguest) => hero.relationships[villain.id];\n\nexport function favouriteIndex(hero: Houseguest, options: Houseguest[]) {\n    // Return the index of the houseguest that hero has the best relationship with.\n    return highestScore(hero, options, relationship);\n}\n\nexport function highestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let highestIndex = 0;\n    let highestScore = -Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore > highestScore) {\n            highestIndex = i;\n            highestScore = currentScore;\n        }\n    });\n    return highestIndex;\n}\nexport function lowestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let lowestIndex = 0;\n    let lowestScore = Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore < lowestScore) {\n            lowestIndex = i;\n            lowestScore = currentScore;\n        }\n    });\n    return lowestIndex;\n}\n\nexport function doesHeroWinTheFinale(\n    hgs: { hero: Houseguest; villain: Houseguest },\n    jury: Houseguest[]\n): boolean {\n    const hero = hgs.hero;\n    const villain = hgs.villain;\n    let heroVotes = 0;\n    let villainVotes = 0;\n    jury.forEach(juror => {\n        if (juror.id === hero.id || juror.id === villain.id) {\n            return;\n        }\n        if (relationship(hero, juror) > relationship(villain, juror)) {\n            heroVotes++;\n        } else {\n            villainVotes++;\n        }\n    });\n    return heroVotes > villainVotes;\n}\n\nexport function heroShouldTargetSuperiors(hero: Houseguest, gameState: GameState): boolean {\n    const totalPlayers = gameState.remainingPlayers;\n    const superiors = hero.superiors.size;\n    // const inferiors = totalPlayers - 1 - hero.superiors.size;\n\n    // Old logic: Target the larger group. If they are equal, target superiors.\n    // return superiors >= inferiors;\n\n    // New logic: Target superiors unless you are in the top 25% of the playerlist.\n    return superiors / totalPlayers >= 0.25;\n}\n\n// TODO: this function can just honestly die. it's only used in nomination logic (which sucks anyways)\n// when I do the new logic, I think people who are dead center should target their superiors. works in F5.\n\nexport function hitList(hero: Houseguest, options: Houseguest[], gameState: GameState): Set<number> {\n    let result = options;\n    // jury logic is not affected by someone who is dead center in power rankings\n    if (inJury(gameState) && heroShouldTargetSuperiors(hero, gameState)) {\n        if (hero.superiors.size * 2 < gameState.remainingPlayers - 1) {\n            result = options.filter(hg => !hero.superiors.has(hg.id));\n        } else {\n            result = options.filter(hg => hero.superiors.has(hg.id));\n        }\n    } else {\n    }\n    return new Set(result.map(hg => hg.id));\n}\n","import { Houseguest, GameState, nonEvictedHouseguests, inJury, exclude } from \"../../model\";\nimport { favouriteIndex, relationship, lowestScore, hitList, heroShouldTargetSuperiors } from \"./aiUtils\";\nimport { classifyRelationship, RelationshipType as Relationship } from \"./classifyRelationship\";\n\ninterface NumberWithLogic {\n    decision: number;\n    reason: string;\n}\n\ninterface HouseguestWithLogic {\n    decision: Houseguest | null;\n    reason: string;\n}\n\n// Return the index of the eviction target.\nexport function castEvictionVote(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): NumberWithLogic {\n    if (inJury(gameState)) {\n        return cutthroatVoteJury(hero, nominees, gameState);\n    } else {\n        return cutthroatVote(hero, nominees);\n    }\n}\n\nfunction cutthroatVoteJury(hero: Houseguest, nominees: Houseguest[], gameState: GameState): NumberWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    const zeroIsInferior = !hero.superiors.has(nom0.id);\n    const oneIsInferior = !hero.superiors.has(nom1.id);\n    // if there is no sup/inf difference, no point in doing special logic for it\n    if (zeroIsInferior === oneIsInferior) {\n        return cutthroatVote(hero, nominees);\n    }\n    // Don't evict the last person in the game you can beat\n    if (gameState.remainingPlayers - hero.superiors.size - 1 === 1 && (zeroIsInferior || oneIsInferior)) {\n        const nonVote = zeroIsInferior ? 0 : 1;\n        return {\n            decision: zeroIsInferior ? 1 : 0,\n            reason: `I can't evict ${nominees[nonVote].name}, because they are the last person I can beat.`\n        };\n    }\n    const target = heroShouldTargetSuperiors(hero, gameState) === oneIsInferior ? 0 : 1;\n    const nonTarget = target ? 0 : 1;\n    const excuse = heroShouldTargetSuperiors(hero, gameState)\n        ? `I can't beat ${nominees[target].name} in the end.`\n        : `I need to keep ${nominees[nonTarget].name} around as a shield.`;\n    const targetIsFriend =\n        classifyRelationship(\n            hero.popularity,\n            nominees[target].popularity,\n            hero.relationships[nominees[target].id]\n        ) === Relationship.Friend;\n    const nonTargetIsNonFriend =\n        classifyRelationship(\n            hero.popularity,\n            nominees[nonTarget].popularity,\n            hero.relationships[nominees[nonTarget].id]\n        ) !== Relationship.Friend;\n    const nonTargetIsFriend = !nonTargetIsNonFriend;\n    const targetIsNonFriend = !targetIsFriend;\n    // the only reason to not evict your target is if he is your only friend on the block\n    if (targetIsFriend && nonTargetIsNonFriend) {\n        return { decision: nonTarget, reason: `${nominees[nonTarget].name} is my enemy.` };\n    } else if (targetIsFriend && nonTargetIsFriend) {\n        return { decision: target, reason: `Both noms are my friends, but ${excuse}` };\n    } else if (targetIsNonFriend && nonTargetIsNonFriend) {\n        return { decision: target, reason: `Neither of the noms are my friends, but ${excuse}` };\n    } else {\n        return { decision: target, reason: `${excuse}` };\n    }\n}\n\n// TODO: only works for 2 nominees\nfunction cutthroatVote(hero: Houseguest, nominees: Houseguest[]): NumberWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    const r0 = classifyRelationship(hero.popularity, nom0.popularity, hero.relationships[nom0.id]);\n    const r1 = classifyRelationship(hero.popularity, nom1.popularity, hero.relationships[nom1.id]);\n    if (r0 === Relationship.Enemy && r1 === Relationship.Enemy) {\n        return {\n            decision: nom0.popularity > nom1.popularity ? 0 : 1,\n            reason: \"Both noms are my enemies, so I voted for the more popular one.\"\n        };\n    } else if (\n        (r0 === Relationship.Enemy && r1 !== Relationship.Enemy) ||\n        (r1 === Relationship.Enemy && r0 !== Relationship.Enemy)\n    ) {\n        const vote = r0 === Relationship.Enemy ? 0 : 1;\n        return { decision: vote, reason: `${nominees[vote].name} is my enemy.` };\n    } else if (\n        (r0 !== Relationship.Friend && r1 === Relationship.Friend) ||\n        (r1 !== Relationship.Friend && r0 === Relationship.Friend)\n    ) {\n        const vote = r0 !== Relationship.Friend ? 0 : 1;\n        const nonVote = vote === 0 ? 1 : 0;\n        return { decision: vote, reason: `${nominees[nonVote].name} is my friend.` };\n    }\n    const vote = lowestScore(hero, nominees, relationship);\n    return {\n        decision: vote,\n        reason: `Both noms are my friends. but I like ${nominees[vote === 0 ? 1 : 0].name} more.`\n    };\n}\n\n// TODO: target and pawn based nominations, different pre and post jury.\nexport function nominateNPlayers(\n    hero: Houseguest,\n    options: Houseguest[],\n    gameState: GameState,\n    n: number\n): NumberWithLogic[] {\n    const result: NumberWithLogic[] = [];\n    const hitlist = hitList(hero, options, gameState);\n    let trueOptions = options.filter(hg => hitlist.has(hg.id));\n    if (trueOptions.length === 0) {\n        // if there are no options, we must sadly deviate from the hit list\n        trueOptions = options;\n    }\n    while (result.length < n) {\n        const decision = trueOptions[lowestScore(hero, trueOptions, relationship)];\n        const reason = \"I think you are ugly\";\n        result.push({ decision: decision.id, reason });\n        trueOptions = exclude(trueOptions, [decision]);\n        if (trueOptions.length === 0) {\n            trueOptions = options.filter(hg => !hitlist.has(hg.id));\n        }\n    }\n    return result;\n}\n\nexport function useGoldenVeto(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): HouseguestWithLogic {\n    let result: HouseguestWithLogic;\n    if (hero.id == nominees[0].id || hero.id == nominees[1].id) {\n        result = { decision: hero, reason: \"I am going to save myself.\" };\n    } else {\n        if (inJury(gameState)) {\n            // Note that I am currently not using the post-jury veto logic, primarily because it sucks at the moment\n            result = useGoldenVetoPreJury(hero, nominees);\n        } else {\n            result = useGoldenVetoPreJury(hero, nominees);\n        }\n        if (nonEvictedHouseguests(gameState).length === 4) {\n            result = {\n                decision: null,\n                reason: \"It doesn't make sense to use the veto here.\"\n            };\n        }\n    }\n    return result || null;\n}\n\n// works with any number of nominees\nfunction useGoldenVetoPostJury(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): HouseguestWithLogic {\n    let save = -1;\n    let reason = \"No reason specified.\";\n    let potentialSave: Houseguest | null = null;\n    let alwaysSave: Houseguest | null = null;\n    // identify potential save targets\n    nominees.forEach((nominee: Houseguest) => {\n        const relationship = classifyRelationship(\n            hero.popularity,\n            nominee.popularity,\n            hero.relationships[nominee.id]\n        );\n        const shouldTargetSuperiors = heroShouldTargetSuperiors(hero, gameState);\n        const nomineeIsSuperior: boolean = hero.superiors.has(nominee.id);\n        // always save the last person you can beat\n        if (gameState.remainingPlayers - hero.superiors.size - 1 === 1 && !nomineeIsSuperior) {\n            alwaysSave = nominee;\n            reason = `I have to save ${nominee.name}, because they are the last person I can beat.`;\n        }\n        // must be a friend and a non-target\n        // TODO: some people have the entire game as targets. they shouldn't be affected. --------------------------\n        if (relationship === Relationship.Friend && nomineeIsSuperior !== shouldTargetSuperiors) {\n            const excuse = heroShouldTargetSuperiors(hero, gameState)\n                ? `I can beat them in the end.`\n                : `I need to keep them around as a shield.`;\n            if (potentialSave) {\n                potentialSave =\n                    hero.relationshipWith(nominee) > hero.relationshipWith(potentialSave)\n                        ? nominee\n                        : potentialSave;\n            } else {\n                reason = `${nominee.name} is my friend, and ${excuse} `;\n                potentialSave = nominee;\n            }\n        }\n    });\n    if (alwaysSave) {\n        return { decision: alwaysSave, reason };\n    } else if (potentialSave) {\n        return { decision: potentialSave, reason };\n    } else {\n        return { decision: null, reason: \"Not sure what to put here yet.\" };\n    }\n}\n\nfunction useGoldenVetoPreJury(hero: Houseguest, nominees: Houseguest[]): HouseguestWithLogic {\n    let save = -1;\n    let reason = \"Neither of these nominees are my friends.\";\n    const rel0 = classifyRelationship(\n        hero.popularity,\n        nominees[0].popularity,\n        hero.relationshipWith(nominees[0])\n    );\n    const rel1 = classifyRelationship(\n        hero.popularity,\n        nominees[1].popularity,\n        hero.relationshipWith(nominees[1])\n    );\n    // basic logic that only saves friends. Doesn't take into account jury stuff.\n    if (rel0 === Relationship.Friend && rel1 !== Relationship.Friend) {\n        save = 0;\n        reason = `${nominees[0].name} is my friend.`;\n    } else if (rel1 === Relationship.Friend && rel0 !== Relationship.Friend) {\n        save = 1;\n        reason = `${nominees[1].name} is my friend.`;\n    } else if (rel0 === Relationship.Friend && rel1 === Relationship.Friend) {\n        save = Math.max(nominees[0].popularity, nominees[1].popularity) === nominees[0].popularity ? 0 : 1;\n        reason = `Both nominees are my friends, but I like ${nominees[save].name} more.`;\n    }\n    return { decision: nominees[save], reason };\n}\n\n// Returns the index of the finalist with the highest relationship with juror\nexport function castJuryVote(juror: Houseguest, finalists: Houseguest[]): number {\n    return favouriteIndex(juror, finalists);\n}\n","import React from \"react\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\n\nconst FullscreenIcon = styled.img`\n    position: -webkit-sticky;\n    position: sticky;\n    top: 20px;\n    right: 20px;\n`;\n\nexport function FullscreenButton(): JSX.Element {\n    return (\n        <FullscreenIcon\n            src={\n                \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAASElEQVRIiWNgGAUEACMa/z+R6ohWz0Sqi0gFLIRcQAAQDAGa+2DoWzAKRgH1wX8G3OULWfqHfkYbsNIUPR5IrQ/gYLQsGngAAEPgCRZjAdYSAAAAAElFTkSuQmCC\"\n            }\n            className=\"button is-rounded\"\n            onClick={() => {\n                isFullscreen$.next(!isFullscreen$.getValue());\n            }}\n        />\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { EpisodeLog } from \"../../../model/logging/episodelog\";\nimport { CenteredBold, Centered, CenteredItallic } from \"../../layout/centered\";\nimport { GameState, getById } from \"../../../model\";\nimport { VoteType, WinnerVote, RunnerUpVote } from \"../../../model/logging/voteType\";\nimport { FullscreenButton } from \"../../mainPage/fullscreenButton\";\n\nexport const EndgameTableCell = styled.td`\n    padding: 0.1em 0.4em;\n    border: 1px solid #a2a9b1;\n`;\n\nconst EndgameTable = styled.table`\n    border: 1px solid #a2a9b1;\n    border-collapse: collapse;\n`;\n\nconst Gray = styled(EndgameTableCell)`\n    background-color: #eaecf0;\n`;\n\nconst White = styled(EndgameTableCell)`\n    background-color: #f8f9fa;\n`;\n\nconst Evicted = styled(EndgameTableCell)`\n    background-color: #fa8072;\n`;\n\nexport const WinnerCell = styled(EndgameTableCell)`\n    background-color: #73fb76;\n`;\n\nexport const RunnerUpCell = styled(EndgameTableCell)`\n    background-color: #d1e8ef;\n`;\n\nconst BlackRow = styled.tr`\n    height: 0.4em;\n    background-color: #000000;\n`;\n\nexport function generateVotingTable(gameState: GameState): JSX.Element {\n    const masterLog: EpisodeLog[] = gameState.log;\n    const houseguestCells: JSX.Element[][] = [];\n    gameState.houseguests.forEach((hg, i) => {\n        houseguestCells[hg.id] = [\n            <Gray key={`hg-name---${i}`}>\n                <CenteredBold noMargin={true}>{hg.name}</CenteredBold>\n            </Gray>\n        ];\n    });\n    const evictionOrder: number[] = [];\n    const topRowCells: JSX.Element[] = [];\n    const preVetoCells: JSX.Element[] = [];\n    const vetoCells: JSX.Element[] = [];\n    const postVetoCells: JSX.Element[] = [];\n    const evictedCells: JSX.Element[] = [];\n    const winnerCells: JSX.Element[] = [];\n    masterLog.forEach((log, i) => {\n        generateTopRow(log, i, topRowCells, masterLog.length - 1);\n        generatePreVetoRow(log, i, preVetoCells);\n        generateVetoRow(log, i, vetoCells);\n        generatePostVetoRow(log, i, postVetoCells);\n        generateEvictedRow(log, i, evictedCells, gameState);\n        if (!log) return;\n        evictionOrder.push(log.evicted);\n        if (log.runnerUp !== undefined) evictionOrder.push(log.runnerUp);\n        if (log.winner !== undefined) evictionOrder.push(log.winner);\n        // add each of the votes to the houseguest cells\n        for (const [key, value] of Object.entries(log.votes)) {\n            // typescript for .. in loops kinda suck so i need to do a sketchy type conversion\n            const id: number = (key as unknown) as number;\n            const vote: VoteType = value;\n            houseguestCells[id].push(vote.render(gameState));\n        }\n        if (log.winner !== undefined && log.runnerUp !== undefined) {\n            houseguestCells[log.winner].push(new WinnerVote().render(gameState));\n            houseguestCells[log.runnerUp].push(new RunnerUpVote().render(gameState));\n            evictedCells.push(\n                <RunnerUpCell>\n                    <CenteredBold noMargin={true}>{getById(gameState, log.runnerUp).name}</CenteredBold>\n                    <Centered noMargin={true}>\n                        <small>Finalist</small> {/** TODO: put \"X votes\" here instead. */}\n                    </Centered>\n                </RunnerUpCell>\n            );\n            winnerCells.push(\n                <WinnerCell>\n                    <CenteredBold noMargin={true}>{getById(gameState, log.winner).name}</CenteredBold>\n                    <Centered noMargin={true}>\n                        <small>Winner</small>\n                    </Centered>\n                </WinnerCell>\n            );\n        }\n    });\n    preVetoCells.push(\n        <White key={`preveto--finale`} rowSpan={3}>\n            <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n        </White>\n    );\n    const winnerRow = <tr>{winnerCells}</tr>;\n    const topRow = <tr>{topRowCells}</tr>;\n    const preVetoRow = <tr>{preVetoCells}</tr>;\n    const vetoRow = <tr>{vetoCells}</tr>;\n    const postVetoRow = <tr>{postVetoCells}</tr>;\n    const blackRow = (\n        <BlackRow>\n            <td colSpan={gameState.houseguests.length} />\n        </BlackRow>\n    );\n    const houseguestRows: JSX.Element[] = [];\n    const evictedRow = <tr>{evictedCells}</tr>;\n    let evictionColSpan = -1;\n    const weeks = evictionOrder.length;\n    evictionOrder.reverse().forEach((id, i) => {\n        if (evictionColSpan > 0) {\n            const weekText = i === 2 ? \"(Finale)\" : `(Week ${weeks - i})`;\n            const isJury = getById(gameState, id).isJury;\n            const colSpan = isJury ? evictionColSpan - 1 : evictionColSpan;\n            const evicted = (\n                <Evicted colSpan={colSpan} key={`evicted-week-${weeks - i}`}>\n                    <CenteredItallic noMargin={true}>Evicted</CenteredItallic>\n                    <CenteredItallic noMargin={true}>\n                        <small>{weekText}</small>\n                    </CenteredItallic>\n                </Evicted>\n            );\n            if (!isJury) {\n                houseguestCells[id].push(evicted); // not jury, they dead\n            } else {\n                const tempList = houseguestCells[id].slice(0, -1);\n                tempList.push(evicted);\n                tempList.push(houseguestCells[id][houseguestCells[id].length - 1]);\n                houseguestCells[id] = tempList;\n            }\n        }\n        houseguestRows.push(<tr key={`hgrow--${id}`}>{houseguestCells[id]}</tr>);\n        evictionColSpan++;\n    });\n\n    return (\n        <div>\n            <FullscreenButton />\n            <EndgameTable>\n                <tbody>\n                    {topRow}\n                    {preVetoRow}\n                    {vetoRow}\n                    {postVetoRow}\n                    {blackRow}\n                    {houseguestRows}\n                    {blackRow}\n                    {evictedRow}\n                    {winnerRow}\n                </tbody>\n            </EndgameTable>\n        </div>\n    );\n}\n\nfunction generateEvictedRow(\n    log: EpisodeLog | undefined,\n    i: number,\n    cells: JSX.Element[],\n    gameState: GameState\n) {\n    if (!log) {\n        cells.push(\n            <Gray key={i} rowSpan={2}>\n                <CenteredBold noMargin={true}>Evicted</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n\n    const voteTextLine1 =\n        log.soleVoter !== undefined\n            ? `${log.soleVoter}'s choice`\n            : `${log.votesInMajority} of ${log.outOf} votes`;\n\n    cells.push(\n        <Evicted key={i} rowSpan={2}>\n            <Centered noMargin={true}>\n                <b>{getById(gameState, log.evicted).name}</b>\n                <br />\n                <small>\n                    {voteTextLine1} <br />\n                    to evict\n                </small>\n            </Centered>\n        </Evicted>\n    );\n}\n\nfunction generatePostVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`postVeto--${i}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(post-veto)</small>\n                </CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`postVeto--${i}`}>\n            <Centered noMargin={true}>\n                {log.nominationsPostVeto[0]}\n                <br /> {log.nominationsPostVeto[1]}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`veto--${i}`}>\n                <CenteredBold noMargin={true}>Veto Winner</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    if (log.vetoWinner === undefined) return;\n\n    cells.push(\n        <White key={`veto--${i}`}>\n            <Centered noMargin={true}>{log.vetoWinner}</Centered>\n        </White>\n    );\n}\n\nfunction generatePreVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`preveto--${i}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(pre-veto)</small>\n                </CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    if (log.nominationsPreVeto.length === 0) {\n        cells.push(\n            <White key={`preveto--${i}`} rowSpan={2}>\n                <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n            </White>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`preveto--${i}`}>\n            <Centered noMargin={true}>\n                {log.nominationsPreVeto[0]}\n                <br /> {log.nominationsPreVeto[1]}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateTopRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[], max: number) {\n    if (!log) {\n        cells.push(<Gray key={`toprow--${i}`} />);\n        return;\n    }\n    if (i === max) {\n        cells.push(\n            <Gray key={`toprow--${i}`} colSpan={2}>\n                <CenteredBold noMargin={true}>Finale</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    cells.push(\n        <Gray key={`toprow--${i}`}>\n            <CenteredBold noMargin={true}>Week {i}</CenteredBold>\n        </Gray>\n    );\n}\n","import React from \"react\";\nimport { GameState, getById } from \"../gameState\";\nimport { CenteredItallic, Centered } from \"../../components/layout/centered\";\nimport { EndgameTableCell, WinnerCell, RunnerUpCell } from \"../../components/episode/scenes/votingTable\";\n\nlet voteKey = 0;\n\nfunction getKey(): string {\n    return `${voteKey++}-- vote key`;\n}\n\nexport interface VoteType {\n    id: number;\n    render: (state: GameState) => JSX.Element;\n}\n\nexport class NormalVote implements VoteType {\n    id: number;\n    render = (state: GameState) => (\n        <EndgameTableCell key={getKey()}>\n            <Centered noMargin={true}>{getById(state, this.id).name}</Centered>\n        </EndgameTableCell>\n    );\n    constructor(id: number) {\n        this.id = id;\n    }\n}\n\nexport class WinnerVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <WinnerCell>\n            <Centered noMargin={true}>Winner</Centered>\n        </WinnerCell>\n    );\n}\n\nexport class RunnerUpVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <RunnerUpCell>\n            <Centered noMargin={true}>Finalist</Centered>\n        </RunnerUpCell>\n    );\n}\n\nexport class NomineeVote implements VoteType {\n    id: number = -1;\n    evicted: boolean;\n    render = (state: GameState) => (\n        <EndgameTableCell key={getKey()} style={{ backgroundColor: \"#959FFD\" }}>\n            <CenteredItallic noMargin={true}>Nominated</CenteredItallic>\n        </EndgameTableCell>\n    );\n    constructor(evicted: boolean) {\n        this.evicted = evicted;\n    }\n}\n\nexport class HoHVote implements VoteType {\n    id: number;\n\n    get hohText(): JSX.Element {\n        return (\n            <CenteredItallic noMargin={true}>\n                Head of\n                <br />\n                Household\n            </CenteredItallic>\n        );\n    }\n\n    private hohVote(state: GameState): JSX.Element {\n        return <CenteredItallic noMargin={true}>{getById(state, this.id).name}</CenteredItallic>;\n    }\n\n    render = (state: GameState) => {\n        return (\n            <EndgameTableCell key={getKey()} style={{ backgroundColor: \"#CCFFCC\" }}>\n                {this.id == -1 ? this.hohText : this.hohVote(state)}\n            </EndgameTableCell>\n        );\n    };\n    constructor(id?: number) {\n        this.id = id === undefined ? -1 : id;\n    }\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\n\nconst ShadowBox = styled.div`\n    box-shadow: 0 2px 3px rgba(10, 10, 10, 0.1), 0 0 0 1px rgba(10, 10, 10, 0.1);\n    border-radius: 6px;\n    margin-left: 3px;\n    margin-right: 3px;\n`;\n\nexport function DividerBox(props: any): JSX.Element {\n    return <ShadowBox className={props.className}>{props.children}</ShadowBox>;\n}\n","import { GameState, getJurors, nonEvictedHouseguests, MutableGameState, Houseguest } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { castJuryVote } from \"../../../utils/ai/aiApi\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport React from \"react\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport { NormalVote } from \"../../../model/logging/voteType\";\n\nexport function juryVoteScene(initialGameState: GameState): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const jurors: Houseguest[] = getJurors(newGameState);\n    const finalists = nonEvictedHouseguests(newGameState);\n    const votes: Array<ProfileHouseguest[]> = [[], []];\n    jurors.forEach(juror => {\n        const decision = castJuryVote(juror, finalists);\n        const result: ProfileHouseguest = { ...juror };\n        votes[decision].push(result);\n        newGameState.currentLog.votes[juror.id] = new NormalVote(finalists[decision].id);\n    });\n    const votesFor0 = votes[0].length;\n    const votesFor1 = votes[1].length;\n    const isUnanimous = votesFor0 === 0 || votesFor1 === 0;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${votesFor0} to ${votesFor1}...`;\n\n    const winner = votesFor0 > votesFor1 ? finalists[0] : finalists[1];\n    const runnerUp = votesFor0 < votesFor1 ? finalists[0] : finalists[1];\n    newGameState.currentLog.winner = winner.id;\n    newGameState.currentLog.runnerUp = runnerUp.id;\n    const scene = new Scene({\n        title: \"Jury Votes\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[0]} centered={true} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[1]} centered={true} />\n                    </DividerBox>\n                </div>\n                <Portraits houseguests={finalists} centered={true} />\n                <CenteredBold>{`Congratulations, ${winner.name}... you are the winner of Big Brother!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [newGameState, scene];\n}\n","import React from \"react\";\nimport { EpisodeType, Episode, InitEpisode } from \"./episodes\";\nimport { Scene } from \"./scene\";\nimport { GameState } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { finalHohCompScene } from \"./scenes/finalHohCompScene\";\nimport { finalEvictionScene } from \"./scenes/finalEvictionScene\";\nimport { juryVoteScene } from \"./scenes/juryVoteScene\";\n\nexport const BigBrotherFinale: EpisodeType = {\n    canPlayWith: (n: number) => n === 3,\n    eliminates: 2,\n    arrowsEnabled: true,\n    hasViewsbar: true\n};\n\nexport function generateBbFinale(initialGameState: GameState): BigBrotherFinaleEpisode {\n    const title = \"Finale\";\n    const content = (\n        <div>\n            Finale Night\n            <MemoryWall houseguests={initialGameState.houseguests} /> <br />\n            <NextEpisodeButton />\n        </div>\n    );\n    let currentGameState;\n    let hohCompScene;\n    let finalHoH;\n    const scenes = [];\n    [currentGameState, hohCompScene, finalHoH] = finalHohCompScene(initialGameState);\n    scenes.push(hohCompScene);\n    let finalEviction;\n    [currentGameState, finalEviction] = finalEvictionScene(currentGameState, finalHoH);\n    scenes.push(finalEviction);\n    const [gameState, juryScene] = juryVoteScene(currentGameState);\n    scenes.push(juryScene);\n    return new BigBrotherFinaleEpisode({ gameState, content, title, scenes, type: BigBrotherFinale });\n}\n\nexport class BigBrotherFinaleEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = BigBrotherFinale;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portraits, Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\n\nexport function finalHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n    const final3 = nonEvictedHouseguests(initialGameState);\n    const enduranceWinner = randomPlayer(final3);\n    const enduranceLosers = final3.filter(hg => hg.id !== enduranceWinner.id);\n    const skillWinner = randomPlayer(final3, [enduranceWinner]);\n    const finalHoH = getById(newGameState, randomPlayer([enduranceWinner, skillWinner]).id);\n    finalHoH.hohWins++;\n    const scene: Scene = new Scene({\n        title: \"Final HoH Competition\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>The final 3 houseguests compete in the endurance competition.</Centered>\n                <Portraits houseguests={final3} centered={true} />\n                <Portrait houseguest={enduranceWinner} centered={true} />\n                <CenteredBold>{`${enduranceWinner.name} has won the endurance competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceLosers[0].name} and ${enduranceLosers[1].name} compete in the skill competition.`}</Centered>\n                <Portraits houseguests={enduranceLosers} centered={true} />\n                <Portrait houseguest={skillWinner} centered={true} />\n                <CenteredBold>{`${skillWinner.name} has won the skill competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceWinner.name} and ${skillWinner.name} compete in the quiz competition.`}</Centered>\n                <Portraits houseguests={[enduranceWinner, skillWinner]} centered={true} />\n                <Portrait houseguest={finalHoH} centered={true} />\n                <CenteredBold>{`Congratulations ${finalHoH.name}, you are the final Head of Household!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene, finalHoH];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { evictHouseguest } from \"../bigBrotherEpisode\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { HoHVote, NomineeVote } from \"../../../model/logging/voteType\";\n\nexport function finalEvictionScene(initialGameState: GameState, HoH: Houseguest): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const nominees = nonEvictedHouseguests(newGameState).filter(hg => hg.id !== HoH.id);\n    newGameState.currentLog.nominationsPostVeto = nominees.map(hg => hg.name);\n    const { decision: vote, reason } = castEvictionVote(HoH, nominees, newGameState);\n    const evictee = nominees[vote];\n    const survivor = nominees[vote == 1 ? 0 : 1];\n    newGameState.currentLog.soleVoter = HoH.name;\n    newGameState.currentLog.votes[survivor.id] = new NomineeVote(false);\n    newGameState.currentLog.votes[HoH.id] = new HoHVote(evictee.id);\n    newGameState.currentLog.votesInMajority = 1;\n    newGameState.currentLog.outOf = 1;\n    const hoh: ProfileHouseguest = { ...HoH };\n    hoh.tooltip = reason;\n    evictHouseguest(newGameState, evictee.id);\n    const scene: Scene = new Scene({\n        title: \"Final Eviction\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <div style={{ textAlign: \"center\" }}>\n                    {`As the final HoH of the season, ${HoH.name}, you may now cast the sole vote to evict.`}\n                    <Portrait houseguest={hoh} centered={true} />\n                    <CenteredBold>{`I vote to evict ${evictee.name}.`}</CenteredBold>\n                    <Portraits houseguests={nominees} centered={true} />\n                    <Centered>\n                        It's official... {evictee.name}, you will be the final person leaving the Big Brother\n                        House.\n                    </Centered>\n                </div>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene];\n}\n","import { Episode, InitEpisode, EpisodeType } from \"./episodes\";\nimport { Scene } from \"./scene\";\nimport { GameState } from \"../../model\";\nimport { evictHouseguest } from \"./bigBrotherEpisode\";\nimport { generateVotingTable } from \"./scenes/votingTable\";\n\nexport const GameOver: EpisodeType = {\n    canPlayWith: (n: number) => n === 1,\n    eliminates: 1,\n    arrowsEnabled: false,\n    hasViewsbar: false\n};\n\nexport function generateGameOver(gameState: GameState): GameOverEpisode {\n    const title = \"Game Over\";\n    const scenes: Scene[] = [];\n    const content = generateVotingTable(gameState);\n    gameState.houseguests.forEach(hg => {\n        evictHouseguest(gameState, hg.id);\n    });\n    return new GameOverEpisode({ gameState, content, title, scenes, type: GameOver });\n}\n\nexport class GameOverEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import { VoteType } from \"./voteType\";\n\nexport class EpisodeLog {\n    public nominationsPreVeto: string[] = [];\n    public vetoWinner?: string;\n    public winner?: number;\n    public runnerUp?: number;\n    public nominationsPostVeto: string[] = [];\n    public evicted: number = -1;\n    public votes: { [id: string]: VoteType } = {};\n    public votesInMajority: number = -1;\n    public outOf: number = -1;\n    public soleVoter?: string;\n}\n","import {\n    GameState,\n    MutableGameState,\n    calculatePopularity,\n    nonEvictedHouseguests,\n    inJury,\n    getJurors\n} from \"../../model/gameState\";\nimport { Episode, Houseguest } from \"../../model\";\nimport { EpisodeType } from \"./episodes\";\nimport { BigBrotherVanilla, generateBbVanilla } from \"./bigBrotherEpisode\";\nimport { BigBrotherFinale, generateBbFinale } from \"./bigBrotherFinale\";\nimport { rng, roundTwoDigits } from \"../../utils\";\nimport { doesHeroWinTheFinale as heroWinsTheFinale } from \"../../utils/ai/aiUtils\";\nimport { classifyRelationship, RelationshipType as Relationship } from \"../../utils/ai/classifyRelationship\";\nimport { PowerRanking } from \"../../model/powerRanking\";\nimport { GameOver, generateGameOver } from \"./gameOver\";\nimport { EpisodeLog } from \"../../model/logging/episodelog\";\n\nfunction firstImpressions(houseguests: Houseguest[]) {\n    for (let i = 0; i < houseguests.length; i++) {\n        const iMap = houseguests[i].relationships;\n        for (let j = i + 1; j < houseguests.length; j++) {\n            // creates a bunch of 100% random mutual relationships\n            const jMap = houseguests[j].relationships;\n            const impression = rng().randomFloat();\n            jMap[i] = impression;\n            iMap[j] = impression;\n        }\n    }\n}\n\nfunction populateSuperiors(houseguests: Houseguest[]) {\n    for (let i = 0; i < houseguests.length; i++) {\n        const hero = houseguests[i];\n        for (let j = i + 1; j < houseguests.length; j++) {\n            const villain = houseguests[j];\n            if (heroWinsTheFinale({ hero, villain }, houseguests)) {\n                villain.superiors.add(hero.id);\n            } else {\n                hero.superiors.add(villain.id);\n            }\n        }\n    }\n}\n\nfunction updatePowerRankings(houseguests: Houseguest[]) {\n    houseguests.forEach(hg => {\n        hg.powerRanking = new PowerRanking(\n            houseguests.length - 1 - hg.superiors.size,\n            houseguests.length - 1\n        );\n    });\n}\n\nfunction updatePopularity(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach(hg => {\n        const result = calculatePopularity(hg, nonEvictedHouseguests(gameState));\n        hg.deltaPopularity = (roundTwoDigits(result) - roundTwoDigits(hg.popularity)) / 100;\n        hg.popularity = result;\n    });\n}\n\nfunction updateFriendCounts(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach(hero => {\n        hero.getFriendEnemyCount = () => {\n            let friends = 0;\n            let enemies = 0;\n            houseguests.forEach(villain => {\n                const rel = classifyRelationship(\n                    hero.popularity,\n                    villain.popularity,\n                    hero.relationshipWith(villain)\n                );\n                if (hero.id === villain.id) {\n                    return;\n                } else if (rel === Relationship.Friend) {\n                    friends++;\n                } else if (rel === Relationship.Enemy) {\n                    enemies++;\n                }\n            });\n            return { friends, enemies };\n        };\n    });\n}\n\nexport class EpisodeFactory {\n    public nextEpisode(gameState: GameState, episodeType: EpisodeType): Episode {\n        let newState = new MutableGameState(gameState);\n        if (gameState.phase === 0) {\n            firstImpressions(newState.houseguests);\n        }\n        newState.phase++;\n        if (nonEvictedHouseguests(gameState).length > 2) {\n            newState.log[newState.phase] = new EpisodeLog();\n        }\n        // If jury starts this episode, populate superior/inferior data. In the future, every jury ep. (dynamic rels)\n        if (inJury(gameState) && getJurors(gameState).length === 0) {\n            populateSuperiors(nonEvictedHouseguests(newState));\n        }\n        if (inJury(gameState)) {\n            updatePowerRankings(nonEvictedHouseguests(newState));\n        }\n        updatePopularity(newState);\n        updateFriendCounts(newState);\n        const finalState = new GameState(newState);\n        switch (episodeType) {\n            case BigBrotherVanilla:\n                return generateBbVanilla(finalState);\n            case BigBrotherFinale:\n                return generateBbFinale(finalState);\n            case GameOver:\n                return generateGameOver(finalState);\n            default:\n                throw new Error(\"Unsupported Episode Type\");\n        }\n    }\n}\n","import {\n    MutableGameState,\n    getById,\n    inJury,\n    nonEvictedHouseguests,\n    GameState,\n    Houseguest,\n    EpisodeType,\n    Episode,\n    InitEpisode\n} from \"../../model\";\nimport { getFinalists, finalJurySize } from \"../../model/season\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateNomCeremonyScene } from \"./scenes/nomCeremonyScene\";\nimport { generateVetoCompScene } from \"./scenes/vetoCompScene\";\nimport { generateVetoCeremonyScene } from \"./scenes/vetoCeremonyScene\";\nimport { generateEvictionScene } from \"./scenes/evictionScene\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Scene } from \"./scene\";\n\nexport const BigBrotherVanilla: EpisodeType = {\n    canPlayWith: (n: number) => {\n        return n > 1;\n    },\n    eliminates: 1,\n    arrowsEnabled: true,\n    hasViewsbar: true\n};\n\n// Refactoring ideas\n/**\n * Might be best to start passing ids instead of houseguests for HoH/nominees/veto winner\n */\n\nexport function evictHouseguest(gameState: MutableGameState, id: number) {\n    const evictee = getById(gameState, id);\n    if (gameState.currentLog) gameState.currentLog.evicted = evictee.id;\n    evictee.isEvicted = true;\n    if (gameState.remainingPlayers - getFinalists() <= finalJurySize()) {\n        evictee.isJury = true;\n    }\n    if (inJury(gameState)) {\n        nonEvictedHouseguests(gameState).forEach(hg => {\n            hg.superiors.delete(evictee.id);\n        });\n    }\n    gameState.remainingPlayers--;\n}\n\nexport function generateBbVanilla(initialGameState: GameState): BigBrotherVanillaEpisode {\n    let currentGameState;\n    let hohCompScene;\n    let hoh: Houseguest;\n    const scenes = [];\n    [currentGameState, hohCompScene, hoh] = generateHohCompScene(initialGameState);\n    scenes.push(hohCompScene);\n\n    let nomCeremonyScene;\n    let nominees: Houseguest[];\n    [currentGameState, nomCeremonyScene, nominees] = generateNomCeremonyScene(currentGameState, hoh);\n    scenes.push(nomCeremonyScene);\n\n    let vetoCompScene;\n    let povWinner: Houseguest;\n    [currentGameState, vetoCompScene, povWinner] = generateVetoCompScene(\n        currentGameState,\n        hoh,\n        nominees[0],\n        nominees[1]\n    );\n    scenes.push(vetoCompScene);\n    let vetoCeremonyScene;\n\n    [currentGameState, vetoCeremonyScene, nominees] = generateVetoCeremonyScene(\n        currentGameState,\n        hoh,\n        nominees,\n        povWinner\n    );\n    scenes.push(vetoCeremonyScene);\n\n    let evictionScene;\n    [currentGameState, evictionScene] = generateEvictionScene(currentGameState, hoh, nominees);\n    scenes.push(evictionScene);\n\n    const title = `Week ${currentGameState.phase}`;\n    const content = (\n        <div>\n            {`Week ${currentGameState.phase}`}\n            <MemoryWall houseguests={initialGameState.houseguests} /> <br />\n            <NextEpisodeButton />\n        </div>\n    );\n    const gameState = new GameState(currentGameState);\n    return new BigBrotherVanillaEpisode({ title, scenes, content, gameState, type: BigBrotherVanilla });\n}\nexport class BigBrotherVanillaEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = BigBrotherVanilla;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import { GameState, Houseguest, MutableGameState, randomPlayer } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { HoHVote } from \"../../../model/logging/voteType\";\n\nexport function generateHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    const previousHoh = initialGameState.previousHOH ? [initialGameState.previousHOH] : [];\n    const newHoH: Houseguest = randomPlayer(newGameState.houseguests, previousHoh);\n    newGameState.previousHOH = newHoH;\n    newGameState.currentLog.votes[newHoH.id] = new HoHVote();\n\n    newHoH.hohWins += 1;\n\n    const scene = new Scene({\n        title: \"HoH Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>\n                    {previousHoh.length > 0 &&\n                        `Houseguests, it's time to find a new Head of Household. As outgoing HoH, ${previousHoh[0].name} will not compete. `}\n                </Centered>\n                <Portrait centered={true} houseguest={newHoH} />\n                <CenteredBold>{newHoH.name} has won Head of Household!</CenteredBold>\n                <br />\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n\n    return [new GameState(newGameState), scene, newHoH];\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    exclude,\n    nonEvictedHouseguests,\n    getById\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { shuffle } from \"lodash\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { nominateNPlayers } from \"../../../utils/ai/aiApi\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\n\nexport function generateNomCeremonyScene(\n    initialGameState: GameState,\n    HoH: Houseguest\n): [GameState, Scene, Houseguest[]] {\n    const newGameState = new MutableGameState(initialGameState);\n    const options = exclude(nonEvictedHouseguests(newGameState), [HoH]);\n    const nom1 = getById(newGameState, nominateNPlayers(HoH, options, newGameState, 2)[0].decision);\n    const nom2 = getById(\n        newGameState,\n        nominateNPlayers(HoH, exclude(options, [nom1]), newGameState, 2)[1].decision\n    );\n    nom1.nominations++;\n    nom2.nominations++;\n    newGameState.currentLog.nominationsPreVeto = [nom1.name, nom2.name];\n    const noms = shuffle([nom1, nom2]);\n    const scene = new Scene({\n        title: \"Nomination Ceremony\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    This is the nomination ceremony. It is my responsibility as the Head of Household to\n                    nominate two houseguests for eviction.\n                </Centered>\n                <Portrait centered={true} houseguest={HoH} />\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Centered> My first nominee is...</Centered>\n                        <Portrait centered={true} houseguest={noms[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Centered>My second nominee is...</Centered>\n                        <Portrait centered={true} houseguest={noms[1]} />\n                    </DividerBox>\n                </div>\n                <CenteredBold>{`I have nominated you, ${noms[0].name} and you, ${noms[1].name} for eviction.`}</CenteredBold>\n                <br />\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene, [nom1, nom2]];\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\n\nexport function generateVetoCompScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    nom1: Houseguest,\n    nom2: Houseguest\n): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    // pick players\n    const choices = nonEvictedHouseguests(newGameState);\n    let povPlayers: any[] = [];\n    const everyoneWillPlay = choices.length <= 6;\n\n    if (everyoneWillPlay) {\n        povPlayers.push({ ...HoH });\n        povPlayers.push({ ...nom1 });\n        povPlayers.push({ ...nom2 });\n        while (povPlayers.length < choices.length) {\n            povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        }\n    } else {\n        // TODO: houseguests choice picks\n        povPlayers.push({ ...HoH });\n        povPlayers.push({ ...nom1 });\n        povPlayers.push({ ...nom2 });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n    }\n    let povWinner = randomPlayer(povPlayers);\n    povWinner = getById(newGameState, povWinner.id);\n    povWinner.povWins++;\n    newGameState.currentLog.vetoWinner = povWinner.name;\n    let introText: string;\n    if (everyoneWillPlay) {\n        introText = \"Everyone left in the house will compete in this challenge.\";\n    } else {\n        introText = `${HoH.name}, as Head of Household, and ${nom1.name} and ${nom2.name} as nominees, will compete, as well as 3 others chosen by random draw.`;\n    }\n    const extras = [povPlayers[3]];\n    povPlayers[4] && extras.push(povPlayers[4]);\n    povPlayers[5] && extras.push(povPlayers[5]);\n    const scene = new Scene({\n        title: \"Veto Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>It's time to pick players for the veto competition.</Centered>\n                <Portraits centered={true} houseguests={[HoH, nom1, nom2]} />\n                <Centered>{introText}</Centered>\n                <Portraits centered={true} houseguests={extras} />\n                <Centered>...</Centered>\n                <Portraits centered={true} houseguests={[povWinner]} />\n                <CenteredBold>{`${povWinner.name} has won the Golden Power of Veto!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene, povWinner];\n}\n","import { GameState, Houseguest, getById, exclude } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { useGoldenVeto, nominateNPlayers } from \"../../../utils/ai/aiApi\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\n\nexport function generateVetoCeremonyScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    initialNominees: Houseguest[],\n    povWinner: Houseguest\n): [GameState, Scene, Houseguest[]] {\n    let povTarget: Houseguest | null = null;\n    let descisionText = \"\";\n    initialNominees[0] = getById(initialGameState, initialNominees[0].id);\n    initialNominees[1] = getById(initialGameState, initialNominees[1].id);\n    HoH = getById(initialGameState, HoH.id);\n    const vetoChoice = useGoldenVeto(povWinner, initialNominees, initialGameState);\n    povTarget = vetoChoice.decision;\n    if (!povTarget) {\n        descisionText += \"... not to use the power of veto.\";\n    } else if (povWinner.id == initialNominees[0].id || povWinner.id == initialNominees[1].id) {\n        descisionText += \"...to use the power of veto on myself.\";\n    } else {\n        descisionText += `...to use the power of veto on ${povTarget.name}.`;\n    }\n    let replacementSpeech = \"\";\n    let nameAReplacement = \"\";\n    let finalNominees: any[] = [...initialNominees];\n    if (povTarget) {\n        nameAReplacement += ` ${HoH.name}, since I have just vetoed one of your nominations, you must name a replacement nominee.`;\n        const replacementNom = {\n            ...getById(\n                initialGameState,\n                nominateNPlayers(\n                    HoH,\n                    exclude(initialGameState.houseguests, [\n                        HoH,\n                        initialNominees[0],\n                        initialNominees[1],\n                        povWinner\n                    ]),\n                    initialGameState,\n                    1\n                )[0].decision\n            )\n        };\n        const replacementIndex = initialNominees.findIndex(hg => hg.id === vetoChoice.decision!.id);\n        finalNominees[replacementIndex] = replacementNom;\n        replacementNom.nominations++;\n        getById(initialGameState, replacementNom.id).nominations++;\n        replacementSpeech = `My replacement nominee is ${replacementNom.name}.`;\n    }\n    const scene = new Scene({\n        title: \"Veto Ceremony\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>This is the Veto Ceremony.</Centered>\n                <Centered>\n                    {`${initialNominees[0].name} and ${initialNominees[1].name} have been nominated for eviction, \n                    but I have the power to veto one of these nominations.`}\n                </Centered>\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={initialNominees[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={initialNominees[1]} />\n                    </DividerBox>\n                </div>\n                <CenteredBold>\n                    I have decided... <br />\n                </CenteredBold>\n                <Portrait centered={true} houseguest={{ ...povWinner, tooltip: vetoChoice.reason }} />\n                <CenteredBold noMargin={true}>{descisionText}</CenteredBold>\n                <Centered>{nameAReplacement}</Centered>\n                {replacementSpeech && <Portrait centered={true} houseguest={HoH} />}\n                <CenteredBold>{replacementSpeech}</CenteredBold>\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={finalNominees[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={finalNominees[1]} />\n                    </DividerBox>\n                </div>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    initialGameState.currentLog.nominationsPostVeto = [finalNominees[0].name, finalNominees[1].name];\n    return [initialGameState, scene, finalNominees];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests, getById } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { shuffle } from \"lodash\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { evictHouseguest } from \"../bigBrotherEpisode\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NomineeVote, NormalVote, HoHVote } from \"../../../model/logging/voteType\";\n\nexport function generateEvictionScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    nominees: Houseguest[]\n): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    nominees = shuffle(nominees);\n    const votes: Array<ProfileHouseguest[]> = [[], []];\n    let lastVoter: Houseguest;\n    nonEvictedHouseguests(newGameState).forEach(hg => {\n        if (hg.id !== nominees[0].id && hg.id !== nominees[1].id && hg.id !== HoH.id) {\n            const logic = castEvictionVote(hg, nominees, newGameState);\n            const result: ProfileHouseguest = { ...hg };\n            result.tooltip = logic.reason;\n            newGameState.currentLog.votes[hg.id] = new NormalVote(nominees[logic.decision].id);\n            votes[logic.decision].push(result);\n            lastVoter = hg;\n        }\n    });\n    const votesFor0 = votes[0].length;\n    const votesFor1 = votes[1].length;\n    newGameState.currentLog.outOf = votesFor0 + votesFor1;\n    if (votesFor0 + votesFor1 === 1) {\n        newGameState.currentLog.soleVoter = lastVoter!!.name;\n    }\n    let tieVote = votesFor0 === votesFor1;\n    let tieBreaker = { decision: 0, reason: \"Error you should not be seeing this\" };\n    if (tieVote) {\n        newGameState.currentLog.outOf++;\n        tieBreaker = castEvictionVote(HoH, nominees, newGameState);\n        newGameState.currentLog.votes[HoH.id] = new HoHVote(nominees[tieBreaker.decision].id);\n    }\n    let evictee: Houseguest;\n    if (votesFor0 > votesFor1) {\n        evictee = nominees[0];\n        newGameState.currentLog.votesInMajority = votesFor0;\n    } else if (votesFor1 > votesFor0) {\n        evictee = nominees[1];\n        newGameState.currentLog.votesInMajority = votesFor1;\n    } else {\n        evictee = nominees[tieBreaker.decision];\n        newGameState.currentLog.votesInMajority = votesFor1 + 1;\n    }\n    newGameState.currentLog.votes[nominees[0].id] = new NomineeVote(evictee.id === nominees[0].id);\n    newGameState.currentLog.votes[nominees[1].id] = new NomineeVote(evictee.id !== nominees[0].id);\n\n    evictHouseguest(newGameState, evictee.id);\n    const isUnanimous = votesFor0 === 0 || votesFor1 === 0;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${votesFor0} to ${votesFor1}...`;\n\n    const displayHoH: ProfileHouseguest = { ...HoH };\n    displayHoH.tooltip = tieBreaker.reason;\n    const scene = new Scene({\n        title: \"Live Eviction\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[0]} centered={true} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[1]} centered={true} />\n                    </DividerBox>\n                </div>\n                {tieVote && (\n                    <div>\n                        <CenteredBold> We have a tie.</CenteredBold>\n                        <Centered>{`${HoH.name}, as current Head of Household, you must cast the sole vote to evict.`}</Centered>\n                        <Portraits houseguests={[displayHoH]} centered={true} />\n                        <CenteredBold>I vote to evict {`${evictee.name}.`}</CenteredBold>\n                    </div>\n                )}\n                <Portraits\n                    houseguests={[\n                        getById(newGameState, nominees[0].id),\n                        getById(newGameState, nominees[1].id)\n                    ]}\n                    centered={true}\n                />\n                <CenteredBold>{`${evictee.name}... you have been evicted from the Big Brother House.`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [newGameState, scene];\n}\n","import { Subscription } from \"rxjs\";\nimport { Sidebar } from \"./sidebar\";\nimport { Season } from \"../../model/season\";\nimport { Episode, nonEvictedHouseguests, getById } from \"../../model\";\nimport { Scene } from \"../episode/scene\";\nimport {\n    mainContentStream$,\n    episodes$,\n    switchEpisode$,\n    newEpisode,\n    switchSceneRelative,\n    cast$,\n    getSelectedPlayer,\n    selectedPlayer$\n} from \"../../subjects/subjects\";\n\ninterface IndexedScene {\n    scene: Scene;\n    index: number;\n}\n\nconst LEFT = 37;\nconst RIGHT = 39;\n\nexport class SidebarController {\n    private view: Sidebar;\n    private subscriptions: Subscription[] = [];\n    private season: Season = new Season();\n    private scenes: IndexedScene[] = [];\n    private selectedEpisode: number = 0;\n\n    public constructor(view: Sidebar) {\n        this.view = view;\n        this.subscriptions.push(\n            episodes$.subscribe({\n                next: episode => this.onNewEpisode(episode)\n            })\n        );\n        this.subscriptions.push(\n            switchEpisode$.subscribe({\n                next: (value: number) => {\n                    this.switchSceneRelative(value);\n                }\n            })\n        );\n        this.subscriptions.push(\n            cast$.subscribe({\n                next: () => (this.season = new Season())\n            })\n        );\n    }\n\n    public getSelectedEpisode() {\n        return this.selectedEpisode;\n    }\n\n    public async switchToScene(id: number) {\n        mainContentStream$.next(this.scenes[id].scene.render);\n        this.selectedEpisode = this.scenes[id].index;\n        await this.view.setState({ selectedScene: id });\n        if (getSelectedPlayer() !== null) {\n            selectedPlayer$.next(\n                getById(this.scenes[this.view.state.selectedScene].scene.gameState, getSelectedPlayer()!.id)\n            );\n        }\n    }\n\n    private switchSceneRelative = (delta: number) => {\n        const selectedScene = this.view.state.selectedScene;\n        const renderedScenes = this.scenes.length;\n        const targetScene = selectedScene + delta;\n        if (targetScene < 0) {\n            return;\n        }\n        const lastEpisode = this.view.state.episodes[this.view.state.episodes.length - 1];\n        if (targetScene < renderedScenes) {\n            // Go back to an earlier scene\n            this.switchToScene(targetScene);\n        } else if (targetScene === renderedScenes) {\n            // Generate a new scene, then jump to it\n            const currentGameState = lastEpisode.gameState;\n            const newPlayerCount = nonEvictedHouseguests(lastEpisode.gameState).length;\n            const nextEpisodeType = this.season.whichEpisodeType(newPlayerCount);\n            if (newPlayerCount > 0) {\n                newEpisode(this.season.renderEpisode(currentGameState, nextEpisodeType));\n                this.switchSceneRelative(1);\n            }\n        }\n    };\n\n    get handleKeyDown(): (e: any) => void {\n        return this._handleKeyDown.bind(this);\n    }\n\n    private _handleKeyDown(event: any) {\n        const state = this.view.state;\n\n        if (\n            state.episodes[this.selectedEpisode] === undefined ||\n            !state.episodes[this.selectedEpisode].type.arrowsEnabled\n        ) {\n            return;\n        }\n        if (event.keyCode === LEFT) {\n            switchSceneRelative(-1);\n        } else if (event.keyCode === RIGHT) {\n            switchSceneRelative(1);\n        }\n    }\n\n    private onNewEpisode(episode: Episode | null) {\n        if (!episode) {\n            this.view.setState({ episodes: [], selectedScene: 0 });\n            this.scenes = [];\n        } else {\n            const newState = { ...this.view.state };\n            // starts at -1: prevent OBOE\n            const latestIndex = this.scenes.length === 0 ? -1 : this.scenes[this.scenes.length - 1].index;\n            const index = latestIndex + 1;\n            this.scenes.push({ scene: episode, index });\n            episode.scenes.forEach(scene => this.scenes.push({ scene, index }));\n            newState.episodes.push(episode);\n            this.view.setState(newState);\n        }\n    }\n\n    public destroy() {\n        this.subscriptions.forEach(sub => sub.unsubscribe());\n    }\n}\n","import React from \"react\";\nimport { SidebarController } from \"./sidebarController\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { Episode, GameState } from \"../../model\";\nimport { Scene } from \"../episode/scene\";\nimport { newEpisode } from \"../../subjects/subjects\";\ninterface SidebarState {\n    episodes: Episode[];\n    selectedScene: number;\n}\n\nexport class Sidebar extends React.Component<{}, SidebarState> {\n    private controller: SidebarController;\n    public constructor(props: {}) {\n        super(props);\n        this.controller = new SidebarController(this);\n        this.state = { episodes: [], selectedScene: 0 };\n        newEpisode(new PregameEpisode(new GameState([])));\n    }\n\n    public componentDidMount() {\n        document.addEventListener(\"keydown\", this.controller.handleKeyDown);\n    }\n\n    public componentWillUnmount() {\n        this.controller.destroy();\n    }\n\n    public render() {\n        return (\n            <div className=\"box\" style={{ minWidth: 140 }}>\n                {this.getEpisodes()}\n            </div>\n        );\n    }\n\n    private getHighlight(title: string, key: number) {\n        if (key === this.state.selectedScene) {\n            return <mark>{title}</mark>;\n        }\n        return title;\n    }\n\n    private getEpisodes() {\n        const result: JSX.Element[] = [];\n        // Weird OBOE to make keys start at 0\n        let episodeKey = -1;\n        let breakKey = 0;\n        this.state.episodes.forEach((episode: Episode) => {\n            const id = ++episodeKey;\n            result.push(\n                <b\n                    key={id}\n                    onClick={() => {\n                        this.controller.switchToScene(id);\n                    }}\n                >\n                    {this.getHighlight(episode.title, id)}\n                </b>\n            );\n            result.push(<br key={--breakKey} />);\n            episode.scenes.forEach((scene: Scene) => {\n                const id = ++episodeKey;\n                if (this.controller.getSelectedEpisode() === episode.gameState.phase) {\n                    result.push(\n                        <a key={id} onClick={() => this.controller.switchToScene(id)}>\n                            {this.getHighlight(scene.title, id)}\n                        </a>\n                    );\n                    result.push(<br key={--breakKey} />);\n                }\n            });\n        });\n        return result;\n    }\n}\n","import styled from \"styled-components\";\nimport React from \"react\";\nimport { mainContentStream$ } from \"../../subjects/subjects\";\n\nconst MainContentAreaWrapper = styled.div`\n    overflow-x: auto;\n`;\n\nexport class MainContentArea extends React.Component<{}, { content: any }> {\n    // a simple class that displays whatever it gets fed through the main content stream.\n\n    private contentStream: any;\n\n    public constructor(props: any) {\n        super(props);\n        this.state = { content: null };\n    }\n\n    public componentDidMount() {\n        this.contentStream = mainContentStream$.subscribe(content => {\n            this.setState({ content });\n        });\n    }\n\n    public componentDidUpdate(prevProps: never, prevState: any) {\n        if (prevState.content !== this.state.content) {\n            window.scrollTo(0, 0);\n        }\n    }\n\n    public componentWillUnmount() {\n        this.contentStream.unsubscribe();\n    }\n\n    public render() {\n        return <MainContentAreaWrapper className=\"box\">{this.state.content}</MainContentAreaWrapper>;\n    }\n}\n","import \"./bulma.scss\";\nimport React from \"react\";\nimport { Sidebar } from \"../sidebar/sidebar\";\nimport { Topbar } from \"../topbar/topBar\";\nimport { MainContentArea } from \"./mainContentArea\";\nimport { MainPageController } from \"./mainPageController\";\n\ninterface MainPageProps {\n    controller: MainPageController;\n}\n\ninterface MainPageState {\n    fullscreen: boolean;\n}\n\nexport class MainPage extends React.Component<MainPageProps, MainPageState> {\n    public constructor(props: MainPageProps) {\n        super(props);\n        this.state = { fullscreen: false };\n        props.controller.inject(this);\n    }\n    public componentDidMount() {\n        this.props.controller.subscribe();\n    }\n    public componentWillUnmount() {\n        this.props.controller.unsubscribe();\n    }\n\n    public render() {\n        const fullscreen = this.state.fullscreen;\n        const hideOnFullscreen = { display: fullscreen ? \"none\" : \"\" };\n        const wrapperStyle = fullscreen\n            ? { margin: \"auto\" }\n            : { margin: \"auto\", maxWidth: 1380, overflow: \"hidden\" };\n        return (\n            <div style={wrapperStyle}>\n                <Topbar style={hideOnFullscreen} />\n                <div className=\"columns\">\n                    <div className=\"column is-narrow\" style={hideOnFullscreen}>\n                        <Sidebar />\n                    </div>\n\n                    <div className=\"column\" style={{ overflowX: \"hidden\" }}>\n                        <MainContentArea />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","import { MainPage } from \"./mainPage\";\nimport { Subscription } from \"rxjs\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\n\nexport class MainPageController {\n    private view: MainPage = new MainPage({ controller: this });\n    private subscriptions: Subscription[] = [];\n    public inject(page: MainPage) {\n        this.view = page;\n    }\n\n    public subscribe(): void {\n        this.unsubscribe();\n        this.subscriptions.push(\n            isFullscreen$.subscribe((fullscreen: boolean) => {\n                this.view.setState({ fullscreen });\n            })\n        );\n    }\n\n    public unsubscribe(): void {\n        this.subscriptions.forEach(sub => sub.unsubscribe());\n    }\n}\n","import React, { Component } from \"react\";\nimport { MainPage } from \"./components/mainPage/mainPage\";\nimport { MainPageController } from \"./components/mainPage/mainPageController\";\n\nclass App extends Component {\n    render() {\n        return <MainPage controller={new MainPageController()} />;\n    }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {});\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {});\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {});\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}